define("frontend/app",["exports","ember","ember/resolver","ember/load-initializers","./config/environment"],function(e,t,r,n,i){"use strict";t["default"].MODEL_FACTORY_INJECTIONS=!0;var a=t["default"].Application.extend({modulePrefix:i["default"].modulePrefix,podModulePrefix:i["default"].podModulePrefix,Resolver:r["default"]});n["default"](a,i["default"].modulePrefix),e["default"]=a}),define("frontend/components/base-focusable",["exports","ember-paper/components/base-focusable"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/dual-slider",["exports","ember"],function(e,t){"use strict";var r=t["default"].Component.extend({classNames:["ember-slider"],classNameBindings:["orientation"],first:-10,startFirst:-10,second:10,startSecond:10,rangeStart:-10,rangeEnd:10,firstPercentage:"left: 0%;",secondPercentage:"left: 100%;",inputtingFirst:!1,inputtingSecond:!1,orientation:"horizontal",init:function(){this.get("controller").on("resetSliders",this,this.reset),this.set("startFirst",this.get("first")),this.setFirstPercentage(),this.set("startSecond",this.get("second")),this.setSecondPercentage(),this._super()},setFirstPercentage:function(){var e=Number(this.get("second")),t=this.get("first");if("-"!==t){t=Number(t);var r=Number(this.get("rangeStart")),n=Number(this.get("rangeEnd"));r>t?(t=r,this.set("first",t)):t>e&&(t=e,this.set("first",t));var i=(t-r)/(n-r)*100;"vertical"===this.get("orientation")?this.set("firstPercentage","bottom: "+i+"%;"):this.set("firstPercentage","left: "+i+"%;"),this.sendAction("action",this.get("first"),this.get("second"))}}.observes("first"),setSecondPercentage:function(){var e=this.get("second");if("-"!==e){e=Number(e);var t=Number(this.get("first")),r=Number(this.get("rangeStart")),n=Number(this.get("rangeEnd"));t>e?(e=t,this.set("second",e)):e>n&&(e=n,this.set("second",e));var i=(e-r)/(n-r)*100;"vertical"===this.get("orientation")?this.set("secondPercentage","bottom: "+i+"%;"):this.set("secondPercentage","left: "+i+"%;"),this.sendAction("action",this.get("first"),this.get("second"))}}.observes("second"),actions:{moveFirstHandle:function(){var e=this,t=this.get("rangeStart"),r=this.get("rangeEnd")-this.get("rangeStart");if("vertical"===this.get("orientation")){var n=this.$(".slider-base").offset().top,i=n+this.$(".slider-base").height(),a=i-n;$(document).on("mousemove",function(n){var o=i-n.pageY,s=o/a*r+t;e.set("first",e.roundIt(s)),e.sendAction("action",e.get("first"),e.get("second"))})}else{var o=this.$(".slider-base").offset().left,s=o+this.$(".slider-base").width(),u=s-o;$(document).on("mousemove",function(n){var i=n.pageX-o,a=i/u*r+t;e.set("first",e.roundIt(a)),e.sendAction("action",e.get("first"),e.get("second"))})}$(document).on("mouseup",function(){$(document).off()})},moveSecondHandle:function(){var e=this,t=this.get("rangeStart"),r=this.get("rangeEnd")-this.get("rangeStart");if("vertical"===this.get("orientation")){var n=this.$(".slider-base").offset().top,i=n+this.$(".slider-base").height(),a=i-n;$(document).on("mousemove",function(n){var o=i-n.pageY,s=o/a*r+t;e.set("second",e.roundIt(s)),e.sendAction("action",e.get("first"),e.get("second"))})}else{var o=this.$(".slider-base").offset().left,s=o+this.$(".slider-base").width(),u=s-o;$(document).on("mousemove",function(n){var i=n.pageX-o,a=i/u*r+t;e.set("second",e.roundIt(a)),e.sendAction("action",e.get("first"),e.get("second"))})}$(document).on("mouseup",function(){$(document).off()})},inputValueFirst:function(){this.toggleProperty("inputtingFirst")},inputValueSecond:function(){this.toggleProperty("inputtingSecond")},confirmValueSecond:function(){this.toggleProperty("inputtingSecond")},confirmValueFirst:function(){this.toggleProperty("inputtingFirst")}},roundIt:function(e){return parseInt(100*e)/100},reset:function(){this.set("first",this.get("startFirst")),this.set("second",this.get("startSecond"))}});e["default"]=r}),define("frontend/components/materialize-button-submit",["exports","./materialize-button"],function(e,t){"use strict";e["default"]=t["default"].extend({layoutName:"components/materialize-button",tagName:"button",attributeBindings:["type"],type:"submit"})}),define("frontend/components/materialize-button",["exports","ember"],function(e,t){"use strict";e["default"]=t["default"].Component.extend({didInsertElement:function(){this._super(),t["default"].run.scheduleOnce("afterRender",this,function(){var e=window.Waves||{};"function"==typeof e.displayEffect&&e.displayEffect()})},tagName:"a",classNameBindings:["btn:waves-effect","isFlat::waves-light","isDisabled:disabled:waves-effect","buttonClass"],text:null,icon:null,iconPosition:"left",buttonType:null,isFlat:t["default"].computed.equal("buttonType","flat"),isDisabled:!1,buttonClass:function(){return this.get("buttonType")?"btn-"+this.get("buttonType"):"btn"}.property("buttonType"),click:function(){this.sendAction()}})}),define("frontend/components/materialize-navbar",["exports","ember"],function(e,t){"use strict";e["default"]=t["default"].Component.extend({didInsertElement:function(){this._super(),t["default"].run.scheduleOnce("afterRender",this,function(){"function"==typeof $(".button-collapse").sideNav&&$(".button-collapse").sideNav()})},tagName:"nav"})}),define("frontend/components/paper-button",["exports","ember-paper/components/paper-button"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-checkbox",["exports","ember-paper/components/paper-checkbox"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-content",["exports","ember-paper/components/paper-content"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-drawer",["exports","ember-paper/components/paper-drawer"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-radio",["exports","ember-paper/components/paper-radio"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-sidenav",["exports","ember-paper/components/paper-sidenav"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-text",["exports","ember-paper/components/paper-text"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/paper-toggle",["exports","ember-paper/components/paper-toggle"],function(e,t){"use strict";e["default"]=t["default"]}),define("frontend/components/scroll-arrow",["exports","ember"],function(e,t){"use strict";var r=t["default"].Component.extend({direction:"",divClass:"",visible:!1,actions:{showIt:function(){this.set("visible",!0)},hideIt:function(){this.set("visible",!1)},scrollIt:function(){var e=$("."+this.get("divClass"));$(document.body).animate({scrollTop:e.offset().top-$(document.body).offset().top},1e3)}}});e["default"]=r}),define("frontend/components/single-slider",["exports","ember"],function(e,t){"use strict";var r=t["default"].Component.extend({classNames:["ember-slider"],classNameBindings:["orientation"],pos:0,startPos:0,rangeStart:-10,rangeEnd:10,percentage:"left: 50%;",inputting:!1,orientation:"horizontal",init:function(){this.get("controller").on("resetSliders",this,this.reset),this.set("startPos",this.get("pos")),this.setPercentage(),this._super()},setPercentage:function(){var e=Number(this.get("pos"));if("-"!==e){e=Number(e);var t=Number(this.get("rangeStart")),r=Number(this.get("rangeEnd"));t>e?(e=t,this.set("pos",e)):e>r&&(e=r,this.set("pos",e));var n=(e-t)/(r-t)*100;"vertical"===this.get("orientation")?this.set("percentage","bottom: "+n+"%;"):this.set("percentage","left: "+n+"%;")}}.observes("pos"),actions:{moveHandle:function(){var e=this,t=this.get("rangeStart"),r=(this.get("pos"),this.get("rangeEnd")-this.get("rangeStart"));if("vertical"===this.get("orientation")){var n=this.$(".slider-base").offset().top,i=n+this.$(".slider-base").height(),a=i-n;$(document).on("mousemove",function(n){var o=i-n.pageY,s=o/a*r+t;e.set("pos",e.roundIt(s)),e.sendAction("action",e.get("pos"))})}else{var o=this.$(".slider-base").offset().left,s=o+this.$(".slider-base").width(),u=s-o;$(document).on("mousemove",function(n){var i=n.pageX-o,a=i/u*r+t;e.set("pos",e.roundIt(a)),e.sendAction("action",e.get("pos"))})}$(document).on("mouseup",function(){$(document).off()})},inputValue:function(){this.toggleProperty("inputting")},confirmValue:function(){this.toggleProperty("inputting")}},roundIt:function(e){return parseInt(100*e)/100},reset:function(){this.set("pos",this.get("startPos"))},testIt:function(){console.log("Component")}});e["default"]=r}),define("frontend/components/square-div",["exports","ember"],function(e,t){"use strict";var r=t["default"].Component.extend({addedClass:"",centerVertically:!1,didInsertElement:function(){this.setHeight(),console.log(this.get("centerVertically")),this.get("centerVertically")===!0&&this.center(),$(window).bind("resize",this.setHeight)},willDestroy:function(){$(window).unbind("resize",this.setHeight)},setHeight:function(){var e=$(".square-div"),t=e.width();e.css("height",t)},center:function(){var e=$(".square-div");e.each(function(e,t){var r=$(t).height(),n=$(t).find(".content"),i=n.height(),a=(r-i)/2;n.css("margin-top",a)})}});e["default"]=r}),define("frontend/controllers/application",["exports","ember"],function(e,t){"use strict";var r=t["default"].Controller.extend({loggedIn:function(){return this.get("session").isLoggedIn()?!0:!1}.property("session.loggedIn")});e["default"]=r}),define("frontend/controllers/demos/derivatives",["exports","ember","../../mixins/animation"],function(e,t,r){"use strict";var n=t["default"].Controller.extend(t["default"].Evented,r["default"],{});e["default"]=n}),define("frontend/controllers/demos/integrals",["exports","ember","../../mixins/animation"],function(e,t,r){"use strict";var n=t["default"].Controller.extend(t["default"].Evented,r["default"],{});e["default"]=n}),define("frontend/controllers/demos/revolutions",["exports","ember","../../mixins/animation"],function(e,t,r){"use strict";var n=t["default"].Controller.extend(t["default"].Evented,r["default"],{});e["default"]=n}),define("frontend/controllers/index",["exports","ember","../objects/session","../objects/flash"],function(e,t,r,n){"use strict";var i=t["default"].Controller.extend({loggedIn:function(){return this.get("session").isLoggedIn()?!0:!1}.property("session.loggedIn"),actions:{submitSignup:function(){var e=this.get("email");t["default"].$.ajax("/signup",{type:"POST",dataType:"JSON",data:{email:e},success:function(e){e.error?n["default"].pushFlash("error",e.error):n["default"].pushFlash("notice","Welcome to the mailing list!")},error:function(e){window.console.log(e)}})}}});e["default"]=i}),define("frontend/controllers/lessons/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].ArrayController.extend({});e["default"]=r}),define("frontend/controllers/lessons/new",["exports","ember"],function(e,t){"use strict";var r=t["default"].ObjectController.extend({author:function(){return this.get("model").get("author")}.property("author"),title:function(){return this.get("model").get("title")}.property("title"),steps:function(){for(var e=this.get("model").get("lessonSteps"),t=new Array(e.get("length")),r=0;r<t.length;r++)t[e.objectAt(r).get("orderNumber")-1]=e.objectAt(r);return t}.property("steps"),setTitle:function(e){this.get("model").set("title",e)}});e["default"]=r}),define("frontend/controllers/lessons/new/create-step",["exports","ember","../../../definitions/stepArray"],function(e,t,r){"use strict";var n=t["default"].ObjectController.extend({needs:"lessonsShow",lesson:t["default"].computed.alias("controllers.lessonsShow"),selectType:!0,choices:r["default"]});e["default"]=n}),define("frontend/controllers/lessons/new/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].ObjectController.extend({needs:"lessonsNew",lesson:t["default"].computed.alias("controllers.lessonsNew"),title:"Untitled",editTitle:!1,setTitle:function(){this.get("lesson").setTitle(this.get("title"))}.observes("title"),author:function(){return this.get("lesson").get("author")}.property("lesson.author"),fullName:function(){return this.get("author").get("firstName")+" "+this.get("author").get("lastName")}.property("author.isFulfilled"),actions:{editTitle:function(){this.set("editTitle",!0)},stopEdit:function(){this.set("editTitle",!1)}}});e["default"]=r}),define("frontend/controllers/lessons/new/step",function(){"use strict"}),define("frontend/controllers/lessons/show",["exports","ember"],function(e,t){"use strict";var r=t["default"].ObjectController.extend({currentStep:0,author:function(){return this.get("model").get("author")}.property("author"),fullName:function(){return this.get("author").get("firstName")+" "+this.get("author").get("lastName")}.property("author.isFulfilled"),title:function(){return this.get("model").get("title")}.property("title"),steps:function(){for(var e=this.get("model").get("lessonSteps"),t=new Array(e.get("length")),r=0;r<t.length;r++)t[e.objectAt(r).get("orderNumber")-1]=e.objectAt(r);return t}.property("steps"),actions:{previousStep:function(){console.log(this.get("currentStep"));var e=this.get("steps"),t=this.get("currentStep"),r=t-1;0===t?console.log("0 step"):1===t?(this.transitionToRoute("lessons.show"),this.set("currentStep",0)):(this.transitionToRoute("lessons.show.step",e.objectAt(r-1)),this.set("currentStep",t-1))},nextStep:function(){console.log(this.get("currentStep"));var e=this.get("steps"),t=this.get("currentStep"),r=t-1;t===e.get("length")?console.log("last step"):(this.transitionToRoute("lessons.show.step",e.objectAt(r+1)),this.set("currentStep",t+1))}}});e["default"]=r}),define("frontend/controllers/lessons/show/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].ObjectController.extend({needs:"lessonsShow",lesson:t["default"].computed.alias("controllers.lessonsShow"),init:function(){this._super()},title:function(){return this.get("lesson").get("title")}.property("lesson.title"),author:function(){return this.get("lesson").get("author")}.property("lesson.author"),fullName:function(){return this.get("author").get("firstName")+" "+this.get("author").get("lastName")}.property("author.isFulfilled"),actions:{setCurrentStep:function(){this.get("lesson").set("currentStep",0)}}});e["default"]=r}),define("frontend/controllers/lessons/show/step",["exports","ember","../../../mixins/animation","../../../views/demos/revolutions","../../../views/demos/derivatives","../../../views/demos/integrals"],function(e,t,r,n,i,a){"use strict";var o=t["default"].ObjectController.extend(t["default"].Evented,r["default"],{needs:"lessonsShow",lesson:t["default"].computed.alias("controllers.lessonsShow"),init:function(){this._super()},setCurrentStep:function(){var e=this.get("model").get("orderNumber");this.get("lesson").set("currentStep",e)}.observes("orderNumber"),multipleChoice:function(){return 1===this.get("model").get("lessonStepType").get("typeNumber")?!0:!1}.property("lessonStepType"),animation:function(){return 2===this.get("model").get("lessonStepType").get("typeNumber")?!0:!1}.property("lessonStepType"),equation:function(){return 3===this.get("model").get("lessonStepType").get("typeNumber")?!0:!1}.property("lessonStepType"),animationParams:function(){if(2===this.get("model").get("lessonStepType").get("typeNumber")){for(var e={},t=this.get("model").get("animation").get("params").get("keys"),r=this.get("model").get("animation").get("params").get("values"),n=0;t.get("length");n++)e[t.objectAt(n)]=r.objectAt(n);return e}return{}}.property("animation"),animationSpecialParams:function(){if(2===this.get("model").get("lessonStepType").get("typeNumber")){for(var e={},t=this.get("model").get("animation").get("specialParams").get("keys"),r=this.get("model").get("animation").get("specialParams").get("values"),n=0;t.get("length");n++)e[t.objectAt(n)]=r.objectAt(n);return e}return{}}.property("animation"),animationType:function(){var e=this.get("model").get("lessonStepType").get("animationType");return 1===e?n["default"]:2===e?a["default"]:3===e?i["default"]:void 0}.property(),instructions:function(){for(var e=this.get("model").get("explanation").get("instructions"),t=new Array(e.get("length")),r=0;r<t.length;r++)t[e.objectAt(r).get("orderNumber")-1]=e.objectAt(r);return t}.property("explanation"),multipleChoiceQuestion:function(){var e=this.get("model").get("multipleChoice").get("question");return e}.property("multipleChoice"),multipleChoiceAnswers:function(){for(var e=this.get("model").get("multipleChoice").get("choices"),t=new Array(e.get("length")),r=0;r<e.get("length");r++)t[e.objectAt(r).get("choiceId")-1]=e.objectAt(r);return t}.property("multipleChoice")});e["default"]=o}),define("frontend/controllers/login",["exports","ember","../objects/flash"],function(e,t,r){"use strict";var n=t["default"].Controller.extend({loggedIn:function(){return this.get("session").isLoggedIn()?!0:!1}.property("session"),actions:{submitForm:function(){var e=this,n=this.get("email"),i=this.get("password"),a=this.get("rememberMe");t["default"].$.ajax("/login",{type:"POST",dataType:"JSON",data:{email:n,password:i},success:function(t){console.log(t),t.error?(r["default"].pushFlash("error",t.error),console.log(t.error)):e.get("session").login(t.user,a,function(){e.transitionToRoute("index")})},error:function(e){console.log(e)}})}}});e["default"]=n}),define("frontend/controllers/signup",["exports","ember","../objects/flash"],function(e,t,r){"use strict";var n=t["default"].Controller.extend({loggedIn:function(){return this.get("session").isLoggedIn()?!0:!1}.property("session"),actions:{submitForm:function(){var e=this,n=this.get("firstName"),i=this.get("lastName"),a=this.get("email"),o=this.get("password");t["default"].$.ajax("/signup",{type:"POST",dataType:"JSON",data:{firstName:n,lastName:i,email:a,password:o},success:function(t){t.error?r["default"].pushFlash("warning",t.error):e.get("session").login(t.user,!1,function(){r["default"].pushFlash("notice","Welcome to HigherEd!")}),e.transitionToRoute("index")},error:function(e){window.console.log(e)}})}}});e["default"]=n}),define("frontend/controllers/subjects/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].ArrayController.extend({});e["default"]=r}),define("frontend/controllers/subjects/show",["exports","ember"],function(e,t){"use strict";var r=t["default"].ObjectController.extend({demo:function(){var e=(this.get("model"),this.get("sections"));console.log(e.get("currentState")[0].get("title"))}.property("demo")});e["default"]=r}),define("frontend/definitions/animationKeys",["exports"],function(e){"use strict";e["default"]={REVOLUTIONS_OF_SOLIDS:1,DERIVATIVES:2,INTEGRALS:3}}),define("frontend/definitions/stepArray",["exports"],function(e){"use strict";e["default"]=[{label:"Multiple Choice",typeNumber:1},{label:"Animation",typeNumber:2,animationTypes:[{type:"Revolutions of Solids",animationType:1},{type:"Derivatives",animationType:2},{type:"Integrals",animationType:3}]},{label:"Equation",typeNumber:3}]}),define("frontend/definitions/typeKeys",["exports"],function(e){"use strict";e["default"]={MULTIPLE_CHOICE:1,ANIMATION:2,EQUATION:3}}),define("frontend/helpers/focus-input",["exports","ember"],function(e,t){"use strict";var r=t["default"].TextField.extend({didInsertElement:function(){this.$().select()}});e["default"]=t["default"].Handlebars.helper("focus-input",r)}),define("frontend/helpers/slider-label-input",["exports","ember"],function(e,t){"use strict";var r=t["default"].TextField.extend({didInsertElement:function(){this.$().select()}});e["default"]=t["default"].Handlebars.helper("slider-label-input",r)}),define("frontend/initializers/app-version",["exports","../config/environment","ember"],function(e,t,r){"use strict";var n=r["default"].String.classify;e["default"]={name:"App Version",initialize:function(e,i){var a=n(i.toString());r["default"].libraries.register(a,t["default"].APP.version)}}}),define("frontend/initializers/export-application-global",["exports","ember","../config/environment"],function(e,t,r){"use strict";function n(e,n){var i=t["default"].String.classify(r["default"].modulePrefix);r["default"].exportApplicationGlobal&&(window[i]=n)}e.initialize=n,e["default"]={name:"export-application-global",initialize:n}}),define("frontend/initializers/link-view",["exports","ember-cli-materialize/initializers/link-view"],function(e,t){"use strict";e["default"]={name:"link-view",initialize:t.initialize}}),define("frontend/initializers/session-setup",["exports","ember","../objects/session"],function(e){"use strict";e["default"]={name:"SessionSetup",after:"store-injector",initialize:function(e,t){var r=e.lookup("session:main");t.deferReadiness(),r.onAppLoad(function(){t.advanceReadiness()})}}}),define("frontend/initializers/store-injector",["exports","ember","../objects/session"],function(e,t,r){"use strict";e["default"]={name:"store-injector",after:"store",initialize:function(e,t){t.register("session:main",r["default"],{singleton:!0}),t.inject("session:main","store","store:main"),t.inject("controller","session","session:main"),t.inject("route","session","session:main")}}}),define("frontend/libraries/mathAnimationLibrary/dist/display-library",["exports","./vendor/three","./vendor/trackballControls"],function(e,t,r){"use strict";function n(e,n,i,a,o){function s(){p.withinRender(),requestAnimationFrame(s),h.update(),c.render(u,l)}var u=new t["default"].Scene,l=new t["default"].PerspectiveCamera(45,e.width()/e.height(),.1,1e3),c=new t["default"].WebGLRenderer;this.scene=u,this.camera=l,this.renderer=c,c.setSize(e.width(),e.height()),c.setClearColor(16777215,1),e.append(c.domElement);var h=new r["default"](l,n);i&&this.build2DAxes(10),a&&this.buildConstraintBox(6,6),o&&this.buildRoom(300),l.position.z=30;var f=new t["default"].Quaternion;f.setFromAxisAngle(new t["default"].Vector3(1,0,0),Math.PI/2);var p=this;s()}n.prototype.invertedCoordinates=function(){var e=new t["default"].Object3D;return e.rotation.x=Math.PI,this.invCoor=e,e},n.prototype.withinRender=function(){},n.prototype.setWithinRender=function(e){this.withinRender=e},n.prototype.clearDisplay=function(){for(var e=this.scene.children;e.length>1;)this.scene.remove(e[1])},n.prototype.pauseAnimation=function(){this.animation.pause()},n.prototype.playAnimation=function(){this.animation.play()},n.prototype.changeAnimationSpeed=function(e){this.animationSpeed=e},n.prototype.roundIt=function(e,t){return Math.round(num*Math.pow(10,t))/Math.pow(10,t)},n.prototype.create2DFunction=function(e){function r(e){var t="f("+e+")",r=s.eval(t);return Number(r)}var n=Number(e.start),i=Number(e.end),a=(i-n)/100,o=void 0===e.axis?"x":e.axis,s=math.parser();s.eval("y"===o?"f(y) = "+e.functionInput:"f(x) = "+e.functionInput);var u=new t["default"].Geometry,l=new t["default"].LineBasicMaterial({linewidth:5,color:16711680});if(null!==c){var c=this.scene.getObjectByName("current2DFunction");this.scene.remove(c)}for(var h=n;i>h;h+=a)u.vertices.push("y"===o?new t["default"].Vector3(r(h),h,0):new t["default"].Vector3(h,r(h),0));var f=new t["default"].Line(u,l);this.scene.add(f),f.name="current2DFunction"},n.prototype.createAxis=function(e){var r=void 0===e.axis?"x":e.axis,n=Number(e.start),i=Number(e.end),a=Number(e.axisValue),o=i-n,s=o/100,u=new t["default"].Geometry,l=new t["default"].LineDashedMaterial({linewidth:5,color:0,dashSize:o/100,gapSize:o/100});if(null!==c){var c=this.scene.getObjectByName("currentAxis");this.scene.remove(c)}for(var h=n;i>h;h+=s)"y"===r?(console.log("here"),u.vertices.push(new t["default"].Vector3(a,h,0))):u.vertices.push(new t["default"].Vector3(h,a,0));var f=new t["default"].Line(u,l);this.scene.add(f),f.name="currentAxis"},n.prototype.createIntegralDisplay=function(e){function r(e){var t="f("+e+")",r=h.eval(t);return Number(r)}function n(e){var t="g("+e+")",r=h.eval(t);return Number(r)}var i=Number(e.start),a=Number(e.end),o=a-i,s=(a-i)/100,u=101,l=void 0===e.axis?"x":e.axis,c=void 0===e.bottomFunction?"0":e.bottomFunction,h=math.parser();if("y"===l?(h.eval("f(y) = "+e.functionInput),h.eval("g(y) = "+c)):(h.eval("f(x) = "+e.functionInput),h.eval("g(x) = "+c)),e.discrete===!0){for(var f=Number(e.numDiscrete)>101?101:parseInt(Number(e.numDiscrete)),p=Array(f),d=Array(f),m=o/f,g=0;f>g;g++){var v=i+(g*m+m/2);p[g]=r(v),d[g]=n(v)}console.log(p),console.log(d)}var y=new t["default"].Geometry,x=new t["default"].MeshBasicMaterial({color:255});if(null!==b){var b=this.scene.getObjectByName("currentIntegral");this.scene.remove(b)}for(var g=0;u>g;g++){var v=i+g*s,w=Math.floor((v-i)/m)>f?f:Math.floor((v-i)/m),M=Math.floor((i+(g+1)*s-i)/m);"y"===l?e.discrete===!0?(y.vertices.push(new t["default"].Vector3(d[w],v,0)),y.vertices.push(new t["default"].Vector3(p[w],v,0)),M>w&&(y.vertices.push(new t["default"].Vector3(d[M],v,0)),y.vertices.push(new t["default"].Vector3(p[M],v,0)))):(y.vertices.push(new t["default"].Vector3(n(v),v,0)),y.vertices.push(new t["default"].Vector3(r(v),v,0))):e.discrete===!0?(y.vertices.push(new t["default"].Vector3(v,d[w],0)),y.vertices.push(new t["default"].Vector3(v,p[w],0)),M>w&&(y.vertices.push(new t["default"].Vector3(v,d[M],0)),y.vertices.push(new t["default"].Vector3(v,p[M],0)))):(y.vertices.push(new t["default"].Vector3(v,n(v),0)),y.vertices.push(new t["default"].Vector3(v,r(v),0)))}console.log(y.vertices.length+3);for(var _=0;_<y.vertices.length-3;_+=2)y.faces.push(new t["default"].Face3(_,_+1,_+2)),y.faces.push(new t["default"].Face3(_,_+2,_+1)),y.faces.push(new t["default"].Face3(_+1,_+2,_+3)),y.faces.push(new t["default"].Face3(_+1,_+3,_+2));y.computeFaceNormals(),y.computeVertexNormals();var x=new t["default"].MeshNormalMaterial,T=new t["default"].Mesh(y,x);this.scene.add(T),T.name="currentIntegral"},n.prototype.createRotationFunction=function(e){function r(e){var t="f("+e+")",r=u.eval(t);return Number(r)}var n=Number(e.start),i=Number(e.end),a=i-n,o=void 0===e.axis?"x":e.axis,s=Number(e.axisValue),u=math.parser();u.eval("y"===o?"f(y) = "+e.functionInput:"f(x) = "+e.functionInput);var l=(i-n)/100,c=Math.floor(a/l)+1;if(e.discrete===!0){for(var h=Number(e.numDiscrete)>101?101:parseInt(Number(e.numDiscrete)),f=Array(h),p=a/h,d=0;h>d;d++){var m=n+(d*p+p/2);f[d]=r(m)}console.log(f)}var g=new t["default"].Geometry;if(null!==v){var v=this.scene.getObjectByName("current");this.scene.remove(v)}for(var y=[],d=0;21>d;d++)y[d]=[];for(var d=0;c>d;d++){var m=n+d*l;if("y"===o){g.vertices.push(new t["default"].Vector3(0+s,m,0));for(var x=0;21>x;x++)y[x].push(new t["default"].Vector3(0+s,m,0))}else{g.vertices.push(new t["default"].Vector3(m,0+s,0));for(var x=0;21>x;x++)y[x].push(new t["default"].Vector3(m,0+s,0))}}for(var b=2*Math.PI/(c-1),d=0;c>d;d++){var m=n+d*l;if(e.discrete===!0)var w=Math.floor((m-n)/p)>h-1?h-1:Math.floor((m-n)/p),M=f[w]-s;else var M=r(m)-s;for(var x=0;c>x;x++)if("y"===o){g.vertices.push(new t["default"].Vector3(M*Math.cos(x*b/1e3)+s,m,M*Math.sin(x*b/1e3)));for(var _=0;21>_;_++)y[_].push(new t["default"].Vector3(M*Math.cos(x*b*_/20)+s,m,M*Math.sin(x*b*_/20)))}else{g.vertices.push(new t["default"].Vector3(m,M*Math.cos(x*b/1e3)+s,M*Math.sin(x*b/1e3)));for(var _=0;21>_;_++)y[_].push(new t["default"].Vector3(m,M*Math.cos(x*b*_/20)+s,M*Math.sin(x*b*_/20)))}}for(var d=0;c>d;d++)for(var T=c*(d+1),E=c*(d+2),x=0;c-1>x;x++)0===d?(g.faces.push(new t["default"].Face3(T+x,T+x+1,0)),g.faces.push(new t["default"].Face3(T+x+1,T+x,0)),g.faces.push(new t["default"].Face3(T+x,T+x+1,E+x)),g.faces.push(new t["default"].Face3(T+x+1,T+x,E+x)),g.faces.push(new t["default"].Face3(T+x+1,E+x,E+x+1)),g.faces.push(new t["default"].Face3(E+x,T+x+1,E+x+1))):d===c-1?(g.faces.push(new t["default"].Face3(T+x,T+x+1,c-1)),g.faces.push(new t["default"].Face3(T+x+1,T+x,c-1))):(g.faces.push(new t["default"].Face3(T+x,T+x+1,E+x)),g.faces.push(new t["default"].Face3(T+x+1,T+x,E+x)),g.faces.push(new t["default"].Face3(T+x+1,E+x,E+x+1)),g.faces.push(new t["default"].Face3(E+x,T+x+1,E+x+1))),0===x&&d!==c-1?(g.faces.push(new t["default"].Face3(T+x,E+x,d)),g.faces.push(new t["default"].Face3(E+x,T+x,d)),g.faces.push(new t["default"].Face3(E+x,d,d+1)),g.faces.push(new t["default"].Face3(E+x,d+1,d))):x===c-2&&d!==c-1&&(g.faces.push(new t["default"].Face3(T+x+1,E+x+1,d)),g.faces.push(new t["default"].Face3(E+x+1,T+x+1,d)),g.faces.push(new t["default"].Face3(E+x+1,d,d+1)),g.faces.push(new t["default"].Face3(E+x+1,d+1,d)));for(var _=0;21>_;_++)g.morphTargets.push({name:"target"+_,vertices:y[_]});g.computeFaceNormals(),g.computeVertexNormals();var S=new t["default"].MeshNormalMaterial({color:10027008,morphTargets:!0}),C=new t["default"].Mesh(g,S);this.scene.add(C),C.name="current",this.animation=new t["default"].MorphAnimation(C),this.animation.loop=!1,this.animationSpeed=1,this.animation.play(),this.setWithinRender(function(){this.animation.update(this.animationSpeed)})},n.prototype.createSurface=function(e){function r(e,t){var r="f("+e+", "+t+")",n=i.eval(r);return[Number(n),null]}function n(e){return null!==e?!0:!1}var i=math.parser();i.eval("f(x,y) = "+e.functionInput);var a=0,o=0,s=e.meshInterval,u=e.xstart,l=e.xend,c=e.ystart,h=e.yend;if(null!==f){var f=this.scene.getObjectByName("current");this.scene.remove(f)}for(var p=new t["default"].Geometry,d=c;h-s>d;d+=s)for(var m=u;l-s>m;m+=s){var g=r(m,d),v=r(m+s,d+s),y=r(m+s,d),x=r(m,d+s),b=g[0],w=g[1],M=v[0],_=v[1],T=y[0],E=y[1],S=x[0],C=x[1];Math.max(b,M,T,S)>a&&(a=Math.max(b,M,T,S)),Math.min(b,M,T,S)<o&&(o=Math.min(b,M,T,S)),Math.max(w,_,E,C)>a&&(a=Math.max(w,_,E,C)),Math.min(w,_,E,C)<o&&(o=Math.min(w,_,E,C));var A=p.vertices.length,N=A;n(b)?n(M)?(p.vertices.push(new t["default"].Vector3(m,d,b)),p.vertices.push(new t["default"].Vector3(m+s,d+s,M)),n(T)?(p.vertices.push(new t["default"].Vector3(m+s,d,T)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),n(S)?(p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.faces.push(new t["default"].Face3(N,N+1,N+3)),p.faces.push(new t["default"].Face3(N,N+3,N+1)),n(w)&&n(_)&&n(E)&&n(C)&&(p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N+4,N+6,N+5)),p.faces.push(new t["default"].Face3(N+4,N+5,N+6)),p.faces.push(new t["default"].Face3(N+4,N+5,N+7)),p.faces.push(new t["default"].Face3(N+4,N+7,N+5)))):n(w)&&n(_)&&n(E)&&(p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.faces.push(new t["default"].Face3(N+3,N+5,N+4)),p.faces.push(new t["default"].Face3(N+3,N+4,N+5)),p.faces.push(new t["default"].Face3(N+0,N+1,N+4)),p.faces.push(new t["default"].Face3(N+0,N+4,N+1)),p.faces.push(new t["default"].Face3(N+0,N+3,N+4)),p.faces.push(new t["default"].Face3(N+0,N+4,N+3)))):n(S)&&(p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),n(w)&&n(_)&&n(C)&&(p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N+3,N+4,N+5)),p.faces.push(new t["default"].Face3(N+3,N+5,N+4)),p.faces.push(new t["default"].Face3(N+0,N+1,N+4)),p.faces.push(new t["default"].Face3(N+0,N+4,N+1)),p.faces.push(new t["default"].Face3(N+0,N+3,N+4)),p.faces.push(new t["default"].Face3(N+0,N+4,N+3))))):n(T)&&n(S)?(p.vertices.push(new t["default"].Vector3(m,d,b)),p.vertices.push(new t["default"].Vector3(m+s,d,T)),p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),n(w)&&n(E)&&n(C)&&(p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N+3,N+5,N+4)),p.faces.push(new t["default"].Face3(N+3,N+4,N+5)),p.faces.push(new t["default"].Face3(N+1,N+2,N+4)),p.faces.push(new t["default"].Face3(N+1,N+4,N+2)),p.faces.push(new t["default"].Face3(N+2,N+4,N+5)),p.faces.push(new t["default"].Face3(N+2,N+5,N+4)))):n(T)?(p.vertices.push(new t["default"].Vector3(m,d,b)),p.vertices.push(new t["default"].Vector3(m+s,d,T)),p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N+1,N+2,N+3)),p.faces.push(new t["default"].Face3(N+1,N+3,N+2))):n(S)&&(p.vertices.push(new t["default"].Vector3(m,d,b)),p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.vertices.push(new t["default"].Vector3(m,d,w)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N+1,N+2,N+3)),p.faces.push(new t["default"].Face3(N+1,N+3,N+2))):n(M)&&n(T)&&n(S)?(p.vertices.push(new t["default"].Vector3(m+s,d+s,M)),p.vertices.push(new t["default"].Vector3(m+s,d,T)),p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),n(_)&&n(E)&&n(C)&&(p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N+3,N+5,N+4)),p.faces.push(new t["default"].Face3(N+3,N+4,N+5)),p.faces.push(new t["default"].Face3(N+1,N+2,N+4)),p.faces.push(new t["default"].Face3(N+1,N+4,N+2)),p.faces.push(new t["default"].Face3(N+2,N+4,N+5)),p.faces.push(new t["default"].Face3(N+2,N+5,N+4)))):n(M)&&n(T)&&n(_)&&n(E)?(p.vertices.push(new t["default"].Vector3(m+s,d+s,M)),p.vertices.push(new t["default"].Vector3(m+s,d,T)),p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m+s,d,E)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N+1,N+2,N+3)),p.faces.push(new t["default"].Face3(N+1,N+3,N+2))):n(M)&&n(S)&&n(_)&&n(C)&&(p.vertices.push(new t["default"].Vector3(m+s,d+s,M)),p.vertices.push(new t["default"].Vector3(m,d+s,S)),p.vertices.push(new t["default"].Vector3(m+s,d+s,_)),p.vertices.push(new t["default"].Vector3(m,d+s,C)),p.faces.push(new t["default"].Face3(N,N+1,N+2)),p.faces.push(new t["default"].Face3(N,N+2,N+1)),p.faces.push(new t["default"].Face3(N+1,N+2,N+3)),p.faces.push(new t["default"].Face3(N+1,N+3,N+2)))
}p.mergeVertices();var R={resolution:{type:"v2",value:new t["default"].Vector2},zmax:{type:"f",value:a},zmin:{type:"f",value:o}},L=new t["default"].ShaderMaterial({uniforms:R,vertexShader:document.getElementById("cubeVertexShader").innerHTML,fragmentShader:document.getElementById("cubeFragmentShader").innerHTML}),D=new t["default"].Mesh(p,L);console.log(D.geometry.vertices[1]),this.scene.add(D),D.name="current"},n.prototype.buildAxes=function(e){function r(e,r,n,i,a,o,s){var u,l=new t["default"].Geometry;return u=o?new t["default"].LineDashedMaterial({linewidth:3,color:a,dashSize:s/100,gapSize:s/100}):new t["default"].LineBasicMaterial({linewidth:3,color:a}),l.vertices.push(e.clone()),l.vertices.push(r.clone()),l.computeLineDistances(),axis=new t["default"].Line(l,u,t["default"].LinePieces),axis}function n(e,r,n,i){var a=new t["default"].Geometry,o=new t["default"].LineBasicMaterial({linewidth:3,color:i});return a.vertices.push(e.clone()),a.vertices.push(r.clone()),a.vertices.push(e.clone()),a.vertices.push(n.clone()),a.computeLineDistances(),arrow=new t["default"].Line(a,o,t["default"].LinePieces),arrow}var i=new t["default"].Object3D;arrowLength=e-e/100,arrowHeight=e/100,i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(e,0,0),new t["default"].Vector3(arrowLength,arrowHeight,0),new t["default"].Vector3(arrowLength,-arrowHeight,0),0,!1,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(-e,0,0),new t["default"].Vector3(-arrowLength,arrowHeight,0),new t["default"].Vector3(-arrowLength,-arrowHeight,0),0,!0,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,e,0),new t["default"].Vector3(0,arrowLength,arrowHeight),new t["default"].Vector3(0,arrowLength,-arrowHeight),0,!1,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,-e,0),new t["default"].Vector3(0,-arrowLength,arrowHeight),new t["default"].Vector3(0,-arrowLength,arrowHeight),0,!0,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,0,e),new t["default"].Vector3(arrowHeight,0,arrowLength),new t["default"].Vector3(-arrowHeight,0,arrowLength),0,!1,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,0,-e),new t["default"].Vector3(arrowHeight,0,-arrowLength),new t["default"].Vector3(-arrowHeight,0,-arrowLength),0,!0,e)),i.add(n(new t["default"].Vector3(e,0,0),new t["default"].Vector3(arrowLength,0,arrowHeight),new t["default"].Vector3(arrowLength,0,-arrowHeight),0)),i.add(n(new t["default"].Vector3(-e,0,0),new t["default"].Vector3(-arrowLength,0,arrowHeight),new t["default"].Vector3(-arrowLength,0,-arrowHeight),0)),i.add(n(new t["default"].Vector3(0,e,0),new t["default"].Vector3(0,arrowLength,arrowHeight),new t["default"].Vector3(0,arrowLength,-arrowHeight),0)),i.add(n(new t["default"].Vector3(0,-e,0),new t["default"].Vector3(0,-arrowLength,arrowHeight),new t["default"].Vector3(0,-arrowLength,-arrowHeight),0)),i.add(n(new t["default"].Vector3(0,0,e),new t["default"].Vector3(arrowHeight,0,arrowLength),new t["default"].Vector3(-arrowHeight,0,arrowLength),0)),i.add(n(new t["default"].Vector3(0,0,-e),new t["default"].Vector3(arrowHeight,0,-arrowLength),new t["default"].Vector3(-arrowHeight,0,-arrowLength),0)),this.scene.add(i),this.axes=i},n.prototype.build2DAxes=function(e){function r(e,r,n,i,a,o,s){var u,l=new t["default"].Geometry;u=o?new t["default"].LineDashedMaterial({linewidth:3,color:a,dashSize:s/100,gapSize:s/100}):new t["default"].LineBasicMaterial({linewidth:3,color:a}),l.vertices.push(e.clone()),l.vertices.push(r.clone()),l.computeLineDistances();var c=new t["default"].Line(l,u,t["default"].LinePieces);return c}function n(e,r,n,i){var a=new t["default"].Geometry,o=new t["default"].LineBasicMaterial({linewidth:3,color:i});a.vertices.push(e.clone()),a.vertices.push(r.clone()),a.vertices.push(e.clone()),a.vertices.push(n.clone()),a.computeLineDistances();var s=new t["default"].Line(a,o,t["default"].LinePieces);return s}var i=new t["default"].Object3D,a=e-e/100,o=e/100;i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(e,0,0),new t["default"].Vector3(a,o,0),new t["default"].Vector3(a,-o,0),0,!1,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(-e,0,0),new t["default"].Vector3(-a,o,0),new t["default"].Vector3(-a,-o,0),0,!0,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,e,0),new t["default"].Vector3(0,a,o),new t["default"].Vector3(0,a,-o),0,!1,e)),i.add(r(new t["default"].Vector3(0,0,0),new t["default"].Vector3(0,-e,0),new t["default"].Vector3(0,-a,o),new t["default"].Vector3(0,-a,o),0,!0,e)),i.add(n(new t["default"].Vector3(e,0,0),new t["default"].Vector3(a,o,0),new t["default"].Vector3(a,-o,0),0)),i.add(n(new t["default"].Vector3(-e,0,0),new t["default"].Vector3(-a,o,0),new t["default"].Vector3(-a,-o,0),0)),i.add(n(new t["default"].Vector3(0,e,0),new t["default"].Vector3(o,a,0),new t["default"].Vector3(-o,a,0),0)),i.add(n(new t["default"].Vector3(0,-e,0),new t["default"].Vector3(o,-a,0),new t["default"].Vector3(-o,-a,0),0)),this.scene.add(i),this.axes=i},n.prototype.buildConstraintBox=function(e){var r=e/2,n=new t["default"].Vector3(r,r,r),i=new t["default"].Vector3(r,r,-r),a=new t["default"].Vector3(r,-r,-r),o=new t["default"].Vector3(r,-r,r),s=new t["default"].Vector3(-r,r,r),u=new t["default"].Vector3(-r,r,-r),l=new t["default"].Vector3(-r,-r,-r),c=new t["default"].Vector3(-r,-r,r),h=new t["default"].Geometry,f=new t["default"].LineBasicMaterial({linewidth:3,color:0});h.vertices.push(n),h.vertices.push(i),h.vertices.push(i),h.vertices.push(a),h.vertices.push(a),h.vertices.push(o),h.vertices.push(o),h.vertices.push(n),h.vertices.push(n),h.vertices.push(s),h.vertices.push(i),h.vertices.push(u),h.vertices.push(a),h.vertices.push(l),h.vertices.push(o),h.vertices.push(c),h.vertices.push(s),h.vertices.push(u),h.vertices.push(u),h.vertices.push(l),h.vertices.push(l),h.vertices.push(c),h.vertices.push(c),h.vertices.push(s);var p=new t["default"].Line(h,f,t["default"].LinePieces);this.scene.add(p),this.cbox=p},n.buildRoom=function(e){for(var r=new t["default"].Object3D,n=new t["default"].Geometry,i=new t["default"].Geometry,a=new t["default"].Geometry,o=new t["default"].PointCloudMaterial({color:255,size:4}),s=new t["default"].PointCloudMaterial({color:65280,size:4}),u=new t["default"].PointCloudMaterial({color:16711680,size:4}),l=0;e>l;l+=e/10)for(var c=0;e>c;c+=e/10)n.vertices.push(new t["default"].Vector3(-l,-c,e)),n.vertices.push(new t["default"].Vector3(l,c,e)),n.vertices.push(new t["default"].Vector3(-l,c,e)),n.vertices.push(new t["default"].Vector3(l,-c,e)),n.vertices.push(new t["default"].Vector3(-l,-c,-e)),n.vertices.push(new t["default"].Vector3(l,c,-e)),n.vertices.push(new t["default"].Vector3(-l,c,-e)),n.vertices.push(new t["default"].Vector3(l,-c,-e)),i.vertices.push(new t["default"].Vector3(-l,e,-c)),i.vertices.push(new t["default"].Vector3(l,e,c)),i.vertices.push(new t["default"].Vector3(-l,e,c)),i.vertices.push(new t["default"].Vector3(l,e,-c)),i.vertices.push(new t["default"].Vector3(-l,-e,-c)),i.vertices.push(new t["default"].Vector3(l,-e,c)),i.vertices.push(new t["default"].Vector3(-l,-e,c)),i.vertices.push(new t["default"].Vector3(l,-e,-c)),a.vertices.push(new t["default"].Vector3(e,-l,-c)),a.vertices.push(new t["default"].Vector3(e,l,c)),a.vertices.push(new t["default"].Vector3(e,-l,c)),a.vertices.push(new t["default"].Vector3(e,l,-c)),a.vertices.push(new t["default"].Vector3(-e,-l,-c)),a.vertices.push(new t["default"].Vector3(-e,l,c)),a.vertices.push(new t["default"].Vector3(-e,-l,c)),a.vertices.push(new t["default"].Vector3(-e,l,-c));r.add(new t["default"].PointCloud(n,o)),r.add(new t["default"].PointCloud(i,s)),r.add(new t["default"].PointCloud(a,u)),this.scene.add(r)},n.prototype.drawLine=function(e,r,n,i){var a=new t["default"].Geometry,o=new t["default"].LineBasicMaterial({linewidth:n,color:i});return a.vertices.push(e),a.vertices.push(r),new t["default"].Line(a,o,t["default"].LinePieces)},n.prototype.drawArc=function(e,r,n,i,a,o){function s(r){"x"===n.toLowerCase()?u.vertices.push(new t["default"].Vector3(e.x,e.y+i*(Math.cos(r)-1),e.z+i*Math.sin(r))):"y"===n.toLowerCase()?u.vertices.push(new t["default"].Vector3(e.x-i*(Math.cos(r)-1),e.y,e.z+i*Math.sin(r))):"z"===n.toLowerCase()?u.vertices.push(new t["default"].Vector3(e.x+i*Math.sin(r),e.y-i*(Math.cos(r)-1),e.z)):console.log("Arc Rotation error, axis not specified")}var u=new t["default"].Geometry,l=new t["default"].LineBasicMaterial({linewidth:a,color:o});if(u.vertices.push(e),r>0)for(var c=0;r>c;c+=.01)s(c);else if(0>r)for(var c=0;c>r;c-=.01)s(c);return new t["default"].Line(u,l)},n.prototype.drawXYZDistances=function(e,r,n){var i=this.scene.getObjectByName("xline");this.scene.remove(i);var a=this.scene.getObjectByName("yline");this.scene.remove(a);var o=this.scene.getObjectByName("zline");this.scene.remove(o),i=this.drawLine(new t["default"].Vector3(0,0,0),new t["default"].Vector3(e,0,0),10,16711680),i.name="xline",this.scene.add(i),a=this.drawLine(new t["default"].Vector3(e,0,0),new t["default"].Vector3(e,r,0),10,65280),a.name="yline",this.scene.add(a),o=this.drawLine(new t["default"].Vector3(e,r,0),new t["default"].Vector3(e,r,n),10,255),o.name="zline",this.scene.add(o)},n.prototype.showDerivative=function(e){function r(e){var t="f("+e+")",r=n.eval(t);return Number(r)}var n=math.parser();n.eval("f(x) = "+e.functionInput);var i=Number(e.location),a=r(i),o=1,s=i-o,u=i+o,l=.01,c=r(i-l),h=r(i+l),f=(h-c)/(2*l),p=a-o*f,d=a+o*f,m=new t["default"].Geometry,g=new t["default"].LineBasicMaterial({linewidth:5,color:0});if(null!==v){var v=this.scene.getObjectByName("currentDerivative");this.scene.remove(v)}m.vertices.push(new t["default"].Vector3(s,p,0)),m.vertices.push(new t["default"].Vector3(u,d,0));var y=new t["default"].Line(m,g);this.scene.add(y),y.name="currentDerivative"},e["default"]=n}),define("frontend/libraries/mathAnimationLibrary/dist/vendor/gentilis_regular.typeface",function(){"use strict";_typeface_js&&_typeface_js.loadFace&&_typeface_js.loadFace({glyphs:{"—":{x_min:41.375,x_max:1022.765625,ha:1064,o:"m 1022 370 q 1013 338 1019 355 q 1002 309 1007 320 l 58 309 l 41 325 q 50 356 44 340 q 62 387 56 373 l 1006 387 l 1022 370 "},"⁄":{x_min:134.28125,x_max:728.40625,ha:814,o:"m 214 2 q 184 -10 198 -5 q 151 -20 169 -15 l 134 0 l 651 816 q 680 828 664 821 q 711 838 696 834 l 728 819 l 214 2 "},"†":{x_min:48.078125,x_max:615.296875,ha:663,o:"m 615 729 q 591 676 605 705 q 559 622 576 647 q 466 645 513 638 q 362 656 419 652 q 368 558 362 608 q 387 461 374 508 q 368 310 373 386 q 362 169 363 234 q 364 85 361 130 q 371 0 367 40 q 341 -15 358 -10 q 307 -27 324 -21 l 288 -12 q 295 80 292 32 q 298 169 298 128 q 291 311 296 236 q 272 461 286 386 q 290 558 285 508 q 297 656 295 609 q 236 651 265 654 q 180 645 208 649 q 123 635 151 641 q 65 622 95 629 l 48 651 q 72 703 57 674 q 103 757 86 732 q 195 734 149 741 q 297 724 241 726 q 287 841 295 785 q 262 948 280 898 q 316 979 288 965 q 368 1004 345 994 l 397 987 q 373 856 382 923 q 363 725 365 789 q 423 728 394 726 q 481 735 453 731 q 539 745 510 739 q 598 758 567 750 l 615 729 "},"’":{x_min:59.875,x_max:256,ha:318,o:"m 256 878 q 246 821 256 852 q 220 760 237 790 q 177 701 202 729 q 119 653 152 673 l 89 676 q 114 709 103 690 q 132 747 124 728 q 142 784 139 766 q 146 816 146 802 q 127 869 146 846 q 70 894 109 892 l 59 924 q 85 943 65 933 q 128 963 105 954 q 174 980 152 973 q 209 986 197 986 q 243 941 231 964 q 256 878 256 917 "},"›":{x_min:94.953125,x_max:368.953125,ha:423,o:"m 368 291 l 124 12 l 94 32 l 251 316 l 95 598 l 124 619 l 367 341 l 368 291 "},"‹":{x_min:54.265625,x_max:328.265625,ha:423,o:"m 299 12 l 54 291 l 54 315 q 54 332 54 324 q 55 341 54 339 l 299 619 l 327 598 l 320 586 q 303 554 314 574 q 278 508 292 534 q 248 457 263 483 q 220 405 233 430 q 195 360 206 379 q 177 328 184 340 q 171 316 170 316 l 328 32 l 299 12 "},"„":{x_min:59.875,x_max:542,ha:624,o:"m 256 41 q 246 -15 256 15 q 220 -76 237 -46 q 177 -135 202 -107 q 119 -184 152 -162 l 89 -160 q 114 -127 103 -146 q 132 -89 124 -108 q 142 -52 139 -70 q 146 -20 146 -34 q 127 32 146 9 q 70 57 109 55 l 59 87 q 85 106 65 96 q 128 126 105 117 q 174 143 152 136 q 209 149 197 149 q 243 104 231 127 q 256 41 256 80 m 542 41 q 532 -15 542 15 q 505 -76 523 -46 q 462 -135 488 -107 q 405 -184 437 -162 l 376 -160 q 400 -127 390 -146 q 418 -89 411 -108 q 429 -52 425 -70 q 433 -20 433 -34 q 414 32 433 9 q 356 57 395 55 l 345 87 q 370 106 350 96 q 414 126 390 117 q 460 143 437 136 q 495 149 483 149 q 529 104 517 127 q 542 41 542 80 "},"”":{x_min:59.875,x_max:542,ha:606,o:"m 256 878 q 246 821 256 852 q 220 760 237 790 q 177 701 202 729 q 119 653 152 673 l 89 676 q 114 709 103 690 q 132 747 124 728 q 142 784 139 766 q 146 816 146 802 q 127 869 146 846 q 70 894 109 892 l 59 924 q 85 943 65 933 q 128 963 105 954 q 174 980 152 973 q 209 986 197 986 q 243 941 231 964 q 256 878 256 917 m 542 878 q 532 821 542 852 q 505 760 523 790 q 462 701 488 729 q 405 653 437 673 l 376 676 q 400 709 390 690 q 418 747 411 728 q 429 784 425 766 q 433 816 433 802 q 414 869 433 846 q 356 894 395 892 l 345 924 q 370 943 350 933 q 414 963 390 954 q 460 980 437 973 q 495 986 483 986 q 529 941 517 964 q 542 878 542 917 "},"€":{x_min:16.28125,x_max:627.359375,ha:652,o:"m 423 317 l 201 317 q 229 197 209 246 q 276 118 248 148 q 337 74 303 88 q 406 61 370 61 q 447 66 427 61 q 490 85 467 72 q 540 120 513 98 q 602 173 567 142 q 609 167 605 172 q 616 158 613 163 q 622 149 619 153 q 627 143 625 145 q 553 65 586 96 q 489 15 520 34 q 426 -11 458 -3 q 358 -20 395 -20 q 261 0 307 -20 q 181 61 216 20 q 122 166 145 102 q 93 317 99 230 l 31 317 l 16 333 q 23 355 19 344 q 31 378 27 367 l 91 378 l 91 380 q 95 466 91 425 l 51 466 l 36 482 q 43 504 40 493 q 51 527 47 516 l 103 527 q 147 661 118 603 q 218 759 176 719 q 313 818 260 798 q 429 838 366 838 q 489 832 463 838 q 538 817 516 827 q 578 796 560 808 q 614 769 596 784 q 612 756 618 766 q 595 733 606 746 q 573 707 585 720 q 553 686 561 694 l 529 690 q 497 719 512 706 q 464 742 482 732 q 424 757 446 752 q 372 763 402 763 q 323 752 349 763 q 274 716 297 742 q 231 643 250 689 q 203 527 212 598 l 444 527 l 461 511 l 444 466 l 198 466 q 197 436 197 451 q 196 405 196 421 l 196 378 l 423 378 l 440 362 l 423 317 "},"–":{x_min:41.375,x_max:610.40625,ha:652,o:"m 610 370 q 601 338 607 355 q 590 309 596 320 l 58 309 l 41 325 q 50 356 44 340 q 62 387 56 373 l 594 387 l 610 370 "},"“":{x_min:62,x_max:546.484375,ha:606,o:"m 259 712 q 233 693 253 704 q 189 672 213 681 q 144 656 166 662 q 109 651 121 650 q 74 694 86 671 q 62 757 62 717 q 71 814 62 784 q 97 875 80 845 q 141 934 115 906 q 199 983 167 961 l 228 959 q 203 925 214 944 q 185 888 193 907 q 175 851 178 869 q 172 818 172 833 q 190 766 172 788 q 248 742 208 744 l 259 712 m 546 712 q 520 693 540 704 q 476 672 500 681 q 431 656 453 662 q 396 651 408 650 q 376 671 385 660 q 361 694 368 681 q 352 722 355 706 q 349 757 349 738 q 358 814 349 784 q 384 875 367 845 q 428 934 402 906 q 486 983 454 961 l 515 959 q 490 925 501 944 q 472 888 480 907 q 462 851 465 869 q 459 818 459 833 q 477 766 459 788 q 534 742 495 744 l 546 712 "},"‘":{x_min:62,x_max:259.5,ha:318,o:"m 259 712 q 233 693 253 704 q 189 672 213 681 q 144 656 166 662 q 109 651 121 650 q 74 694 86 671 q 62 757 62 717 q 71 814 62 784 q 97 875 80 845 q 141 934 115 906 q 199 983 167 961 l 228 959 q 203 925 214 944 q 185 888 193 907 q 175 851 178 869 q 172 818 172 833 q 190 766 172 788 q 248 742 208 744 l 259 712 "},"ﬁ":{x_min:30.875,x_max:770.984375,ha:808,o:"m 554 985 q 544 969 554 980 q 521 947 535 958 q 493 925 507 935 q 468 910 478 915 q 435 935 452 924 q 403 952 419 945 q 375 962 388 959 q 353 966 362 966 q 315 954 335 966 q 278 911 295 942 q 249 826 261 880 q 238 689 238 773 l 238 631 l 412 631 l 432 611 q 417 591 426 602 q 399 571 408 580 q 381 553 389 561 q 366 543 372 545 q 321 559 350 551 q 238 567 292 567 l 238 69 q 245 61 238 65 q 269 52 252 57 q 312 42 286 48 q 379 29 339 36 l 379 0 l 41 0 l 41 29 q 111 49 87 37 q 136 69 136 61 l 136 567 l 45 567 l 30 585 l 83 631 l 136 631 l 136 652 q 146 786 136 731 q 176 878 157 841 q 219 941 195 916 q 271 988 244 967 q 311 1015 289 1003 q 354 1034 332 1026 q 395 1046 375 1042 q 427 1051 414 1051 q 470 1042 448 1051 q 511 1024 493 1034 q 542 1002 530 1013 q 554 985 554 991 m 479 0 l 479 29 q 549 49 525 38 q 574 70 574 61 l 574 454 q 572 510 574 488 q 562 543 571 531 q 534 560 553 555 q 479 569 515 566 l 479 596 q 523 606 500 600 q 569 619 546 612 q 614 634 593 626 q 652 651 635 642 l 676 651 l 676 70 q 698 50 676 62 q 770 29 721 38 l 770 0 l 479 0 m 696 854 q 689 818 696 835 q 673 789 683 801 q 648 769 662 776 q 617 762 634 762 q 573 778 586 762 q 560 826 560 795 q 566 862 560 845 q 583 892 572 879 q 608 911 594 904 q 638 919 622 919 q 696 854 696 919 "},"…":{x_min:89,x_max:860.40625,ha:929,o:"m 250 83 q 242 39 250 59 q 223 4 235 19 q 193 -18 210 -10 q 156 -27 176 -27 q 104 -7 120 -27 q 89 48 89 12 q 96 91 89 71 q 116 127 103 111 q 146 151 129 142 q 183 160 164 160 q 233 140 216 160 q 250 83 250 120 m 555 83 q 548 39 555 59 q 528 4 541 19 q 498 -18 515 -10 q 461 -27 481 -27 q 409 -7 425 -27 q 394 48 394 12 q 401 91 394 71 q 421 127 409 111 q 452 151 434 142 q 488 160 469 160 q 538 140 522 160 q 555 83 555 120 m 860 83 q 853 39 860 59 q 833 4 846 19 q 803 -18 821 -10 q 767 -27 786 -27 q 714 -7 730 -27 q 699 48 699 12 q 706 91 699 71 q 727 127 714 111 q 757 151 740 142 q 793 160 774 160 q 843 140 827 160 q 860 83 860 120 "},"‚":{x_min:59.875,x_max:256,ha:318,o:"m 256 41 q 246 -15 256 15 q 220 -76 237 -46 q 177 -135 202 -107 q 119 -184 152 -162 l 89 -160 q 114 -127 103 -146 q 132 -89 124 -108 q 142 -52 139 -70 q 146 -20 146 -34 q 127 32 146 9 q 70 57 109 55 l 59 87 q 85 106 65 96 q 128 126 105 117 q 174 143 152 136 q 209 149 197 149 q 243 104 231 127 q 256 41 256 80 "},"‑":{x_min:41.375,x_max:426.609375,ha:468,o:"m 426 370 q 416 338 422 355 q 405 309 411 320 l 58 309 l 41 325 q 50 356 44 340 q 62 387 56 373 l 409 387 l 426 370 "},"‡":{x_min:47.734375,x_max:614.9375,ha:663,o:"m 614 729 q 590 676 605 705 q 559 622 576 647 q 466 644 512 637 q 363 656 420 652 q 369 574 364 613 q 388 488 375 534 q 370 402 376 443 q 364 321 365 360 q 424 325 395 322 q 481 331 452 327 q 538 341 509 335 q 597 354 567 347 l 614 325 q 590 273 605 302 q 559 218 576 244 q 467 239 513 230 q 363 252 420 248 q 371 133 363 186 q 398 28 379 80 q 343 -2 372 11 q 292 -27 315 -17 l 263 -10 q 288 119 279 54 q 298 252 296 183 q 237 247 266 250 q 180 240 209 244 q 123 230 152 236 q 64 218 95 225 l 47 247 q 71 300 57 271 q 103 354 86 329 q 195 331 148 338 q 298 321 241 323 q 290 402 296 360 q 273 488 285 444 q 291 574 286 535 q 298 656 296 613 q 180 644 235 652 q 64 622 125 635 l 47 651 q 71 703 57 674 q 103 757 86 732 q 195 734 148 741 q 298 724 241 726 q 287 842 296 788 q 263 948 279 897 q 317 979 289 965 q 369 1004 346 994 l 398 987 q 376 858 385 923 q 364 725 367 792 q 481 735 426 727 q 597 758 536 742 l 614 729 "},"•":{x_min:47.46875,x_max:337.75,ha:386,o:"m 337 448 q 325 373 337 407 q 292 315 314 339 q 241 277 271 291 q 176 264 212 264 q 119 275 143 264 q 79 306 95 286 q 55 354 63 327 q 47 415 47 382 q 60 489 47 455 q 94 548 72 523 q 145 586 115 572 q 209 600 174 600 q 264 588 240 600 q 304 557 288 577 q 329 509 320 537 q 337 448 337 482 "},"ﬂ":{x_min:30.875,x_max:777.734375,ha:808,o:"m 472 0 l 472 29 q 521 38 501 33 q 552 49 540 44 q 568 59 563 54 q 574 70 574 65 l 574 878 q 569 926 574 909 q 555 951 565 942 q 535 960 546 957 q 520 947 528 953 q 492 925 507 935 q 467 910 478 915 q 435 935 451 924 q 403 952 418 945 q 374 962 388 959 q 352 966 361 966 q 315 954 335 966 q 278 911 295 942 q 249 826 260 880 q 238 689 238 773 l 238 631 l 412 631 l 432 611 q 417 591 426 602 q 399 571 408 580 q 381 553 389 561 q 366 543 372 545 q 321 559 350 551 q 238 567 292 567 l 238 69 q 245 61 238 65 q 269 52 252 57 q 312 42 286 48 q 379 29 339 36 l 379 0 l 41 0 l 41 29 q 111 49 87 37 q 136 69 136 61 l 136 567 l 45 567 l 30 585 l 83 631 l 136 631 l 136 652 q 146 786 136 731 q 176 878 157 841 q 219 941 194 916 q 270 988 243 967 q 310 1015 289 1003 q 353 1034 332 1026 q 394 1046 375 1042 q 426 1051 413 1051 q 470 1042 447 1051 q 510 1023 492 1034 q 535 1008 524 1016 q 569 1017 552 1013 q 651 1051 609 1029 l 676 1027 l 676 70 q 699 49 676 60 q 777 29 722 38 l 777 0 l 472 0 "},"‰":{x_min:52,x_max:1356,ha:1408,o:"m 1257 196 q 1248 278 1257 243 q 1226 337 1239 313 q 1194 371 1212 360 q 1156 383 1175 383 q 1126 373 1141 383 q 1099 343 1111 363 q 1080 294 1087 324 q 1073 225 1073 265 q 1080 140 1073 176 q 1101 81 1088 104 q 1133 46 1114 58 q 1173 35 1152 35 q 1205 45 1190 35 q 1232 75 1220 55 q 1250 126 1243 95 q 1257 196 1257 156 m 1356 209 q 1339 120 1356 162 q 1296 47 1323 78 q 1232 -2 1269 15 q 1157 -21 1196 -21 q 1083 -2 1116 -21 q 1025 47 1049 15 q 988 120 1001 78 q 975 209 975 162 q 991 298 975 256 q 1035 371 1008 339 q 1099 420 1063 402 q 1173 439 1135 439 q 1248 421 1214 439 q 1305 371 1281 403 q 1342 298 1329 340 q 1356 209 1356 257 m 810 196 q 801 278 810 243 q 778 337 793 313 q 746 371 764 360 q 708 383 727 383 q 678 373 693 383 q 652 343 664 363 q 634 294 641 324 q 627 225 627 265 q 634 140 627 176 q 655 81 641 104 q 686 46 668 58 q 726 35 704 35 q 758 45 743 35 q 784 75 773 55 q 803 126 796 95 q 810 196 810 156 m 907 209 q 890 120 907 162 q 847 47 874 78 q 783 -2 820 15 q 708 -21 747 -21 q 635 -2 669 -21 q 578 47 602 15 q 541 120 555 78 q 528 209 528 162 q 544 298 528 256 q 588 371 561 339 q 652 420 616 402 q 726 439 688 439 q 800 421 767 439 q 857 371 833 403 q 894 298 881 340 q 907 209 907 257 m 242 10 q 224 0 236 5 q 199 -8 212 -4 q 172 -17 185 -13 q 151 -24 159 -21 l 134 0 l 715 805 q 759 825 734 817 q 805 839 784 833 l 825 816 l 242 10 m 334 595 q 325 678 334 643 q 302 736 317 713 q 270 770 288 759 q 232 782 251 782 q 202 772 217 782 q 176 742 188 762 q 157 693 164 723 q 150 624 150 664 q 157 539 150 575 q 178 480 164 503 q 210 445 191 457 q 250 434 228 434 q 282 444 266 434 q 308 474 297 454 q 327 525 320 494 q 334 595 334 555 m 432 608 q 415 519 432 561 q 372 446 399 477 q 308 396 344 414 q 232 378 272 378 q 159 396 192 378 q 102 446 126 414 q 65 519 78 477 q 52 608 52 561 q 68 697 52 655 q 111 770 84 738 q 175 819 139 801 q 250 838 211 838 q 324 820 291 838 q 381 770 357 802 q 418 697 405 739 q 432 608 432 656 "}},cssFontWeight:"normal",ascender:1214,underlinePosition:-250,cssFontStyle:"normal",boundingBox:{yMin:-184,xMin:16.28125,yMax:1051,xMax:1356},resolution:1e3,original_font_information:{postscript_name:"Gentilis-Regular",version_string:"Version 1.100",vendor_url:"http://scripts.sil.org/",full_font_name:"Gentilis",font_family_name:"Gentilis",copyright:"Copyright (c) SIL International, 2003-2008.",description:"",trademark:"Gentium is a trademark of SIL International.",designer:"J. Victor Gaultney and Annie Olsen",designer_url:"http://www.sil.org/~gaultney",unique_font_identifier:"SIL International:Gentilis:2-3-108",license_url:"http://scripts.sil.org/OFL",license_description:'Copyright (c) 2003-2008, SIL International (http://www.sil.org/) with Reserved Font Names "Gentium" and "SIL".\r\n\r\nThis Font Software is licensed under the SIL Open Font License, Version 1.1. This license is copied below, and is also available with a FAQ at: http://scripts.sil.org/OFL\r\n\r\n\r\n-----------------------------------------------------------\r\nSIL OPEN FONT LICENSE Version 1.1 - 26 February 2007\r\n-----------------------------------------------------------\r\n\r\nPREAMBLE\r\nThe goals of the Open Font License (OFL) are to stimulate worldwide development of collaborative font projects, to support the font creation efforts of academic and linguistic communities, and to provide a free and open framework in which fonts may be shared and improved in partnership with others.\r\n\r\nThe OFL allows the licensed fonts to be used, studied, modified and redistributed freely as long as they are not sold by themselves. The fonts, including any derivative works, can be bundled, embedded, redistributed and/or sold with any software provided that any reserved names are not used by derivative works. The fonts and derivatives, however, cannot be released under any other type of license. The requirement for fonts to remain under this license does not apply to any document created using the fonts or their derivatives.\r\n\r\nDEFINITIONS\r\n"Font Software" refers to the set of files released by the Copyright Holder(s) under this license and clearly marked as such. This may include source files, build scripts and documentation.\r\n\r\n"Reserved Font Name" refers to any names specified as such after the copyright statement(s).\r\n\r\n"Original Version" refers to the collection of Font Software components as distributed by the Copyright Holder(s).\r\n\r\n"Modified Version" refers to any derivative made by adding to, deleting, or substituting -- in part or in whole -- any of the components of the Original Version, by changing formats or by porting the Font Software to a new environment.\r\n\r\n"Author" refers to any designer, engineer, programmer, technical writer or other person who contributed to the Font Software.\r\n\r\nPERMISSION & CONDITIONS\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the Font Software, to use, study, copy, merge, embed, modify, redistribute, and sell modified and unmodified copies of the Font Software, subject to the following conditions:\r\n\r\n1) Neither the Font Software nor any of its individual components, in Original or Modified Versions, may be sold by itself.\r\n\r\n2) Original or Modified Versions of the Font Software may be bundled, redistributed and/or sold with any software, provided that each copy contains the above copyright notice and this license. These can be included either as stand-alone text files, human-readable headers or in the appropriate machine-readable metadata fields within text or binary files as long as those fields can be easily viewed by the user.\r\n\r\n3) No Modified Version of the Font Software may use the Reserved Font Name(s) unless explicit written permission is granted by the corresponding Copyright Holder. This restriction only applies to the primary font name as presented to the users.\r\n\r\n4) The name(s) of the Copyright Holder(s) or the Author(s) of the Font Software shall not be used to promote, endorse or advertise any Modified Version, except to acknowledge the contribution(s) of the Copyright Holder(s) and the Author(s) or with their explicit written permission.\r\n\r\n5) The Font Software, modified or unmodified, in part or in whole, must be distributed entirely under this license, and must not be distributed under any other license. The requirement for fonts to remain under this license does not apply to any document created using the Font Software.\r\n\r\nTERMINATION\r\nThis license becomes null and void if any of the above conditions are not met.\r\n\r\nDISCLAIMER\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL THE COPYRIGHT HOLDER BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"SIL International",font_sub_family_name:"Regular"},descender:-394,familyName:"Gentilis",lineHeight:1607,underlineThickness:100})}),define("frontend/libraries/mathAnimationLibrary/dist/vendor/math",["exports"],function(e){"use strict";!function(t,r){"object"==typeof e&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):"object"==typeof e?e.math=r():t.math=r()}(void 0,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){function n(e){if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var t={},o={matrix:"matrix",number:"number",precision:64,epsilon:1e-14};t.config=function(e){if(e){if(i.deepExtend(o,e),e.precision&&t.type.BigNumber.config({precision:e.precision}),r(2)(t,o),e.number&&e.number.defaultType)throw new Error("setting `number.defaultType` is deprecated. Use `number` instead.");if(e.number&&e.number.precision)throw new Error("setting `number.precision` is deprecated. Use `precision` instead.");if(e.matrix&&e.matrix.defaultType)throw new Error("setting `matrix.defaultType` is deprecated. Use `matrix` instead.");if(e.matrix&&e.matrix["default"])throw new Error("setting `matrix.default` is deprecated. Use `matrix` instead.");if(e.decimals)throw new Error("setting `decimals` is deprecated. Use `precision` instead.")}return i.clone(o)},t.create=n;var s=r(139).constructor();if("function"!=typeof s.prototype.clone&&(s.prototype.clone=function(){return new s(this)}),"function"==typeof s.convert)throw new Error("Cannot add function convert to BigNumber: function already exists");return s.convert=function(e){return a(e)>15?e:new s(e)},t.error=r(5),t.type={},t.type.Complex=r(6),t.type.Range=r(7),t.type.Index=r(8),t.type.Matrix=r(9),t.type.Unit=r(10),t.type.Help=r(11),t.type.ResultSet=r(12),t.type.BigNumber=s,t.collection=r(13),t.expression={},t.expression.node=r(16),t.expression.parse=r(14),t.expression.Parser=r(15),t.expression.docs=r(17),r(29)(t,o),r(30)(t,o),r(31)(t,o),r(32)(t,o),r(33)(t,o),r(34)(t,o),r(35)(t,o),r(36)(t,o),r(37)(t,o),r(38)(t,o),r(39)(t,o),r(40)(t,o),r(41)(t,o),r(42)(t,o),r(43)(t,o),r(44)(t,o),r(45)(t,o),r(46)(t,o),r(47)(t,o),r(48)(t,o),r(49)(t,o),r(50)(t,o),r(51)(t,o),r(52)(t,o),r(53)(t,o),r(54)(t,o),r(55)(t,o),r(56)(t,o),r(57)(t,o),r(58)(t,o),r(59)(t,o),r(60)(t,o),r(61)(t,o),r(62)(t,o),r(63)(t,o),r(64)(t,o),r(65)(t,o),r(66)(t,o),r(67)(t,o),r(68)(t,o),r(69)(t,o),r(70)(t,o),r(71)(t,o),r(72)(t,o),r(73)(t,o),r(74)(t,o),r(75)(t,o),r(76)(t,o),r(77)(t,o),r(78)(t,o),r(79)(t,o),r(80)(t,o),r(81)(t,o),r(82)(t,o),r(83)(t,o),r(84)(t,o),r(85)(t,o),r(86)(t,o),r(87)(t,o),r(88)(t,o),r(89)(t,o),r(90)(t,o),r(91)(t,o),r(92)(t,o),r(93)(t,o),r(94)(t,o),r(95)(t,o),r(96)(t,o),r(97)(t,o),r(98)(t,o),r(99)(t,o),r(100)(t,o),r(101)(t,o),r(102)(t,o),r(103)(t,o),r(104)(t,o),r(105)(t,o),r(106)(t,o),r(107)(t,o),r(108)(t,o),r(109)(t,o),r(110)(t,o),r(111)(t,o),r(112)(t,o),r(113)(t,o),r(114)(t,o),r(115)(t,o),r(116)(t,o),r(117)(t,o),r(118)(t,o),r(119)(t,o),r(120)(t,o),r(121)(t,o),r(122)(t,o),r(123)(t,o),r(124)(t,o),r(125)(t,o),r(126)(t,o),r(127)(t,o),r(128)(t,o),r(129)(t,o),r(130)(t,o),r(131)(t,o),r(132)(t,o),r(133)(t,o),r(134)(t,o),r(135)(t,o),t.ifElse=function(){throw new Error("Function ifElse is deprecated. Use the conditional operator instead.")},r(2)(t,o),r(18)(t,o),r(19)(t,o),r(20)(t,o),r(21)(t,o),r(22)(t,o),r(23)(t,o),r(24)(t,o),r(25)(t,o),r(26)(t,o),r(27)(t,o),t.chaining={},t.chaining.Selector=r(28)(t,o),t.config(o),t.config(e),t}var i=r(3),a=r(4).digits,o=n();"undefined"!=typeof window&&(window.mathjs=o),e.exports=o},function(e,t,r){e.exports=function(e,t){function n(){return new l(1).exp()}function i(){return new l(1).plus(new l(5).sqrt()).div(2)}function a(e){for(var t=e,r=0/0,n=e.times(e),i=e,a=-1,o=3;!t.equals(r);o+=2)i=i.times(n),r=t,t=a>0?t.plus(i.div(o)):t.minus(i.div(o)),a=-a;return t}function o(){var e=l.constructor({precision:l.precision+4}),t=new e(4).times(a(new e(1).div(5))).minus(a(new e(1).div(239)));return new l(4).times(t)}function s(){l.config({precision:t.precision+2});var e=o();return l.config({precision:t.precision}),new l(2).times(e)}var u=(r(136),r(6)),l=e.type.BigNumber,c="bignumber"===t.number;
e.pi=c?o():Math.PI,e.tau=c?s():2*Math.PI,e.e=c?n():Math.E,e.phi=c?i():1.618033988749895,e.i=new u(0,1),e.Infinity=1/0,e.NaN=0/0,e["true"]=!0,e["false"]=!1,e["null"]=null,e.uninitialized=r(137).UNINITIALIZED,e.E=e.e,e.LN2=c?new l(2).ln():Math.LN2,e.LN10=c?new l(10).ln():Math.LN10,e.LOG2E=c?new l(1).div(new l(2).ln()):Math.LOG2E,e.LOG10E=c?new l(1).div(new l(10).ln()):Math.LOG10E,e.PI=e.pi,e.SQRT1_2=c?new l(.5).sqrt():Math.SQRT1_2,e.SQRT2=c?new l(2).sqrt():Math.SQRT2,e.version=r(138)}},function(e,t){t.clone=function r(e){var t=typeof e;if("number"===t||"string"===t||"boolean"===t||null===e||void 0===e)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map(function(e){return r(e)});if(e instanceof Number)return new Number(e.valueOf());if(e instanceof String)return new String(e.valueOf());if(e instanceof Boolean)return new Boolean(e.valueOf());if(e instanceof Date)return new Date(e.valueOf());if(e instanceof RegExp)throw new TypeError("Cannot clone "+e);var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=r(e[i]));return n},t.extend=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},t.deepExtend=function n(e,t){if(Array.isArray(t))throw new TypeError("Arrays are not supported by deepExtend");for(var r in t)if(t.hasOwnProperty(r))if(t[r]&&t[r].constructor===Object)void 0===e[r]&&(e[r]={}),e[r].constructor===Object?n(e[r],t[r]):e[r]=t[r];else{if(Array.isArray(t[r]))throw new TypeError("Arrays are not supported by deepExtend");e[r]=t[r]}return e},t.deepEqual=function(e,r){var n,i,a;if(Array.isArray(e)){if(!Array.isArray(r))return!1;if(e.length!=r.length)return!1;for(i=0,a=e.length;a>i;i++)if(!t.deepEqual(e[i],r[i]))return!1;return!0}if(e instanceof Object){if(Array.isArray(r)||!(r instanceof Object))return!1;for(n in e)if(!t.deepEqual(e[n],r[n]))return!1;for(n in r)if(!t.deepEqual(e[n],r[n]))return!1;return!0}return typeof e==typeof r&&e==r}},function(e,t){t.isNumber=function(e){return e instanceof Number||"number"==typeof e},t.isInteger=function(e){return e==Math.round(e)},t.sign=function(e){return e>0?1:0>e?-1:0},t.format=function(e,r){if("function"==typeof r)return r(e);if(1/0===e)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var n="auto",i=void 0;switch(r&&(r.notation&&(n=r.notation),t.isNumber(r)?i=r:r.precision&&(i=r.precision)),n){case"fixed":return t.toFixed(e,i);case"exponential":return t.toExponential(e,i);case"auto":var a=.001,o=1e5;if(r&&r.exponential&&(void 0!==r.exponential.lower&&(a=r.exponential.lower),void 0!==r.exponential.upper&&(o=r.exponential.upper)),0===e)return"0";var s,u=Math.abs(e);if(u>=a&&o>u){var l=i?e.toPrecision(Math.min(i,21)):e.toPrecision();s=parseFloat(l)+""}else s=t.toExponential(e,i);return s.replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", or "fixed".')}},t.toExponential=function(e,t){return void 0!==t?e.toExponential(Math.min(t-1,20)):e.toExponential()},t.toFixed=function(e,t){return e.toFixed(Math.min(t,20))},t.digits=function(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},t.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,t.nearlyEqual=function(e,r,n){if(null==n)return e==r;if(e==r)return!0;if(isNaN(e)||isNaN(r))return!1;if(isFinite(e)&&isFinite(r)){var i=Math.abs(e-r);return i<t.DBL_EPSILON?!0:i<=Math.max(Math.abs(e),Math.abs(r))*n}return!1}},function(e,t,r){t.ArgumentsError=r(140),t.DimensionError=r(141),t.IndexError=r(142),t.UnsupportedTypeError=r(143)},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");switch(arguments.length){case 0:this.re=0,this.im=0;break;case 1:var r=arguments[0];if("object"==typeof r){if("re"in r&&"im"in r){var i=new n(r.re,r.im);this.re=i.re,this.im=i.im;break}if("r"in r&&"phi"in r){var i=n.fromPolar(r.r,r.phi);this.re=i.re,this.im=i.im;break}}throw new SyntaxError("Object with the re and im or r and phi properties expected.");case 2:if(!d(e)||!d(t))throw new TypeError("Two numbers expected in Complex constructor");this.re=e,this.im=t;break;default:throw new SyntaxError("One, two or three arguments expected in Complex constructor")}}function i(){for(;" "==x||"	"==x;)s()}function a(e){return e>="0"&&"9">=e||"."==e}function o(e){return e>="0"&&"9">=e}function s(){y++,x=v.charAt(y)}function u(e){y=e,x=v.charAt(y)}function l(){var e,t="";if(e=y,"+"==x?s():"-"==x&&(t+=x,s()),!a(x))return u(e),null;if("."==x){if(t+=x,s(),!o(x))return u(e),null}else{for(;o(x);)t+=x,s();"."==x&&(t+=x,s())}for(;o(x);)t+=x,s();if("E"==x||"e"==x){if(t+=x,s(),("+"==x||"-"==x)&&(t+=x,s()),!o(x))return u(e),null;for(;o(x);)t+=x,s()}return t}function c(){var e=v.charAt(y+1);if("I"==x||"i"==x)return s(),"1";if(!("+"!=x&&"-"!=x||"I"!=e&&"i"!=e)){var t="+"==x?"1":"-1";return s(),s(),t}return null}var h=r(144),f=r(10),p=h.number,d=h.number.isNumber,m=f.isUnit,g=h.string.isString;n.isComplex=function(e){return e instanceof n};var v,y,x;n.parse=function(e){if(v=e,y=-1,x="",!g(v))return null;s(),i();var t=l();if(t){if("I"==x||"i"==x)return s(),i(),x?null:new n(0,Number(t));i();var r=x;if("+"!=r&&"-"!=r)return i(),x?null:new n(Number(t),0);s(),i();var a=l();if(a){if("I"!=x&&"i"!=x)return null;s()}else if(a=c(),!a)return null;return"-"==r&&(a="-"==a[0]?"+"+a.substring(1):"-"+a),s(),i(),x?null:new n(Number(t),Number(a))}return(t=c())?(i(),x?null:new n(0,Number(t))):null},n.fromPolar=function(){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return n.fromPolar(e.r,e.phi);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var t=arguments[0],r=arguments[1];if(d(t)){if(m(r)&&r.hasBase(f.BASE_UNITS.ANGLE)&&(r=r.toNumber("rad")),d(r))return new n(t*Math.cos(r),t*Math.sin(r));throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},n.prototype.toPolar=function(){return{r:Math.sqrt(this.re*this.re+this.im*this.im),phi:Math.atan2(this.im,this.re)}},n.prototype.clone=function(){return new n(this.re,this.im)},n.prototype.equals=function(e){return this.re===e.re&&this.im===e.im},n.prototype.format=function(e){var t="",r=p.format(this.re,e),n=p.format(this.im,e);return t=0==this.im?r:0==this.re?1==this.im?"i":-1==this.im?"-i":n+"i":this.im>0?1==this.im?r+" + i":r+" + "+n+"i":-1==this.im?r+" - i":r+" - "+n.substring(1)+"i"},n.prototype.toString=function(){return this.format()},n.prototype.valueOf=n.prototype.toString,e.exports=n},function(e,t,r){function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(null!=e&&!a.isNumber(e))throw new TypeError("Parameter start must be a number");if(null!=t&&!a.isNumber(t))throw new TypeError("Parameter end must be a number");if(null!=r&&!a.isNumber(r))throw new TypeError("Parameter step must be a number");this.start=null!=e?parseFloat(e):0,this.end=null!=t?parseFloat(t):0,this.step=null!=r?parseFloat(r):1}{var i=r(144),a=i.number,o=i.string;i.array}n.parse=function(e){if(!o.isString(e))return null;var t=e.split(":"),r=t.map(function(e){return parseFloat(e)}),i=r.some(function(e){return isNaN(e)});if(i)return null;switch(r.length){case 2:return new n(r[0],r[1]);case 3:return new n(r[0],r[2],r[1]);default:return null}},n.prototype.clone=function(){return new n(this.start,this.end,this.step)},n.isRange=function(e){return e instanceof n},n.prototype.size=function(){var e=0,t=this.start,r=this.step,n=this.end,i=n-t;return a.sign(r)==a.sign(i)?e=Math.ceil(i/r):0==i&&(e=0),isNaN(e)&&(e=0),[e]},n.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},n.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},n.prototype.forEach=function(e){var t=this.start,r=this.step,n=this.end,i=0;if(r>0)for(;n>t;)e(t,i,this),t+=r,i++;else if(0>r)for(;t>n;)e(t,i,this),t+=r,i++},n.prototype.map=function(e){var t=[];return this.forEach(function(r,n,i){t[n]=e(r,n,i)}),t},n.prototype.toArray=function(){var e=[];return this.forEach(function(t,r){e[r]=t}),e},n.prototype.valueOf=function(){return this.toArray()},n.prototype.format=function(e){var t=a.format(this.start,e);return 1!=this.step&&(t+=":"+a.format(this.step,e)),t+=":"+a.format(this.end,e)},n.prototype.toString=function(){return this.format()},e.exports=n},function(e,t,r){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._ranges=[],this._isScalar=!0;for(var e=0,t=arguments.length;t>e;e++){var r=arguments[e];if(r instanceof o)this._ranges.push(r),this._isScalar=!1;else if(c(r))this._ranges.push(i(r)),this._isScalar=!1;else if(u(r))this._ranges.push(i([r,r+1]));else{var a=r.valueOf();if(!c(a))throw new TypeError("Ranges must be an Array, Number, or Range");this._ranges.push(i(a)),this._isScalar=!1}}}function i(e){for(var t=e.length,r=0;t>r;r++)if(!u(e[r])||!l(e[r]))throw new TypeError("Index parameters must be integer numbers");switch(e.length){case 2:return new o(e[0],e[1]);case 3:return new o(e[0],e[1],e[2]);default:throw new SyntaxError("Wrong number of arguments in Index (2 or 3 expected)")}}var a=r(144),o=r(7),s=a.number,u=s.isNumber,l=s.isInteger,c=Array.isArray;n.prototype.clone=function(){var e=new n;return e._ranges=a.object.clone(this._ranges),e._isScalar=this._isScalar,e},n.isIndex=function(e){return e instanceof n},n.create=function(e){var t=new n;return n.apply(t,e),t},n.prototype.size=function(){for(var e=[],t=0,r=this._ranges.length;r>t;t++){var n=this._ranges[t];e[t]=n.size()[0]}return e},n.prototype.max=function(){for(var e=[],t=0,r=this._ranges.length;r>t;t++){var n=this._ranges[t];e[t]=n.max()}return e},n.prototype.min=function(){for(var e=[],t=0,r=this._ranges.length;r>t;t++){var n=this._ranges[t];e[t]=n.min()}return e},n.prototype.forEach=function(e){for(var t=0,r=this._ranges.length;r>t;t++)e(this._ranges[t],t,this)},n.prototype.range=function(e){return this._ranges[e]||null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var e=[],t=0,r=this._ranges.length;r>t;t++){var n=this._ranges[t],i=[],a=n.start,o=n.end,s=n.step;if(s>0)for(;o>a;)i.push(a),a+=s;else if(0>s)for(;a>o;)i.push(a),a+=s;e.push(i)}return e},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var e=[],t=0,r=this._ranges.length;r>t;t++){var n=this._ranges[t],i=s.format(n.start);1!=n.step&&(i+=":"+s.format(n.step)),i+=":"+s.format(n.end),e.push(i)}return"["+e.join(", ")+"]"},e.exports=n},function(e,t,r){function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e instanceof n)this._data=e.clone()._data;else if(g(e))this._data=l(e);else{if(null!=e)throw new TypeError("Unsupported type of data ("+c.types.type(e)+")");this._data=[]}this._size=d.size(this._data)}function i(e,t){if(!(t instanceof f))throw new TypeError("Invalid index");var r=t.isScalar();if(r)return e.get(t.min());var i=t.size();if(i.length!=e._size.length)throw new h(i.length,e._size.length);for(var o=t.min(),s=t.max(),u=0,l=e._size.length;l>u;u++)v(o[u],e._size[u]),v(s[u],e._size[u]);return new n(a(e._data,t,i.length,0))}function a(e,t,r,n){var i=n==r-1,o=t.range(n);return o.map(i?function(t){return e[t]}:function(i){var o=e[i];return a(o,t,r,n+1)})}function o(e,t,r,i){if(!(t instanceof f))throw new TypeError("Invalid index");var a,o=t.size(),l=t.isScalar();if(r instanceof n?(a=r.size(),r=r.valueOf()):a=d.size(r),l){if(0!=a.length)throw new TypeError("Scalar expected");e.set(t.min(),r,i)}else{if(o.length<e._size.length)throw new h(o.length,e._size.length,"<");if(a.length<o.length){for(var c=0,p=0;1===o[c]&&1===a[c];)c++;for(;1===o[c];)p++,c++;r=d.unsqueeze(r,o.length,p,a)}if(!m.deepEqual(o,a))throw new h(o,a,">");var g=t.max().map(function(e){return e+1});u(e,g,i);var v=o.length,y=0;s(e._data,t,r,v,y)}return e}function s(e,t,r,n,i){var a=i==n-1,o=t.range(i);o.forEach(a?function(t,n){v(t),e[t]=r[n]}:function(a,o){v(a),s(e[a],t,r[o],n,i+1)})}function u(e,t,r){for(var n=m.clone(e._size),i=!1;n.length<t.length;)n.push(0),i=!0;for(var a=0,o=t.length;o>a;a++)t[a]>n[a]&&(n[a]=t[a],i=!0);i&&e.resize(n,r)}function l(e){for(var t=0,r=e.length;r>t;t++){var i=e[t];g(i)?e[t]=l(i):i instanceof n&&(e[t]=l(i._data))}return e}var c=r(144),h=r(141),f=r(8),p=(c.number,c.string),d=c.array,m=c.object,g=Array.isArray,v=d.validateIndex;n.isMatrix=function(e){return e instanceof n},n.prototype.subset=function(e,t,r){switch(arguments.length){case 1:return i(this,e);case 2:case 3:return o(this,e,t,r);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(e){if(!g(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new h(e.length,this._size.length);for(var t=this._data,r=0,n=e.length;n>r;r++){var i=e[r];v(i,t.length),t=t[i]}return m.clone(t)},n.prototype.set=function(e,t,r){var n,i;if(!g(e))throw new Error("Array expected");if(e.length<this._size.length)throw new h(e.length,this._size.length,"<");var a=e.map(function(e){return e+1});u(this,a,r);var o=this._data;for(n=0,i=e.length-1;i>n;n++){var s=e[n];v(s,o.length),o=o[s]}return s=e[e.length-1],v(s,o.length),o[s]=t,this},n.prototype.resize=function(e,t){return this._size=m.clone(e),this._data=d.resize(this._data,this._size,t),this},n.prototype.clone=function(){var e=new n;return e._data=m.clone(this._data),e._size=m.clone(this._size),e},n.prototype.size=function(){return this._size},n.prototype.map=function(e){var t=this,r=new n,i=[],a=function(r,n){return g(r)?r.map(function(e,t){return i[n]=t,a(e,n+1)}):e(r,i,t)};return r._data=a(this._data,0),r._size=m.clone(this._size),r},n.prototype.forEach=function(e){var t=this,r=[],n=function(i,a){g(i)?i.forEach(function(e,t){r[a]=t,n(e,a+1)}):e(i,r,t)};n(this._data,0)},n.prototype.toArray=function(){return m.clone(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(e){return p.format(this._data,e)},n.prototype.toString=function(){return p.format(this._data)},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new Error("Constructor must be called with the new operator");if(void 0!=e&&!y(e))throw new TypeError("First parameter in Unit constructor must be a number");if(void 0!=t&&(!x(t)||""==t))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!=t){var r=h(t);if(!r)throw new SyntaxError('Unknown unit "'+t+'"');this.unit=r.unit,this.prefix=r.prefix}else this.unit=T,this.prefix=w;this.value=void 0!=e?this._normalize(e):null,this.fixPrefix=!1}function i(){for(;" "==d||"	"==d;)s()}function a(e){return e>="0"&&"9">=e||"."==e}function o(e){return e>="0"&&"9">=e}function s(){p++,d=f.charAt(p)}function u(e){p=e,d=f.charAt(p)}function l(){var e,t="";if(e=p,"+"==d?s():"-"==d&&(t+=d,s()),!a(d))return u(e),null;if("."==d){if(t+=d,s(),!o(d))return u(e),null}else{for(;o(d);)t+=d,s();"."==d&&(t+=d,s())}for(;o(d);)t+=d,s();if("E"==d||"e"==d){if(t+=d,s(),("+"==d||"-"==d)&&(t+=d,s()),!o(d))return u(e),null;for(;o(d);)t+=d,s()}return t}function c(){var e="";for(i();d&&" "!=d&&"	"!=d;)e+=d,s();return e||null}function h(e){for(var t in E)if(E.hasOwnProperty(t)&&v.endsWith(e,t)){var r=E[t],n=e.length-t.length,i=e.substring(0,n),a=r.prefixes[i];if(void 0!==a)return{unit:r,prefix:a}}return null}var f,p,d,m=r(144),g=m.number,v=m.string,y=m.number.isNumber,x=m.string.isString;n.parse=function(e){if(f=e,p=-1,d="",!x(f))return null;s(),i();var t,r=l();if(r){if(t=c(),s(),i(),d)return null;if(r&&t)try{return new n(Number(r),t)}catch(a){}}else{if(t=c(),s(),i(),d)return null;if(t)try{return new n(null,t)}catch(a){}}return null},n.isUnit=function(e){return e instanceof n},n.prototype.clone=function(){var e=new n;for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},n.prototype._normalize=function(e){return(e+this.unit.offset)*this.unit.value*this.prefix.value},n.prototype._unnormalize=function(e,t){return void 0==t?e/this.unit.value/this.prefix.value-this.unit.offset:e/this.unit.value/t-this.unit.offset},n.isValuelessUnit=function(e){return null!=h(e)},n.prototype.hasBase=function(e){return this.unit.base===e},n.prototype.equalBase=function(e){return this.unit.base===e.unit.base},n.prototype.equals=function(e){return this.equalBase(e)&&this.value==e.value},n.prototype.to=function(e){var t;if(x(e)){if(t=new n(null,e),!this.equalBase(t))throw new Error("Units do not match");return t.value=this.value,t.fixPrefix=!0,t}if(e instanceof n){if(!this.equalBase(e))throw new Error("Units do not match");if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return t=e.clone(),t.value=this.value,t.fixPrefix=!0,t}throw new Error("String or Unit expected as parameter")},n.prototype.toNumber=function(e){var t=this.to(e);return t._unnormalize(t.value,t.prefix.value)},n.prototype.toString=function(){return this.format()},n.prototype.valueOf=n.prototype.toString,n.prototype.format=function(e){var t,r;if(null===this.value||this.fixPrefix)t=this._unnormalize(this.value),r=null!==this.value?g.format(t,e)+" ":"",r+=this.prefix.name+this.unit.name;else{var n=this._bestPrefix();t=this._unnormalize(this.value,n.value),r=g.format(t,e)+" ",r+=n.name+this.unit.name}return r},n.prototype._bestPrefix=function(){var e=Math.abs(this.value/this.unit.value),t=w,r=Math.abs(Math.log(e/t.value)/Math.LN10-1.2),n=this.unit.prefixes;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];if(a.scientific){var o=Math.abs(Math.log(e/a.value)/Math.LN10-1.2);r>o&&(t=a,r=o)}}return t};var b={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-42,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1024,scientific:!0},M:{name:"M",value:Math.pow(1024,2),scientific:!0},G:{name:"G",value:Math.pow(1024,3),scientific:!0},T:{name:"T",value:Math.pow(1024,4),scientific:!0},P:{name:"P",value:Math.pow(1024,5),scientific:!0},E:{name:"E",value:Math.pow(1024,6),scientific:!0},Z:{name:"Z",value:Math.pow(1024,7),scientific:!0},Y:{name:"Y",value:Math.pow(1024,8),scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1024,scientific:!0},mega:{name:"mega",value:Math.pow(1024,2),scientific:!0},giga:{name:"giga",value:Math.pow(1024,3),scientific:!0},tera:{name:"tera",value:Math.pow(1024,4),scientific:!0},peta:{name:"peta",value:Math.pow(1024,5),scientific:!0},exa:{name:"exa",value:Math.pow(1024,6),scientific:!0},zetta:{name:"zetta",value:Math.pow(1024,7),scientific:!0},yotta:{name:"yotta",value:Math.pow(1024,8),scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}}},w={name:"",value:1,scientific:!0},M={NONE:{},LENGTH:{},MASS:{},TIME:{},CURRENT:{},TEMPERATURE:{},LUMINOUS_INTENSITY:{},AMOUNT_OF_SUBSTANCE:{},FORCE:{},SURFACE:{},VOLUME:{},ANGLE:{},BIT:{}},_={},T={name:"",base:_,value:1,offset:0},E={meter:{name:"meter",base:M.LENGTH,prefixes:b.LONG,value:1,offset:0},inch:{name:"inch",base:M.LENGTH,prefixes:b.NONE,value:.0254,offset:0},foot:{name:"foot",base:M.LENGTH,prefixes:b.NONE,value:.3048,offset:0},yard:{name:"yard",base:M.LENGTH,prefixes:b.NONE,value:.9144,offset:0},mile:{name:"mile",base:M.LENGTH,prefixes:b.NONE,value:1609.344,offset:0},link:{name:"link",base:M.LENGTH,prefixes:b.NONE,value:.201168,offset:0},rod:{name:"rod",base:M.LENGTH,prefixes:b.NONE,value:5.02921,offset:0},chain:{name:"chain",base:M.LENGTH,prefixes:b.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:M.LENGTH,prefixes:b.NONE,value:1e-10,offset:0},m:{name:"m",base:M.LENGTH,prefixes:b.SHORT,value:1,offset:0},"in":{name:"in",base:M.LENGTH,prefixes:b.NONE,value:.0254,offset:0},ft:{name:"ft",base:M.LENGTH,prefixes:b.NONE,value:.3048,offset:0},yd:{name:"yd",base:M.LENGTH,prefixes:b.NONE,value:.9144,offset:0},mi:{name:"mi",base:M.LENGTH,prefixes:b.NONE,value:1609.344,offset:0},li:{name:"li",base:M.LENGTH,prefixes:b.NONE,value:.201168,offset:0},rd:{name:"rd",base:M.LENGTH,prefixes:b.NONE,value:5.02921,offset:0},ch:{name:"ch",base:M.LENGTH,prefixes:b.NONE,value:20.1168,offset:0},mil:{name:"mil",base:M.LENGTH,prefixes:b.NONE,value:254e-7,offset:0},m2:{name:"m2",base:M.SURFACE,prefixes:b.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:M.SURFACE,prefixes:b.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:M.SURFACE,prefixes:b.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:M.SURFACE,prefixes:b.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:M.SURFACE,prefixes:b.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:M.SURFACE,prefixes:b.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:M.SURFACE,prefixes:b.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:M.SURFACE,prefixes:b.NONE,value:6.4516e-10,offset:0},m3:{name:"m3",base:M.VOLUME,prefixes:b.CUBIC,value:1,offset:0},L:{name:"L",base:M.VOLUME,prefixes:b.SHORT,value:.001,offset:0},l:{name:"l",base:M.VOLUME,prefixes:b.SHORT,value:.001,offset:0},litre:{name:"litre",base:M.VOLUME,prefixes:b.LONG,value:.001,offset:0},cuin:{name:"cuin",base:M.VOLUME,prefixes:b.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:M.VOLUME,prefixes:b.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:M.VOLUME,prefixes:b.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:M.VOLUME,prefixes:b.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:M.VOLUME,prefixes:b.NONE,value:15e-6,offset:0},drop:{name:"drop",base:M.VOLUME,prefixes:b.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:M.VOLUME,prefixes:b.NONE,value:5e-8,offset:0},minim:{name:"minim",base:M.VOLUME,prefixes:b.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:M.VOLUME,prefixes:b.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:M.VOLUME,prefixes:b.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:M.VOLUME,prefixes:b.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:M.VOLUME,prefixes:b.NONE,value:1e-6,offset:0},cup:{name:"cup",base:M.VOLUME,prefixes:b.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:M.VOLUME,prefixes:b.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:M.VOLUME,prefixes:b.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:M.VOLUME,prefixes:b.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:M.VOLUME,prefixes:b.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:M.VOLUME,prefixes:b.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:M.VOLUME,prefixes:b.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:M.VOLUME,prefixes:b.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:M.VOLUME,prefixes:b.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:M.VOLUME,prefixes:b.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:M.VOLUME,prefixes:b.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:M.VOLUME,prefixes:b.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:M.VOLUME,prefixes:b.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:M.VOLUME,prefixes:b.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:M.VOLUME,prefixes:b.NONE,value:.1173478,offset:0},obl:{name:"obl",base:M.VOLUME,prefixes:b.NONE,value:.1589873,offset:0},g:{name:"g",base:M.MASS,prefixes:b.SHORT,value:.001,offset:0},gram:{name:"gram",base:M.MASS,prefixes:b.LONG,value:.001,offset:0},ton:{name:"ton",base:M.MASS,prefixes:b.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:M.MASS,prefixes:b.SHORT,value:1e3,offset:0},grain:{name:"grain",base:M.MASS,prefixes:b.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:M.MASS,prefixes:b.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:M.MASS,prefixes:b.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:M.MASS,prefixes:b.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:M.MASS,prefixes:b.NONE,value:45.359237,offset:0},stick:{name:"stick",base:M.MASS,prefixes:b.NONE,value:.115,offset:0},gr:{name:"gr",base:M.MASS,prefixes:b.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:M.MASS,prefixes:b.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:M.MASS,prefixes:b.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:M.MASS,prefixes:b.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:M.MASS,prefixes:b.NONE,value:45.359237,offset:0},s:{name:"s",base:M.TIME,prefixes:b.SHORT,value:1,offset:0},min:{name:"min",base:M.TIME,prefixes:b.NONE,value:60,offset:0},h:{name:"h",base:M.TIME,prefixes:b.NONE,value:3600,offset:0},second:{name:"second",base:M.TIME,prefixes:b.LONG,value:1,offset:0},sec:{name:"sec",base:M.TIME,prefixes:b.LONG,value:1,offset:0},minute:{name:"minute",base:M.TIME,prefixes:b.NONE,value:60,offset:0},hour:{name:"hour",base:M.TIME,prefixes:b.NONE,value:3600,offset:0},day:{name:"day",base:M.TIME,prefixes:b.NONE,value:86400,offset:0},rad:{name:"rad",base:M.ANGLE,prefixes:b.NONE,value:1,offset:0},deg:{name:"deg",base:M.ANGLE,prefixes:b.NONE,value:.017453292519943295,offset:0},grad:{name:"grad",base:M.ANGLE,prefixes:b.NONE,value:.015707963267948967,offset:0},cycle:{name:"cycle",base:M.ANGLE,prefixes:b.NONE,value:6.283185307179586,offset:0},A:{name:"A",base:M.CURRENT,prefixes:b.SHORT,value:1,offset:0},ampere:{name:"ampere",base:M.CURRENT,prefixes:b.LONG,value:1,offset:0},K:{name:"K",base:M.TEMPERATURE,prefixes:b.NONE,value:1,offset:0},degC:{name:"degC",base:M.TEMPERATURE,prefixes:b.NONE,value:1,offset:273.15},degF:{name:"degF",base:M.TEMPERATURE,prefixes:b.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:M.TEMPERATURE,prefixes:b.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:M.TEMPERATURE,prefixes:b.NONE,value:1,offset:0},celsius:{name:"celsius",base:M.TEMPERATURE,prefixes:b.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:M.TEMPERATURE,prefixes:b.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:M.TEMPERATURE,prefixes:b.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:M.AMOUNT_OF_SUBSTANCE,prefixes:b.NONE,value:1,offset:0},mole:{name:"mole",base:M.AMOUNT_OF_SUBSTANCE,prefixes:b.NONE,value:1,offset:0},cd:{name:"cd",base:M.LUMINOUS_INTENSITY,prefixes:b.NONE,value:1,offset:0},candela:{name:"candela",base:M.LUMINOUS_INTENSITY,prefixes:b.NONE,value:1,offset:0},N:{name:"N",base:M.FORCE,prefixes:b.SHORT,value:1,offset:0},newton:{name:"newton",base:M.FORCE,prefixes:b.LONG,value:1,offset:0},lbf:{name:"lbf",base:M.FORCE,prefixes:b.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:M.FORCE,prefixes:b.NONE,value:4.4482216152605,offset:0},b:{name:"b",base:M.BIT,prefixes:b.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:M.BIT,prefixes:b.BINARY_LONG,value:1,offset:0},B:{name:"B",base:M.BIT,prefixes:b.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:M.BIT,prefixes:b.BINARY_LONG,value:8,offset:0}},S={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",litres:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",seconds:"second",minutes:"minute",hours:"hour",days:"day",radians:"rad",degrees:"deg",gradients:"grad",cycles:"cycle",amperes:"ampere",moles:"mole"};for(var C in S)if(S.hasOwnProperty(C)){var A=E[S[C]],N=Object.create(A);N.name=C,E[C]=N}E.lt=E.l,E.liter=E.litre,E.liters=E.litres,E.lb=E.lbm,E.lbs=E.lbm,n.PREFIXES=b,n.BASE_UNITS=M,n.UNITS=E,e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");
this.math=e,this.doc=t}var i=r(144),a=i.object,o=i.string;n.isHelp=function(e){return e instanceof n},n.prototype.toString=function(){var e=this.doc||{},t="\n";if(e.name&&(t+="Name: "+e.name+"\n\n"),e.category&&(t+="Category: "+e.category+"\n\n"),e.description&&(t+="Description:\n    "+e.description+"\n\n"),e.syntax&&(t+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){var r=this.math.parser();t+="Examples:\n";for(var i=0;i<e.examples.length;i++){var a,s=e.examples[i];try{a=r.eval(s)}catch(u){a=u}t+="    "+s+"\n",!a||a instanceof n||(t+="        "+o.format(a,{precision:14})+"\n")}t+="\n"}return e.seealso&&(t+="See also: "+e.seealso.join(", ")+"\n"),t},n.prototype.toJSON=function(){return a.clone(this.doc)},n.prototype.valueOf=n.prototype.toString,e.exports=n},function(e){function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}t.prototype.valueOf=function(){return this.entries},t.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},e.exports=t},function(e,t,r){function n(e,t,r){var a,o,s,u;if(0>=t){if(c(e[0])){for(u=i(e),o=[],a=0;a<u.length;a++)o[a]=n(u[a],t-1,r);return o}for(s=e[0],a=1;a<e.length;a++)s=r(s,e[a]);return s}for(o=[],a=0;a<e.length;a++)o[a]=n(e[a],t-1,r);return o}function i(e){var t,r,n=e.length,i=e[0].length,a=[];for(r=0;i>r;r++){var o=[];for(t=0;n>t;t++)o.push(e[t][r]);a.push(o)}return a}{var a=r(144),o=r(142),s=r(141),u=r(9),l=a.array,c=a.array.isArray;a.string.isString}t.argsToArray=function(e){if(0==e.length)return[];if(1==e.length){var t=e[0];return t instanceof u&&(t=t.valueOf()),c(t)||(t=[t]),t}return a.array.argsToArray(e)},t.isCollection=function(e){return c(e)||e instanceof u},t.deepMap=function h(e,t){return e&&"function"==typeof e.map?e.map(function(e){return h(e,t)}):t(e)},t.deepMap2=function f(e,t,r){var n,i,a;if(c(e))if(c(t)){if(e.length!=t.length)throw new s(e.length,t.length);for(n=[],i=e.length,a=0;i>a;a++)n[a]=f(e[a],t[a],r)}else{if(t instanceof u)return n=f(e,t.valueOf(),r),new u(n);for(n=[],i=e.length,a=0;i>a;a++)n[a]=f(e[a],t,r)}else{if(e instanceof u)return t instanceof u?(n=f(e.valueOf(),t.valueOf(),r),new u(n)):(n=f(e.valueOf(),t,r),new u(n));if(c(t))for(n=[],i=t.length,a=0;i>a;a++)n[a]=f(e,t[a],r);else{if(t instanceof u)return n=f(e,t.valueOf(),r),new u(n);n=r(e,t)}}return n},t.reduce=function(e,t,r){var i=c(e)?l.size(e):e.size();if(0>t)throw new o(t);if(t>=i.length)throw new o(t,i.length);return e instanceof u?new u(n(e.valueOf(),t,r)):n(e,t,r)},t.deepForEach=function p(e,t){e instanceof u&&(e=e.valueOf());for(var r=0,n=e.length;n>r;r++){var i=e[r];c(i)?p(i,t):t(i)}}},function(e,t,r){function n(e,t){if(1!=arguments.length&&2!=arguments.length)throw new z("parse",arguments.length,1,2);if(st=t&&t.nodes?t.nodes:{},q(e))return ut=e,d();if(G(e)||e instanceof H)return j.deepMap(e,function(e){if(!q(e))throw new TypeError("String expected");return ut=e,d()});throw new TypeError("String or matrix expected")}function i(){lt=0,ct=ut.charAt(0),pt=0,dt=null}function a(){lt++,ct=ut.charAt(lt)}function o(){return ut.charAt(lt+1)}function s(){for(ft=it.NULL,ht="";" "==ct||"	"==ct||"\n"==ct&&pt;)a();if("#"==ct)for(;"\n"!=ct&&""!=ct;)a();if(""==ct)return void(ft=it.DELIMITER);if("\n"==ct&&!pt)return ft=it.DELIMITER,ht=ct,void a();var e=ct+o();if(2==e.length&&at[e])return ft=it.DELIMITER,ht=e,a(),void a();if(at[ct])return ft=it.DELIMITER,ht=ct,void a();if(!f(ct)){if(h(ct)){for(;h(ct)||p(ct);)ht+=ct,a();return void(ft=ot[ht]?it.DELIMITER:it.SYMBOL)}for(ft=it.UNKNOWN;""!=ct;)ht+=ct,a();throw B('Syntax error in part "'+ht+'"')}if(ft=it.NUMBER,"."==ct)ht+=ct,a(),p(ct)||(ft=it.UNKNOWN);else{for(;p(ct);)ht+=ct,a();"."==ct&&(ht+=ct,a())}for(;p(ct);)ht+=ct,a();if("E"==ct||"e"==ct)for(ht+=ct,a(),("+"==ct||"-"==ct)&&(ht+=ct,a()),p(ct)||(ft=it.UNKNOWN);p(ct);)ht+=ct,a()}function u(){do s();while("\n"==ht)}function l(){pt++}function c(){pt--}function h(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"==e}function f(e){return e>="0"&&"9">=e||"."==e}function p(e){return e>="0"&&"9">=e}function d(){i(),s();var e=m();if(""!=ht)throw ft==it.DELIMITER?V("Unexpected operator "+ht):B('Unexpected part "'+ht+'"');return e}function m(){var e,t,r;if(""==ht)return new Z("undefined","undefined");for("\n"!=ht&&";"!=ht&&(e=g());"\n"==ht||";"==ht;)t||(t=new Y,e&&(r=";"!=ht,t.add(e,r))),s(),"\n"!=ht&&";"!=ht&&""!=ht&&(e=g(),r=";"!=ht,t.add(e,r));return t?t:e}function g(){if(ft==it.SYMBOL&&"function"==ht)throw B('Deprecated keyword "function". Functions can now be assigned without it, like "f(x) = x^2".');return v()}function v(){var e,t,r,n,i=y();if("="==ht){if(i instanceof rt)return e=i.name,u(),r=v(),new X(e,r);if(i instanceof $)return u(),r=v(),new nt(i,r);if(i instanceof et&&(n=!0,t=[],e=i.symbol.name,i.params.forEach(function(e,r){e instanceof rt?t[r]=e.name:n=!1}),n))return u(),r=v(),new Q(e,t,r);throw B("Invalid left hand side of assignment operator =")}return i}function y(){for(var e=x();"?"==ht;){var t=dt;dt=pt,u();var r=e,n=x();if(":"!=ht)throw B("False part of conditional expression expected");dt=null,u();var i=y();e=new K(r,n,i),dt=t}return e}function x(){var e,t,r,n,i;for(e=b(),t={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};ht in t;)r=ht,n=t[r],u(),i=[e,b()],e=new J(r,n,i);return e}function b(){var e,t,r,n,i;for(e=w(),t={to:"to","in":"to"};ht in t;)r=ht,n=t[r],u(),i=[e,w()],e=new J(r,n,i);return e}function w(){var e,t=[];if(e=":"==ht?new Z("1","number"):M(),":"==ht&&dt!==pt){for(t.push(e);":"==ht;)u(),t.push(")"==ht||"]"==ht||","==ht||""==ht?new rt("end"):M());if(3==t.length){var r=t[2];t[2]=t[1],t[1]=r}e=new tt(t)}return e}function M(){var e,t,r,n,i;for(e=_(),t={"+":"add","-":"subtract"};ht in t;)r=ht,n=t[r],u(),i=[e,_()],e=new J(r,n,i);return e}function _(){var e,t,r,n,i;if(e=T(),t={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"},ht in t)for(;ht in t;)r=ht,n=t[r],u(),i=[e,T()],e=new J(r,n,i);return(ft==it.SYMBOL||"in"==ht&&e instanceof Z||ft==it.NUMBER&&!(e instanceof Z)||"("==ht||"["==ht)&&(e=new J("*","multiply",[e,_()])),e}function T(){var e,t,r;return"-"==ht||"+"==ht?(e=ht,t="+"==e?"unaryPlus":"unaryMinus",u(),r=[T()],new J(e,t,r)):E()}function E(){var e,t,r,n;return e=S(),("^"==ht||".^"==ht)&&(t=ht,r="^"==t?"pow":"dotPow",u(),n=[e,T()],e=new J(t,r,n)),e}function S(){var e,t,r,n,i;for(e=C(),t={"!":"factorial","'":"transpose"};ht in t;)r=ht,n=t[r],s(),i=[e],e=new J(r,n,i);return e}function C(){var e,t=[];if(ft==it.SYMBOL&&st[ht]){if(e=st[ht],s(),"("==ht){if(t=[],l(),s(),")"!=ht)for(t.push(y());","==ht;)s(),t.push(y());if(")"!=ht)throw B("Parenthesis ) expected");c(),s()}return new e(t)}return A()}function A(){var e,t;return ft==it.SYMBOL||ft==it.DELIMITER&&ht in ot?(t=ht,s(),e=new rt(t),e=N(e),e=R(e)):L()}function N(e){var t;if("("==ht){if(t=[],l(),s(),")"!=ht)for(t.push(y());","==ht;)s(),t.push(y());if(")"!=ht)throw B("Parenthesis ) expected");return c(),s(),new et(e,t)}return e}function R(e){for(var t;"["==ht;){if(t=[],l(),s(),"]"!=ht)for(t.push(y());","==ht;)s(),t.push(y());if("]"!=ht)throw B("Parenthesis ] expected");c(),s(),e=new $(e,t)}return e}function L(){var e,t,r;if('"'==ht){for(t="",r="";""!=ct&&('"'!=ct||"\\"==r);)t+=ct,r=ct,a();if(s(),'"'!=ht)throw B('End of string " expected');return s(),e=new Z(t,"string"),e=R(e)}return D()}function D(){var e,t,r,n;if("["==ht){if(l(),s(),"]"!=ht){var i=P();if(";"==ht){for(r=1,t=[i];";"==ht;)s(),t[r]=P(),r++;if("]"!=ht)throw B("End of matrix ] expected");c(),s(),n=t[0].nodes.length;for(var a=1;r>a;a++)if(t[a].nodes.length!=n)throw V("Column dimensions mismatch ("+t[a].nodes.length+" != "+n+")");e=new W(t)}else{if("]"!=ht)throw B("End of matrix ] expected");c(),s(),e=i}}else c(),s(),e=new W([]);return e}return I()}function P(){for(var e=[v()],t=1;","==ht;)s(),e[t]=v(),t++;return new W(e)}function I(){var e;return ft==it.NUMBER?(e=ht,s(),new Z(e,"number")):F()}function F(){var e;if("("==ht){if(l(),s(),e=v(),")"!=ht)throw B("Parenthesis ) expected");return c(),s(),e}return U()}function U(){throw B(""==ht?"Unexpected end of expression":"Value expected")}function O(){return lt-ht.length+1}function B(e){var t=O(),r=new SyntaxError(e+" (char "+t+")");return r["char"]=t,r}function V(e){var t=O(),r=new Error(e+" (char "+t+")");return r["char"]=t,r}var k=r(144),z=r(140),q=k.string.isString,G=Array.isArray,H=(k.types.type,r(6),r(9)),j=(r(10),r(13)),W=r(145),X=r(146),Y=r(147),K=r(148),Z=r(149),Q=r(150),$=r(151),J=r(152),et=r(153),tt=r(154),rt=r(155),nt=r(156),it={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},at={",":!0,"(":!0,")":!0,"[":!0,"]":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"!":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0},ot={mod:!0,to:!0,"in":!0},st={},ut="",lt=0,ct="",ht="",ft=it.NULL,pt=0,dt=null;e.exports=n},function(e,t,r){function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!(e instanceof Object))throw new TypeError("Object expected as parameter math");this.math=e,this.scope={}}var i=r(14);n.prototype.parse=function(){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},n.prototype.compile=function(){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},n.prototype.eval=function(e){return i(e).compile(this.math).eval(this.scope)},n.prototype.get=function(e){return this.scope[e]},n.prototype.set=function(e,t){return this.scope[e]=t},n.prototype.remove=function(e){delete this.scope[e]},n.prototype.clear=function(){for(var e in this.scope)this.scope.hasOwnProperty(e)&&delete this.scope[e]},e.exports=n},function(e,t,r){t.ArrayNode=r(145),t.AssignmentNode=r(146),t.BlockNode=r(147),t.ConditionalNode=r(148),t.ConstantNode=r(149),t.IndexNode=r(151),t.FunctionAssignmentNode=r(150),t.FunctionNode=r(153),t.Node=r(157),t.OperatorNode=r(152),t.RangeNode=r(154),t.SymbolNode=r(155),t.UpdateNode=r(156)},function(e,t,r){t.e=r(161),t.E=r(161),t["false"]=r(162),t.i=r(163),t.Infinity=r(164),t.LN2=r(165),t.LN10=r(166),t.LOG2E=r(167),t.LOG10E=r(168),t.NaN=r(169),t["null"]=r(170),t.pi=r(171),t.PI=r(171),t.phi=r(172),t.SQRT1_2=r(173),t.SQRT2=r(174),t.tau=r(175),t["true"]=r(176),t.version=r(177),t.abs=r(181),t.add=r(182),t.ceil=r(183),t.cube=r(184),t.divide=r(185),t.dotDivide=r(186),t.dotMultiply=r(187),t.dotPow=r(188),t.exp=r(189),t.fix=r(190),t.floor=r(191),t.gcd=r(192),t.lcm=r(193),t.log=r(194),t.log10=r(195),t.mod=r(196),t.multiply=r(197),t.norm=r(198),t.pow=r(199),t.round=r(200),t.sign=r(201),t.sqrt=r(202),t.square=r(203),t.subtract=r(204),t.unaryMinus=r(205),t.unaryPlus=r(206),t.xgcd=r(207),t.compare=r(208),t.deepEqual=r(209),t.equal=r(210),t.larger=r(211),t.largerEq=r(212),t.smaller=r(213),t.smallerEq=r(214),t.unequal=r(215),t.arg=r(216),t.conj=r(217),t.re=r(218),t.im=r(219),t.bignumber=r(220),t["boolean"]=r(221),t.complex=r(222),t.index=r(223),t.matrix=r(224),t.number=r(225),t.string=r(226),t.unit=r(227),t.eval=r(228),t.help=r(229),t.concat=r(230),t.det=r(231),t.diag=r(232),t.eye=r(233),t.flatten=r(234),t.inv=r(235),t.ones=r(236),t.range=r(237),t.resize=r(238),t.size=r(239),t.squeeze=r(240),t.subset=r(241),t.transpose=r(242),t.zeros=r(243),t.combinations=r(244),t.factorial=r(245),t.permutations=r(246),t.pickRandom=r(247),t.random=r(248),t.randomInt=r(249),t.max=r(250),t.mean=r(251),t.median=r(252),t.min=r(253),t.prod=r(254),t.std=r(255),t.sum=r(256),t["var"]=r(257),t.acos=r(258),t.asin=r(259),t.atan=r(260),t.atan2=r(261),t.cos=r(262),t.cosh=r(263),t.cot=r(264),t.coth=r(265),t.csc=r(266),t.csch=r(267),t.sec=r(268),t.sech=r(269),t.sin=r(270),t.sinh=r(271),t.tan=r(272),t.tanh=r(273),t.to=r(274),t.clone=r(275),t.map=r(276),t.filter=r(277),t.forEach=r(278),t.format=r(279),t["import"]=r(280),t.sort=r(281),t["typeof"]=r(282)},function(e,t,r){var n=r(139),i=r(158).transform,a=r(4).isNumber,o=r(137).argsToArray;e.exports=function(e){e.concat.transform=function(){var t=o(arguments),r=t.length-1,s=t[r];a(s)?t[r]=s-1:s instanceof n&&(t[r]=s.minus(1));try{return e.concat.apply(e,t)}catch(u){throw i(u)}}}},function(e,t,r){var n=r(155),i=(r(159).isBoolean,r(137).argsToArray,r(140));e.exports=function(e){var t=e.filter;t.transform=function(e,r,a){if(2!==e.length)throw new i("filter",arguments.length,2);var o,s=e[0].compile(r).eval(a);if(e[1]instanceof n)o=e[1].compile(r).eval(a);else{var u=a||{},l=e[1].find({type:n}).filter(function(e){return!(e.name in r||e.name in u)})[0],c=Object.create(u),h=e[1].compile(r);if(!l)throw new Error("No undefined variable found in filter equation");var f=l.name;o=function(e){return c[f]=e,h.eval(c)}}return t(s,o)},e.filter.transform.rawArgs=!0}},function(e,t,r){{var n=r(9);r(139),r(7),r(8),r(4).isNumber,Array.isArray}e.exports=function(e){e.forEach.transform=function(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("forEach",arguments.length,2);var i=t instanceof n?t.valueOf():t;if(!Array.isArray(i))throw new e.error.UnsupportedTypeError("forEach",e["typeof"](t));var a=[],o=function(e,n){return Array.isArray(e)?e.map(function(e,t){return a[n]=t+1,o(e,n+1)}):void r(e,a,t)};o(i,0)}}},function(e,t,r){{var n=r(139),i=r(7),a=r(8),o=(r(9),r(4).isNumber);Array.isArray}e.exports=function(e){e.index.transform=function(){for(var e=[],t=0,r=arguments.length;r>t;t++){var s=arguments[t];if(s instanceof i)s.start--,s.end-=s.step>0?0:2;else if(o(s))s--;else{if(!(s instanceof n))throw new TypeError("Ranges must be a Number or Range");s=s.toNumber()-1}e[t]=s}var u=new a;return a.apply(u,e),u}}},function(e,t,r){{var n=r(9);r(139),r(7),r(8),r(4).isNumber,Array.isArray}e.exports=function(e){e.map.transform=function(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("map",arguments.length,2);var i=t instanceof n,a=i?t.valueOf():t;if(Array.isArray(a)){var o=[],s=function(e,n){return Array.isArray(e)?e.map(function(e,t){return o[n]=t+1,s(e,n+1)}):r(e,o,t)},u=s(a,0);return i?new n(u):u}throw new e.error.UnsupportedTypeError("map",e["typeof"](t))}}},function(e,t,r){var n=r(139),i=r(158).transform,a=r(4).isNumber,o=r(13).isCollection,s=r(137).argsToArray;e.exports=function(e){e.max.transform=function(){var t=s(arguments);if(2==t.length&&o(t[0])){var r=t[1];a(r)?t[1]=r-1:r instanceof n&&(t[1]=r.minus(1))}try{return e.max.apply(e,t)}catch(u){throw i(u)}}}},function(e,t,r){var n=r(139),i=r(158).transform,a=r(4).isNumber,o=r(13).isCollection,s=r(137).argsToArray;e.exports=function(e){e.mean.transform=function(){var t=s(arguments);if(2==t.length&&o(t[0])){var r=t[1];a(r)?t[1]=r-1:r instanceof n&&(t[1]=r.minus(1))}try{return e.mean.apply(e,t)}catch(u){throw i(u)}}}},function(e,t,r){var n=r(139),i=r(158).transform,a=r(4).isNumber,o=r(13).isCollection,s=r(137).argsToArray;e.exports=function(e){e.min.transform=function(){var t=s(arguments);if(2==t.length&&o(t[0])){var r=t[1];a(r)?t[1]=r-1:r instanceof n&&(t[1]=r.minus(1))}try{return e.min.apply(e,t)}catch(u){throw i(u)}}}},function(e,t,r){var n=r(159).isBoolean,i=r(137).argsToArray;e.exports=function(e){e.range.transform=function(){var t=i(arguments),r=t.length-1,a=t[r];return n(a)||t.push(!0),e.range.apply(e,t)}}},function(e,t,r){var n=r(158).transform,i=(r(159).isBoolean,r(137).argsToArray);e.exports=function(e){e.subset.transform=function(){try{return e.subset.apply(e,i(arguments))}catch(t){throw n(t)}}}},function(e,t,r){e.exports=function(e){function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.value=e instanceof t?e.value:e}function n(e,r){var n=Array.prototype.slice;t.prototype[e]="function"==typeof r?function(){var e=[this.value].concat(n.call(arguments,0));return new t(r.apply(this,e))}:new t(r)}var i=r(160);t.prototype.done=function(){return this.value},t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return i.format(this.value)},t.createProxy=n;for(var a in e)e.hasOwnProperty(a)&&n(a,e[a]);return t}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(14),i=r(13),a=t.string.isString,o=i.isCollection;e.compile=function(t){if(1!=arguments.length)throw new e.error.ArgumentsError("compile",arguments.length,1);if(a(t))return n(t).compile(e);if(o(t))return i.deepMap(t,function(t){return n(t).compile(e)});throw new TypeError("String, array, or matrix expected")}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(14),i=r(13),a=t.string.isString,o=i.isCollection;e.eval=function(t,r){if(1!=arguments.length&&2!=arguments.length)throw new e.error.ArgumentsError("eval",arguments.length,1,2);if(r=r||{},a(t))return n(t).compile(e).eval(r);if(o(t))return i.deepMap(t,function(t){return n(t).compile(e).eval(r)});throw new TypeError("String, array, or matrix expected")}}},function(e,t,r){e.exports=function(e){var t=r(11);e.help=function(r){if(1!=arguments.length)throw new SyntaxError("Wrong number of arguments in function help ("+arguments.length+" provided, 1 expected)");var n=null;if(r instanceof String||"string"==typeof r)n=r;else{var i;for(i in e)if(e.hasOwnProperty(i)&&r===e[i]){n=i;break}}var a=e.expression.docs[n];if(!n||!a)throw new Error('No documentation found on "'+n+'"');return new t(e,a)}}},function(e,t,r){e.exports=function(e){var t=r(14);e.parse=function(){return t.apply(t,arguments)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=(r(9),r(13)),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.abs=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("abs",arguments.length,1);if(o(t))return Math.abs(t);if(u(t))return Math.sqrt(t.re*t.re+t.im*t.im);if(t instanceof n)return t.abs();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.abs(t);throw new e.error.UnsupportedTypeError("abs",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=(r(9),r(10)),o=r(13),s=t["boolean"].isBoolean,u=t.number.isNumber,l=t.string.isString,c=i.isComplex,h=a.isUnit,f=o.isCollection;e.add=function p(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("add",arguments.length,2);if(u(t)){if(u(r))return t+r;if(c(r))return new i(t+r.re,r.im)}if(c(t)){if(c(r))return new i(t.re+r.re,t.im+r.im);if(u(r))return new i(t.re+r,t.im)}if(h(t)&&h(r)){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==r.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(r))throw new Error("Units do not match");var a=t.clone();return a.value+=r.value,a.fixPrefix=!1,a}if(t instanceof n)return u(r)?r=n.convert(r):(s(r)||null===r)&&(r=new n(r?1:0)),r instanceof n?t.plus(r):p(t.toNumber(),r);if(r instanceof n)return u(t)?t=n.convert(t):(s(t)||null===t)&&(t=new n(t?1:0)),t instanceof n?t.plus(r):p(t,r.toNumber());if(f(t)||f(r))return o.deepMap2(t,r,p);if(l(t)||l(r))return t+r;if(s(t)||null===t)return p(+t,r);if(s(r)||null===r)return p(t,+r);throw new e.error.UnsupportedTypeError("add",e["typeof"](t),e["typeof"](r))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=a.isCollection,l=i.isComplex;e.ceil=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("ceil",arguments.length,1);if(o(t))return Math.ceil(t);if(l(t))return new i(Math.ceil(t.re),Math.ceil(t.im));if(t instanceof n)return t.ceil();if(u(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.ceil(t);throw new e.error.UnsupportedTypeError("ceil",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.cube=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("cube",arguments.length,1);if(o(t))return t*t*t;if(u(t))return e.multiply(e.multiply(t,t),t);if(t instanceof n)return t.times(t).times(t);if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("cube",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){function t(e,t){var r=t.re*t.re+t.im*t.im;return 0!=r?new a((e.re*t.re+e.im*t.im)/r,(e.im*t.re-e.re*t.im)/r):new a(0!=e.re?e.re/0:0,0!=e.im?e.im/0:0)}var n=r(144),i=e.type.BigNumber,a=r(6),o=(r(9),r(10)),s=r(13),u=n.number.isNumber,l=n["boolean"].isBoolean,c=a.isComplex,h=o.isUnit,f=s.isCollection;e.divide=function p(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("divide",arguments.length,2);if(u(r)){if(u(n))return r/n;if(c(n))return t(new a(r,0),n)}if(c(r)){if(c(n))return t(r,n);if(u(n))return t(r,new a(n,0))}if(r instanceof i)return u(n)?n=i.convert(n):(l(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?r.div(n):p(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(l(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?r.div(n):p(r,n.toNumber());if(h(r)&&u(n)){var o=r.clone();return o.value/=n,o}if(f(r))return f(n)?e.multiply(r,e.inv(n)):s.deepMap2(r,n,p);if(f(n))return e.multiply(r,e.inv(n));if(l(r)||null===r)return p(+r,n);if(l(n)||null===n)return p(r,+n);throw new e.error.UnsupportedTypeError("divide",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){var t=r(13);e.dotDivide=function(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("dotDivide",arguments.length,2);return t.deepMap2(r,n,e.divide)},e.edivide=function(){throw new Error("Function edivide is renamed to dotDivide")}}},function(e,t,r){e.exports=function(e){var t=(r(144),r(13));e.dotMultiply=function(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("dotMultiply",arguments.length,2);return t.deepMap2(r,n,e.multiply)},e.emultiply=function(){throw new Error("Function emultiply is renamed to dotMultiply")}}},function(e,t,r){e.exports=function(e){var t=(r(144),r(13));e.dotPow=function(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("dotPow",arguments.length,2);return t.deepMap2(r,n,e.pow)},e.epow=function(){throw new Error("Function epow is renamed to dotPow")}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=(r(9),r(13)),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.exp=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("exp",arguments.length,1);if(o(t))return Math.exp(t);if(u(t)){var r=Math.exp(t.re);return new i(r*Math.cos(t.im),r*Math.sin(t.im))}if(t instanceof n)return t.exp();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.exp(t);throw new e.error.UnsupportedTypeError("exp",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.fix=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("fix",arguments.length,1);if(o(t))return t>0?Math.floor(t):Math.ceil(t);if(u(t))return new i(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im));if(t instanceof n)return t.isNegative()?t.ceil():t.floor();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("fix",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.floor=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("floor",arguments.length,1);if(o(t))return Math.floor(t);if(u(t))return new i(Math.floor(t.re),Math.floor(t.im));if(t instanceof n)return t.floor();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("floor",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){function t(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var r=new i(0);!t.isZero();){var n=e.mod(t);e=t,t=n}return e.lt(r)?e.neg():e}var n=r(144),i=e.type.BigNumber,a=r(13),o=n.number.isNumber,s=n["boolean"].isBoolean,u=n.number.isInteger,l=a.isCollection;e.gcd=function c(){var r,n=arguments[0],h=arguments[1];if(2==arguments.length){if(o(n)&&o(h)){if(!u(n)||!u(h))throw new Error("Parameters in function gcd must be integer numbers");for(;0!=h;)r=n%h,n=h,h=r;return 0>n?-n:n}if(l(n)||l(h))return a.deepMap2(n,h,c);if(n instanceof i)return o(h)?h=i.convert(h):(s(h)||null===h)&&(h=new i(h?1:0)),h instanceof i?t(n,h):c(n.toNumber(),h);if(h instanceof i)return o(n)?n=i.convert(n):(s(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?t(n,h):c(n.toNumber(),h);if(s(n)||null===n)return c(+n,h);if(s(h)||null===h)return c(n,+h);throw new e.error.UnsupportedTypeError("gcd",e["typeof"](n),e["typeof"](h))}if(arguments.length>2){for(var f=1;f<arguments.length;f++)n=c(n,arguments[f]);return n}throw new SyntaxError("Function gcd expects two or more arguments")}}},function(e,t,r){e.exports=function(e){function t(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero()||t.isZero())return new i(0);for(var r=e.times(t);!t.isZero();){var n=t;t=e.mod(n),e=n}return r.div(e).abs()}var n=r(144),i=e.type.BigNumber,a=r(13),o=n.number.isNumber,s=n["boolean"].isBoolean,u=n.number.isInteger,l=a.isCollection;e.lcm=function c(){var r,n=arguments[0],h=arguments[1];if(2==arguments.length){if(o(n)&&o(h)){if(!u(n)||!u(h))throw new Error("Parameters in function lcm must be integer numbers");if(0==n||0==h)return 0;for(var f=n*h;0!=h;)r=h,h=n%r,n=r;return Math.abs(f/n)}if(l(n)||l(h))return a.deepMap2(n,h,c);if(n instanceof i)return o(h)?h=i.convert(h):(s(h)||null===h)&&(h=new i(h?1:0)),h instanceof i?t(n,h):c(n.toNumber(),h);if(h instanceof i)return o(n)?n=i.convert(n):(s(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?t(n,h):c(n.toNumber(),h);if(s(n)||null===n)return c(+n,h);if(s(h)||null===h)return c(n,+h);throw new e.error.UnsupportedTypeError("lcm",e["typeof"](n),e["typeof"](h))}if(arguments.length>2){for(var p=1;p<arguments.length;p++)n=c(n,arguments[p]);return n}throw new SyntaxError("Function lcm expects two or more arguments")}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.log=function c(t,r){if(1==arguments.length){if(o(t))return t>=0?Math.log(t):c(new i(t,0));if(u(t))return new i(Math.log(Math.sqrt(t.re*t.re+t.im*t.im)),Math.atan2(t.im,t.re));if(t instanceof n)return t.isNegative()?c(t.toNumber()):t.ln();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("log",e["typeof"](t))}if(2==arguments.length)return e.divide(c(t),c(r));throw new e.error.ArgumentsError("log",arguments.length,1,2)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.log10=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("log10",arguments.length,1);if(o(t))return t>=0?Math.log(t)/Math.LN10:c(new i(t,0));if(t instanceof n)return t.isNegative()?c(t.toNumber()):t.log();if(u(t))return new i(Math.log(Math.sqrt(t.re*t.re+t.im*t.im))/Math.LN10,Math.atan2(t.im,t.re)/Math.LN10);if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("log10",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){function t(e,t){if(t>0)return e-t*Math.floor(e/t);if(0==t)return e;throw new Error("Cannot calculate mod for a negative divisor")}var n=r(144),i=e.type.BigNumber,a=r(13),o=n.number.isNumber,s=n["boolean"].isBoolean,u=a.isCollection;e.mod=function l(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("mod",arguments.length,2);if(o(r)&&o(n))return t(r,n);if(r instanceof i)return o(n)?n=i.convert(n):(s(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?n.isZero()?r:r.mod(n):l(r.toNumber(),n);if(n instanceof i)return o(r)?r=i.convert(r):(s(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?n.isZero()?r:r.mod(n):l(r,n.toNumber());if(u(r)||u(n))return a.deepMap2(r,n,l);if(s(r)||null===r)return l(+r,n);if(s(n)||null===n)return l(r,+n);throw new e.error.UnsupportedTypeError("mod",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){function t(t,r){for(var n=[],i=t.length,a=r[0].length,o=t[0].length,s=0;i>s;s++){n[s]=[];for(var u=0;a>u;u++){for(var l=null,c=0;o>c;c++){var h=e.multiply(t[s][c],r[c][u]);l=null===l?h:e.add(l,h)}n[s][u]=l}}var f=1===i&&1===a;return f?n[0][0]:n}function n(t,r){for(var n=[],i=r.length,a=r[0].length,o=0;a>o;o++){for(var s=null,u=0;i>u;u++){var l=e.multiply(t[u],r[u][o]);s=0===u?l:e.add(s,l)}n[o]=s}return 1===n.length?n[0]:n}function i(t,r){for(var n=[],i=t.length,a=t[0].length,o=0;i>o;o++){for(var s=null,u=0;a>u;u++){var l=e.multiply(t[o][u],r[u]);s=0===u?l:e.add(s,l)}n[o]=s}return 1===n.length?n[0]:n}function a(t,r){var n=t.length;if(!n)throw new Error("Cannot multiply two empty vectors");for(var i=0,a=0;n>a;a++)i=e.add(i,e.multiply(t[a],r[a]));return i}function o(e,t){return 0==e.im?0==t.im?new l(e.re*t.re,0):0==t.re?new l(0,e.re*t.im):new l(e.re*t.re,e.re*t.im):0==e.re?0==t.im?new l(0,e.im*t.re):0==t.re?new l(-e.im*t.im,0):new l(-e.im*t.im,e.im*t.re):0==t.im?new l(e.re*t.re,e.im*t.re):0==t.re?new l(-e.im*t.im,e.re*t.im):new l(e.re*t.re-e.im*t.im,e.re*t.im+e.im*t.re)}var s=r(144),u=e.type.BigNumber,l=r(6),c=r(9),h=r(10),f=r(13),p=s.array,d=s.number.isNumber,m=s["boolean"].isBoolean,g=l.isComplex,v=Array.isArray,y=h.isUnit;e.multiply=function x(r,s){var h;if(2!=arguments.length)throw new e.error.ArgumentsError("multiply",arguments.length,2);if(d(r)){if(d(s))return r*s;if(g(s))return o(new l(r,0),s);if(y(s))return h=s.clone(),h.value=null===h.value?h._normalize(r):h.value*r,h}if(g(r)){if(d(s))return o(r,new l(s,0));if(g(s))return o(r,s)}if(r instanceof u)return d(s)?s=u.convert(s):(m(s)||null===s)&&(s=new u(s?1:0)),s instanceof u?r.times(s):x(r.toNumber(),s);if(s instanceof u)return d(r)?r=u.convert(r):(m(r)||null===r)&&(r=new u(r?1:0)),r instanceof u?r.times(s):x(r,s.toNumber());if(y(r)&&d(s))return h=r.clone(),h.value=null===h.value?h._normalize(s):h.value*s,h;if(v(r)){if(v(s)){var b=p.size(r),w=p.size(s);if(1==b.length){if(1==w.length){if(b[0]!=w[0])throw new RangeError("Dimension mismatch in multiplication. Length of A must match length of B (A is "+b[0]+", B is "+w[0]+b[0]+" != "+w[0]+")");return a(r,s)}if(2==w.length){if(b[0]!=w[0])throw new RangeError("Dimension mismatch in multiplication. Length of A must match rows of B (A is "+b[0]+", B is "+w[0]+"x"+w[1]+", "+b[0]+" != "+w[0]+")");return n(r,s)}throw new Error("Can only multiply a 1 or 2 dimensional matrix (B has "+w.length+" dimensions)")}if(2==b.length){if(1==w.length){if(b[1]!=w[0])throw new RangeError("Dimension mismatch in multiplication. Columns of A must match length of B (A is "+b[0]+"x"+b[0]+", B is "+w[0]+", "+b[1]+" != "+w[0]+")");return i(r,s)}if(2==w.length){if(b[1]!=w[0])throw new RangeError("Dimension mismatch in multiplication. Columns of A must match rows of B (A is "+b[0]+"x"+b[1]+", B is "+w[0]+"x"+w[1]+", "+b[1]+" != "+w[0]+")");return t(r,s)}throw new Error("Can only multiply a 1 or 2 dimensional matrix (B has "+w.length+" dimensions)")}throw new Error("Can only multiply a 1 or 2 dimensional matrix (A has "+b.length+" dimensions)")}return s instanceof c?(h=x(r,s.valueOf()),v(h)?new c(h):h):f.deepMap2(r,s,x)}if(r instanceof c)return s instanceof c?(h=x(r.valueOf(),s.valueOf()),v(h)?new c(h):h):(h=x(r.valueOf(),s),v(h)?new c(h):h);if(v(s))return f.deepMap2(r,s,x);if(s instanceof c)return new c(f.deepMap2(r,s.valueOf(),x));if(m(r)||null===r)return x(+r,s);if(m(s)||null===s)return x(r,+s);throw new e.error.UnsupportedTypeError("multiply",e["typeof"](r),e["typeof"](s))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(137),i=e.type.BigNumber,a=r(6),o=r(9),s=(r(13),t.number.isNumber),u=t["boolean"].isBoolean,l=a.isComplex,c=Array.isArray;e.norm=function h(t,r){if(arguments.length<1||arguments.length>2)throw new e.error.ArgumentsError("abs",arguments.length,1,2);if(s(t))return Math.abs(t);
if(l(t))return Math.sqrt(t.re*t.re+t.im*t.im);if(t instanceof i)return t.abs();if(u(t)||null===t)return Math.abs(t);if(c(t)){var a=n.size(t);if(null==r&&(r=2),1==a.length){if(r===Number.POSITIVE_INFINITY||"inf"===r){var f;return e.forEach(t,function(t){var r=e.abs(t);(!f||e.larger(r,f))&&(f=r)}),f}if(r===Number.NEGATIVE_INFINITY||"-inf"===r){var f;return e.forEach(t,function(t){var r=e.abs(t);(!f||e.smaller(r,f))&&(f=r)}),f}if("fro"===r)return h(t);if(s(r)&&!isNaN(r)){if(!e.equal(r,0)){var f=0;return e.forEach(t,function(t){f=e.add(e.pow(e.abs(t),r),f)}),e.pow(f,1/r)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2==a.length){if(1==r){for(var p=[],d=0;d<t.length;d++)for(var m=t[d],g=0;g<m.length;g++)p[g]=e.add(p[g]||0,e.abs(m[g]));return e.max(p)}if(r==Number.POSITIVE_INFINITY||"inf"===r){for(var f=0,d=0;d<t.length;d++){for(var v=0,m=t[d],g=0;g<m.length;g++)v=e.add(v,e.abs(m[g]));e.larger(v,f)&&(f=v)}return f}if("fro"===r){var y=e.diag(e.multiply(e.transpose(t),t)),x=0;return e.forEach(y,function(t){x=e.add(t,x)}),e.sqrt(x)}if(2==r)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}if(t instanceof o)return h(t.valueOf(),r);throw new e.error.UnsupportedTypeError("norm",t)}}},function(e,t,r){e.exports=function(e){function t(t,r){var n=e.log(t),i=e.multiply(n,r);return e.exp(i)}var n=r(144),i=e.type.BigNumber,a=r(6),o=r(9),s=(r(13),n.array),u=n.number.isNumber,l=n["boolean"].isBoolean,c=Array.isArray,h=n.number.isInteger,f=a.isComplex;e.pow=function p(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("pow",arguments.length,2);if(u(r)){if(u(n))return h(n)||r>=0?Math.pow(r,n):t(new a(r,0),new a(n,0));if(f(n))return t(new a(r,0),n)}if(f(r)){if(u(n))return t(r,new a(n,0));if(f(n))return t(r,n)}if(r instanceof i)return u(n)?n=i.convert(n):(l(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?n.isInteger()&&!r.isNegative()?r.pow(n):p(r.toNumber(),n.toNumber()):p(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(l(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?n.isInteger()&&!r.isNegative()?r.pow(n):p(r.toNumber(),n.toNumber()):p(r,n.toNumber());if(c(r)){if(!u(n)||!h(n)||0>n)throw new TypeError("For A^b, b must be a positive integer (value is "+n+")");var d=s.size(r);if(2!=d.length)throw new Error("For A^b, A must be 2 dimensional (A has "+d.length+" dimensions)");if(d[0]!=d[1])throw new Error("For A^b, A must be square (size is "+d[0]+"x"+d[1]+")");for(var m=e.eye(d[0]).valueOf(),g=r;n>=1;)1==(1&n)&&(m=e.multiply(g,m)),n>>=1,g=e.multiply(g,g);return m}if(r instanceof o)return new o(p(r.valueOf(),n));if(l(r)||null===r)return p(+r,n);if(l(n)||null===n)return p(r,+n);throw new e.error.UnsupportedTypeError("pow",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){function t(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r}var n=r(144),i=e.type.BigNumber,a=r(6),o=r(13),s=n.number.isNumber,u=n.number.isInteger,l=n["boolean"].isBoolean,c=a.isComplex,h=o.isCollection;e.round=function f(r,n){if(1!=arguments.length&&2!=arguments.length)throw new e.error.ArgumentsError("round",arguments.length,1,2);if(void 0==n){if(s(r))return Math.round(r);if(c(r))return new a(Math.round(r.re),Math.round(r.im));if(r instanceof i)return r.toDecimalPlaces(0);if(h(r))return o.deepMap(r,f);if(l(r)||null===r)return Math.round(r);throw new e.error.UnsupportedTypeError("round",e["typeof"](r))}if(!s(n)||!u(n)){if(!(n instanceof i)){if(l(n)||null===r)return f(r,+n);throw new TypeError("Number of decimals in function round must be an integer")}n=parseFloat(n.valueOf())}if(0>n||n>15)throw new Error("Number of decimals in function round must be in te range of 0-15");if(s(r))return t(r,n);if(c(r))return new a(t(r.re,n),t(r.im,n));if(r instanceof i)return r.toDecimalPlaces(n);if(h(r)||h(n))return o.deepMap2(r,n,f);if(l(r)||null===r)return f(+r,n);throw new e.error.UnsupportedTypeError("round",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number,s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isCollection;e.sign=function h(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sign",arguments.length,1);if(s(t))return o.sign(t);if(l(t)){var r=Math.sqrt(t.re*t.re+t.im*t.im);return new i(t.re/r,t.im/r)}if(t instanceof n)return new n(t.cmp(0));if(c(t))return a.deepMap(t,h);if(u(t)||null===t)return o.sign(t);throw new e.error.UnsupportedTypeError("sign",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.sqrt=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sqrt",arguments.length,1);if(o(t))return t>=0?Math.sqrt(t):c(new i(t,0));if(u(t)){var r,h,f=Math.sqrt(t.re*t.re+t.im*t.im);return r=t.re>=0?.5*Math.sqrt(2*(f+t.re)):Math.abs(t.im)/Math.sqrt(2*(f-t.re)),h=t.re<=0?.5*Math.sqrt(2*(f-t.re)):Math.abs(t.im)/Math.sqrt(2*(f+t.re)),t.im>=0?new i(r,h):new i(r,-h)}if(t instanceof n)return t.isNegative()?c(t.toNumber()):t.sqrt();if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);throw new e.error.UnsupportedTypeError("sqrt",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.square=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("square",arguments.length,1);if(o(t))return t*t;if(u(t))return e.multiply(t,t);if(t instanceof n)return t.times(t);if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return t*t;throw new e.error.UnsupportedTypeError("square",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=(r(9),r(10)),o=r(13),s=t["boolean"].isBoolean,u=t.number.isNumber,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.subtract=function f(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("subtract",arguments.length,2);if(u(t)){if(u(r))return t-r;if(l(r))return new i(t-r.re,-r.im)}else if(l(t)){if(u(r))return new i(t.re-r,t.im);if(l(r))return new i(t.re-r.re,t.im-r.im)}if(t instanceof n)return u(r)?r=n.convert(r):(s(r)||null===r)&&(r=new n(r?1:0)),r instanceof n?t.minus(r):f(t.toNumber(),r);if(r instanceof n)return u(t)?t=n.convert(t):(s(t)||null===t)&&(t=new n(t?1:0)),t instanceof n?t.minus(r):f(t,r.toNumber());if(c(t)&&c(r)){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==r.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(r))throw new Error("Units do not match");var a=t.clone();return a.value-=r.value,a.fixPrefix=!1,a}if(h(t)||h(r))return o.deepMap2(t,r,f);if(s(t)||null===t)return f(+t,r);if(s(r)||null===r)return f(t,+r);throw new e.error.UnsupportedTypeError("subtract",e["typeof"](t),e["typeof"](r))}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n["boolean"].isBoolean,c=n.string.isString,h=a.isComplex,f=o.isUnit,p=s.isCollection;e.unaryMinus=function d(r){if(1!=arguments.length)throw new e.error.ArgumentsError("unaryMinus",arguments.length,1);if(u(r))return-r;if(h(r))return new a(-r.re,-r.im);if(r instanceof i)return r.neg();if(f(r)){var n=r.clone();return n.value=-r.value,n}if(p(r))return s.deepMap(r,d);if(l(r)||c(r)||null===r)return"bignumber"==t.number?new i(-r):-r;throw new e.error.UnsupportedTypeError("unaryMinus",e["typeof"](r))},e.unary=function(){throw new Error("Function unary is deprecated. Use unaryMinus instead.")}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n["boolean"].isBoolean,c=n.string.isString,h=a.isComplex,f=o.isUnit,p=s.isCollection;e.unaryPlus=function d(r){if(1!=arguments.length)throw new e.error.ArgumentsError("unaryPlus",arguments.length,1);if(u(r))return r;if(h(r))return r.clone();if(r instanceof i)return r;if(f(r))return r.clone();if(p(r))return s.deepMap(r,d);if(l(r)||c(r)||null===r)return"bignumber"==t.number?new i(+r):+r;throw new e.error.UnsupportedTypeError("unaryPlus",e["typeof"](r))}}},function(e,t,r){e.exports=function(e,t){function n(e,r){for(var n,i,a,s=0,u=1,l=1,c=0;r;)i=Math.floor(e/r),a=e%r,n=s,s=u-i*s,u=n,n=l,l=c-i*l,c=n,e=r,r=a;var h;return h=0>e?[-e,-u,-c]:[e,e?u:0,c],"array"===t.matrix?h:new o(h)}function i(e,r){for(var n,i,a,u=new s(0),l=new s(0),c=new s(1),h=new s(1),f=new s(0);!r.isZero();)i=e.div(r).floor(),a=e.mod(r),n=l,l=c.minus(i.times(l)),c=n,n=h,h=f.minus(i.times(h)),f=n,e=r,r=a;var p;return p=e.lt(u)?[e.neg(),c.neg(),f.neg()]:[e,e.isZero()?0:c,f],"array"===t.matrix?p:new o(p)}var a=r(144),o=r(9),s=e.type.BigNumber,u=a.number.isNumber,l=a["boolean"].isBoolean,c=a.number.isInteger;e.xgcd=function h(t,r){if(2==arguments.length){if(u(t)&&u(r)){if(!c(t)||!c(r))throw new Error("Parameters in function xgcd must be integer numbers");return n(t,r)}if(t instanceof s)return u(r)?r=s.convert(r):(l(r)||null===r)&&(r=new s(r?1:0)),r instanceof s?i(t,r):h(t.toNumber(),r);if(r instanceof s)return u(t)?t=s.convert(t):(l(t)||null===t)&&(t=new s(t?1:0)),t instanceof s?i(t,r):h(t.toNumber(),r);if(l(t)||null===t)return h(+t,r);if(l(r)||null===r)return h(t,+r);throw new e.error.UnsupportedTypeError("xgcd",e["typeof"](t),e["typeof"](r))}throw new SyntaxError("Function xgcd expects two arguments")}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.compare=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("compare",arguments.length,2);if(u(r)&&u(n))return l(r,n,t.epsilon)?0:r>n?1:-1;if(r instanceof i)return u(n)?n=i.convert(n):(c(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?new i(r.cmp(n)):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(c(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?new i(r.cmp(n)):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value>n.value?1:r.value<n.value?-1:0}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return r>n?1:n>r?-1:0;if(c(r)||null===r)return m(+r,n);if(c(n)||null===n)return m(r,+n);if(f(r)||f(n))throw new TypeError("No ordering relation is defined for complex numbers");throw new e.error.UnsupportedTypeError("compare",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){function t(r,n){if(a(r)){if(a(n)){var i=r.length;if(i!==n.length)return!1;for(var o=0;i>o;o++)if(!t(r[o],n[o]))return!1;return!0}return!1}return a(n)?!1:e.equal(r,n)}var n=r(13),i=n.isCollection,a=Array.isArray;e.deepEqual=function(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("deepEqual",arguments.length,2);return i(r)||i(n)?t(r.valueOf(),n.valueOf()):e.equal(r,n)}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.equal=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("equal",arguments.length,2);if(u(r)){if(u(n))return l(r,n,t.epsilon);if(f(n))return l(r,n.re,t.epsilon)&&l(n.im,0,t.epsilon)}if(f(r)){if(u(n))return l(r.re,n,t.epsilon)&&l(r.im,0,t.epsilon);if(f(n))return l(r.re,n.re,t.epsilon)&&l(r.im,n.im,t.epsilon)}if(r instanceof i)return u(n)?n=i.convert(n):c(n)&&(n=new i(n?1:0)),n instanceof i?r.eq(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):c(r)&&(r=new i(r?1:0)),r instanceof i?r.eq(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value==n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return r==n;if(c(r))return m(+r,n);if(c(n))return m(r,+n);if(null===r)return null===n;if(null===n)return null===r;if(void 0===r)return void 0===n;if(void 0===n)return void 0===r;throw new e.error.UnsupportedTypeError("equal",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.larger=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("larger",arguments.length,2);if(u(r)&&u(n))return!l(r,n,t.epsilon)&&r>n;if(r instanceof i)return u(n)?n=i.convert(n):(c(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?r.gt(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(c(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?r.gt(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value>n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return r>n;if(c(r)||null===r)return m(+r,n);if(c(n)||null===n)return m(r,+n);if(f(r)||f(n))throw new TypeError("No ordering relation is defined for complex numbers");throw new e.error.UnsupportedTypeError("larger",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.largerEq=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("largerEq",arguments.length,2);if(u(r)&&u(n))return l(r,n,t.epsilon)||r>n;if(r instanceof i)return u(n)?n=i.convert(n):(c(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?r.gte(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(c(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?r.gte(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value>=n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return r>=n;if(c(r)||null===r)return m(+r,n);if(c(n)||null===n)return m(r,+n);if(f(r)||f(n))throw new TypeError("No ordering relation is defined for complex numbers");throw new e.error.UnsupportedTypeError("largerEq",e["typeof"](r),e["typeof"](n))},e.largereq=function(){throw new Error("Function largereq is renamed to largerEq")}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.smaller=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("smaller",arguments.length,2);if(u(r)&&u(n))return!l(r,n,t.epsilon)&&n>r;if(r instanceof i)return u(n)?n=i.convert(n):(c(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?r.lt(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(c(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?r.lt(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value<n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return n>r;if(c(r)||null===r)return m(+r,n);if(c(n)||null===n)return m(r,+n);if(f(r)||f(n))throw new TypeError("No ordering relation is defined for complex numbers");throw new e.error.UnsupportedTypeError("smaller",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.smallerEq=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("smallerEq",arguments.length,2);if(u(r)&&u(n))return l(r,n,t.epsilon)||n>r;if(r instanceof i)return u(n)?n=i.convert(n):(c(n)||null===n)&&(n=new i(n?1:0)),n instanceof i?r.lte(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):(c(r)||null===r)&&(r=new i(r?1:0)),r instanceof i?r.lte(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value<=n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return n>=r;if(c(r)||null===r)return m(+r,n);if(c(n)||null===n)return m(r,+n);if(f(r)||f(n))throw new TypeError("No ordering relation is defined for complex numbers");throw new e.error.UnsupportedTypeError("smallerEq",e["typeof"](r),e["typeof"](n))},e.smallereq=function(){throw new Error("Function smallereq is renamed to smallerEq")}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(13),u=n.number.isNumber,l=n.number.nearlyEqual,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit,d=s.isCollection;e.unequal=function m(r,n){if(2!=arguments.length)throw new e.error.ArgumentsError("unequal",arguments.length,2);if(u(r)){if(u(n))return!l(r,n,t.epsilon);if(f(n))return!l(r,n.re,t.epsilon)||!l(n.im,0,t.epsilon)}if(f(r)){if(u(n))return!l(r.re,n,t.epsilon)||!l(r.im,0,t.epsilon);if(f(n))return!l(r.re,n.re,t.epsilon)||!l(r.im,n.im,t.epsilon)}if(r instanceof i)return u(n)?n=i.convert(n):c(n)&&(n=new i(n?1:0)),n instanceof i?!r.eq(n):m(r.toNumber(),n);if(n instanceof i)return u(r)?r=i.convert(r):c(r)&&(r=new i(r?1:0)),r instanceof i?!r.eq(n):m(r,n.toNumber());if(p(r)&&p(n)){if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return r.value!=n.value}if(d(r)||d(n))return s.deepMap2(r,n,m);if(h(r)||h(n))return r!=n;if(c(r))return m(+r,n);if(c(n))return m(r,+n);if(null===r)return null!==n;if(null===n)return null!==r;if(void 0===r)return void 0!==n;if(void 0===n)return void 0!==r;throw new e.error.UnsupportedTypeError("unequal",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=a.isCollection,l=i.isComplex;e.arg=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("arg",arguments.length,1);if(o(t))return Math.atan2(0,t);if(l(t))return Math.atan2(t.im,t.re);if(u(t))return a.deepMap(t,c);if(s(t)||null===t)return c(+t);if(t instanceof n)return c(t.toNumber());throw new e.error.UnsupportedTypeError("arg",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.object,s=t.number.isNumber,u=t["boolean"].isBoolean,l=a.isCollection,c=i.isComplex;e.conj=function h(t){if(1!=arguments.length)throw new e.error.ArgumentsError("conj",arguments.length,1);return s(t)?t:t instanceof n?new n(t):c(t)?new i(t.re,-t.im):l(t)?a.deepMap(t,h):u(t)||null===t?+t:o.clone(t)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.object,s=t.number.isNumber,u=t["boolean"].isBoolean,l=a.isCollection,c=i.isComplex;e.re=function h(t){if(1!=arguments.length)throw new e.error.ArgumentsError("re",arguments.length,1);return s(t)?t:t instanceof n?new n(t):c(t)?t.re:l(t)?a.deepMap(t,h):u(t)||null===t?+t:o.clone(t)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=a.isCollection,l=i.isComplex;e.im=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("im",arguments.length,1);return o(t)?0:t instanceof n?new n(0):l(t)?t.im:u(t)?a.deepMap(t,c):(s(t)||null===t,0)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(13),a=i.isCollection,o=t.number.isNumber,s=t.string.isString,u=t["boolean"].isBoolean;e.bignumber=function l(t){if(arguments.length>1)throw new e.error.ArgumentsError("bignumber",arguments.length,0,1);if(t instanceof n||o(t)||s(t))return new n(t);if(u(t)||null===t)return new n(+t);if(a(t))return i.deepMap(t,l);if(0==arguments.length)return new n(0);throw new e.error.UnsupportedTypeError("bignumber",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(13),a=i.isCollection,o=t.number.isNumber,s=t.string.isString;e["boolean"]=function u(t){if(1!=arguments.length)throw new e.error.ArgumentsError("boolean",arguments.length,0,1);if("true"===t||t===!0)return!0;if("false"===t||t===!1||null===t)return!1;if(t instanceof Boolean)return 1==t;if(o(t))return 0!==t;if(t instanceof n)return!t.isZero();if(s(t)){var r=t.toLowerCase();if("true"===r)return!0;if("false"===r)return!1;var l=Number(t);if(""!=t&&!isNaN(l))return 0!==l}if(a(t))return i.deepMap(t,u);throw new SyntaxError(t.toString()+" is no valid boolean")}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=a.isCollection,s=t.number.isNumber,u=t.string.isString,l=i.isComplex;e.complex=function c(){switch(arguments.length){case 0:return new i(0,0);case 1:var t=arguments[0];if(s(t))return new i(t,0);if(t instanceof n)return new i(t.toNumber(),0);if(l(t))return t.clone();if(u(t)){var r=i.parse(t);if(r)return r;throw new SyntaxError('String "'+t+'" is no valid complex number')}if(o(t))return a.deepMap(t,c);if("object"==typeof t){if("re"in t&&"im"in t)return new i(t.re,t.im);if("r"in t&&"phi"in t)return i.fromPolar(t.r,t.phi)}throw new TypeError("Two numbers, single string or an fitting object expected in function complex");case 2:var h=arguments[0],f=arguments[1];if(h instanceof n&&(h=h.toNumber()),f instanceof n&&(f=f.toNumber()),s(h)&&s(f))return new i(h,f);throw new TypeError("Two numbers or a single string expected in function complex");default:throw new e.error.ArgumentsError("complex",arguments.length,0,2)}}}},function(e,t,r){e.exports=function(e){var t=(r(144),e.type.BigNumber),n=r(8);e.index=function(){var e=Array.prototype.slice.apply(arguments).map(function(e){return e instanceof t?e.toNumber():Array.isArray(e)?e.map(function(e){return e instanceof t?e.toNumber():e}):e}),r=new n;return n.apply(r,e),r}}},function(e,t,r){e.exports=function(e){var t=(r(144),r(9));e.matrix=function(r){if(arguments.length>1)throw new e.error.ArgumentsError("matrix",arguments.length,0,1);return new t(r)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=e.type.Unit,a=r(13),o=a.isCollection,s=t.number.isNumber,u=t["boolean"].isBoolean,l=t.string.isString;e.number=function c(t,r){switch(arguments.length){case 0:return 0;case 1:if(o(t))return a.deepMap(t,c);if(t instanceof n)return t.toNumber();if(l(t)){var h=Number(t);if(isNaN(h)&&(h=Number(t.valueOf())),isNaN(h))throw new SyntaxError(t.toString()+" is no valid number");return h}if(u(t)||null===t)return+t;if(s(t))return t;if(t instanceof i)throw new Error("Second argument with valueless unit expected");throw new e.error.UnsupportedTypeError("number",e["typeof"](t));case 2:if(t instanceof i&&l(r)||r instanceof i)return t.toNumber(r);throw new e.error.UnsupportedTypeError("number",e["typeof"](t),e["typeof"](r));default:throw new e.error.ArgumentsError("number",arguments.length,0,1)}}}},function(e,t,r){e.exports=function(e){var t=r(15);e.parser=function(){return new t(e)}}},function(e){e.exports=function(e){e.select=function(t){return new e.chaining.Selector(t)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(13),i=t.number,a=t.number.isNumber,o=n.isCollection;e.string=function s(t){switch(arguments.length){case 0:return"";case 1:return a(t)?i.format(t):o(t)?n.deepMap(t,s):null===t?"null":t.toString();default:throw new e.error.ArgumentsError("string",arguments.length,0,1)}}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(10),a=r(13),o=a.isCollection,s=t.string.isString;e.unit=function u(t){switch(arguments.length){case 1:var r=arguments[0];if(r instanceof i)return r.clone();if(s(r)){if(i.isValuelessUnit(r))return new i(null,r);var l=i.parse(r);if(l)return l;throw new SyntaxError('String "'+r+'" is no valid unit')}if(o(t))return a.deepMap(t,u);throw new TypeError("A string or a number and string expected in function unit");case 2:return arguments[0]instanceof n?new i(arguments[0].toNumber(),arguments[1]):new i(arguments[0],arguments[1]);default:throw new e.error.ArgumentsError("unit",arguments.length,1,2)}}}},function(e,t,r){e.exports=function(e){function t(r,n,i,a){if(i>a){if(r.length!=n.length)throw new e.error.DimensionError(r.length,n.length);for(var o=[],s=0;s<r.length;s++)o[s]=t(r[s],n[s],i,a+1);return o}return r.concat(n)}var n=r(144),i=r(139),a=r(9),o=r(13),s=n.object,u=n.array,l=n.number.isNumber,c=n.number.isInteger,h=o.isCollection;e.concat=function(){var r,n,o=arguments.length,f=-1,p=!1,d=[];for(r=0;o>r;r++){var m=arguments[r];if(m instanceof a&&(p=!0),r==o-1&&(l(m)||m instanceof i)){if(n=f,f=m.valueOf(),!c(f))throw new TypeError("Integer number expected for dimension");if(0>f)throw new e.error.IndexError(f);if(r>0&&f>n)throw new e.error.IndexError(f,n+1)}else{if(!h(m))throw new e.error.UnsupportedTypeError("concat",e["typeof"](m));var g=s.clone(m).valueOf(),v=u.size(m.valueOf());if(d[r]=g,n=f,f=v.length-1,r>0&&f!=n)throw new e.error.DimensionError(n+1,f+1)}}if(0==d.length)throw new SyntaxError("At least one matrix expected");for(var y=d.shift();d.length;)y=t(y,d.shift(),f,0);return p?new a(y):y}}},function(e,t,r){e.exports=function(e){function t(t,r){if(1==r)return a.clone(t[0][0]);if(2==r)return e.subtract(e.multiply(t[0][0],t[1][1]),e.multiply(t[1][0],t[0][1]));for(var n=function(t){var r,n,i=new Array(t.length),a=0;for(r=1;r<t.length;r++)a=e.add(a,t[r][r]);for(r=0;r<t.length;r++){for(i[r]=new Array(t.length),i[r][r]=e.unaryMinus(a),n=0;r>n;n++)i[r][n]=0;for(n=r+1;n<t.length;n++)i[r][n]=t[r][n];r+1<t.length&&(a=e.subtract(a,t[r+1][r+1]))}return i},i=t,o=0;r-1>o;o++)i=e.multiply(n(i),t);return r%2==0?e.unaryMinus(i[0][0]):i[0][0]}var n=r(144),i=r(9),a=n.object,o=n.string;e.det=function(r){if(1!=arguments.length)throw new e.error.ArgumentsError("det",arguments.length,1);var n;switch(r instanceof i?n=r.size():r instanceof Array?(r=new i(r),n=r.size()):n=[],n.length){case 0:return a.clone(r);case 1:if(1==n[0])return a.clone(r.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+o.format(n)+")");case 2:var s=n[0],u=n[1];if(s==u)return t(r.clone().valueOf(),s,u);throw new RangeError("Matrix must be square (size: "+o.format(n)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+o.format(n)+")")}}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(9),a=t.object,o=t.array.isArray,s=t.number.isNumber,u=t.number.isInteger;e.diag=function(t,r){var l,c,h,f;if(1!=arguments.length&&2!=arguments.length)throw new e.error.ArgumentsError("diag",arguments.length,1,2);if(r){if(r instanceof n&&(r=r.toNumber()),!s(r)||!u(r))throw new TypeError("Second parameter in function diag must be an integer")}else r=0;var p,d=r>0?r:0,m=0>r?-r:0;if(t instanceof i)p=!1;else{if(!o(t))throw new TypeError("First parameter in function diag must be a Matrix or Array");t=new i(t),p=!0}var g=t.size();switch(g.length){case 1:c=t.valueOf();var v=new i,y=c[0]instanceof n?new n(0):0;for(v.resize([c.length+m,c.length+d],y),l=v.valueOf(),f=c.length,h=0;f>h;h++)l[h+m][h+d]=a.clone(c[h]);return p?v.valueOf():v;case 2:for(c=[],l=t.valueOf(),f=Math.min(g[0]-m,g[1]-d),h=0;f>h;h++)c[h]=a.clone(l[h+m][h+d]);return p?c:new i(c);default:throw new RangeError("Matrix for function diag must be 2 dimensional")}}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(9),o=r(13),s=n.number.isNumber,u=n.number.isInteger,l=Array.isArray;e.eye=function(r){var n=o.argsToArray(arguments),c=r instanceof a?!0:l(r)?!1:"matrix"===t.matrix;if(0==n.length)return c?new a:[];if(1==n.length)n[1]=n[0];else if(n.length>2)throw new e.error.ArgumentsError("eye",n.length,0,2);var h=n[0],f=n[1];if(h instanceof i&&(h=h.toNumber()),f instanceof i&&(f=f.toNumber()),!s(h)||!u(h)||1>h)throw new Error("Parameters in function eye must be positive integers");if(!s(f)||!u(f)||1>f)throw new Error("Parameters in function eye must be positive integers");var p=!1;n=n.map(function(e){return e instanceof i?(p=!0,e.toNumber()):e});var d=new a,m=p?new i(1):1,g=p?new i(0):0;d.resize(n,g);for(var v=e.min(n),y=d.valueOf(),x=0;v>x;x++)y[x][x]=m;return c?d:d.valueOf()}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(9),i=t.object,a=t.array,o=Array.isArray;e.flatten=function(t){if(1!==arguments.length)throw new e.error.ArgumentsError("flatten",arguments.length,1);if(t instanceof n){var r=i.clone(t.toArray()),s=a.flatten(r);return new n(s)}if(o(t))return a.flatten(i.clone(t));throw new e.error.UnsupportedTypeError("flatten",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){function t(t,r,n){var i,a,o,s,u;if(1==r){if(s=t[0][0],0==s)throw Error("Cannot calculate inverse, determinant is zero");return[[e.divide(1,s)]]}if(2==r){var l=e.det(t);if(0==l)throw Error("Cannot calculate inverse, determinant is zero");return[[e.divide(t[1][1],l),e.divide(e.unaryMinus(t[0][1]),l)],[e.divide(e.unaryMinus(t[1][0]),l),e.divide(t[0][0],l)]]}var c=t.concat();for(i=0;r>i;i++)c[i]=c[i].concat();for(var h=e.eye(r).valueOf(),f=0;n>f;f++){for(i=f;r>i&&0==c[i][f];)i++;if(i==r||0==c[i][f])throw Error("Cannot calculate inverse, determinant is zero");i!=f&&(u=c[f],c[f]=c[i],c[i]=u,u=h[f],h[f]=h[i],h[i]=u);var p=c[f],d=h[f];for(i=0;r>i;i++){var m=c[i],g=h[i];if(i!=f){if(0!=m[f]){for(o=e.divide(e.unaryMinus(m[f]),p[f]),a=f;n>a;a++)m[a]=e.add(m[a],e.multiply(o,p[a]));for(a=0;n>a;a++)g[a]=e.add(g[a],e.multiply(o,d[a]))}}else{for(o=p[f],a=f;n>a;a++)m[a]=e.divide(m[a],o);for(a=0;n>a;a++)g[a]=e.divide(g[a],o)}}}return h}var n=r(144),i=n.string,a=r(9);e.inv=function(r){if(1!=arguments.length)throw new e.error.ArgumentsError("inv",arguments.length,1);var n=e.size(r).valueOf();switch(n.length){case 0:return e.divide(1,r);case 1:if(1==n[0])return r instanceof a?new a([e.divide(1,r.valueOf()[0])]):[e.divide(1,r[0])];throw new RangeError("Matrix must be square (size: "+i.format(n)+")");case 2:var o=n[0],s=n[1];if(o==s)return r instanceof a?new a(t(r.valueOf(),o,s)):t(r,o,s);throw new RangeError("Matrix must be square (size: "+i.format(n)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+i.format(n)+")")}}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(9),o=r(13),s=n.array,u=Array.isArray;e.ones=function(e){var r=o.argsToArray(arguments),n=e instanceof a?!0:u(e)?!1:"matrix"===t.matrix;if(0==r.length)return n?new a:[];var l=!1;r=r.map(function(e){return e instanceof i?(l=!0,e.toNumber()):e});var c=[],h=l?new i(1):1;return c=s.resize(c,r,h),n?new a(c):c}}},function(e,t,r){e.exports=function(e,t){function n(e,t,r){var n=[],i=e;if(r>0)for(;t>i;)n.push(i),i+=r;else if(0>r)for(;i>t;)n.push(i),i+=r;return n}function i(e,t,r){var n=[],i=e;if(r>0)for(;t>=i;)n.push(i),i+=r;else if(0>r)for(;i>=t;)n.push(i),i+=r;return n}function a(e,t,r){var n=[],i=e.clone(),a=new l(0);if(r.gt(a))for(;i.lt(t);)n.push(i),i=i.plus(r);else if(r.lt(a))for(;i.gt(t);)n.push(i),i=i.plus(r);return n}function o(e,t,r){var n=[],i=e.clone(),a=new l(0);if(r.gt(a))for(;i.lte(t);)n.push(i),i=i.plus(r);else if(r.lt(a))for(;i.gte(t);)n.push(i),i=i.plus(r);return n}function s(e){var r=e.split(":"),n=null;if("bignumber"===t.number)try{n=r.map(function(e){return new l(e)})}catch(i){return null}else{n=r.map(function(e){return Number(e)});var a=n.some(function(e){return isNaN(e)});if(a)return null}switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}var u=r(144),l=e.type.BigNumber,c=r(9),h=(r(13),u["boolean"].isBoolean),f=u.string.isString,p=u.number.isNumber;e.range=function(){var r,u,d,m=Array.prototype.slice.call(arguments),g=!1;switch(h(m[m.length-1])&&(g=m.pop()?!0:!1),m.length){case 1:if(!f(m[0]))throw new TypeError("Two or three numbers or a single string expected in function range");var v=s(m[0]);if(!v)throw new SyntaxError('String "'+m[0]+'" is no valid range');r=v.start,u=v.end,d=v.step;break;case 2:r=m[0],u=m[1],d=1;break;case 3:r=m[0],u=m[1],d=m[2];break;case 4:throw new TypeError("Parameter includeEnd must be a boolean");
default:throw new e.error.ArgumentsError("range",arguments.length,2,4)}if(!(p(r)||r instanceof l))throw new TypeError("Parameter start must be a number");if(!(p(u)||u instanceof l))throw new TypeError("Parameter end must be a number");if(!(p(d)||d instanceof l))throw new TypeError("Parameter step must be a number");if(r instanceof l||u instanceof l||d instanceof l){var y=!0;r instanceof l||(r=l.convert(r)),u instanceof l||(u=l.convert(u)),d instanceof l||(d=l.convert(d)),r instanceof l&&u instanceof l&&d instanceof l||(y=!1,r instanceof l&&(r=r.toNumber()),u instanceof l&&(u=u.toNumber()),d instanceof l&&(d=d.toNumber()))}var x=y?g?o:a:g?i:n,b=x(r,u,d);return"array"===t.matrix?b:new c(b)}}},function(e,t,r){e.exports=function(e,t){function n(t,r,n){if(void 0!==n){if(!c(n)||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==r.length)throw new e.error.DimensionError(r.length,1);var i=r[0];if(!h(i)||!f(i))throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(r)+")");if(t.length>i)return t.substring(0,i);if(t.length<i){for(var a=t,o=0,s=i-t.length;s>o;o++)a+=n;return a}return t}var i=r(144),a=e.type.BigNumber,o=r(9),s=i.array,u=i.object.clone,l=i.string,c=i.string.isString,h=i.number.isNumber,f=i.number.isInteger,p=s.isArray;e.resize=function(r,i,l){if(2!=arguments.length&&3!=arguments.length)throw new e.error.ArgumentsError("resize",arguments.length,2,3);var h=r instanceof o?!0:p(r)?!1:"array"!==t.matrix;if(r instanceof o&&(r=r.valueOf()),i instanceof o&&(i=i.valueOf()),i.length&&i[0]instanceof a&&(i=i.map(function(e){return e instanceof a?e.toNumber():e})),c(r))return n(r,i,l);if(0==i.length){for(;p(r);)r=r[0];return u(r)}p(r)||(r=[r]),r=u(r);var f=s.resize(r,i,l);return h?new o(f):f}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(6),o=r(10),s=r(9),u=n.array,l=n.number.isNumber,c=n["boolean"].isBoolean,h=n.string.isString,f=a.isComplex,p=o.isUnit;e.size=function(r){if(1!=arguments.length)throw new e.error.ArgumentsError("size",arguments.length,1);var n="array"===t.matrix;if(l(r)||f(r)||p(r)||c(r)||null==r||r instanceof i)return n?[]:new s([]);if(h(r))return n?[r.length]:new s([r.length]);if(Array.isArray(r))return u.size(r);if(r instanceof s)return new s(r.size());throw new e.error.UnsupportedTypeError("size",e["typeof"](r))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(9),i=t.object,a=t.array,o=Array.isArray;e.squeeze=function(t){if(1!=arguments.length)throw new e.error.ArgumentsError("squeeze",arguments.length,1);if(o(t))return a.squeeze(i.clone(t));if(t instanceof n){var r=a.squeeze(t.toArray());return o(r)?new n(r):r}return i.clone(t)}}},function(e,t,r){e.exports=function(e){function t(t,r){var i,a;if(h(t))return i=new s(t),a=i.subset(r),a&&a.valueOf();if(t instanceof s)return t.subset(r);if(c(t))return n(t,r);throw new e.error.UnsupportedTypeError("subset",e["typeof"](t))}function n(t,r){if(!(r instanceof u))throw new TypeError("Index expected");if(1!=r.size().length)throw new e.error.DimensionError(r.size().length,1);var n=t.length;l.validateIndex(r.min()[0],n),l.validateIndex(r.max()[0],n);var i=r.range(0),a="";return i.forEach(function(e){a+=t.charAt(e)}),a}function i(t,r,n,i){var o;if(h(t))return o=new s(e.clone(t)),o.subset(r,n,i),o.valueOf();if(t instanceof s)return t.clone().subset(r,n,i);if(c(t))return a(t,r,n,i);throw new e.error.UnsupportedTypeError("subset",e["typeof"](t))}function a(t,r,n,i){if(!(r instanceof u))throw new TypeError("Index expected");if(1!=r.size().length)throw new e.error.DimensionError(r.size().length,1);if(void 0!==i){if(!c(i)||1!==i.length)throw new TypeError("Single character expected as defaultValue")}else i=" ";var a=r.range(0),o=a.size()[0];if(o!=n.length)throw new e.error.DimensionError(a.size()[0],n.length);var s=t.length;l.validateIndex(r.min()[0]),l.validateIndex(r.max()[0]);for(var h=[],f=0;s>f;f++)h[f]=t.charAt(f);if(a.forEach(function(e,t){h[e]=n.charAt(t)}),h.length>s)for(f=s-1,o=h.length;o>f;f++)h[f]||(h[f]=i);return h.join("")}var o=r(144),s=r(9),u=r(8),l=o.array,c=o.string.isString,h=Array.isArray;e.subset=function(){switch(arguments.length){case 2:return t(arguments[0],arguments[1]);case 3:case 4:return i(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw new e.error.ArgumentsError("subset",arguments.length,2,4)}}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(9),i=t.object,a=t.string;e.transpose=function(t){if(1!=arguments.length)throw new e.error.ArgumentsError("transpose",arguments.length,1);var r=e.size(t).valueOf();switch(r.length){case 0:return i.clone(t);case 1:return i.clone(t);case 2:var o,s=r[1],u=r[0],l=t instanceof n,c=t.valueOf(),h=[],f=i.clone;if(0===s)throw new RangeError("Cannot transpose a 2D matrix with no rows(size: "+a.format(r)+")");for(var p=0;s>p;p++){o=h[p]=[];for(var d=0;u>d;d++)o[d]=f(c[d][p])}return l?new n(h):h;default:throw new RangeError("Matrix must be two dimensional (size: "+a.format(r)+")")}}}},function(e,t,r){e.exports=function(e,t){var n=r(144),i=e.type.BigNumber,a=r(9),o=r(13),s=n.array,u=Array.isArray;e.zeros=function(e){var r=o.argsToArray(arguments),n=e instanceof a?!0:u(e)?!1:"matrix"===t.matrix;if(0==r.length)return n?new a:[];var l=!1;r=r.map(function(e){return e instanceof i?(l=!0,e.toNumber()):e});var c=[],h=l?new i(0):0;return c=s.resize(c,r,h),n?new a(c):c}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(13),a=t.number.isNumber,o=t["boolean"].isBoolean,s=t.number.isInteger,u=i.isCollection;e.factorial=function c(t){var r,h;if(1!=arguments.length)throw new e.error.ArgumentsError("factorial",arguments.length,1);if(a(t)){if(!s(t)||0>t)throw new TypeError("Positive integer value expected in function factorial");for(r=t-1,h=t;r>1;)h*=r,r--;return 0==h&&(h=1),h}if(t instanceof n){if(!l(t))throw new TypeError("Positive integer value expected in function factorial");var f=new n(1);for(r=t.minus(f),h=t;r.gt(f);)h=h.times(r),r=r.minus(f);return h.equals(0)&&(h=f),h}if(o(t)||null===t)return 1;if(u(t))return i.deepMap(t,c);throw new e.error.UnsupportedTypeError("factorial",e["typeof"](t))};var l=function(e){return e.isInteger()&&e.gte(0)}}},function(e,t,r){e.exports=function(e){var t=r(178)(e);e.random=t("uniform").random}},function(e,t,r){e.exports=function(e){var t=r(178)(e);e.randomInt=t("uniform").randomInt}},function(e,t,r){e.exports=function(e){var t=r(178)(e);e.pickRandom=t("uniform").pickRandom}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=t.number.isNumber,a=t.number.isInteger;e.permutations=function(t,r){var s,u,l=arguments.length;if(l>2)throw new e.error.ArgumentsError("permutations",arguments.length,2);if(i(t)){if(!a(t)||0>t)throw new TypeError("Positive integer value expected in function permutations");if(1==l)return e.factorial(t);if(2==l&&i(r)){if(!a(r)||0>r)throw new TypeError("Positive integer value expected in function permutations");if(r>t)throw new TypeError("second argument k must be less than or equal to first argument n");for(s=1,u=t-r+1;t>=u;u++)s*=u;return s}}if(t instanceof n){if(void 0===r&&o(t))return e.factorial(t);if(r=n.convert(r),!(r instanceof n&&o(t)&&o(r)))throw new TypeError("Positive integer value expected in function permutations");if(r.gt(t))throw new TypeError("second argument k must be less than or equal to first argument n");for(s=new n(1),u=t.minus(r).plus(1);u.lte(t);u=u.plus(1))s=s.times(u);return s}throw new e.error.UnsupportedTypeError("permutations",e["typeof"](t))};var o=function(e){return e.isInteger()&&e.gte(0)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=(r(13),t.number.isNumber),a=t.number.isInteger;e.combinations=function(t,r){var s,u,l,c,h=arguments.length;if(2!=h)throw new e.error.ArgumentsError("combinations",arguments.length,2);if(i(t)){if(!a(t)||0>t)throw new TypeError("Positive integer value enpected in function combinations");if(r>t)throw new TypeError("k must be less than or equal to n");for(s=Math.max(r,t-r),u=1,l=1;t-s>=l;l++)u=u*(s+l)/l;return u}if(t instanceof n){if(r=n.convert(r),!(r instanceof n&&o(t)&&o(r)))throw new TypeError("Positive integer value expected in function combinations");if(r.gt(t))throw new TypeError("k must be less than n in function combinations");for(s=t.minus(r),r.lt(s)&&(s=r),u=new n(1),l=new n(1),c=t.minus(s);l.lte(c);l=l.plus(1))u=u.times(s.plus(l)).dividedBy(l);return u}throw new e.error.UnsupportedTypeError("combinations",e["typeof"](t))};var o=function(e){return e.isInteger()&&e.gte(0)}}},function(e,t,r){e.exports=function(e){function t(t,r){return e.smaller(t,r)?t:r}function n(t){var r=void 0;if(i.deepForEach(t,function(t){(void 0===r||e.smaller(t,r))&&(r=t)}),void 0===r)throw new Error("Cannot calculate min of an empty array");return r}var i=(r(9),r(13)),a=i.isCollection;e.min=function(e){if(0==arguments.length)throw new SyntaxError("Function min requires one or more parameters (0 provided)");if(a(e)){if(1==arguments.length)return n(e);if(2==arguments.length)return i.reduce(arguments[0],arguments[1],t);throw new SyntaxError("Wrong number of parameters")}return n(arguments)}}},function(e,t,r){e.exports=function(e){function t(t,r){return e.larger(t,r)?t:r}function n(t){var r=void 0;if(i.deepForEach(t,function(t){(void 0===r||e.larger(t,r))&&(r=t)}),void 0===r)throw new Error("Cannot calculate max of an empty array");return r}var i=(r(9),r(13)),a=i.isCollection;e.max=function(e){if(0==arguments.length)throw new SyntaxError("Function max requires one or more parameters (0 provided)");if(a(e)){if(1==arguments.length)return n(e);if(2==arguments.length)return i.reduce(arguments[0],arguments[1],t);throw new SyntaxError("Wrong number of parameters")}return n(arguments)}}},function(e,t,r){e.exports=function(e){function t(t,r){var n=i.reduce(t,r,e.add),a=s(t)?o(t):t.size();return e.divide(n,a[r])}function n(t){var r=0,n=0;if(i.deepForEach(t,function(t){r=e.add(r,t),n++}),0===n)throw new Error("Cannot calculate mean of an empty array");return e.divide(r,n)}var i=(r(9),r(13)),a=i.isCollection,o=r(137).size,s=Array.isArray;e.mean=function(e){if(0==arguments.length)throw new SyntaxError("Function mean requires one or more parameters (0 provided)");if(a(e)){if(1==arguments.length)return n(e);if(2==arguments.length)return t(arguments[0],arguments[1]);throw new SyntaxError("Wrong number of parameters")}return n(arguments)}}},function(e,t,r){e.exports=function(e){function t(t){var r=u(t);r.sort(e.compare);var a=r.length;if(0==a)throw new Error("Cannot calculate median of an empty array");if(a%2==0){var s=r[a/2-1],l=r[a/2];if(!(o(s)||s instanceof i||s instanceof n))throw new e.error.UnsupportedTypeError("median",e["typeof"](s));if(!(o(l)||l instanceof i||l instanceof n))throw new e.error.UnsupportedTypeError("median",e["typeof"](l));return e.divide(e.add(s,l),2)}var c=r[(a-1)/2];if(!(o(c)||c instanceof i||c instanceof n))throw new e.error.UnsupportedTypeError("median",e["typeof"](c));return c}var n=(r(9),r(10)),i=e.type.BigNumber,a=r(13),o=r(4).isNumber,s=a.isCollection,u=r(137).flatten;e.median=function(e){if(0==arguments.length)throw new SyntaxError("Function median requires one or more parameters (0 provided)");if(s(e)){if(1==arguments.length)return t(e.valueOf());throw 2==arguments.length?new Error("median(A, dim) is not yet supported"):new SyntaxError("Wrong number of parameters")}return t(Array.prototype.slice.call(arguments))}}},function(e,t,r){e.exports=function(e){function t(t){var r=void 0;if(n.deepForEach(t,function(t){r=void 0===r?t:e.multiply(r,t)}),void 0===r)throw new Error("Cannot calculate prod of an empty array");return r}var n=(r(9),r(13)),i=n.isCollection;e.prod=function(e){if(0==arguments.length)throw new SyntaxError("Function prod requires one or more parameters (0 provided)");if(i(e)){if(1==arguments.length)return t(e);throw 2==arguments.length?new Error("prod(A, dim) is not yet supported"):new SyntaxError("Wrong number of parameters")}return t(arguments)}}},function(e){e.exports=function(e){e.std=function(){if(0==arguments.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");var t=e["var"].apply(null,arguments);return e.sqrt(t)}}},function(e,t,r){e.exports=function(e){function t(t){var r=void 0;if(n.deepForEach(t,function(t){r=void 0===r?t:e.add(r,t)}),void 0===r)throw new Error("Cannot calculate sum of an empty array");return r}var n=(r(9),r(13)),i=n.isCollection;e.sum=function(e){if(0==arguments.length)throw new SyntaxError("Function sum requires one or more parameters (0 provided)");if(i(e)){if(1==arguments.length)return t(e);throw 2==arguments.length?new Error("sum(A, dim) is not yet supported"):new SyntaxError("Wrong number of parameters")}return t(arguments)}}},function(e,t,r){e.exports=function(e){function t(t,r){var a=0,o=0;if(i.deepForEach(t,function(t){a=e.add(a,t),o++}),0===o)throw new Error("Cannot calculate var of an empty array");var s=e.divide(a,o);switch(a=0,i.deepForEach(t,function(t){var r=e.subtract(t,s);a=e.add(a,e.multiply(r,r))}),r){case"uncorrected":return e.divide(a,o);case"biased":return e.divide(a,o+1);case"unbiased":var u=a instanceof n?new n(0):0;return 1==o?u:e.divide(a,o-1);default:throw new Error('Unknown normalization "'+r+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}var n=(r(9),e.type.BigNumber),i=r(13),a=i.isCollection,o=r(160).isString,s="unbiased";e["var"]=function(e,r){if(0==arguments.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(a(e)){if(1==arguments.length)return t(e,s);if(2==arguments.length){if(!o(r))throw new Error("String expected for parameter normalization");return t(e,r)}throw new SyntaxError("Wrong number of parameters")}return t(arguments,s)}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.acos=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("acos",arguments.length,1);if(o(t))return t>=-1&&1>=t?Math.acos(t):c(new i(t,0));if(u(t)){var r=new i(t.im*t.im-t.re*t.re+1,-2*t.re*t.im),h=e.sqrt(r),f=new i(h.re-t.im,h.im+t.re),p=e.log(f);return new i(1.5707963267948966-p.im,p.re)}if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.acos(t);if(t instanceof n)return c(t.toNumber());throw new e.error.UnsupportedTypeError("acos",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.asin=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("asin",arguments.length,1);if(o(t))return t>=-1&&1>=t?Math.asin(t):c(new i(t,0));if(u(t)){var r=t.re,h=t.im,f=new i(h*h-r*r+1,-2*r*h),p=e.sqrt(f),d=new i(p.re-h,p.im+r),m=e.log(d);return new i(m.im,-m.re)}if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.asin(t);if(t instanceof n)return c(t.toNumber());throw new e.error.UnsupportedTypeError("asin",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=i.isComplex,l=a.isCollection;e.atan=function c(t){if(1!=arguments.length)throw new e.error.ArgumentsError("atan",arguments.length,1);if(o(t))return Math.atan(t);if(u(t)){var r=t.re,h=t.im,f=r*r+(1-h)*(1-h),p=new i((1-h*h-r*r)/f,-2*r/f),d=e.log(p);return new i(-.5*d.im,.5*d.re)}if(l(t))return a.deepMap(t,c);if(s(t)||null===t)return Math.atan(t);if(t instanceof n)return c(t.toNumber());throw new e.error.UnsupportedTypeError("atan",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(13),o=t.number.isNumber,s=t["boolean"].isBoolean,u=(i.isComplex,a.isCollection);e.atan2=function l(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("atan2",arguments.length,2);if(o(t)&&o(r))return Math.atan2(t,r);if(u(t)||u(r))return a.deepMap2(t,r,l);if(s(t)||null===t)return l(+t,r);if(s(r)||null===r)return l(t,+r);if(t instanceof n)return l(t.toNumber(),r);if(r instanceof n)return l(t,r.toNumber());throw new e.error.UnsupportedTypeError("atan2",e["typeof"](t),e["typeof"](r))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.cos=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("cos",arguments.length,1);if(s(t))return Math.cos(t);if(l(t))return new i(.5*Math.cos(t.re)*(Math.exp(-t.im)+Math.exp(t.im)),.5*Math.sin(t.re)*(Math.exp(-t.im)-Math.exp(t.im)));if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.cos(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return Math.cos(t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("cos",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.cosh=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("cosh",arguments.length,1);if(s(t))return(Math.exp(t)+Math.exp(-t))/2;if(l(t)){var r=Math.exp(t.re),p=Math.exp(-t.re);return new i(Math.cos(t.im)*(r+p)/2,Math.sin(t.im)*(r-p)/2)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return f(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(t?1:0);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("cosh",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.cot=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("cot",arguments.length,1);if(s(t))return 1/Math.tan(t);if(l(t)){var r=Math.exp(-4*t.im)-2*Math.exp(-2*t.im)*Math.cos(2*t.re)+1;return new i(2*Math.exp(-2*t.im)*Math.sin(2*t.re)/r,(Math.exp(-4*t.im)-1)/r)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return 1/Math.tan(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(+t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("cot",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.coth=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("coth",arguments.length,1);if(s(t)){var r=Math.exp(2*t);return(r+1)/(r-1)}if(l(t)){var p=Math.exp(2*t.re),d=p*Math.cos(2*t.im),m=p*Math.sin(2*t.im),g=(d-1)*(d-1)+m*m;return new i(((d+1)*(d-1)+m*m)/g,-2*m/g)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return f(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(t?1:0);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("coth",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.csc=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("csc",arguments.length,1);if(s(t))return 1/Math.sin(t);if(l(t)){var r=.25*(Math.exp(-2*t.im)+Math.exp(2*t.im))-.5*Math.cos(2*t.re);return new i(.5*Math.sin(t.re)*(Math.exp(-t.im)+Math.exp(t.im))/r,.5*Math.cos(t.re)*(Math.exp(-t.im)-Math.exp(t.im))/r)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return 1/Math.sin(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(+t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("csc",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number,u=t.number.isNumber,l=t["boolean"].isBoolean,c=i.isComplex,h=a.isUnit,f=o.isCollection;e.csch=function p(t){if(1!=arguments.length)throw new e.error.ArgumentsError("csch",arguments.length,1);if(u(t))return 0==t?Number.NaN:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*s.sign(t);if(c(t)){var r=Math.exp(t.re),d=Math.exp(-t.re),m=Math.cos(t.im)*(r-d),g=Math.sin(t.im)*(r+d),v=m*m+g*g;return new i(2*m/v,-2*g/v)}if(h(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return p(t.value)}if(f(t))return o.deepMap(t,p);if(l(t)||null===t)return p(t?1:0);if(t instanceof n)return p(t.toNumber());throw new e.error.UnsupportedTypeError("csch",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.sec=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sec",arguments.length,1);if(s(t))return 1/Math.cos(t);if(l(t)){var r=.25*(Math.exp(-2*t.im)+Math.exp(2*t.im))+.5*Math.cos(2*t.re);return new i(.5*Math.cos(t.re)*(Math.exp(-t.im)+Math.exp(t.im))/r,.5*Math.sin(t.re)*(Math.exp(t.im)-Math.exp(-t.im))/r)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return 1/Math.cos(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(+t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("sec",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.sech=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sech",arguments.length,1);if(s(t))return 2/(Math.exp(t)+Math.exp(-t));if(l(t)){var r=Math.exp(t.re),p=Math.exp(-t.re),d=Math.cos(t.im)*(r+p),m=Math.sin(t.im)*(r-p),g=d*d+m*m;return new i(2*d/g,-2*m/g)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return f(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(t?1:0);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("sech",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.sin=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sin",arguments.length,1);if(s(t))return Math.sin(t);if(l(t))return new i(.5*Math.sin(t.re)*(Math.exp(-t.im)+Math.exp(t.im)),.5*Math.cos(t.re)*(Math.exp(t.im)-Math.exp(-t.im)));if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return Math.sin(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return Math.sin(t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("sin",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.sinh=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("sinh",arguments.length,1);if(s(t))return(Math.exp(t)-Math.exp(-t))/2;if(l(t)){var r=Math.cos(t.im),p=Math.sin(t.im),d=Math.exp(t.re),m=Math.exp(-t.re);return new i(r*(d-m)/2,p*(d+m)/2)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return f(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(t?1:0);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("sinh",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.tan=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("tan",arguments.length,1);if(s(t))return Math.tan(t);if(l(t)){var r=Math.exp(-4*t.im)+2*Math.exp(-2*t.im)*Math.cos(2*t.re)+1;return new i(2*Math.exp(-2*t.im)*Math.sin(2*t.re)/r,(1-Math.exp(-4*t.im))/r)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return Math.tan(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return Math.tan(t);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("tan",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=e.type.BigNumber,i=r(6),a=r(10),o=r(13),s=t.number.isNumber,u=t["boolean"].isBoolean,l=i.isComplex,c=a.isUnit,h=o.isCollection;e.tanh=function f(t){if(1!=arguments.length)throw new e.error.ArgumentsError("tanh",arguments.length,1);if(s(t)){var r=Math.exp(2*t);return(r-1)/(r+1)}if(l(t)){var p=Math.exp(2*t.re),d=p*Math.cos(2*t.im),m=p*Math.sin(2*t.im),g=(d+1)*(d+1)+m*m;return new i(((d-1)*(d+1)+m*m)/g,2*m/g)}if(c(t)){if(!t.hasBase(a.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return f(t.value)}if(h(t))return o.deepMap(t,f);if(u(t)||null===t)return f(t?1:0);if(t instanceof n)return f(t.toNumber());throw new e.error.UnsupportedTypeError("tanh",e["typeof"](t))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=r(10),i=r(13),a=t.string.isString,o=n.isUnit,s=i.isCollection;e.to=function u(t,r){if(2!=arguments.length)throw new e.error.ArgumentsError("to",arguments.length,2);if(o(t)&&(o(r)||a(r)))return t.to(r);if(s(t)||s(r))return i.deepMap2(t,r,u);throw new e.error.UnsupportedTypeError("to",e["typeof"](t),e["typeof"](r))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=t.object;e.clone=function(t){if(1!=arguments.length)throw new e.error.ArgumentsError("clone",arguments.length,1);return n.clone(t)}}},function(e,t,r){e.exports=function(e){function t(e,t){if("function"==typeof t)return e.filter(function(e){return t(e)});if(t instanceof RegExp)return e.filter(function(e){return t.test(e)});throw new TypeError("Function or RegExp expected")}var n=r(9);e.filter=function(r,i){if(2!==arguments.length)throw new e.error.ArgumentsError("filter",arguments.length,2);if(r instanceof n){var a=r.size();if(a.length>1)throw new Error("Only one dimensional matrices supported");return new n(t(r.toArray(),i))}if(Array.isArray(r))return t(r,i);throw new e.error.UnsupportedTypeError("filter",e["typeof"](r),e["typeof"](compare))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=t.string;e.format=function(t,r){var i=arguments.length;if(1!==i&&2!==i)throw new e.error.ArgumentsError("format",i,1,2);return n.format(t,r)}}},function(e,t,r){e.exports=function(e){function t(t,r,n){(n.override||void 0===e[t])&&(e[t]=n.wrap&&"function"==typeof r?function(){for(var t=[],n=0,i=arguments.length;i>n;n++){var a=arguments[n];t[n]=a&&a.valueOf()}return r.apply(e,t)}:r,e.chaining.Selector.createProxy(t,r))}function n(e){return"function"==typeof e||s(e)||u(e)||l(e)||c(e)}var i=r(144),a=r(6),o=r(10),s=i.number.isNumber,u=i.string.isString,l=a.isComplex,c=o.isUnit;e["import"]=function h(i,a){var o=arguments.length;if(1!=o&&2!=o)throw new e.error.ArgumentsError("import",o,1,2);var s,l={override:a&&a.override||!1,wrap:a&&a.wrap||!1};if(u(i)){var c=r(179)(i);h(c,a)}else{if("object"!=typeof i)throw new TypeError("Object or module name expected");for(s in i)if(i.hasOwnProperty(s)){var f=i[s];n(f)?t(s,f,l):h(f,a)}}}}},function(e,t,r){e.exports=function(e){function t(e,t){var r=[],n=function(i,a){return Array.isArray(i)?i.map(function(e,t){return r[a]=t,n(e,a+1)}):t(i,r,e)};return n(e,0)}var n=r(9).isMatrix;e.map=function(r,i){if(2!=arguments.length)throw new e.error.ArgumentsError("map",arguments.length,2);if(Array.isArray(r))return t(r,i);if(n(r))return r.map(i);throw new e.error.UnsupportedTypeError("map",e["typeof"](r))}}},function(e,t,r){e.exports=function(e){var t=r(144),n=t.string.isString;e.print=function(t,r,i){var a=arguments.length;if(2!=a&&3!=a)throw new e.error.ArgumentsError("print",a,2,3);if(!n(t))throw new TypeError("String expected as first parameter in function format");if(!(r instanceof Object))throw new TypeError("Object expected as second parameter in function format");return t.replace(/\$([\w\.]+)/g,function(t,a){for(var o=a.split("."),s=r[o.shift()];o.length&&void 0!==s;){var u=o.shift();s=u?s[u]:s+"."}return void 0!==s?n(s)?s:e.format(s,i):t})}}},function(e,t,r){e.exports=function(e){var t=r(9);e.sort=function(r,n){var i=null;if(1===arguments.length)i=e.compare;else{if(2!==arguments.length)throw new e.error.ArgumentsError("sort",arguments.length,1,2);if("function"==typeof n)i=n;else if("asc"===n)i=e.compare;else{if("desc"!==n)throw new e.error.UnsupportedTypeError("sort",e["typeof"](r),e["typeof"](n));i=function(t,r){return-e.compare(t,r)}}}if(r instanceof t){var a=r.size();if(a.length>1)throw new Error("Only one dimensional matrices supported");return new t(r.toArray().sort(i))}if(Array.isArray(r))return r.sort(i);throw new e.error.UnsupportedTypeError("sort",e["typeof"](r),e["typeof"](n))}}},function(e,t,r){e.exports=function(e){var t=r(180),n=r(6),i=r(9),a=r(10),o=r(8),s=r(7),u=r(11);e["typeof"]=function(r){if(1!=arguments.length)throw new e.error.ArgumentsError("typeof",arguments.length,1);var l=t.type(r);if("object"===l){if(r instanceof n)return"complex";if(r instanceof i)return"matrix";if(r instanceof a)return"unit";if(r instanceof o)return"index";if(r instanceof s)return"range";if(r instanceof u)return"help";if(r instanceof e.type.BigNumber)return"bignumber";if(r instanceof e.chaining.Selector)return"selector"}return l}}},function(e,t,r){e.exports=function(e){function t(e,t){var r=[],n=function(i,a){Array.isArray(i)?i.forEach(function(e,t){r[a]=t,n(e,a+1)}):t(i,r,e)};n(e,0)}var n=r(9).isMatrix;e.forEach=function(r,i){if(2!=arguments.length)throw new e.error.ArgumentsError("forEach",arguments.length,2);if(Array.isArray(r))return t(r,i);if(n(r))return r.forEach(i);throw new e.error.UnsupportedTypeError("forEach",e["typeof"](r))}}},function(e,t,r){{var n=r(139),i=r(4).isNumber;r(4).digits}t.isBigNumber=function(e){return e instanceof n},t.format=function(e,r){if("function"==typeof r)return r(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var n="auto",a=void 0;switch(void 0!==r&&(r.notation&&(n=r.notation),i(r)?a=r:r.precision&&(a=r.precision)),n){case"fixed":return t.toFixed(e,a);case"exponential":return t.toExponential(e,a);case"auto":var o=.001,s=1e5;r&&r.exponential&&(void 0!==r.exponential.lower&&(o=r.exponential.lower),void 0!==r.exponential.upper&&(s=r.exponential.upper));{({toExpNeg:e.constructor.toExpNeg,toExpPos:e.constructor.toExpPos})}if(e.constructor.config({toExpNeg:Math.round(Math.log(o)/Math.LN10),toExpPos:Math.round(Math.log(s)/Math.LN10)}),e.isZero())return"0";var u,l=e.abs();return u=l.gte(o)&&l.lt(s)?e.toSignificantDigits(a).toFixed():t.toExponential(e,a),u.replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", or "fixed".')}},t.toExponential=function(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()},t.toFixed=function(e,t){return e.toFixed(t||0)}},function(e,t,r){function n(e){for(var t=[];p(e);)t.push(e.length),e=e[0];return t}function i(e,t,r){var n,a=e.length;if(a!=t[r])throw new h(a,t[r]);if(r<t.length-1){var o=r+1;for(n=0;a>n;n++){var s=e[n];if(!p(s))throw new h(t.length-1,t.length,"<");i(e[n],t,o)}}else for(n=0;a>n;n++)if(p(e[n]))throw new h(t.length+1,t.length,">")}function a(e,r,n,i){var o,s,u=e.length,l=r[n],h=Math.min(u,l);if(e.length=l,n<r.length-1){var f=n+1;for(o=0;h>o;o++)s=e[o],p(s)||(s=[s],e[o]=s),a(s,r,f,i);for(o=h;l>o;o++)s=[],e[o]=s,a(s,r,f,i)}else{for(o=0;h>o;o++)for(;p(e[o]);)e[o]=e[o][0];if(i!==t.UNINITIALIZED)for(o=h;l>o;o++)e[o]=c.clone(i)}}function o(e,t,r){var n,i;if(t>r){var a=r+1;for(n=0,i=e.length;i>n;n++)e[n]=o(e[n],t,a)}else for(;p(e);)e=e[0];return e}function s(e,t,r){var n,i;if(p(e)){var a=r+1;
for(n=0,i=e.length;i>n;n++)e[n]=s(e[n],t,a)}else for(var o=r;t>o;o++)e=[e];return e}var u=r(4),l=r(160),c=r(3),h=(r(180),r(141)),f=r(142),p=Array.isArray;t.size=function(e){var r=n(e);return t.validate(e,r),r},t.validate=function(e,t){var r=0==t.length;if(r){if(p(e))throw new h(e.length,0)}else i(e,t,0)},t.validateIndex=function(e,t){if(!u.isNumber(e)||!u.isInteger(e))throw new TypeError("Index must be an integer (value: "+e+")");if(0>e)throw new f(e);if(void 0!==t&&e>=t)throw new f(e,t)},t.UNINITIALIZED={},t.resize=function(e,t,r){if(!p(e)||!p(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");t.forEach(function(e){if(!u.isNumber(e)||!u.isInteger(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(t)+")")});var n=void 0!==r?r:0;return a(e,t,0,n),e},t.squeeze=function(e,r){for(var n=r||t.size(e);p(e)&&1===e.length;)e=e[0],n.shift();for(var i=n.length;1===n[i-1];)i--;return i<n.length&&(e=o(e,i,0),n.length=i),e},t.unsqueeze=function(e,r,n,i){var a=i||t.size(e);if(n)for(var o=0;n>o;o++)e=[e],a.unshift(1);for(e=s(e,r,0);a.length<r;)a.push(1);return e},t.flatten=function(e){for(var t=e,r=Array.isArray;r(t[0]);){for(var n=[],i=0,a=t.length;a>i;i++)n=n.concat.apply(n,t[i]);t=n}return t},t.argsToArray=function(e){for(var t=[],r=0,n=e.length;n>r;r++)t[r]=e[r];return t},t.isArray=p},function(e){e.exports="1.0.1"},function(e,t,r){var n;!function(i){function a(e){for(var t,r,n=1,i=e.length,a=e[0]+"";i>n;n++){for(t=e[n]+"",r=S-t.length;r--;)t="0"+t;a+=t}for(i=a.length;"0"==a.charAt(--i););return a.slice(0,i+1||1)}function o(e,t,r,n){var i,a,o,s,u;for(a=1,o=e[0];o>=10;o/=10,a++);return o=t-a,0>o?(o+=S,i=0):(i=Math.ceil((o+1)/S),o%=S),a=_(10,S-o),u=e[i]%a|0,null==n?3>o?(0==o?u=u/100|0:1==o&&(u=u/10|0),s=4>r&&99999==u||r>3&&49999==u||5e4==u||0==u):s=(4>r&&u+1==a||r>3&&u+1==a/2)&&(e[i+1]/a/100|0)==_(10,o-2)-1||(u==a/2||0==u)&&0==(e[i+1]/a/100|0):4>o?(0==o?u=u/1e3|0:1==o?u=u/100|0:2==o&&(u=u/10|0),s=(n||4>r)&&9999==u||!n&&r>3&&4999==u):s=((n||4>r)&&u+1==a||!n&&r>3&&u+1==a/2)&&(e[i+1]/a/1e3|0)==_(10,o-3)-1,s}function s(e,t,r){var n=e.constructor;return null==t||((y=0>t||t>8)||0!==t&&(n.errors?parseInt:parseFloat)(t)!=t)&&!f(n,"rounding mode",t,r,0)?n.rounding:0|t}function u(e,t,r,n){var i=e.constructor;return!(y=(n||0)>t||t>=R+1)&&(0===t||(i.errors?parseInt:parseFloat)(t)==t)||f(i,"argument",t,r,0)}function l(e,t){var r,n,i,s,u,l,c,h=0,f=0,p=0,d=e.constructor,g=d.ONE,v=d.rounding,y=d.precision;if(!e.c||!e.c[0]||e.e>17)return new d(e.c?e.c[0]?e.s<0?0:1/0:g:e.s?e.s<0?0:e:0/0);for(null==t?(b=!1,u=y):u=t,c=new d(.03125);e.e>-2;)e=e.times(c),p+=5;for(n=Math.log(_(2,p))/Math.LN10*2+5|0,u+=n,r=s=l=new d(g),d.precision=u;;){if(s=m(s.times(e),u,1),r=r.times(++f),c=l.plus(P(s,r,u,1)),a(c.c).slice(0,u)===a(l.c).slice(0,u)){for(i=p;i--;)l=m(l.times(l),u,1);if(null!=t)return d.precision=y,l;if(!(3>h&&o(l.c,u-n,v,h)))return m(l,d.precision=y,v,b=!0);d.precision=u+=10,r=s=c=new d(g),f=0,h++}l=c}}function c(e,t,r,n){var i,o,s=e.constructor,u=(e=new s(e)).e;if(null==t?r=0:(m(e,++t,r),r=n?t:t+e.e-u),u=e.e,i=a(e.c),1==n||2==n&&(u>=t||u<=s.toExpNeg)){for(;i.length<r;i+="0");i.length>1&&(i=i.charAt(0)+"."+i.slice(1)),i+=(0>u?"e":"e+")+u}else{if(n=i.length,0>u){for(o=r-n;++u;i="0"+i);i="0."+i}else if(++u>n){for(o=r-u,u-=n;u--;i+="0");o>0&&(i+=".")}else o=r-n,n>u?i=i.slice(0,u)+"."+i.slice(u):o>0&&(i+=".");if(o>0)for(;o--;i+="0");}return e.s<0&&e.c[0]?"-"+i:i}function h(e){var t=e.length-1,r=t*S+1;if(t=e[t]){for(;t%10==0;t/=10,r--);for(t=e[0];t>=10;t/=10,r++);}return r}function f(e,t,r,n,i){if(e.errors){var a=new Error((n||["new Decimal","cmp","div","eq","gt","gte","lt","lte","minus","mod","plus","times","toFraction","pow","random","log","sqrt","toNearest","divToInt"][w?0>w?-w:w:0>1/w?1:0])+"() "+(["number type has more than 15 significant digits","LN10 out of digits"][t]||t+([y?" out of range":" not an integer"," not a boolean or binary digit"][i]||""))+": "+r);throw a.name="Decimal Error",y=w=0,a}}function p(e,t,r){var n=new e(e.ONE);for(b=!1;1&r&&(n=n.times(t)),r>>=1,r;)t=t.times(t);return b=!0,n}function d(e,t){var r,n,i,s,u,l,c,h,p,g,v,y=1,x=10,w=e,M=w.c,_=w.constructor,T=_.ONE,E=_.rounding,S=_.precision;if(w.s<0||!M||!M[0]||!w.e&&1==M[0]&&1==M.length)return new _(M&&!M[0]?-1/0:1!=w.s?0/0:M?0:w);if(null==t?(b=!1,c=S):c=t,_.precision=c+=x,r=a(M),n=r.charAt(0),!(Math.abs(s=w.e)<15e14))return w=new _(n+"."+r.slice(1)),c+2>D.length&&f(_,1,c+2,"ln"),w=d(w,c-x).plus(new _(D.slice(0,c+2)).times(s+"")),_.precision=S,null==t?m(w,S,E,b=!0):w;for(;7>n&&1!=n||1==n&&r.charAt(1)>3;)w=w.times(e),r=a(w.c),n=r.charAt(0),y++;for(s=w.e,n>1?(w=new _("0."+r),s++):w=new _(n+"."+r.slice(1)),g=w,h=u=w=P(w.minus(T),w.plus(T),c,1),v=m(w.times(w),c,1),i=3;;){if(u=m(u.times(v),c,1),p=h.plus(P(u,new _(i),c,1)),a(p.c).slice(0,c)===a(h.c).slice(0,c)){if(h=h.times(2),0!==s&&(c+2>D.length&&f(_,1,c+2,"ln"),h=h.plus(new _(D.slice(0,c+2)).times(s+""))),h=P(h,new _(y),c,1),null!=t)return _.precision=S,h;if(!o(h.c,c-x,E,l))return m(h,_.precision=S,E,b=!0);_.precision=c+=x,p=u=w=P(g.minus(T),g.plus(T),c,1),v=m(w.times(w),c,1),i=l=1}h=p,i+=2}}function m(e,t,r,n){var i,a,o,s,u,l,c,h,f=e.constructor;e:if(t!=a){if(!(c=e.c))return e;for(i=1,s=c[0];s>=10;s/=10,i++);if(a=t-i,0>a)a+=S,o=t,u=c[h=0],l=u/_(10,i-o-1)%10|0;else if(h=Math.ceil((a+1)/S),h>=c.length){if(!n)break e;for(;c.length<=h;c.push(0));u=l=0,i=1,a%=S,o=a-S+1}else{for(u=s=c[h],i=1;s>=10;s/=10,i++);a%=S,o=a-S+i,l=0>o?0:M(u/_(10,i-o-1)%10)}if(n=n||0>t||null!=c[h+1]||(0>o?u:u%_(10,i-o-1)),n=4>r?(l||n)&&(0==r||r==(e.s<0?3:2)):l>5||5==l&&(4==r||n||6==r&&(a>0?o>0?u/_(10,i-o):0:c[h-1])%10&1||r==(e.s<0?8:7)),1>t||!c[0])return c.length=0,n?(t-=e.e+1,c[0]=_(10,t%S),e.e=-t||0):c[0]=e.e=0,e;if(0==a?(c.length=h,s=1,h--):(c.length=h+1,s=_(10,S-a),c[h]=o>0?(u/_(10,i-o)%_(10,o)|0)*s:0),n)for(;;){if(0==h){for(a=1,o=c[0];o>=10;o/=10,a++);for(o=c[0]+=s,s=1;o>=10;o/=10,s++);a!=s&&(e.e++,c[0]==E&&(c[0]=1));break}if(c[h]+=s,c[h]!=E)break;c[h--]=0,s=1}for(a=c.length;0===c[--a];c.pop());}return b&&(e.e>f.maxE?e.c=e.e=null:e.e<f.minE&&(e.c=[e.e=0])),e}var g,v,y,x=i.crypto,b=!0,w=0,M=Math.floor,_=Math.pow,T=Object.prototype.toString,E=1e7,S=7,C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",A={},N=9e15,R=1e9,L=3e3,D="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058";A.absoluteValue=A.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),m(e)},A.ceil=function(){return m(new this.constructor(this),this.e+1,2)},A.comparedTo=A.cmp=function(e,t){var r,n=this,i=n.c,a=(w=-w,e=new n.constructor(e,t),e.c),o=n.s,s=e.s,u=n.e,l=e.e;if(!o||!s)return null;if(r=i&&!i[0],t=a&&!a[0],r||t)return r?t?0:-s:o;if(o!=s)return o;if(r=0>o,!i||!a)return u==l?0:!i^r?1:-1;if(u!=l)return u>l^r?1:-1;for(o=-1,s=(u=i.length)<(l=a.length)?u:l;++o<s;)if(i[o]!=a[o])return i[o]>a[o]^r?1:-1;return u==l?0:u>l^r?1:-1},A.decimalPlaces=A.dp=function(){var e,t,r=null;if(e=this.c){if(r=((t=e.length-1)-M(this.e/S))*S,t=e[t])for(;t%10==0;t/=10,r--);0>r&&(r=0)}return r},A.dividedBy=A.div=function(e,t){return w=2,P(this,new this.constructor(e,t))},A.dividedToIntegerBy=A.divToInt=function(e,t){var r=this,n=r.constructor;return w=18,m(P(r,new n(e,t),0,1,1),n.precision,n.rounding)},A.equals=A.eq=function(e,t){return w=3,0===this.cmp(e,t)},A.exponential=A.exp=function(){return l(this)},A.floor=function(){return m(new this.constructor(this),this.e+1,3)},A.greaterThan=A.gt=function(e,t){return w=4,this.cmp(e,t)>0},A.greaterThanOrEqualTo=A.gte=function(e,t){return w=5,t=this.cmp(e,t),1==t||0===t},A.isFinite=function(){return!!this.c},A.isInteger=A.isInt=function(){return!!this.c&&M(this.e/S)>this.c.length-2},A.isNaN=function(){return!this.s},A.isNegative=A.isNeg=function(){return this.s<0},A.isZero=function(){return!!this.c&&0==this.c[0]},A.lessThan=A.lt=function(e,t){return w=6,this.cmp(e,t)<0},A.lessThanOrEqualTo=A.lte=function(e,t){return w=7,t=this.cmp(e,t),-1==t||0===t},A.logarithm=A.log=function(e,t){var r,n,i,s,u,l,c,h,p,g=this,v=g.constructor,y=v.precision,x=v.rounding,M=5;if(null==e)e=new v(10),r=!0;else{if(w=15,e=new v(e,t),n=e.c,e.s<0||!n||!n[0]||!e.e&&1==n[0]&&1==n.length)return new v(0/0);r=e.eq(10)}if(n=g.c,g.s<0||!n||!n[0]||!g.e&&1==n[0]&&1==n.length)return new v(n&&!n[0]?-1/0:1!=g.s?0/0:n?0:1/0);if(u=r&&(s=n[0],n.length>1||1!=s&&10!=s&&100!=s&&1e3!=s&&1e4!=s&&1e5!=s&&1e6!=s),b=!1,c=y+M,h=c+10,l=d(g,c),r?(h>D.length&&f(v,1,h,"log"),i=new v(D.slice(0,h))):i=d(e,c),p=P(l,i,c,1),o(p.c,s=y,x))do if(c+=10,l=d(g,c),r?(h=c+10,h>D.length&&f(v,1,h,"log"),i=new v(D.slice(0,h))):i=d(e,c),p=P(l,i,c,1),!u){+a(p.c).slice(s+1,s+15)+1==1e14&&(p=m(p,y+1,0));break}while(o(p.c,s+=10,x));return b=!0,m(p,y,x)},A.minus=function(e,t){var r,n,i,a,o=this,s=o.constructor,u=o.s;if(w=8,e=new s(e,t),t=e.s,!u||!t)return new s(0/0);if(u!=t)return e.s=-t,o.plus(e);var l=o.c,c=e.c,h=M(e.e/S),f=M(o.e/S),p=s.precision,d=s.rounding;if(!f||!h){if(!l||!c)return l?(e.s=-t,e):new s(c?o:0/0);if(!l[0]||!c[0])return o=c[0]?(e.s=-t,e):new s(l[0]?o:3==d?-0:0),b?m(o,p,d):o}if(l=l.slice(),n=l.length,u=f-h){for((a=0>u)?(u=-u,r=l,n=c.length):(h=f,r=c),(f=Math.ceil(p/S))>n&&(n=f),u>(n+=2)&&(u=n,r.length=1),r.reverse(),t=u;t--;r.push(0));r.reverse()}else for((a=n<(i=c.length))&&(i=n),u=t=0;i>t;t++)if(l[t]!=c[t]){a=l[t]<c[t];break}if(a&&(r=l,l=c,c=r,e.s=-e.s),(t=-((i=l.length)-c.length))>0)for(;t--;l[i++]=0);for(f=E-1,t=c.length;t>u;){if(l[--t]<c[t]){for(n=t;n&&!l[--n];l[n]=f);--l[n],l[t]+=E}l[t]-=c[t]}for(;0==l[--i];l.pop());for(;0==l[0];l.shift(),--h);for(l[0]||(l=[h=0],e.s=3==d?-1:1),e.c=l,u=1,t=l[0];t>=10;t/=10,u++);return e.e=u+h*S-1,b?m(e,p,d):e},A.modulo=A.mod=function(e,t){var r,n,i=this,a=i.constructor,o=a.modulo;return w=9,e=new a(e,t),t=e.s,r=!i.c||!t||e.c&&!e.c[0],r||!e.c||i.c&&!i.c[0]?r?new a(0/0):m(new a(i),a.precision,a.rounding):(b=!1,9==o?(e.s=1,n=P(i,e,0,3,1),e.s=t,n.s*=t):n=P(i,e,0,o,1),n=n.times(e),b=!0,i.minus(n))},A.naturalLogarithm=A.ln=function(){return d(this)},A.negated=A.neg=function(){var e=new this.constructor(this);return e.s=-e.s||null,m(e)},A.plus=function(e,t){var r,n=this,i=n.constructor,a=n.s;if(w=10,e=new i(e,t),t=e.s,!a||!t)return new i(0/0);if(a!=t)return e.s=-t,n.minus(e);var o=n.c,s=e.c,u=M(e.e/S),l=M(n.e/S),c=i.precision,h=i.rounding;if(!l||!u){if(!o||!s)return new i(a/0);if(!o[0]||!s[0])return n=s[0]?e:new i(o[0]?n:0*a),b?m(n,c,h):n}if(o=o.slice(),a=l-u){for(0>a?(a=-a,r=o,t=s.length):(u=l,r=s,t=o.length),(l=Math.ceil(c/S))>t&&(t=l),a>++t&&(a=t,r.length=1),r.reverse();a--;r.push(0));r.reverse()}for(o.length-s.length<0&&(r=s,s=o,o=r),a=s.length,t=0,l=E;a;o[a]%=l)t=(o[--a]=o[a]+s[a]+t)/l|0;for(t&&(o.unshift(t),++u),a=o.length;0==o[--a];o.pop());for(e.c=o,a=1,t=o[0];t>=10;t/=10,a++);return e.e=a+u*S-1,b?m(e,c,h):e},A.precision=A.sd=function(e){var t=null,r=this;return e!=t&&e!==!!e&&1!==e&&0!==e&&f(r.constructor,"argument",e,"precision",1),r.c&&(t=h(r.c),e&&r.e+1>t&&(t=r.e+1)),t},A.round=function(){var e=this,t=e.constructor;return m(new t(e),e.e+1,t.rounding)},A.squareRoot=A.sqrt=function(){var e,t,r,n,i,o,s=this,u=s.c,l=s.s,c=s.e,h=s.constructor,f=new h(.5);if(1!==l||!u||!u[0])return new h(!l||0>l&&(!u||u[0])?0/0:u?s:1/0);for(b=!1,l=Math.sqrt(+s),0==l||l==1/0?(t=a(u),(t.length+c)%2==0&&(t+="0"),l=Math.sqrt(t),c=M((c+1)/2)-(0>c||c%2),l==1/0?t="1e"+c:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),n=new h(t)):n=new h(l.toString()),r=(c=h.precision)+3;;)if(o=n,n=f.times(o.plus(P(s,o,r+2,1))),a(o.c).slice(0,r)===(t=a(n.c)).slice(0,r)){if(t=t.slice(r-3,r+1),"9999"!=t&&(i||"4999"!=t)){(!+t||!+t.slice(1)&&"5"==t.charAt(0))&&(m(n,c+1,1),e=!n.times(n).eq(s));break}if(!i&&(m(o,c+1,0),o.times(o).eq(s))){n=o;break}r+=4,i=1}return b=!0,m(n,c,h.rounding,e)},A.times=function(e,t){var r,n,i=this,a=i.constructor,o=i.c,s=(w=11,e=new a(e,t),e.c),u=M(i.e/S),l=M(e.e/S),c=i.s;if(t=e.s,e.s=c==t?1:-1,!((u||o&&o[0])&&(l||s&&s[0])))return new a(!c||!t||o&&!o[0]&&!s||s&&!s[0]&&!o?0/0:o&&s?0*e.s:e.s/0);for(n=u+l,c=o.length,t=s.length,t>c&&(r=o,o=s,s=r,l=c,c=t,t=l),l=c+t,r=[];l--;r.push(0));for(u=t-1;u>-1;u--){for(t=0,l=c+u;l>u;t=t/E|0)t=r[l]+s[u]*o[l-u-1]+t,r[l--]=t%E|0;t&&(r[l]=(r[l]+t)%E)}for(t&&++n,r[0]||r.shift(),l=r.length;!r[--l];r.pop());for(e.c=r,c=1,t=r[0];t>=10;t/=10,c++);return e.e=c+n*S-1,b?m(e,a.precision,a.rounding):e},A.toDecimalPlaces=A.toDP=function(e,t){var r=this;return r=new r.constructor(r),null!=e&&u(r,e,"toDP")?m(r,(0|e)+r.e+1,s(r,t,"toDP")):r},A.toExponential=function(e,t){var r=this;return r.c?c(r,null!=e&&u(r,e,"toExponential")?0|e:null,null!=e&&s(r,t,"toExponential"),1):r.toString()},A.toFixed=function(e,t){var r,n=this,i=n.constructor,a=i.toExpNeg,o=i.toExpPos;return null!=e&&(e=u(n,e,r="toFixed")?n.e+(0|e):null,t=s(n,t,r)),i.toExpNeg=-(i.toExpPos=1/0),null!=e&&n.c?(r=c(n,e,t),n.s<0&&n.c&&(n.c[0]?r.indexOf("-")<0&&(r="-"+r):r=r.replace("-",""))):r=n.toString(),i.toExpNeg=a,i.toExpPos=o,r},A.toFormat=function(e,t,r){var n=this.toFixed(t).split(".");return n[0].replace(/\B(?=(\d{3})+$)/g,null==e?",":e+"")+(n[1]?"."+(r?n[1].replace(/\d{5}\B/g,"$&"+r):n[1]):"")},A.toFraction=function(e){var t,r,n,i,o,s,u,l,c=this,p=c.constructor,d=t=new p(p.ONE),m=s=new p(0),g=c.c,v=new p(m);if(!g)return c.toString();for(n=v.e=h(g)-c.e-1,v.c[0]=_(10,(u=n%S)<0?S+u:u),(null==e||(!(w=12,o=new p(e)).s||(y=o.cmp(d)<0||!o.c)||p.errors&&M(o.e/S)<o.c.length-1)&&!f(p,"max denominator",e,"toFraction",0)||(e=o).cmp(v)>0)&&(e=n>0?v:d),b=!1,o=new p(a(g)),u=p.precision,p.precision=n=g.length*S*2;l=P(o,v,0,1,1),r=t.plus(l.times(m)),1!=r.cmp(e);)t=m,m=r,d=s.plus(l.times(r=d)),s=r,v=o.minus(l.times(r=v)),o=r;return r=P(e.minus(t),m,0,1,1),s=s.plus(r.times(d)),t=t.plus(r.times(m)),s.s=d.s=c.s,i=P(d,m,n,1).minus(c).abs().cmp(P(s,t,n,1).minus(c).abs())<1?[d+"",m+""]:[s+"",t+""],b=!0,p.precision=u,i},A.toNearest=function(e,t){var r=this,n=r.constructor;return r=new n(r),null==e?(e=new n(n.ONE),t=n.rounding):(w=17,e=new n(e),t=s(r,t,"toNearest")),e.c?r.c&&(e.c[0]?(b=!1,r=P(r,e,0,4>t?[4,5,7,8][t]:t,1).times(e),b=!0,m(r)):r.c=[r.e=0]):r.s&&(e.s&&(e.s=r.s),r=e),r},A.toNumber=function(){var e=this;return+e||(e.s?0*e.s:0/0)},A.toPower=A.pow=function(e,t){var r,n,i,s,u=this,c=u.constructor,h=u.s,f=(w=13,+(e=new c(e,t))),g=0>f?-f:f,v=c.precision,y=c.rounding;if(!u.c||!e.c||(i=!u.c[0])||!e.c[0])return new c(_(i?0*h:+u,f));if(u=new c(u),r=u.c.length,!u.e&&u.c[0]==u.s&&1==r)return u;if(t=e.c.length-1,e.e||e.c[0]!=e.s||t)if(n=M(e.e/S),i=n>=t,!i&&0>h)s=new c(0/0);else{if(i&&L>r*S*g){if(s=p(c,u,g),e.s<0)return c.ONE.div(s)}else{if(h=0>h&&1&e.c[Math.max(n,t)]?-1:1,t=_(+u,f),n=0!=t&&isFinite(t)?new c(t+"").e:M(f*(Math.log("0."+a(u.c))/Math.LN10+u.e+1)),n>c.maxE+1||n<c.minE-1)return new c(n>0?h/0:0);b=!1,c.rounding=u.s=1,g=Math.min(12,(n+"").length),s=l(e.times(d(u,v+g)),v),s=m(s,v+5,1),o(s.c,v,y)&&(n=v+10,s=m(l(e.times(d(u,n+g)),n),n+5,1),+a(s.c).slice(v+1,v+15)+1==1e14&&(s=m(s,v+1,0))),s.s=h,b=!0,c.rounding=y}s=m(s,v,y)}else s=m(u,v,y);return s},A.toPrecision=function(e,t){var r=this;return null!=e&&u(r,e,"toPrecision",1)&&r.c?c(r,0|--e,s(r,t,"toPrecision"),2):r.toString()},A.toSignificantDigits=A.toSD=function(e,t){var r=this,n=r.constructor;return r=new n(r),null!=e&&u(r,e,"toSD",1)?m(r,0|e,s(r,t,"toSD")):m(r,n.precision,n.rounding)},A.toString=function(e){var t,r,n,i=this,o=i.constructor,s=i.e;if(null===s)r=i.s?"Infinity":"NaN";else{if(e===t&&(s<=o.toExpNeg||s>=o.toExpPos))return c(i,null,o.rounding,1);if(r=a(i.c),0>s){for(;++s;r="0"+r);r="0."+r}else if(n=r.length,s>0)if(++s>n)for(s-=n;s--;r+="0");else n>s&&(r=r.slice(0,s)+"."+r.slice(s));else if(t=r.charAt(0),n>1)r=t+"."+r.slice(1);else if("0"==t)return t;if(null!=e)if((y=!(e>=2&&65>e))||e!=(0|e)&&o.errors)f(o,"base",e,"toString",0);else if(r=g(o,r,0|e,10,i.s),"0"==r)return r}return i.s<0?"-"+r:r},A.truncated=A.trunc=function(){return m(new this.constructor(this),this.e+1,1)},A.valueOf=A.toJSON=function(){return this.toString()},g=function(){function e(e,t,r){for(var n,i,a=[0],o=0,s=e.length;s>o;){for(i=a.length;i--;a[i]*=t);for(a[n=0]+=C.indexOf(e.charAt(o++));n<a.length;n++)a[n]>r-1&&(null==a[n+1]&&(a[n+1]=0),a[n+1]+=a[n]/r|0,a[n]%=r)}return a.reverse()}return function(t,r,n,i,a){var o,s,u,l,c,h,f=r.indexOf("."),d=t.precision,m=t.rounding;for(37>i&&(r=r.toLowerCase()),f>=0&&(r=r.replace(".",""),h=new t(i),l=p(t,h,r.length-f),h.c=e(l.toFixed(),10,n),h.e=h.c.length),c=e(r,i,n),o=s=c.length;0==c[--s];c.pop());if(!c[0])return"0";if(0>f?o--:(l.c=c,l.e=o,l.s=a,l=P(l,h,d,m,0,n),c=l.c,u=l.r,o=l.e),f=c[d],s=n/2,u=u||null!=c[d+1],4>m?(null!=f||u)&&(0==m||m==(l.s<0?3:2)):f>s||f==s&&(4==m||u||6==m&&1&c[d-1]||m==(l.s<0?8:7)))for(c.length=d,--n;++c[--d]>n;)c[d]=0,d||(++o,c.unshift(1));else c.length=d;for(s=c.length;!c[--s];);for(f=0,r="";s>=f;r+=C.charAt(c[f++]));if(0>o){for(;++o;r="0"+r);r="0."+r}else if(f=r.length,++o>f)for(o-=f;o--;r+="0");else f>o&&(r=r.slice(0,o)+"."+r.slice(o));return r}}();var P=function(){function e(e,t,r){var n,i=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+i,e[a]=n%r|0,i=n/r|0;return i&&e.unshift(i),e}function t(e,t,r,n){var i,a;if(r!=n)a=r>n?1:-1;else for(i=a=0;r>i;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.shift());}return function(n,i,a,o,s,u){var l,c,h,f,p,d,g,v,y,x,b,w,_,T,C,A,N,R,L,D=n.constructor,P=n.s==i.s?1:-1,I=n.c,F=i.c;if(!(I&&I[0]&&F&&F[0]))return new D(n.s&&i.s&&(I?!F||I[0]!=F[0]:F)?I&&0==I[0]||!F?0*P:P/0:0/0);for(u?(f=1,c=n.e-i.e):(u=E,f=S,c=M(n.e/f)-M(i.e/f)),R=F.length,A=I.length,y=new D(P),x=y.c=[],h=0;F[h]==(I[h]||0);h++);if(F[h]>(I[h]||0)&&c--,null==a?(P=a=D.precision,o=D.rounding):P=s?a+(n.e-i.e)+1:a,0>P)x.push(1),p=!0;else{if(P=P/f+2|0,h=0,1==R){for(d=0,F=F[0],P++;(A>h||d)&&P--;h++)T=d*u+(I[h]||0),x[h]=T/F|0,d=T%F|0;p=d||A>h}else{for(d=u/(F[0]+1)|0,d>1&&(F=e(F,d,u),I=e(I,d,u),R=F.length,A=I.length),C=R,b=I.slice(0,R),w=b.length;R>w;b[w++]=0);L=F.slice(),L.unshift(0),N=F[0],F[1]>=u/2&&N++;do d=0,l=t(F,b,R,w),0>l?(_=b[0],R!=w&&(_=_*u+(b[1]||0)),d=_/N|0,d>1?(d>=u&&(d=u-1),g=e(F,d,u),v=g.length,w=b.length,l=t(g,b,v,w),1==l&&(d--,r(g,v>R?L:F,v,u))):(0==d&&(l=d=1),g=F.slice()),v=g.length,w>v&&g.unshift(0),r(b,g,w,u),-1==l&&(w=b.length,l=t(F,b,R,w),1>l&&(d++,r(b,w>R?L:F,w,u))),w=b.length):0===l&&(d++,b=[0]),x[h++]=d,l&&b[0]?b[w++]=I[C]||0:(b=[I[C]],w=1);while((C++<A||null!=b[0])&&P--);p=null!=b[0]}x[0]||x.shift()}if(1==f)y.e=c,y.r=+p;else{for(h=1,P=x[0];P>=10;P/=10,h++);y.e=h+c*f-1,m(y,s?a+y.e+1:a,o,p)}return y}}();v=function(){function e(e){var t,r,n,i=this,a="config",o=i.errors?parseInt:parseFloat;return e==r||"object"!=typeof e&&!f(i,"object expected",e,a)?i:((n=e[t="precision"])!=r&&((y=1>n||n>R)||o(n)!=n?f(i,t,n,a,0):i[t]=0|n),(n=e[t="rounding"])!=r&&((y=0>n||n>8)||o(n)!=n?f(i,t,n,a,0):i[t]=0|n),(n=e[t="toExpNeg"])!=r&&((y=-N>n||n>0)||o(n)!=n?f(i,t,n,a,0):i[t]=M(n)),(n=e[t="toExpPos"])!=r&&((y=0>n||n>N)||o(n)!=n?f(i,t,n,a,0):i[t]=M(n)),(n=e[t="minE"])!=r&&((y=-N>n||n>0)||o(n)!=n?f(i,t,n,a,0):i[t]=M(n)),(n=e[t="maxE"])!=r&&((y=0>n||n>N)||o(n)!=n?f(i,t,n,a,0):i[t]=M(n)),(n=e[t="errors"])!=r&&(n===!!n||1===n||0===n?(y=w=0,i[t]=!!n):f(i,t,n,a,1)),(n=e[t="crypto"])!=r&&(n===!!n||1===n||0===n?i[t]=!(!n||!x||"object"!=typeof x):f(i,t,n,a,1)),(n=e[t="modulo"])!=r&&((y=0>n||n>9)||o(n)!=n?f(i,t,n,a,0):i[t]=0|n),i)}function t(e){return new this(e).exp()}function r(e){return new this(e).ln()}function n(e,t){return new this(e).log(t)}function i(e,t,r){var n,i,a=0;for("[object Array]"==T.call(t[0])&&(t=t[0]),n=new e(t[0]);++a<t.length;){if(i=new e(t[a]),!i.s){n=i;break}n[r](i)&&(n=i)}return n}function a(){return i(this,arguments,"lt")}function o(){return i(this,arguments,"gt")}function s(e,t){return new this(e).pow(t)}function l(e){var t,r,n,i=0,a=[],o=this,s=new o(o.ONE);if(null!=e&&u(s,e,"random")?e|=0:e=o.precision,r=Math.ceil(e/S),o.crypto)if(x&&x.getRandomValues)for(t=x.getRandomValues(new Uint32Array(r));r>i;)n=t[i],n>=429e7?t[i]=x.getRandomValues(new Uint32Array(1))[0]:a[i++]=n%1e7;else if(x&&x.randomBytes){for(t=x.randomBytes(r*=4);r>i;)n=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((127&t[i+3])<<24),n>=214e7?x.randomBytes(4).copy(t,i):(a.push(n%1e7),i+=4);i=r/4}else f(o,"crypto unavailable",x,"random");if(!i)for(;r>i;)a[i++]=1e7*Math.random()|0;for(r=a[--i],e%=S,r&&e&&(n=_(10,S-e),a[i]=(r/n|0)*n);0===a[i];i--)a.pop();if(0>i)a=[r=0];else{for(r=-1;0===a[0];)a.shift(),r-=S;for(i=1,n=a[0];n>=10;)n/=10,i++;S>i&&(r-=S-i)}return s.e=r,s.c=a,s}function c(e){return new this(e).sqrt()}function h(i){function u(e,t){var r=this;if(!(r instanceof u))return f(u,"Decimal called without new",e),new u(e,t);if(e instanceof u){if(null==t)return w=0,r.constructor=e.constructor,r.s=e.s,r.e=e.e,void(r.c=(e=e.c)?e.slice():e);if(10==t)return m(new u(e),u.precision,u.rounding);e+=""}return p(r.constructor=u,r,e,t)}return u.precision=20,u.rounding=4,u.modulo=1,u.toExpNeg=-7,u.toExpPos=21,u.minE=-N,u.maxE=N,u.errors=!0,u.crypto=!1,u.prototype=A,u.ONE=new u(1),u.ROUND_UP=0,u.ROUND_DOWN=1,u.ROUND_CEIL=2,u.ROUND_FLOOR=3,u.ROUND_HALF_UP=4,u.ROUND_HALF_DOWN=5,u.ROUND_HALF_EVEN=6,u.ROUND_HALF_CEIL=7,u.ROUND_HALF_FLOOR=8,u.EUCLID=9,u.config=e,u.constructor=h,u.exp=t,u.ln=r,u.log=n,u.max=a,u.min=o,u.pow=s,u.sqrt=c,u.random=l,null!=i&&u.config(i),u}var p=function(){var e=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,t=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};return function(r,n,i,a){var o,s,u,l,c,h;if("string"!=typeof i&&(i=(l="number"==typeof i||"[object Number]"==T.call(i))&&0===i&&0>1/i?"-0":i+""),c=i,a==s&&e.test(i))n.s="-"==i.charAt(0)?(i=i.slice(1),-1):1;else{if(10==a)return m(new r(i),r.precision,r.rounding);if(i=t.call(i).replace(/^\+(?!-)/,""),n.s="-"==i.charAt(0)?(i=i.replace(/^-(?!-)/,""),-1):1,a!=s?a!=(0|a)&&r.errors||(y=!(a>=2&&65>a))?(f(r,"base",a,0,0),h=e.test(i)):(o="["+C.slice(0,a=0|a)+"]+",i=i.replace(/\.$/,"").replace(/^\./,"0."),(h=new RegExp("^"+o+"(?:\\."+o+")?$",37>a?"i":"").test(i))?(l&&(i.replace(/^0\.0*|\./,"").length>15&&f(r,0,c),l=!l),i=g(r,i,10,a,n.s)):"Infinity"!=i&&"NaN"!=i&&(f(r,"not a base "+a+" number",c),i="NaN")):h=e.test(i),!h)return n.c=n.e=null,"Infinity"!=i&&("NaN"!=i&&f(r,"not a number",c),n.s=null),w=0,n}for((s=i.indexOf("."))>-1&&(i=i.replace(".","")),(u=i.search(/e/i))>0?(0>s&&(s=u),s+=+i.slice(u+1),i=i.substring(0,u)):0>s&&(s=i.length),u=0;"0"==i.charAt(u);u++);for(a=i.length;"0"==i.charAt(--a););if(i=i.slice(u,a+1)){if(a=i.length,l&&a>15&&f(r,0,c),n.e=s=s-u-1,n.c=[],u=(s+1)%S,0>s&&(u+=S),a>u){for(u&&n.c.push(+i.slice(0,u)),a-=S;a>u;)n.c.push(+i.slice(u,u+=S));i=i.slice(u),u=S-i.length}else u-=a;for(;u--;i+="0");n.c.push(+i),b&&(n.e>r.maxE?n.c=n.e=null:n.e<r.minE&&(n.c=[n.e=0]))}else n.c=[n.e=0];w=0}}();return h()}(),n=function(){return v}.call(t,r,t,e),!(void 0!==n&&(e.exports=n))}(this)},function(e){function t(e,r,n,i){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=r,this.min=n,this.max=i,this.message="Wrong number of arguments in function "+e+" ("+r+" provided, "+n+(void 0!=i?"-"+i:"")+" expected)",this.stack=(new Error).stack}t.prototype=new Error,t.prototype.constructor=Error,t.prototype.name="ArgumentsError",e.exports=t},function(e){function t(e,r,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=r,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(r)?"["+r.join(", ")+"]":r)+")",this.stack=(new Error).stack}t.prototype=new RangeError,t.prototype.constructor=RangeError,t.prototype.name="DimensionError",e.exports=t},function(e){function t(e,r,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=r):(this.min=r,this.max=n),this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")",this.stack=(new Error).stack}t.prototype=new RangeError,t.prototype.constructor=RangeError,t.prototype.name="IndexError",e.exports=t},function(e){function t(e){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.types=Array.prototype.splice.call(arguments,1),this.message=e?0==this.types.length?"Unsupported type of argument in function "+e:"Function "+e+"("+this.types.join(", ")+") not supported":"Unsupported type of argument",this.stack=(new Error).stack}t.prototype=new TypeError,t.prototype.constructor=TypeError,t.prototype.name="UnsupportedTypeError",e.exports=t},function(e,t,r){t.array=r(137),t["boolean"]=r(159),t.number=r(4),t.bignumber=r(136),t.object=r(3),t.string=r(160),t.types=r(180)},function(e,t,r){function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(this.nodes=e||[],!o(this.nodes)||!this.nodes.every(s))throw new TypeError("Array containing Nodes expected")}var i=r(157),a=(r(3),r(160)),o=(r(13),r(144),Array.isArray),s=i.isNode;n.prototype=new i,n.prototype.type="ArrayNode",n.prototype._compile=function(e){var t="array"!==e.math.config().matrix,r=this.nodes.map(function(t){return t._compile(e)});return(t?"math.matrix([":"[")+r.join(",")+(t?"])":"]")},n.prototype.find=function(e){var t=[];this.match(e)&&t.push(this);for(var r=this.nodes,n=0,i=r.length;i>n;n++)t=t.concat(r[n].find(e));return t},n.prototype.toString=function(){return a.format(this.nodes)},n.prototype.toTex=function(e){e=e||"bmatrix";var t="\\begin{"+e+"}";return this.nodes.forEach(function(e){t+=e.nodes?e.nodes.map(function(e){return e.toTex()}).join("&"):e.toTex(),t+="\\\\"}),t+="\\end{"+e+"}"},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!u(e))throw new TypeError('String expected for parameter "name"');if(!(t instanceof i))throw new TypeError('Node expected for parameter "expr"');if(e in o)throw new Error('Illegal symbol name, "'+e+'" is a reserved keyword');this.name=e,this.expr=t}var i=r(157),a=r(145),o=r(283),s=r(284),u=r(160).isString;n.prototype=new i,n.prototype.type="AssignmentNode",n.prototype._compile=function(e){return'scope["'+this.name+'"] = '+this.expr._compile(e)},n.prototype.find=function(e){var t=[];return this.match(e)&&t.push(this),t=t.concat(this.expr.find(e))},n.prototype.toString=function(){return this.name+" = "+this.expr.toString()},n.prototype.toTex=function(){var e;return this.expr instanceof a&&(e=["\\mathbf{","}"]),s.addBraces(s.toSymbol(this.name),e)+"="+s.addBraces(this.expr.toTex())},e.exports=n},function(e,t,r){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.params=[]}var i=r(157),a=r(12),o=r(159).isBoolean;n.prototype=new i,n.prototype.type="BlockNode",n.prototype.add=function(e,t){if(void 0===t&&(t=!0),!(e instanceof i))throw new TypeError('Node expected for parameter "expr"');if(!o(t))throw new TypeError('Boolean expected for parameter "visible"');var r=this.params.length;this.params[r]={node:e,visible:t}},n.prototype._compile=function(e){e.ResultSet=a;var t=this.params.map(function(t){var r=t.node._compile(e);return t.visible?"results.push("+r+");":r+";"});return"(function () {var results = [];"+t.join("")+"return new ResultSet(results);})()"},n.prototype.find=function(e){var t=[];this.match(e)&&t.push(this);for(var r=this.params,n=0,i=r.length;i>n;n++)t=t.concat(r[n].node.find(e));return t},n.prototype.toString=function(){return this.params.map(function(e){return e.node.toString()+(e.visible?"":";")}).join("\n")},n.prototype.toTex=function(){return this.params.map(function(e){return e.node.toTex()+(e.visible?"":";")}).join("\n")},e.exports=n},function(e,t,r){function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!(e instanceof i))throw new TypeError("Parameter condition must be a Node");if(!(t instanceof i))throw new TypeError("Parameter trueExpr must be a Node");if(!(r instanceof i))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=r}var i=r(157),a=r(284),o=r(139),s=r(6),u=r(10),l=r(144),c=l.string.isString,h=l.number.isNumber,f=l["boolean"].isBoolean;n.prototype=new i,n.prototype.type="ConditionalNode",n.prototype._compile=function(e){return e.testCondition=function(t){if(h(t)||f(t)||c(t))return t?!0:!1;if(t instanceof o)return t.isZero()?!1:!0;if(t instanceof s)return t.re||t.im?!0:!1;if(t instanceof u)return t.value?!0:!1;if(null===t||void 0===t)return!1;throw new TypeError('Unsupported type of condition "'+e.math["typeof"](t)+'"')},"testCondition("+this.condition._compile(e)+") ? ( "+this.trueExpr._compile(e)+") : ( "+this.falseExpr._compile(e)+")"},n.prototype.find=function(e){var t=[];return this.match(e)&&t.push(this),t=t.concat(this.condition.find(e),this.trueExpr.find(e),this.falseExpr.find(e))},n.prototype.toString=function(){return"("+this.condition.toString()+") ? ("+this.trueExpr.toString()+") : ("+this.falseExpr.toString()+")"},n.prototype.toTex=function(){var e=a.addBraces(this.trueExpr.toTex())+", &\\quad"+a.addBraces("\\text{if}\\;"+this.condition.toTex())+"\\\\"+(a.addBraces(this.falseExpr.toTex())+", &\\quad"+a.addBraces("\\text{otherwise}"));return a.addBraces(e,["\\left\\{\\begin{array}{l l}","\\end{array}\\right."])},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(t){if(!o(t))throw new TypeError('String expected for parameter "valueType"');if(!o(e))throw new TypeError('String expected for parameter "value"');this.value=e,this.valueType=t}else this.value=e+"",this.valueType=a(e);if(!s[this.valueType])throw new TypeError('Unsupported type of value "'+this.valueType+'"')}var i=r(157),a=(r(139),r(180).type),o=r(160).isString,s={number:!0,string:!0,"boolean":!0,undefined:!0,"null":!0};n.prototype=new i,n.prototype.type="ConstantNode",n.prototype._compile=function(e){switch(this.valueType){case"number":return"bignumber"===e.math.config().number?'math.bignumber("'+this.value+'")':this.value.replace(/^(0*)[0-9]/,function(e,t){return e.substring(t.length)});case"string":return'"'+this.value+'"';case"boolean":return this.value;case"undefined":return this.value;case"null":return this.value;default:throw new TypeError('Unsupported type of constant "'+this.valueType+'"')}},n.prototype.toString=function(){switch(this.valueType){case"string":return'"'+this.value+'"';default:return this.value}},n.prototype.toTex=function(){var e,t=this.value;switch(this.valueType){case"string":return"\\text{"+t+"}";case"number":return e=t.toLowerCase().indexOf("e"),-1!==e?t.substring(0,e)+" \\cdot 10^{"+t.substring(e+1)+"}":t;default:return t}},e.exports=n},function(e,t,r){function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");
if(!s(e))throw new TypeError('String expected for parameter "name"');if(!u(t)||!t.every(s))throw new TypeError('Array containing strings expected for parameter "args"');if(!(r instanceof i))throw new TypeError('Node expected for parameter "expr"');if(e in a)throw new Error('Illegal function name, "'+e+'" is a reserved keyword');this.name=e,this.args=t,this.expr=r}var i=r(157),a=r(283),o=r(284),s=r(160).isString,u=Array.isArray;n.prototype=new i,n.prototype.type="FunctionAssignmentNode",n.prototype._compile=function(e){return'scope["'+this.name+'"] =   (function (scope) {    scope = Object.create(scope);     var fn = function '+this.name+"("+this.args.join(",")+") {      if (arguments.length != "+this.args.length+') {        throw new SyntaxError("Wrong number of arguments in function '+this.name+' (" + arguments.length + " provided, '+this.args.length+' expected)");      }'+this.args.map(function(e,t){return'scope["'+e+'"] = arguments['+t+"];"}).join("")+"      return "+this.expr._compile(e)+'    };    fn.syntax = "'+this.name+"("+this.args.join(", ")+')";    return fn;  })(scope);'},n.prototype.find=function(e){var t=[];return this.match(e)&&t.push(this),t=t.concat(this.expr.find(e))},n.prototype.toString=function(){return"function "+this.name+"("+this.args.join(", ")+") = "+this.expr.toString()},n.prototype.toTex=function(){return this.name+o.addBraces(this.args.map(o.toSymbol).join(", "),!0)+"="+o.addBraces(this.expr.toTex())},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!(e instanceof i))throw new TypeError('Node expected for parameter "object"');if(!c(t)||!t.every(l))throw new TypeError('Array containing Nodes expected for parameter "ranges"');this.object=e,this.ranges=t}var i=r(157),a=r(154),o=r(155),s=r(139),u=r(7),l=i.isNode,c=Array.isArray;n.prototype=new i,n.prototype.type="IndexNode",n.prototype._compile=function(e){return this.compileSubset(e)},n.prototype.compileSubset=function(e,t){var r={type:o,properties:{name:"end"}},n=!1,i=this.ranges.map(function(e){var t=e.find(r).length>0;return n=t?t:n,t});e.range=function(e,t,r){return new u(e instanceof s?e.toNumber():e,t instanceof s?t.toNumber():t,r instanceof s?r.toNumber():r)};var l=this.ranges.map(function(t,r){var n=i[r];return t instanceof a?n?'(function (scope) {  scope = Object.create(scope);   scope["end"] = size['+r+"];  return range(    "+t.start._compile(e)+",     "+t.end._compile(e)+",     "+(t.step?t.step._compile(e):"1")+"  );})(scope)":"range("+t.start._compile(e)+", "+t.end._compile(e)+", "+(t.step?t.step._compile(e):"1")+")":n?'(function (scope) {  scope = Object.create(scope);   scope["end"] = size['+r+"];  return "+t._compile(e)+";})(scope)":t._compile(e)});return n?"(function () {  var obj = "+this.object._compile(e)+";  var size = math.size(obj).valueOf();  return math.subset(    obj,     math.index("+l.join(", ")+")    "+(t?", "+t:"")+"  );})()":"math.subset("+this.object._compile(e)+",math.index("+l.join(", ")+")"+(t?", "+t:"")+")"},n.prototype.find=function(e){var t=[];this.match(e)&&t.push(this),t=t.concat(this.object.find(e));for(var r=this.ranges,n=0,i=r.length;i>n;n++)t=t.concat(r[n].find(e));return t},n.prototype.objectName=function(){return this.object.name},n.prototype.toString=function(){return this.object.toString()+"["+this.ranges.join(", ")+"]"},n.prototype.toTex=function(){return this.object.toTex()+"["+this.ranges.join(", ")+"]"},e.exports=n},function(e,t,r){function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.op=e,this.fn=t,this.params=r}var i=r(157),a=r(149),o=r(155),s=r(153),u=r(284);n.prototype=new i,n.prototype.type="OperatorNode",n.prototype._compile=function(e){if(!(this.fn in e.math))throw new Error("Function "+this.fn+' missing in provided namespace "math"');var t=this.params.map(function(t){return t._compile(e)});return"math."+this.fn+"("+t.join(", ")+")"},n.prototype.find=function(e){var t=[];this.match(e)&&t.push(this);var r=this.params;if(r)for(var n=0,i=r.length;i>n;n++)t=t.concat(r[n].find(e));return t},n.prototype.toString=function(){var e=this.params;switch(e.length){case 1:return"-"==this.op?"-"+e[0].toString():e[0].toString()+this.op;case 2:var t=e[0].toString();e[0]instanceof n&&(t="("+t+")");var r=e[1].toString();return e[1]instanceof n&&(r="("+r+")"),t+" "+this.op+" "+r;default:return this.op+"("+this.params.join(", ")+")"}},n.prototype.toTex=function(){var e=this.params,t=u.toOperator(this.op),r=e[0],i=e[1];switch(e.length){case 1:return"-"===this.op||"+"===this.op?this.op+r.toTex():r.toTex()+this.op;case 2:var l=r.toTex(),c=!1,h=i.toTex(),f=!1,p="",d="";switch(this.op){case"/":p=t,t="";break;case"*":r instanceof n&&("+"===r.op||"-"===r.op)&&(c=!0),i instanceof n&&("+"===i.op||"-"===i.op?f=!0:"*"===i.op&&(f=!0)),t=(r instanceof a||r instanceof n)&&(i instanceof a||i instanceof n)?" \\cdot ":" \\, ";break;case"^":r instanceof n||r instanceof s?c=!0:r instanceof o&&(c=null);break;case"to":h=u.toUnit(h,!0)}return l=u.addBraces(l,c),h=u.addBraces(h,f),p+l+t+h+d;default:return t+"("+this.params.map(u.toSymbol).join(", ")+")"}},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!(e instanceof i))throw new TypeError('SymbolNode expected for parameter "symbol"');if(!s(t)||!t.every(o))throw new TypeError('Array containing Nodes expected for parameter "params"');this.symbol=e,this.params=t}var i=r(157),a=r(284),o=i.isNode,s=Array.isArray;n.prototype=new i,n.prototype.type="FunctionNode",n.prototype._compile=function(e){var t=e.math[this.symbol.name],r="function"==typeof t&&1==t.rawArgs,n=this.params.map(function(t){return t._compile(e)});if(r){var i,a=this.symbol.name;do i="p"+Math.round(1e4*Math.random());while(i in e);return e[i]=this.params,'("'+a+'" in scope ? scope["'+a+'"]('+n.join(", ")+') : math["'+a+'"]('+i+", math, scope))"}return this.symbol._compile(e)+"("+n.join(", ")+")"},n.prototype.find=function(e){var t=[];this.match(e)&&t.push(this),t=t.concat(this.symbol.find(e));for(var r=this.params,n=0,i=r.length;i>n;n++)t=t.concat(r[n].find(e));return t},n.prototype.toString=function(){return this.symbol.toString()+"("+this.params.join(", ")+")"},n.prototype.toTex=function(){return a.toParams(this)},e.exports=n},function(e,t,r){function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(e)||2!=e.length&&3!=e.length||!e.every(a))throw new TypeError('Expected an Array containing 2 or 3 Nodes as parameter "params"');this.start=e[0],this.end=e[1],this.step=e[2]}var i=r(157),a=i.isNode;n.prototype=new i,n.prototype.type="RangeNode",n.prototype._compile=function(e){return"math.range("+this.start._compile(e)+", "+this.end._compile(e)+(this.step?", "+this.step._compile(e):"")+")"},n.prototype.find=function(e){var t=[];return this.match(e)&&t.push(this),t=t.concat(this.start.find(e)),this.step&&(t=t.concat(this.step.find(e))),t=t.concat(this.end.find(e))},n.prototype.toString=function(){var e=this.start.toString();return this.step&&(e+=":"+this.step.toString()),e+=":"+this.end.toString()},n.prototype.toTex=function(){var e=this.start.toTex();return this.step&&(e+=":"+this.step.toTex()),e+=":"+this.end.toTex()},e.exports=n},function(e,t,r){function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!u(e))throw new TypeError('String expected for parameter "name"');this.name=e}function i(e){throw new Error("Undefined symbol "+e)}var a=r(157),o=r(10),s=r(284),u=r(160).isString;n.prototype=new a,n.prototype.type="SymbolNode",n.prototype._compile=function(e){return e.undef=i,e.Unit=o,this.name in e.math?'("'+this.name+'" in scope ? scope["'+this.name+'"] : math["'+this.name+'"])':'("'+this.name+'" in scope ? scope["'+this.name+'"] : '+(o.isValuelessUnit(this.name)?'new Unit(null, "'+this.name+'")':'undef("'+this.name+'")')+")"},n.prototype.toString=function(){return this.name},n.prototype.toTex=function(){return s.toSymbol(this.name)},e.exports=n},function(e,t,r){function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!(e instanceof a))throw new TypeError('Expected IndexNode for parameter "index"');if(!(t instanceof i))throw new TypeError('Expected Node for parameter "expr"');this.index=e,this.expr=t}var i=r(157),a=r(151);n.prototype=new i,n.prototype.type="UpdateNode",n.prototype._compile=function(e){return'scope["'+this.index.objectName()+'"] = '+this.index.compileSubset(e,this.expr._compile(e))},n.prototype.find=function(e){var t=[];return this.match(e)&&t.push(this),t=t.concat(this.index.find(e)),t=t.concat(this.expr.find(e))},n.prototype.toString=function(){return this.index.toString()+" = "+this.expr.toString()},n.prototype.toTex=function(){return this.index.toTex()+" = "+this.expr.toTex()},e.exports=n},function(e,t,r){function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}function i(e){for(var t in e)if(e.hasOwnProperty(t)&&t in o)throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}function a(e){var t=Object.create(e);for(var r in e)if(e.hasOwnProperty(r)){var n=e[r],i=n&&n.transform;i&&(t[r]=i)}return t}var o=r(283);n.prototype.eval=function(){throw new Error("Node.eval is deprecated. Use Node.compile(math).eval([scope]) instead.")},n.prototype.type="Node",n.prototype.compile=function(e){if(!(e instanceof Object))throw new TypeError("Object expected for parameter math");var t={math:a(e),_validateScope:i},r=this._compile(t),n=Object.keys(t).map(function(e){return"    var "+e+' = defs["'+e+'"];'}),o=n.join(" ")+'return {  "eval": function (scope) {    if (scope) _validateScope(scope);    scope = scope || {};    return '+r+";  }};",s=new Function("defs",o);return s(t)},n.prototype._compile=function(){throw new Error("Cannot compile a Node interface")},n.prototype.find=function(e){return this.match(e)?[this]:[]},n.prototype.match=function(e){var t=!0;if(e){!e.type||this instanceof e.type||(t=!1);var r=e.properties;if(t&&r)for(var n in r)if(r.hasOwnProperty(n)&&this[n]!==r[n]){t=!1;break}}return t},n.prototype.toString=function(){return""},n.prototype.toTex=function(){return""},n.isNode=function(e){return e instanceof n},e.exports=n},function(e,t,r){var n=(r(141),r(142));t.transform=function(e){return e instanceof n?new n(e.index+1,e.min+1,e.max+1):e}},function(e,t){t.isBoolean=function(e){return e instanceof Boolean||"boolean"==typeof e}},function(e,t,r){function n(e,r){if(Array.isArray(e)){for(var i="[",a=e.length,o=0;a>o;o++)0!=o&&(i+=", "),i+=n(e[o],r);return i+="]"}return t.format(e,r)}var i=r(4),a=r(136),o=r(139);t.isString=function(e){return e instanceof String||"string"==typeof e},t.endsWith=function(e,t){var r=e.length-t.length,n=e.length;return e.substring(r,n)===t},t.format=function(e,r){return i.isNumber(e)?i.format(e,r):e instanceof o?a.format(e,r):Array.isArray(e)?n(e,r):t.isString(e)?'"'+e+'"':"function"==typeof e?e.syntax?e.syntax+"":"function":e instanceof Object?"function"==typeof e.format?e.format(r):e.toString():String(e)}},function(e){e.exports={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]}},function(e){e.exports={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]}},function(e){e.exports={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]}},function(e){e.exports={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]}},function(e){e.exports={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]}},function(e){e.exports={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]}},function(e){e.exports={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]}},function(e){e.exports={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]}},function(e){e.exports={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]}},function(e){e.exports={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]}},function(e){e.exports={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]}},function(e){e.exports={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["tau"],seealso:[]}},function(e){e.exports={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]}},function(e){e.exports={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]}},function(e){e.exports={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]}},function(e){e.exports={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]}},function(e){e.exports={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]}},function(e,t,r){e.exports=function(e){function t(t){if(!s.hasOwnProperty(t))throw new Error("Unknown distribution "+t);var r=Array.prototype.slice.call(arguments,1),a=s[t].apply(this,r);return function(t){var r={random:function(t,r,i){var s,l,c;if(arguments.length>3)throw new e.error.ArgumentsError("random",arguments.length,0,3);if(1===arguments.length?o(t)?s=t:c=t:2===arguments.length?o(t)?(s=t,c=r):(l=t,c=r):(s=t,l=r,c=i),void 0===c&&(c=1),void 0===l&&(l=0),void 0!==s){var h=u(s.valueOf(),l,c,a);return s instanceof n?new n(h):h}return a(l,c)},randomInt:function(t,r,i){var a,l,c;if(arguments.length>3||arguments.length<1)throw new e.error.ArgumentsError("randomInt",arguments.length,1,3);if(1===arguments.length?o(t)?a=t:c=t:2===arguments.length?o(t)?(a=t,c=r):(l=t,c=r):(a=t,l=r,c=i),void 0===l&&(l=0),void 0!==a){var h=u(a.valueOf(),l,c,s);return a instanceof n?new n(h):h}return s(l,c)},pickRandom:function(t){if(1!==arguments.length)throw new e.error.ArgumentsError("pickRandom",arguments.length,1);if(t instanceof n)t=t.valueOf();else if(!Array.isArray(t))throw new e.error.UnsupportedTypeError("pickRandom",e["typeof"](t));if(i.size(t).length>1)throw new Error("Only one dimensional vectors supported");return t[Math.floor(Math.random()*t.length)]}},a=function(e,r){return e+t()*(r-e)},s=function(e,r){return Math.floor(e+t()*(r-e))},u=function(e,t,r,n){var i,a,o=[];if(e=e.slice(0),e.length>1)for(a=0,i=e.shift();i>a;a++)o.push(u(e,t,r,n));else for(a=0,i=e.shift();i>a;a++)o.push(n(t,r));return o};return r}(a)}var n=r(9),i=r(137),a=r(13),o=a.isCollection,s={uniform:function(){return Math.random},normal:function(){return function(){for(var e,t,r=-1;0>r||r>1;)e=Math.random(),t=Math.random(),r=1/6*Math.pow(-2*Math.log(e),.5)*Math.cos(2*Math.PI*t)+.5;return r}}};return t}},function(e,t,r){function n(e){return r(i(e))}function i(e){return a[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var a={"./clone":127,"./clone.js":127,"./filter":128,"./filter.js":128,"./forEach":135,"./forEach.js":135,"./format":129,"./format.js":129,"./import":130,"./import.js":130,"./map":131,"./map.js":131,"./print":132,"./print.js":132,"./sort":133,"./sort.js":133,"./typeof":134,"./typeof.js":134};n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n},function(e,t){t.type=function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Boolean)return"boolean";if(e instanceof Number)return"number";if(e instanceof String)return"string";if(Array.isArray(e))return"array";if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}},function(e){e.exports={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]}},function(e){e.exports={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i",'"hello" + " world"',"3 cm + 2 inch"],seealso:["subtract"]}},function(e){e.exports={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]}},function(e){e.exports={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]}},function(e){e.exports={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]}},function(e){e.exports={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]}},function(e){e.exports={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]}},function(e){e.exports={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]}},function(e){e.exports={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["pow","log"]}},function(e){e.exports={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]}},function(e){e.exports={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]}},function(e){e.exports={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]}},function(e){e.exports={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]}},function(e){e.exports={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log10"]}},function(e){e.exports={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]}},function(e){e.exports={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","function isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]}},function(e){e.exports={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]}},function(e){e.exports={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i))","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)","norm([[1, 2], [3, 4]], 'inf')","norm([[1, 2], [3, 4]], 'fro')"]}},function(e){e.exports={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3 = 8","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]}},function(e){e.exports={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]}},function(e){e.exports={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]}},function(e){e.exports={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","multiply"]}},function(e){e.exports={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]}},function(e){e.exports={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]}},function(e){e.exports={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]}},function(e){e.exports={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]}},function(e){e.exports={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]}},function(e){e.exports={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 if x is larger than y, -1 if x is smaller than y, and 0 if x and y are equal.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq"]}},function(e){e.exports={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["[1,3,4] == [1,3,4]","[1,3,4] == [1,3]"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]}},function(e){e.exports={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(e){e.exports={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]}},function(e){e.exports={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 > 1+1","2 >= 1+1","a = 3.2","b = 6-2.8","(a > b)"],seealso:["equal","unequal","smallerEq","smaller","largerEq","compare"]}},function(e){e.exports={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]}},function(e){e.exports={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 1+1","2 <= 1+1","a = 3.2","b = 6-2.8","(a < b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]}},function(e){e.exports={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(e){e.exports={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]}},function(e){e.exports={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]}},function(e){e.exports={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]}},function(e){e.exports={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]}},function(e){e.exports={name:"bignumber",category:"Type",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","index","matrix","string","unit"]}},function(e){e.exports={name:"boolean",category:"Type",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]}},function(e){e.exports={name:"complex",category:"Type",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]}},function(e){e.exports={name:"index",category:"Type",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]}},function(e){e.exports={name:"matrix",category:"Type",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()","matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])"],seealso:["bignumber","boolean","complex","index","number","string","unit"]}},function(e){e.exports={name:"number",category:"Type",syntax:["x","number(x)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number("52cm", "m")'],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]}},function(e){e.exports={name:"string",category:"Type",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]}},function(e){e.exports={name:"unit",category:"Type",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]}},function(e){e.exports={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]}},function(e){e.exports={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]}},function(e){e.exports={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}
},function(e){e.exports={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])","eye"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]}},function(e){e.exports={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])","ones"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze"]}},function(e){e.exports={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","transpose","zeros"]}},function(e){e.exports={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","transpose","zeros"]}},function(e){e.exports={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","transpose","zeros"]}},function(e){e.exports={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","zeros"]}},function(e){e.exports={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])","zeros"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose"]}},function(e){e.exports={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]}},function(e){e.exports={name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5*4*3*2*1","3!"],seealso:["combinations","permutations"]}},function(e){e.exports={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]}},function(e){e.exports={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])"],seealso:["random","randomInt"]}},function(e){e.exports={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]}},function(e){e.exports={name:"randInt",category:"Probability",syntax:["randInt()","randInt(max)","randInt(min, max)","randInt(size)","randInt(size, max)","randInt(size, min, max)"],description:"Return a random integer number",examples:["randInt()","randInt(10, 20)","randInt([2, 3], 10)"],seealso:["pickRandom","random"]}},function(e){e.exports={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3], 0)","max([2, 5; 4, 3], 1)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]}},function(e){e.exports={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3], 0)","mean([2, 5; 4, 3], 1)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]}},function(e){e.exports={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var"]}},function(e){e.exports={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3], 0)","min([2, 5; 4, 3], 1)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]}},function(e){e.exports={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","var"]}},function(e){e.exports={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]}},function(e){e.exports={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]}},function(e){e.exports={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]}},function(e){e.exports={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]}},function(e){e.exports={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(2.3))"],seealso:["sin","acos","atan"]}},function(e){e.exports={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(2.3))"],seealso:["tan","acos","asin"]}},function(e){e.exports={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]}},function(e){e.exports={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]}},function(e){e.exports={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]}},function(e){e.exports={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]}},function(e){e.exports={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]}},function(e){e.exports={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]}},function(e){e.exports={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]}},function(e){e.exports={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]}},function(e){e.exports={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]}},function(e){e.exports={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]}},function(e){e.exports={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]}},function(e){e.exports={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]}},function(e){e.exports={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]}},function(e){e.exports={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]}},function(e){e.exports={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]}},function(e){e.exports={name:"map",category:"Utils",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], function(val) { return value * value })"],seealso:["filter","forEach"]}},function(e){e.exports={name:"filter",category:"Utils",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]}},function(e){e.exports={name:"forEach",category:"Utils",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]}},function(e){e.exports={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]}},function(e){e.exports={name:"import",category:"Utils",syntax:["import(string)"],description:"Import functions from a file.",examples:['import("numbers")','import("./mylib.js")'],seealso:[]}},function(e){e.exports={name:"sort",category:"Utils",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc" or "desc", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)'],seealso:["map","filter","forEach"]}},function(e){e.exports={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]}},function(e){e.exports={end:!0}},function(e,t,r){function n(){for(var e,t=Array.prototype.slice.call(arguments),r=0,n=t.length;n>r;r++){e=t[r];for(var i in e)e.hasOwnProperty(i)&&(v[i]=e[i])}}function i(e,t){return"undefined"!=typeof e[t]}function a(e){return function(t){return i(e,t)}}function o(e){return function(r){if("boolean"==typeof e[r])r=e[r]===!0?"\\"+r:"\\mathrm{"+r+"}";else if("string"==typeof e[r])r=e[r];else if("string"==typeof r){var n=r.indexOf("_");-1!==n&&(r=t.toSymbol(r.substring(0,n))+"_{"+t.toSymbol(r.substring(n+1))+"}")}return r}}var s=r(145),u=r(152),l={Alpha:"A",alpha:!0,Beta:"B",beta:!0,Gamma:!0,gamma:!0,Delta:!0,delta:!0,Epsilon:"E",epsilon:!0,varepsilon:!0,Zeta:"Z",zeta:!0,Eta:"H",eta:!0,Theta:!0,theta:!0,vartheta:!0,Iota:"I",iota:!0,Kappa:"K",kappa:!0,varkappa:!0,Lambda:!0,lambda:!0,Mu:"M",mu:!0,Nu:"N",nu:!0,Xi:!0,xi:!0,Omicron:"O",omicron:!0,Pi:!0,pi:!0,varpi:!0,Rho:"P",rho:!0,varrho:!0,Sigma:!0,sigma:!0,varsigma:!0,Tau:"T",tau:!0,Upsilon:!0,upsilon:!0,Phi:!0,phi:!0,varphi:!0,Chi:"X",chi:!0,Psi:!0,psi:!0,Omega:!0,omega:!0},c={dots:!0,ldots:!0,cdots:!0,vdots:!0,ddots:!0,idots:!0},h={"true":"\\mathrm{True}","false":"\\mathrm{False}"},f={inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:!0,undefined:"\\mathbf{?}"},p={acos:"\\cos^{-1}",arccos:"\\cos^{-1}",cos:!0,csc:!0,csch:!1,exp:!0,ker:!0,limsup:!0,min:!0,sinh:!0,asin:"\\sin^{-1}",arcsin:"\\sin^{-1}",cosh:!0,deg:!0,gcd:!0,lg:!0,ln:!0,Pr:!0,sup:!0,atan:"\\tan^{-1}",atan2:"\\tan2^{-1}",arctan:"\\tan^{-1}",cot:!0,det:!0,hom:!0,log:!0,log10:"\\log_{10}",sec:!0,sech:!1,tan:!0,arg:!0,coth:!0,dim:!0,inf:!0,max:!0,sin:!0,tanh:!0,fix:!1,lcm:!1,sign:!1,xgcd:!1,unaryMinus:!1,unaryPlus:!1,complex:!1,conj:!1,im:!1,re:!1,diag:!1,resize:!1,size:!1,squeeze:!1,subset:!1,index:!1,ones:!1,zeros:!1,range:!1,random:!1,mean:"\\mu",median:!1,prod:!1,std:"\\sigma","var":"\\sigma^2"},d={sqrt:!0,inv:!0,"int":"\\int",Int:"\\int",integrate:"\\int",eigenvalues:"\\lambda",liminf:!0,lim:!0,exp:"e^",sum:!0,eye:"\\mathbf{I}"},m={"<=":"\\leq",">=":"\\geq","!=":"\\neq","in":!0,"*":"\\cdot","/":"\\frac",mod:"\\bmod",to:"\\rightarrow"},g={deg:"^{\\circ}"},v={};n(p,d,l,c,h,f),t.isSymbol=a(v),t.toSymbol=o(v),t.isFunction=a(p),t.toFunction=o(p),t.isCurlyFunction=a(d),t.toCurlyFunction=o(d),t.isOperator=a(m),t.toOperator=o(m),t.isUnit=a(g),t.toUnit=function(){var e=o(g);return function(r,n){return t.isUnit(r)?e(r):(n?"":"\\,")+"\\mathrm{"+r+"}"}}(),t.addBraces=function(e,t,r){if(null===t)return e;var n=["",""];switch(r=r||"normal","undefined"==typeof t||t===!1?n=["{","}"]:t===!0?(n=["(",")"],r="lr"):n=Array.isArray(t)&&2===t.length?t:[t,t],r){case"normal":case!1:return n[0]+e+n[1];case"lr":return"\\left"+n[0]+"{"+e+"}\\right"+n[1];case"be":return"\\begin{"+n[0]+"}"+e+"\\end{"+n[1]+"}"}return n[0]+e+n[1]},t.toParams=function(e){var r=e.symbol,n=e.params,i=r.toTex(),a=null,o=null,l=!1,c=!1,h="",f="",p=null;switch(r.name){case"add":p="+";break;case"subtract":p="-";break;case"larger":p=">";break;case"largerEq":p=">=";break;case"smaller":p="<";break;case"smallerEq":p="<=";break;case"unequal":p="!=";break;case"equal":p="=";break;case"mod":p="mod";break;case"multiply":p="*";break;case"pow":p="^";break;case"concat":p="||";break;case"factorial":p="!";break;case"permutations":if(1!==n.length){var d=n[0].toTex(),m=n[1].toTex();return"\\frac{"+d+"!}{\\left("+d+" - "+m+"\\right)!}"}p="!";break;case"combinations":p="\\choose";break;case"abs":o="|",l="lr";break;case"norm":if(o="\\|",l="lr",2===n.length){var g=n[1].toTex();"\\text{inf}"===g?g="\\infty":"\\text{-inf}"===g?g="{- \\infty}":"\\text{fro}"===g&&(g="F"),f="_{"+g+"}",n=[n[0]]}break;case"ceil":o=["\\lceil","\\rceil"],l="lr";break;case"floor":o=["\\lfloor","\\rfloor"],l="lr";break;case"round":o=["\\lfloor","\\rceil"],l="lr",2===n.length&&(f="_"+t.addBraces(n[1].toTex()),n=[n[0]]);break;case"inv":f="^{-1}";break;case"transpose":f="^{T}",o=!1;break;case"log":var v="e";2===n.length&&(v=n[1].toTex(),i="\\log_{"+v+"}",n=[n[0]]),"e"===v&&(i="\\ln"),c=!0;break;case"square":f="^{2}";break;case"cube":f="^{3}";break;case"eye":c=!0,o=!1,i+="_";break;case"det":if(e.params[0]instanceof s)return e.params[0].toTex("vmatrix");o="vmatrix",l="be";break;default:c=!0}return null!==p?(o="+"===p||"-"===p,a=new u(p,r.name,n).toTex()):p=", ",null!==o||t.isCurlyFunction(r.name)||(o=!0),a=a||n.map(function(e){return"{"+e.toTex()+"}"}).join(p),h+(c?i:"")+t.addBraces(a,o,l)+f}}])}),e["default"]=math}),define("frontend/libraries/mathAnimationLibrary/dist/vendor/three",["exports"],function(e){"use strict";var t={REVISION:"69"};"object"==typeof module&&(module.exports=t),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:e>0?1:0}),t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.NoShading=0,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.UVMapping=function(){},t.CubeReflectionMapping=function(){},t.CubeRefractionMapping=function(){},t.SphericalReflectionMapping=function(){},t.SphericalRefractionMapping=function(){},t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.UnsignedShort4444Type=1016,t.UnsignedShort5551Type=1017,t.UnsignedShort565Type=1018,t.AlphaFormat=1019,t.RGBFormat=1020,t.RGBAFormat=1021,t.LuminanceFormat=1022,t.LuminanceAlphaFormat=1023,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},t.Color.prototype={constructor:t.Color,r:1,g:1,b:1,set:function(e){return e instanceof t.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(0===t)this.r=this.g=this.b=r;else{var n=function(e,t,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?e+6*(t-e)*r:.5>r?t:2/3>r?e+6*(t-e)*(2/3-r):e},i=.5>=r?r*(1+t):r+t-r*t,a=2*r-i;this.r=n(a,i,e+1/3),this.g=n(a,i,e),this.b=n(a,i,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var r=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){var r=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){var r=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(r[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var r=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(r[1]+r[1]+r[2]+r[2]+r[3]+r[3],16)),this}return/^(\w+)$/i.test(e)?(this.setHex(t.ColorKeywords[e]),this):void 0},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,r,n=e||{h:0,s:0,l:0},i=this.r,a=this.g,o=this.b,s=Math.max(i,a,o),u=Math.min(i,a,o),l=(u+s)/2;if(u===s)t=0,r=0;else{var c=s-u;switch(r=.5>=l?c/(s+u):c/(2-s-u),s){case i:t=(a-o)/c+(o>a?6:0);break;case a:t=(o-i)/c+2;break;case o:t=(i-a)/c+4}t/=6}return n.h=t,n.s=r,n.l=l,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new t.Color).setRGB(this.r,this.g,this.b)}},t.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},t.Quaternion=function(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1},t.Quaternion.prototype={constructor:t.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,r){if(e instanceof t.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(e._x/2),i=Math.cos(e._y/2),a=Math.cos(e._z/2),o=Math.sin(e._x/2),s=Math.sin(e._y/2),u=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=o*i*a+n*s*u,this._y=n*s*a-o*i*u,this._z=n*i*u+o*s*a,this._w=n*i*a-o*s*u):"YXZ"===e.order?(this._x=o*i*a+n*s*u,this._y=n*s*a-o*i*u,this._z=n*i*u-o*s*a,this._w=n*i*a+o*s*u):"ZXY"===e.order?(this._x=o*i*a-n*s*u,this._y=n*s*a+o*i*u,this._z=n*i*u+o*s*a,this._w=n*i*a-o*s*u):"ZYX"===e.order?(this._x=o*i*a-n*s*u,this._y=n*s*a+o*i*u,this._z=n*i*u-o*s*a,this._w=n*i*a+o*s*u):"YZX"===e.order?(this._x=o*i*a+n*s*u,this._y=n*s*a+o*i*u,this._z=n*i*u-o*s*a,this._w=n*i*a-o*s*u):"XZY"===e.order&&(this._x=o*i*a-n*s*u,this._y=n*s*a-o*i*u,this._z=n*i*u+o*s*a,this._w=n*i*a+o*s*u),r!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],u=r[9],l=r[2],c=r[6],h=r[10],f=n+s+h;return f>0?(t=.5/Math.sqrt(f+1),this._w=.25/t,this._x=(c-u)*t,this._y=(a-l)*t,this._z=(o-i)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(c-u)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+l)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(a-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(o-i)/t,this._x=(a+l)/t,this._y=(u+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,r,n=1e-6;return function(i,a){return void 0===e&&(e=new t.Vector3),r=i.dot(a)+1,n>r?(r=0,Math.abs(i.x)>Math.abs(i.z)?e.set(-i.y,i.x,0):e.set(0,-i.z,i.y)):e.crossVectors(i,a),this._x=e.x,this._y=e.y,this._z=e.z,this._w=r,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=r*l+a*o+n*u-i*s,this._y=n*l+a*s+i*o-r*u,this._z=i*l+a*u+r*s-n*o,this._w=a*l-r*o-n*s-i*u,this.onChangeCallback(),this},multiplyVector3:function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,a=this._w,o=a*e._w+r*e._x+n*e._y+i*e._z;if(0>o?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;
var s=Math.acos(o),u=Math.sqrt(1-o*o);if(Math.abs(u)<.001)return this._w=.5*(a+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var l=Math.sin((1-t)*s)/u,c=Math.sin(t*s)/u;return this._w=a*l+this._w*c,this._x=r*l+this._x*c,this._y=n*l+this._y*c,this._z=i*l+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new t.Quaternion(this._x,this._y,this._z,this._w)}},t.Quaternion.slerp=function(e,t,r,n){return r.copy(e).slerp(t,n)},t.Vector2=function(e,t){this.x=e||0,this.y=t||0},t.Vector2.prototype={constructor:t.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(){var e,r;return function(n,i){return void 0===e&&(e=new t.Vector2,r=new t.Vector2),e.set(n,n),r.set(i,i),this.clamp(e,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},clone:function(){return new t.Vector2(this.x,this.y)}},t.Vector3=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0},t.Vector3.prototype={constructor:t.Vector3,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e;return function(r){return r instanceof t.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===e&&(e=new t.Quaternion),this.applyQuaternion(e.setFromEuler(r)),this}}(),applyAxisAngle:function(){var e;return function(r,n){return void 0===e&&(e=new t.Quaternion),this.applyQuaternion(e.setFromAxisAngle(r,n)),this}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n+i[12],this.y=i[1]*t+i[5]*r+i[9]*n+i[13],this.z=i[2]*t+i[6]*r+i[10]*n+i[14],this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*n-o*r,l=s*r+o*t-i*n,c=s*n+i*r-a*t,h=-i*t-a*r-o*n;return this.x=u*s+h*-i+l*-o-c*-a,this.y=l*s+h*-a+c*-i-u*-o,this.z=c*s+h*-o+u*-a-l*-i,this},project:function(){var e;return function(r){return void 0===e&&(e=new t.Matrix4),e.multiplyMatrices(r.projectionMatrix,e.getInverse(r.matrixWorld)),this.applyProjection(e)}}(),unproject:function(){var e;return function(r){return void 0===e&&(e=new t.Matrix4),e.multiplyMatrices(r.matrixWorld,e.getInverse(r.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,r;return function(n,i){return void 0===e&&(e=new t.Vector3,r=new t.Vector3),e.set(n,n,n),r.set(i,i,i),this.clamp(e,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-r*e.z,this.z=r*e.y-n*e.x,this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this},projectOnVector:function(){var e,r;return function(n){return void 0===e&&(e=new t.Vector3),e.copy(n).normalize(),r=this.dot(e),this.copy(e).multiplyScalar(r)}}(),projectOnPlane:function(){var e;return function(r){return void 0===e&&(e=new t.Vector3),e.copy(this).projectOnVector(r),this.sub(e)}}(),reflect:function(){var e;return function(r){return void 0===e&&(e=new t.Vector3),this.sub(e.copy(r).multiplyScalar(2*this.dot(r)))}}(),angleTo:function(e){var r=this.dot(e)/(this.length()*e.length());return Math.acos(t.Math.clamp(r,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},clone:function(){return new t.Vector3(this.x,this.y,this.z)}},t.Vector4=function(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1},t.Vector4.prototype={constructor:t.Vector4,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],h=s[1],f=s[5],p=s[9],d=s[2],m=s[6],g=s[10];if(Math.abs(l-h)<a&&Math.abs(c-d)<a&&Math.abs(p-m)<a){if(Math.abs(l+h)<o&&Math.abs(c+d)<o&&Math.abs(p+m)<o&&Math.abs(u+f+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var v=(u+1)/2,y=(f+1)/2,x=(g+1)/2,b=(l+h)/4,w=(c+d)/4,M=(p+m)/4;return v>y&&v>x?a>v?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(v),n=b/r,i=w/r):y>x?a>y?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(y),r=b/n,i=M/n):a>x?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(x),r=w/i,n=M/i),this.set(r,n,i,t),this}var _=Math.sqrt((m-p)*(m-p)+(c-d)*(c-d)+(h-l)*(h-l));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(c-d)/_,this.z=(h-l)/_,this.w=Math.acos((u+f+g-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,r;return function(n,i){return void 0===e&&(e=new t.Vector4,r=new t.Vector4),e.set(n,n,n,n),r.set(i,i,i,i),this.clamp(e,r)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},clone:function(){return new t.Vector4(this.x,this.y,this.z,this.w)}},t.Euler=function(e,r,n,i){this._x=e||0,this._y=r||0,this._z=n||0,this._order=i||t.Euler.DefaultOrder},t.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],t.Euler.DefaultOrder="XYZ",t.Euler.prototype={constructor:t.Euler,_x:0,_y:0,_z:0,_order:t.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,r){var n=t.Math.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],u=i[1],l=i[5],c=i[9],h=i[2],f=i[6],p=i[10];return r=r||this._order,"XYZ"===r?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(f,l),this._z=0)):"YXZ"===r?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===r?(this._x=Math.asin(n(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===r?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===r?(this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===r?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(f,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+r),this._order=r,this.onChangeCallback(),this},setFromQuaternion:function(e,r,n){var i=t.Math.clamp,a=e.x*e.x,o=e.y*e.y,s=e.z*e.z,u=e.w*e.w;return r=r||this._order,"XYZ"===r?(this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),u-a-o+s),this._y=Math.asin(i(2*(e.x*e.z+e.y*e.w),-1,1)),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u+a-o-s)):"YXZ"===r?(this._x=Math.asin(i(2*(e.x*e.w-e.y*e.z),-1,1)),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u-a-o+s),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u-a+o-s)):"ZXY"===r?(this._x=Math.asin(i(2*(e.x*e.w+e.y*e.z),-1,1)),this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),u-a-o+s),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u-a+o-s)):"ZYX"===r?(this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),u-a-o+s),this._y=Math.asin(i(2*(e.y*e.w-e.x*e.z),-1,1)),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u+a-o-s)):"YZX"===r?(this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),u-a+o-s),this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),u+a-o-s),this._z=Math.asin(i(2*(e.x*e.y+e.z*e.w),-1,1))):"XZY"===r?(this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),u-a+o-s),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u+a-o-s),this._z=Math.asin(i(2*(e.z*e.w-e.x*e.y),-1,1))):console.warn("THREE.Euler: .setFromQuaternion() given unsupported order: "+r),this._order=r,n!==!1&&this.onChangeCallback(),this},reorder:function(){var e=new t.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new t.Euler(this._x,this._y,this._z,this._order)}},t.Line3=function(e,r){this.start=void 0!==e?e:new t.Vector3,this.end=void 0!==r?r:new t.Vector3},t.Line3.prototype={constructor:t.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var r=e||new t.Vector3;return r.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var r=e||new t.Vector3;return r.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,r){var n=r||new t.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new t.Vector3,r=new t.Vector3;return function(n,i){e.subVectors(n,this.start),r.subVectors(this.end,this.start);var a=r.dot(r),o=r.dot(e),s=o/a;return i&&(s=t.Math.clamp(s,0,1)),s}}(),closestPointToPoint:function(e,r,n){var i=this.closestPointToPointParameter(e,r),a=n||new t.Vector3;return this.delta(a).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new t.Line3).copy(this)}},t.Box2=function(e,r){this.min=void 0!==e?e:new t.Vector2(1/0,1/0),this.max=void 0!==r?r:new t.Vector2(-1/0,-1/0)},t.Box2.prototype={constructor:t.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;r>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new t.Vector2;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var r=e||new t.Vector2;return r.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var r=e||new t.Vector2;return r.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e,r){var n=r||new t.Vector2;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,r){var n=r||new t.Vector2;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new t.Vector2;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new t.Box2).copy(this)}},t.Box3=function(e,r){this.min=void 0!==e?e:new t.Vector3(1/0,1/0,1/0),this.max=void 0!==r?r:new t.Vector3(-1/0,-1/0,-1/0)},t.Box3.prototype={constructor:t.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;r>t;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new t.Vector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(){var e=new t.Vector3;return function(r){var n=this;return r.updateMatrixWorld(!0),this.makeEmpty(),r.traverse(function(r){var i=r.geometry;if(void 0!==i)if(i instanceof t.Geometry)for(var a=i.vertices,o=0,s=a.length;s>o;o++)e.copy(a[o]),e.applyMatrix4(r.matrixWorld),n.expandByPoint(e);else if(i instanceof t.BufferGeometry&&void 0!==i.attributes.position)for(var u=i.attributes.position.array,o=0,s=u.length;s>o;o+=3)e.set(u[o],u[o+1],u[o+2]),e.applyMatrix4(r.matrixWorld),n.expandByPoint(e)}),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var r=e||new t.Vector3;return r.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var r=e||new t.Vector3;return r.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,r){var n=r||new t.Vector3;return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,r){var n=r||new t.Vector3;return n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new t.Vector3;return function(t){var r=e.copy(t).clamp(this.min,this.max);return r.sub(t).length()}}(),getBoundingSphere:function(){var e=new t.Vector3;return function(r){var n=r||new t.Sphere;return n.center=this.center(),n.radius=.5*this.size(e).length(),n}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new t.Vector3,new t.Vector3,new t.Vector3,new t.Vector3,new t.Vector3,new t.Vector3,new t.Vector3,new t.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new t.Box3).copy(this)}},t.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},t.Matrix3.prototype={constructor:t.Matrix3,set:function(e,t,r,n,i,a,o,s,u){var l=this.elements;return l[0]=e,l[3]=t,l[6]=r,l[1]=n,l[4]=i,l[7]=a,l[2]=o,l[5]=s,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new t.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,a=r;n>i;i+=3,a+=3)e.x=t[a],e.y=t[a+1],e.z=t[a+2],e.applyMatrix3(this),t[a]=e.x,t[a+1]=e.y,t[a+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-r*i*l+r*o*s+n*i*u-n*a*s},getInverse:function(e,t){var r=e.elements,n=this.elements;n[0]=r[10]*r[5]-r[6]*r[9],n[1]=-r[10]*r[1]+r[2]*r[9],n[2]=r[6]*r[1]-r[2]*r[5],n[3]=-r[10]*r[4]+r[6]*r[8],n[4]=r[10]*r[0]-r[2]*r[8],n[5]=-r[6]*r[0]+r[2]*r[4],n[6]=r[9]*r[4]-r[5]*r[8],n[7]=-r[9]*r[0]+r[1]*r[8],n[8]=r[5]*r[0]-r[1]*r[4];var i=r[0]*n[0]+r[1]*n[3]+r[2]*n[6];if(0===i){var a="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(a);return console.warn(a),this.identity(),this}return this.multiplyScalar(1/i),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new t.Matrix3).fromArray(this.elements)}},t.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},t.Matrix4.prototype={constructor:t.Matrix4,set:function(e,t,r,n,i,a,o,s,u,l,c,h,f,p,d,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=h,g[3]=f,g[7]=p,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractRotation:function(){var e=new t.Vector3;return function(t){var r=this.elements,n=t.elements,i=1/e.set(n[0],n[1],n[2]).length(),a=1/e.set(n[4],n[5],n[6]).length(),o=1/e.set(n[8],n[9],n[10]).length();
return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*a,r[5]=n[5]*a,r[6]=n[6]*a,r[8]=n[8]*o,r[9]=n[9]*o,r[10]=n[10]*o,this}}(),makeRotationFromEuler:function(e){e instanceof t.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,n=e.x,i=e.y,a=e.z,o=Math.cos(n),s=Math.sin(n),u=Math.cos(i),l=Math.sin(i),c=Math.cos(a),h=Math.sin(a);if("XYZ"===e.order){var f=o*c,p=o*h,d=s*c,m=s*h;r[0]=u*c,r[4]=-u*h,r[8]=l,r[1]=p+d*l,r[5]=f-m*l,r[9]=-s*u,r[2]=m-f*l,r[6]=d+p*l,r[10]=o*u}else if("YXZ"===e.order){var g=u*c,v=u*h,y=l*c,x=l*h;r[0]=g+x*s,r[4]=y*s-v,r[8]=o*l,r[1]=o*h,r[5]=o*c,r[9]=-s,r[2]=v*s-y,r[6]=x+g*s,r[10]=o*u}else if("ZXY"===e.order){var g=u*c,v=u*h,y=l*c,x=l*h;r[0]=g-x*s,r[4]=-o*h,r[8]=y+v*s,r[1]=v+y*s,r[5]=o*c,r[9]=x-g*s,r[2]=-o*l,r[6]=s,r[10]=o*u}else if("ZYX"===e.order){var f=o*c,p=o*h,d=s*c,m=s*h;r[0]=u*c,r[4]=d*l-p,r[8]=f*l+m,r[1]=u*h,r[5]=m*l+f,r[9]=p*l-d,r[2]=-l,r[6]=s*u,r[10]=o*u}else if("YZX"===e.order){var b=o*u,w=o*l,M=s*u,_=s*l;r[0]=u*c,r[4]=_-b*h,r[8]=M*h+w,r[1]=h,r[5]=o*c,r[9]=-s*c,r[2]=-l*c,r[6]=w*h+M,r[10]=b-_*h}else if("XZY"===e.order){var b=o*u,w=o*l,M=s*u,_=s*l;r[0]=u*c,r[4]=-h,r[8]=l*c,r[1]=b*h+_,r[5]=o*c,r[9]=w*h-M,r[2]=M*h-w,r[6]=s*c,r[10]=_*h+b}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,a=e.w,o=r+r,s=n+n,u=i+i,l=r*o,c=r*s,h=r*u,f=n*s,p=n*u,d=i*u,m=a*o,g=a*s,v=a*u;return t[0]=1-(f+d),t[4]=c-v,t[8]=h+g,t[1]=c+v,t[5]=1-(l+d),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(l+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new t.Vector3,r=new t.Vector3,n=new t.Vector3;return function(t,i,a){var o=this.elements;return n.subVectors(t,i).normalize(),0===n.length()&&(n.z=1),e.crossVectors(a,n).normalize(),0===e.length()&&(n.x+=1e-4,e.crossVectors(a,n).normalize()),r.crossVectors(n,e),o[0]=e.x,o[4]=r.x,o[8]=n.x,o[1]=e.y,o[5]=r.y,o[9]=n.y,o[2]=e.z,o[6]=r.z,o[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[4],s=r[8],u=r[12],l=r[1],c=r[5],h=r[9],f=r[13],p=r[2],d=r[6],m=r[10],g=r[14],v=r[3],y=r[7],x=r[11],b=r[15],w=n[0],M=n[4],_=n[8],T=n[12],E=n[1],S=n[5],C=n[9],A=n[13],N=n[2],R=n[6],L=n[10],D=n[14],P=n[3],I=n[7],F=n[11],U=n[15];return i[0]=a*w+o*E+s*N+u*P,i[4]=a*M+o*S+s*R+u*I,i[8]=a*_+o*C+s*L+u*F,i[12]=a*T+o*A+s*D+u*U,i[1]=l*w+c*E+h*N+f*P,i[5]=l*M+c*S+h*R+f*I,i[9]=l*_+c*C+h*L+f*F,i[13]=l*T+c*A+h*D+f*U,i[2]=p*w+d*E+m*N+g*P,i[6]=p*M+d*S+m*R+g*I,i[10]=p*_+d*C+m*L+g*F,i[14]=p*T+d*A+m*D+g*U,i[3]=v*w+y*E+x*N+b*P,i[7]=v*M+y*S+x*R+b*I,i[11]=v*_+y*C+x*L+b*F,i[15]=v*T+y*A+x*D+b*U,this},multiplyToArray:function(e,t,r){var n=this.elements;return this.multiplyMatrices(e,t),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new t.Vector3;return function(t,r,n){void 0===r&&(r=0),void 0===n&&(n=t.length);for(var i=0,a=r;n>i;i+=3,a+=3)e.x=t[a],e.y=t[a+1],e.z=t[a+2],e.applyMatrix4(this),t[a]=e.x,t[a+1]=e.y,t[a+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14],p=e[3],d=e[7],m=e[11],g=e[15];return p*(+i*s*c-n*u*c-i*o*h+r*u*h+n*o*f-r*s*f)+d*(+t*s*f-t*u*h+i*a*h-n*a*f+n*u*l-i*s*l)+m*(+t*u*c-t*o*f-i*a*c+r*a*f+i*o*l-r*u*l)+g*(-n*o*l-t*s*c+t*o*h+n*a*c-r*a*h+r*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e},getPosition:function(){var e=new t.Vector3;return function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],a=n[4],o=n[8],s=n[12],u=n[1],l=n[5],c=n[9],h=n[13],f=n[2],p=n[6],d=n[10],m=n[14],g=n[3],v=n[7],y=n[11],x=n[15];r[0]=c*m*v-h*d*v+h*p*y-l*m*y-c*p*x+l*d*x,r[4]=s*d*v-o*m*v-s*p*y+a*m*y+o*p*x-a*d*x,r[8]=o*h*v-s*c*v+s*l*y-a*h*y-o*l*x+a*c*x,r[12]=s*c*p-o*h*p-s*l*d+a*h*d+o*l*m-a*c*m,r[1]=h*d*g-c*m*g-h*f*y+u*m*y+c*f*x-u*d*x,r[5]=o*m*g-s*d*g+s*f*y-i*m*y-o*f*x+i*d*x,r[9]=s*c*g-o*h*g-s*u*y+i*h*y+o*u*x-i*c*x,r[13]=o*h*f-s*c*f+s*u*d-i*h*d-o*u*m+i*c*m,r[2]=l*m*g-h*p*g+h*f*v-u*m*v-l*f*x+u*p*x,r[6]=s*p*g-a*m*g-s*f*v+i*m*v+a*f*x-i*p*x,r[10]=a*h*g-s*l*g+s*u*v-i*h*v-a*u*x+i*l*x,r[14]=s*l*f-a*h*f-s*u*p+i*h*p+a*u*m-i*l*m,r[3]=c*p*g-l*d*g-c*f*v+u*d*v+l*f*y-u*p*y,r[7]=a*d*g-o*p*g+o*f*v-i*d*v-a*f*y+i*p*y,r[11]=o*l*g-a*c*g-o*u*v+i*c*v+a*u*y-i*l*y,r[15]=a*c*f-o*l*f+o*u*p-i*c*p-a*u*d+i*l*d;var b=i*r[0]+u*r[4]+f*r[8]+g*r[12];if(0==b){var w="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(w);return console.warn(w),this.identity(),this}return this.multiplyScalar(1/b),this},translate:function(){console.warn("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.warn("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.warn("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.warn("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(r,n)))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+r,u*o-n*s,u*s+n*o,0,u*o+n*s,l*o+r,l*s-n*a,0,u*s-n*o,l*s+n*a,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:function(){var e=new t.Vector3,r=new t.Matrix4;return function(t,n,i){var a=this.elements,o=e.set(a[0],a[1],a[2]).length(),s=e.set(a[4],a[5],a[6]).length(),u=e.set(a[8],a[9],a[10]).length(),l=this.determinant();0>l&&(o=-o),t.x=a[12],t.y=a[13],t.z=a[14],r.elements.set(this.elements);var c=1/o,h=1/s,f=1/u;return r.elements[0]*=c,r.elements[1]*=c,r.elements[2]*=c,r.elements[4]*=h,r.elements[5]*=h,r.elements[6]*=h,r.elements[8]*=f,r.elements[9]*=f,r.elements[10]*=f,n.setFromRotationMatrix(r),i.x=o,i.y=s,i.z=u,this}}(),makeFrustum:function(e,t,r,n,i,a){var o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),h=-(a+i)/(a-i),f=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,r,n,i){var a=n*Math.tan(t.Math.degToRad(.5*e)),o=-a,s=o*r,u=a*r;return this.makeFrustum(s,u,o,a,n,i)},makeOrthographic:function(e,t,r,n,i,a){var o=this.elements,s=t-e,u=r-n,l=a-i,c=(t+e)/s,h=(r+n)/u,f=(a+i)/l;return o[0]=2/s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2/u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2/l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new t.Matrix4).fromArray(this.elements)}},t.Ray=function(e,r){this.origin=void 0!==e?e:new t.Vector3,this.direction=void 0!==r?r:new t.Vector3},t.Ray.prototype={constructor:t.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,r){var n=r||new t.Vector3;return n.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new t.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,r){var n=r||new t.Vector3;n.subVectors(e,this.origin);var i=n.dot(this.direction);return 0>i?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var e=new t.Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:function(e,t,r,n){var i,a,o,s,u=e.clone().add(t).multiplyScalar(.5),l=t.clone().sub(e).normalize(),c=.5*e.distanceTo(t),h=this.origin.clone().sub(u),f=-this.direction.dot(l),p=h.dot(this.direction),d=-h.dot(l),m=h.lengthSq(),g=Math.abs(1-f*f);if(g>=0)if(i=f*d-p,a=f*p-d,s=c*g,i>=0)if(a>=-s)if(s>=a){var v=1/g;i*=v,a*=v,o=i*(i+f*a+2*p)+a*(f*i+a+2*d)+m}else a=c,i=Math.max(0,-(f*a+p)),o=-i*i+a*(a+2*d)+m;else a=-c,i=Math.max(0,-(f*a+p)),o=-i*i+a*(a+2*d)+m;else-s>=a?(i=Math.max(0,-(-f*c+p)),a=i>0?-c:Math.min(Math.max(-c,-d),c),o=-i*i+a*(a+2*d)+m):s>=a?(i=0,a=Math.min(Math.max(-c,-d),c),o=a*(a+2*d)+m):(i=Math.max(0,-(f*c+p)),a=i>0?c:Math.min(Math.max(-c,-d),c),o=-i*i+a*(a+2*d)+m);else a=f>0?-c:c,i=Math.max(0,-(f*a+p)),o=-i*i+a*(a+2*d)+m;return r&&r.copy(this.direction.clone().multiplyScalar(i).add(this.origin)),n&&n.copy(l.clone().multiplyScalar(a).add(u)),o},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new t.Vector3;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,a=t.radius*t.radius;if(i>a)return null;var o=Math.sqrt(a-i),s=n-o,u=n+o;return 0>s&&0>u?null:0>s?this.at(u,r):this.at(s,r)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return!0;var r=e.normal.dot(this.direction);return 0>r*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},isIntersectionBox:function(){var e=new t.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var r,n,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(r=(e.min.x-h.x)*u,n=(e.max.x-h.x)*u):(r=(e.max.x-h.x)*u,n=(e.min.x-h.x)*u),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),r>a||i>n?null:((i>r||r!==r)&&(r=i),(n>a||n!==n)&&(n=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),r>s||o>n?null:((o>r||r!==r)&&(r=o),(n>s||n!==n)&&(n=s),0>n?null:this.at(r>=0?r:n,t)))},intersectTriangle:function(){var e=new t.Vector3,r=new t.Vector3,n=new t.Vector3,i=new t.Vector3;return function(t,a,o,s,u){r.subVectors(a,t),n.subVectors(o,t),i.crossVectors(r,n);var l,c=this.direction.dot(i);if(c>0){if(s)return null;l=1}else{if(!(0>c))return null;l=-1,c=-c}e.subVectors(this.origin,t);var h=l*this.direction.dot(n.crossVectors(e,n));if(0>h)return null;var f=l*this.direction.dot(r.cross(e));if(0>f)return null;if(h+f>c)return null;var p=-l*e.dot(i);return 0>p?null:this.at(p/c,u)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new t.Ray).copy(this)}},t.Sphere=function(e,r){this.center=void 0!==e?e:new t.Vector3,this.radius=void 0!==r?r:0},t.Sphere.prototype={constructor:t.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new t.Box3;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).center(n);for(var i=0,a=0,o=t.length;o>a;a++)i=Math.max(i,n.distanceToSquared(t[a]));return this.radius=Math.sqrt(i),this}}(),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,r){var n=this.center.distanceToSquared(e),i=r||new t.Vector3;return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(e){var r=e||new t.Box3;return r.set(this.center,this.center),r.expandByScalar(this.radius),r},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new t.Sphere).copy(this)}},t.Frustum=function(e,r,n,i,a,o){this.planes=[void 0!==e?e:new t.Plane,void 0!==r?r:new t.Plane,void 0!==n?n:new t.Plane,void 0!==i?i:new t.Plane,void 0!==a?a:new t.Plane,void 0!==o?o:new t.Plane]},t.Frustum.prototype={constructor:t.Frustum,set:function(e,t,r,n,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},copy:function(e){for(var t=this.planes,r=0;6>r;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],l=r[6],c=r[7],h=r[8],f=r[9],p=r[10],d=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(o-n,c-s,d-h,y-m).normalize(),t[1].setComponents(o+n,c+s,d+h,y+m).normalize(),t[2].setComponents(o+i,c+u,d+f,y+g).normalize(),t[3].setComponents(o-i,c-u,d-f,y-g).normalize(),t[4].setComponents(o-a,c-l,d-p,y-v).normalize(),t[5].setComponents(o+a,c+l,d+p,y+v).normalize(),this},intersectsObject:function(){var e=new t.Sphere;return function(t){var r=t.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere),e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;6>i;i++){var a=t[i].distanceToPoint(r);if(n>a)return!1}return!0},intersectsBox:function(){var e=new t.Vector3,r=new t.Vector3;return function(t){for(var n=this.planes,i=0;6>i;i++){var a=n[i];e.x=a.normal.x>0?t.min.x:t.max.x,r.x=a.normal.x>0?t.max.x:t.min.x,e.y=a.normal.y>0?t.min.y:t.max.y,r.y=a.normal.y>0?t.max.y:t.min.y,e.z=a.normal.z>0?t.min.z:t.max.z,r.z=a.normal.z>0?t.max.z:t.min.z;var o=a.distanceToPoint(e),s=a.distanceToPoint(r);if(0>o&&0>s)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;6>r;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new t.Frustum).copy(this)}},t.Plane=function(e,r){this.normal=void 0!==e?e:new t.Vector3(1,0,0),this.constant=void 0!==r?r:0},t.Plane.prototype={constructor:t.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new t.Vector3,r=new t.Vector3;return function(t,n,i){var a=e.subVectors(i,n).cross(r.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,t),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,r){var n=this.distanceToPoint(e),i=r||new t.Vector3;return i.copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return 0>t&&r>0||0>r&&t>0},intersectLine:function(){var e=new t.Vector3;return function(r,n){var i=n||new t.Vector3,a=r.delta(e),o=this.normal.dot(a);if(0==o)return 0==this.distanceToPoint(r.start)?i.copy(r.start):void 0;var s=-(r.start.dot(this.normal)+this.constant)/o;return 0>s||s>1?void 0:i.copy(a).multiplyScalar(s).add(r.start)}}(),coplanarPoint:function(e){var r=e||new t.Vector3;return r.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new t.Vector3,r=new t.Vector3,n=new t.Matrix3;return function(t,i){var a=i||n.getNormalMatrix(t),o=e.copy(this.normal).applyMatrix3(a),s=this.coplanarPoint(r);return s.applyMatrix4(t),this.setFromNormalAndCoplanarPoint(o,s),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new t.Plane).copy(this)}},t.Math={generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),n=0;return function(){for(var i=0;36>i;i++)8==i||13==i||18==i||23==i?r[i]="-":14==i?r[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,r[i]=t[19==i?3&e|8:e]);return r.join("")}}(),clamp:function(e,t,r){return t>e?t:e>r?r:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},smoothstep:function(e,t,r){return t>=e?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))},smootherstep:function(e,t,r){return t>=e?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e}},t.Spline=function(e){function r(e,t,r,n,i,a,o){var s=.5*(r-e),u=.5*(n-t);return(2*(t-r)+s+u)*o+(-3*(t-r)-2*s-u)*a+s*i+t}this.points=e;var n,i,a,o,s,u,l,c,h,f=[],p={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return n=(this.points.length-1)*e,i=Math.floor(n),a=n-i,f[0]=0===i?i:i-1,f[1]=i,f[2]=i>this.points.length-2?this.points.length-1:i+1,f[3]=i>this.points.length-3?this.points.length-1:i+2,u=this.points[f[0]],l=this.points[f[1]],c=this.points[f[2]],h=this.points[f[3]],o=a*a,s=a*o,p.x=r(u.x,l.x,c.x,h.x,a,o,s),p.y=r(u.y,l.y,c.y,h.y,a,o,s),p.z=r(u.z,l.z,c.z,h.z,a,o,s),p},this.getControlPointsArray=function(){var e,t,r=this.points.length,n=[];for(e=0;r>e;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var r,n,i,a,o=0,s=0,u=0,l=new t.Vector3,c=new t.Vector3,h=[],f=0;for(h[0]=0,e||(e=100),i=this.points.length*e,l.copy(this.points[0]),r=1;i>r;r++)n=r/i,a=this.getPoint(n),c.copy(a),f+=c.distanceTo(l),l.copy(a),o=(this.points.length-1)*n,s=Math.floor(o),s!=u&&(h[s]=f,u=s);return h[h.length]=f,{chunks:h,total:f}},this.reparametrizeByArcLength=function(e){var r,n,i,a,o,s,u,l,c=[],h=new t.Vector3,f=this.getLength();for(c.push(h.copy(this.points[0]).clone()),r=1;r<this.points.length;r++){for(s=f.chunks[r]-f.chunks[r-1],u=Math.ceil(e*s/f.total),a=(r-1)/(this.points.length-1),o=r/(this.points.length-1),n=1;u-1>n;n++)i=a+n*(1/u)*(o-a),l=this.getPoint(i),c.push(h.copy(l).clone());c.push(h.copy(this.points[r]).clone())}this.points=c}},t.Triangle=function(e,r,n){this.a=void 0!==e?e:new t.Vector3,this.b=void 0!==r?r:new t.Vector3,this.c=void 0!==n?n:new t.Vector3},t.Triangle.normal=function(){var e=new t.Vector3;return function(r,n,i,a){var o=a||new t.Vector3;o.subVectors(i,n),e.subVectors(r,n),o.cross(e);var s=o.lengthSq();return s>0?o.multiplyScalar(1/Math.sqrt(s)):o.set(0,0,0)}}(),t.Triangle.barycoordFromPoint=function(){var e=new t.Vector3,r=new t.Vector3,n=new t.Vector3;return function(i,a,o,s,u){e.subVectors(s,a),r.subVectors(o,a),n.subVectors(i,a);var l=e.dot(e),c=e.dot(r),h=e.dot(n),f=r.dot(r),p=r.dot(n),d=l*f-c*c,m=u||new t.Vector3;if(0==d)return m.set(-2,-1,-1);var g=1/d,v=(f*h-c*p)*g,y=(l*p-c*h)*g;return m.set(1-v-y,y,v)}}(),t.Triangle.containsPoint=function(){var e=new t.Vector3;return function(r,n,i,a){var o=t.Triangle.barycoordFromPoint(r,n,i,a,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),t.Triangle.prototype={constructor:t.Triangle,set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new t.Vector3,r=new t.Vector3;return function(){return e.subVectors(this.c,this.b),r.subVectors(this.a,this.b),.5*e.cross(r).length()}}(),midpoint:function(e){var r=e||new t.Vector3;return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return t.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var r=e||new t.Plane;return r.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,r){return t.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,r)},containsPoint:function(e){return t.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new t.Triangle).copy(this)}},t.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},t.Clock.prototype={constructor:t.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},t.EventDispatcher=function(){},t.EventDispatcher.prototype={constructor:t.EventDispatcher,apply:function(e){e.addEventListener=t.EventDispatcher.prototype.addEventListener,e.hasEventListener=t.EventDispatcher.prototype.hasEventListener,e.removeEventListener=t.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=t.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners,n=r[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,r=t[e.type];if(void 0!==r){e.target=this;for(var n=[],i=r.length,a=0;i>a;a++)n[a]=r[a];for(var a=0;i>a;a++)n[a].call(this,e)}}}},function(e){e.Raycaster=function(t,r,n,i){this.ray=new e.Ray(t,r),this.near=n||0,this.far=i||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var t=function(e,t){return e.distance-t.distance},r=function(e,t,n,i){if(e.raycast(t,n),i===!0)for(var a=e.children,o=0,s=a.length;s>o;o++)r(a[o],t,n,!0)};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,linePrecision:1,set:function(e,t){this.ray.set(e,t)},intersectObject:function(e,n){var i=[];return r(e,this,i,n),i.sort(t),i},intersectObjects:function(e,n){var i=[];if(e instanceof Array==!1)return console.log("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var a=0,o=e.length;o>a;a++)r(e[a],this,i,n);return i.sort(t),i}}}(t),t.Object3D=function(){Object.defineProperty(this,"id",{value:t.Object3DIdCount++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=t.Object3D.DefaultUp.clone();var e=new t.Vector3,r=new t.Euler,n=new t.Quaternion,i=new t.Vector3(1,1,1),a=function(){n.setFromEuler(r,!1)},o=function(){r.setFromQuaternion(n,void 0,!1)};r.onChange(a),n.onChange(o),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:r},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i}}),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new t.Matrix4,this.matrixWorld=new t.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},t.Object3D.DefaultUp=new t.Vector3(0,1,0),t.Object3D.prototype={constructor:t.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new t.Quaternion;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new t.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new t.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new t.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new t.Vector3;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new t.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new t.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new t.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new t.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new t.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return e===this?(console.error("THREE.Object3D.add:",e,"can't be added as a child of itself."),this):(e instanceof t.Object3D?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add:",e,"is not an instance of THREE.Object3D."),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var r=this.children.indexOf(e);-1!==r&&(e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(r,1))},getChildByName:function(e,t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e,t)},getObjectById:function(e,t){if(this.id===e)return this;for(var r=0,n=this.children.length;n>r;r++){var i=this.children[r],a=i.getObjectById(e,t);if(void 0!==a)return a}return void 0},getObjectByName:function(e,t){if(this.name===e)return this;for(var r=0,n=this.children.length;n>r;r++){var i=this.children[r],a=i.getObjectByName(e,t);if(void 0!==a)return a}return void 0},getWorldPosition:function(e){var r=e||new t.Vector3;return this.updateMatrixWorld(!0),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new t.Vector3,r=new t.Vector3;return function(n){var i=n||new t.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,i,r),i}}(),getWorldRotation:function(){var e=new t.Quaternion;return function(r){var n=r||new t.Euler;return this.getWorldQuaternion(e),n.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new t.Vector3,r=new t.Quaternion;return function(n){var i=n||new t.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,r,i),i}}(),getWorldDirection:function(){var e=new t.Quaternion;return function(r){var n=r||new t.Vector3;return this.getWorldQuaternion(e),n.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,r=this.children.length;r>t;t++)this.children[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);
for(var t=0,r=this.children.length;r>t;t++)this.children[t].traverseVisible(e)}},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,r=this.children.length;r>t;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},r={},n=function(t){if(void 0===e.geometries&&(e.geometries=[]),void 0===r[t.uuid]){var n=t.toJSON();delete n.metadata,r[t.uuid]=n,e.geometries.push(n)}return t.uuid},i={},a=function(t){if(void 0===e.materials&&(e.materials=[]),void 0===i[t.uuid]){var r=t.toJSON();delete r.metadata,i[t.uuid]=r,e.materials.push(r)}return t.uuid},o=function(e){var r={};if(r.uuid=e.uuid,r.type=e.type,""!==e.name&&(r.name=e.name),"{}"!==JSON.stringify(e.userData)&&(r.userData=e.userData),e.visible!==!0&&(r.visible=e.visible),e instanceof t.PerspectiveCamera?(r.fov=e.fov,r.aspect=e.aspect,r.near=e.near,r.far=e.far):e instanceof t.OrthographicCamera?(r.left=e.left,r.right=e.right,r.top=e.top,r.bottom=e.bottom,r.near=e.near,r.far=e.far):e instanceof t.AmbientLight?r.color=e.color.getHex():e instanceof t.DirectionalLight?(r.color=e.color.getHex(),r.intensity=e.intensity):e instanceof t.PointLight?(r.color=e.color.getHex(),r.intensity=e.intensity,r.distance=e.distance):e instanceof t.SpotLight?(r.color=e.color.getHex(),r.intensity=e.intensity,r.distance=e.distance,r.angle=e.angle,r.exponent=e.exponent):e instanceof t.HemisphereLight?(r.color=e.color.getHex(),r.groundColor=e.groundColor.getHex()):e instanceof t.Mesh?(r.geometry=n(e.geometry),r.material=a(e.material)):e instanceof t.Line?(r.geometry=n(e.geometry),r.material=a(e.material)):e instanceof t.Sprite&&(r.material=a(e.material)),r.matrix=e.matrix.toArray(),e.children.length>0){r.children=[];for(var i=0;i<e.children.length;i++)r.children.push(o(e.children[i]))}return r};return e.object=o(this),e},clone:function(e,r){if(void 0===e&&(e=new t.Object3D),void 0===r&&(r=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.renderDepth=this.renderDepth,e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),r===!0)for(var n=0;n<this.children.length;n++){var i=this.children[n];e.add(i.clone())}return e}},t.EventDispatcher.prototype.apply(t.Object3D.prototype),t.Object3DIdCount=0,t.Projector=function(){console.warn("THREE.Projector has been moved to /examples/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() has been removed.")}},t.Face3=function(e,r,n,i,a,o){this.a=e,this.b=r,this.c=n,this.normal=i instanceof t.Vector3?i:new t.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=a instanceof t.Color?a:new t.Color,this.vertexColors=a instanceof Array?a:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0},t.Face3.prototype={constructor:t.Face3,clone:function(){var e=new t.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.materialIndex=this.materialIndex;for(var r=0,n=this.vertexNormals.length;n>r;r++)e.vertexNormals[r]=this.vertexNormals[r].clone();for(var r=0,n=this.vertexColors.length;n>r;r++)e.vertexColors[r]=this.vertexColors[r].clone();for(var r=0,n=this.vertexTangents.length;n>r;r++)e.vertexTangents[r]=this.vertexTangents[r].clone();return e}},t.Face4=function(e,r,n,i,a,o,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new t.Face3(e,r,n,a,o,s)},t.BufferAttribute=function(e,t){this.array=e,this.itemSize=t,this.needsUpdate=!1},t.BufferAttribute.prototype={constructor:t.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;i>n;n++)this.array[e+n]=t.array[r+n]},set:function(e){return this.array.set(e),this},setX:function(e,t){return this.array[e*this.itemSize]=t,this},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},clone:function(){return new t.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},t.Int8Attribute=function(e,r){return console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Uint8Attribute=function(e,r){return console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Uint8ClampedAttribute=function(e,r){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Int16Attribute=function(e,r){return console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Uint16Attribute=function(e,r){return console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Int32Attribute=function(e,r){return console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Uint32Attribute=function(e,r){return console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Float32Attribute=function(e,r){return console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.Float64Attribute=function(e,r){return console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new t.BufferAttribute(e,r)},t.BufferGeometry=function(){Object.defineProperty(this,"id",{value:t.GeometryIdCount++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},t.BufferGeometry.prototype={constructor:t.BufferGeometry,addAttribute:function(e,r){return r instanceof t.BufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[e]={array:arguments[1],itemSize:arguments[2]})):(this.attributes[e]=r,void(this.attributesKeys=Object.keys(this.attributes)))},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,r){this.drawcalls.push({start:e,count:t,index:void 0!==r?r:0})},applyMatrix:function(e){var r=this.attributes.position;void 0!==r&&(e.applyToVector3Array(r.array),r.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new t.Matrix3).getNormalMatrix(e);i.applyToVector3Array(n.array),n.needsUpdate=!0}},center:function(){},fromGeometry:function(e,r){r=r||{vertexColors:t.NoColors};var n=e.vertices,i=e.faces,a=e.faceVertexUvs,o=r.vertexColors,s=a[0].length>0,u=3==i[0].vertexNormals.length,l=new Float32Array(3*i.length*3);this.addAttribute("position",new t.BufferAttribute(l,3));var c=new Float32Array(3*i.length*3);if(this.addAttribute("normal",new t.BufferAttribute(c,3)),o!==t.NoColors){var h=new Float32Array(3*i.length*3);this.addAttribute("color",new t.BufferAttribute(h,3))}if(s===!0){var f=new Float32Array(3*i.length*2);this.addAttribute("uv",new t.BufferAttribute(f,2))}for(var p=0,d=0,m=0;p<i.length;p++,d+=6,m+=9){var g=i[p],v=n[g.a],y=n[g.b],x=n[g.c];if(l[m]=v.x,l[m+1]=v.y,l[m+2]=v.z,l[m+3]=y.x,l[m+4]=y.y,l[m+5]=y.z,l[m+6]=x.x,l[m+7]=x.y,l[m+8]=x.z,u===!0){var b=g.vertexNormals[0],w=g.vertexNormals[1],M=g.vertexNormals[2];c[m]=b.x,c[m+1]=b.y,c[m+2]=b.z,c[m+3]=w.x,c[m+4]=w.y,c[m+5]=w.z,c[m+6]=M.x,c[m+7]=M.y,c[m+8]=M.z}else{var _=g.normal;c[m]=_.x,c[m+1]=_.y,c[m+2]=_.z,c[m+3]=_.x,c[m+4]=_.y,c[m+5]=_.z,c[m+6]=_.x,c[m+7]=_.y,c[m+8]=_.z}if(o===t.FaceColors){var T=g.color;h[m]=T.r,h[m+1]=T.g,h[m+2]=T.b,h[m+3]=T.r,h[m+4]=T.g,h[m+5]=T.b,h[m+6]=T.r,h[m+7]=T.g,h[m+8]=T.b}else if(o===t.VertexColors){var E=g.vertexColors[0],S=g.vertexColors[1],C=g.vertexColors[2];h[m]=E.r,h[m+1]=E.g,h[m+2]=E.b,h[m+3]=S.r,h[m+4]=S.g,h[m+5]=S.b,h[m+6]=C.r,h[m+7]=C.g,h[m+8]=C.b}if(s===!0){var A=a[0][p][0],N=a[0][p][1],R=a[0][p][2];f[d]=A.x,f[d+1]=A.y,f[d+2]=N.x,f[d+3]=N.y,f[d+4]=R.x,f[d+5]=R.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var e=new t.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new t.Box3);var r=this.attributes.position.array;if(r){var n=this.boundingBox;n.makeEmpty();for(var i=0,a=r.length;a>i;i+=3)e.set(r[i],r[i+1],r[i+2]),n.expandByPoint(e)}(void 0===r||0===r.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var e=new t.Box3,r=new t.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new t.Sphere);var n=this.attributes.position.array;if(n){e.makeEmpty();for(var i=this.boundingSphere.center,a=0,o=n.length;o>a;a+=3)r.set(n[a],n[a+1],n[a+2]),e.expandByPoint(r);e.center(i);for(var s=0,a=0,o=n.length;o>a;a+=3)r.set(n[a],n[a+1],n[a+2]),s=Math.max(s,i.distanceToSquared(r));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.attributes;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new t.BufferAttribute(new Float32Array(r.length),3));else for(var n=e.normal.array,i=0,a=n.length;a>i;i++)n[i]=0;var o,s,u,n=e.normal.array,l=new t.Vector3,c=new t.Vector3,h=new t.Vector3,f=new t.Vector3,p=new t.Vector3;if(e.index)for(var d=e.index.array,m=this.offsets.length>0?this.offsets:[{start:0,count:d.length,index:0}],g=0,v=m.length;v>g;++g)for(var y=m[g].start,x=m[g].count,b=m[g].index,i=y,a=y+x;a>i;i+=3)o=3*(b+d[i]),s=3*(b+d[i+1]),u=3*(b+d[i+2]),l.fromArray(r,o),c.fromArray(r,s),h.fromArray(r,u),f.subVectors(h,c),p.subVectors(l,c),f.cross(p),n[o]+=f.x,n[o+1]+=f.y,n[o+2]+=f.z,n[s]+=f.x,n[s+1]+=f.y,n[s+2]+=f.z,n[u]+=f.x,n[u+1]+=f.y,n[u+2]+=f.z;else for(var i=0,a=r.length;a>i;i+=9)l.fromArray(r,i),c.fromArray(r,i+3),h.fromArray(r,i+6),f.subVectors(h,c),p.subVectors(l,c),f.cross(p),n[i]=f.x,n[i+1]=f.y,n[i+2]=f.z,n[i+3]=f.x,n[i+4]=f.y,n[i+5]=f.z,n[i+6]=f.x,n[i+7]=f.y,n[i+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){function e(e,t,r){R.fromArray(i,3*e),L.fromArray(i,3*t),D.fromArray(i,3*r),P.fromArray(o,2*e),I.fromArray(o,2*t),F.fromArray(o,2*r),f=L.x-R.x,p=D.x-R.x,d=L.y-R.y,m=D.y-R.y,g=L.z-R.z,v=D.z-R.z,y=I.x-P.x,x=F.x-P.x,b=I.y-P.y,w=F.y-P.y,M=1/(y*w-x*b),U.set((w*f-b*p)*M,(w*d-b*m)*M,(w*g-b*v)*M),O.set((y*p-x*f)*M,(y*m-x*d)*M,(y*v-x*g)*M),l[e].add(U),l[t].add(U),l[r].add(U),c[e].add(O),c[t].add(O),c[r].add(O)}function r(e){X.fromArray(a,3*e),Y.copy(X),G=l[e],j.copy(G),j.sub(X.multiplyScalar(X.dot(G))).normalize(),W.crossVectors(Y,G),H=W.dot(c[e]),q=0>H?-1:1,u[4*e]=j.x,u[4*e+1]=j.y,u[4*e+2]=j.z,u[4*e+3]=q}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var n=this.attributes.index.array,i=this.attributes.position.array,a=this.attributes.normal.array,o=this.attributes.uv.array,s=i.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new t.BufferAttribute(new Float32Array(4*s),4));for(var u=this.attributes.tangent.array,l=[],c=[],h=0;s>h;h++)l[h]=new t.Vector3,c[h]=new t.Vector3;var f,p,d,m,g,v,y,x,b,w,M,_,T,E,S,C,A,N,R=new t.Vector3,L=new t.Vector3,D=new t.Vector3,P=new t.Vector2,I=new t.Vector2,F=new t.Vector2,U=new t.Vector3,O=new t.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,n.length,0);var B=this.drawcalls;for(E=0,S=B.length;S>E;++E){var V=B[E].start,k=B[E].count,z=B[E].index;for(_=V,T=V+k;T>_;_+=3)C=z+n[_],A=z+n[_+1],N=z+n[_+2],e(C,A,N)}var q,G,H,j=new t.Vector3,W=new t.Vector3,X=new t.Vector3,Y=new t.Vector3;for(E=0,S=B.length;S>E;++E){var V=B[E].start,k=B[E].count,z=B[E].index;for(_=V,T=V+k;T>_;_+=3)C=z+n[_],A=z+n[_+1],N=z+n[_+2],r(C),r(A),r(N)}},computeOffsets:function(e){var t=e;void 0===e&&(t=65535);for(var r=(Date.now(),this.attributes.index.array),n=this.attributes.position.array,i=(n.length/3,r.length/3),a=new Uint16Array(r.length),o=0,s=0,u=[{start:0,count:0,index:0}],l=u[0],c=0,h=0,f=new Int32Array(6),p=new Int32Array(n.length),d=new Int32Array(n.length),m=0;m<n.length;m++)p[m]=-1,d[m]=-1;for(var g=0;i>g;g++){h=0;for(var v=0;3>v;v++){var y=r[3*g+v];-1==p[y]?(f[2*v]=y,f[2*v+1]=-1,h++):p[y]<l.index?(f[2*v]=y,f[2*v+1]=-1,c++):(f[2*v]=y,f[2*v+1]=p[y])}var x=s+h;if(x>l.index+t){var b={start:o,count:0,index:s};u.push(b),l=b;for(var w=0;6>w;w+=2){var M=f[w+1];M>-1&&M<l.index&&(f[w+1]=-1)}}for(var w=0;6>w;w+=2){var y=f[w],M=f[w+1];-1===M&&(M=s++),p[y]=M,d[M]=y,a[o++]=M-l.index,l.count++}}return this.reorderBuffers(a,d,s),this.offsets=u,u},merge:function(){console.log("BufferGeometry.merge(): TODO")},normalizeNormals:function(){for(var e,t,r,n,i=this.attributes.normal.array,a=0,o=i.length;o>a;a+=3)e=i[a],t=i[a+1],r=i[a+2],n=1/Math.sqrt(e*e+t*t+r*r),i[a]*=n,i[a+1]*=n,i[a+2]*=n},reorderBuffers:function(e,t,r){var n={};for(var i in this.attributes)if("index"!=i){var a=this.attributes[i].array;n[i]=new a.constructor(this.attributes[i].itemSize*r)}for(var o=0;r>o;o++){var s=t[o];for(var i in this.attributes)if("index"!=i)for(var u=this.attributes[i].array,l=this.attributes[i].itemSize,c=n[i],h=0;l>h;h++)c[o*l+h]=u[s*l+h]}this.attributes.index.array=e;for(var i in this.attributes)"index"!=i&&(this.attributes[i].array=n[i],this.attributes[i].numItems=this.attributes[i].itemSize*r)},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},t=this.attributes,r=this.offsets,n=this.boundingSphere;for(var i in t){for(var a=t[i],o=[],s=a.array,u=0,l=s.length;l>u;u++)o[u]=s[u];e.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:o}}return r.length>0&&(e.data.offsets=JSON.parse(JSON.stringify(r))),null!==n&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius}),e},clone:function(){var e=new t.BufferGeometry;for(var r in this.attributes){var n=this.attributes[r];e.addAttribute(r,n.clone())}for(var i=0,a=this.offsets.length;a>i;i++){var o=this.offsets[i];e.offsets.push({start:o.start,index:o.index,count:o.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},t.EventDispatcher.prototype.apply(t.BufferGeometry.prototype),t.Geometry=function(){Object.defineProperty(this,"id",{value:t.GeometryIdCount++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},t.Geometry.prototype={constructor:t.Geometry,applyMatrix:function(e){for(var r=(new t.Matrix3).getNormalMatrix(e),n=0,i=this.vertices.length;i>n;n++){var a=this.vertices[n];a.applyMatrix4(e)}for(var n=0,i=this.faces.length;i>n;n++){var o=this.faces[n];o.normal.applyMatrix3(r).normalize();for(var s=0,u=o.vertexNormals.length;u>s;s++)o.vertexNormals[s].applyMatrix3(r).normalize()}this.boundingBox instanceof t.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof t.Sphere&&this.computeBoundingSphere()},fromBufferGeometry:function(e){for(var r=this,n=e.attributes,i=n.position.array,a=void 0!==n.index?n.index.array:void 0,o=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,u=void 0!==n.uv?n.uv.array:void 0,l=[],c=[],h=0,f=0;h<i.length;h+=3,f+=2)r.vertices.push(new t.Vector3(i[h],i[h+1],i[h+2])),void 0!==o&&l.push(new t.Vector3(o[h],o[h+1],o[h+2])),void 0!==s&&r.colors.push(new t.Color(s[h],s[h+1],s[h+2])),void 0!==u&&c.push(new t.Vector2(u[f],u[f+1]));var p=function(e,n,i){var a=void 0!==o?[l[e].clone(),l[n].clone(),l[i].clone()]:[],u=void 0!==s?[r.colors[e].clone(),r.colors[n].clone(),r.colors[i].clone()]:[];r.faces.push(new t.Face3(e,n,i,a,u)),r.faceVertexUvs[0].push([c[e],c[n],c[i]])};if(void 0!==a)for(var h=0;h<a.length;h+=3)p(a[h],a[h+1],a[h+2]);else for(var h=0;h<i.length/3;h+=3)p(h,h+1,h+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=new t.Vector3;return e.addVectors(this.boundingBox.min,this.boundingBox.max),e.multiplyScalar(-.5),this.applyMatrix((new t.Matrix4).makeTranslation(e.x,e.y,e.z)),this.computeBoundingBox(),e},computeFaceNormals:function(){for(var e=new t.Vector3,r=new t.Vector3,n=0,i=this.faces.length;i>n;n++){var a=this.faces[n],o=this.vertices[a.a],s=this.vertices[a.b],u=this.vertices[a.c];e.subVectors(u,s),r.subVectors(o,s),e.cross(r),e.normalize(),a.normal.copy(e)}},computeVertexNormals:function(e){var r,n,i,a,o,s;for(s=new Array(this.vertices.length),r=0,n=this.vertices.length;n>r;r++)s[r]=new t.Vector3;if(e){{var u,l,c,h=new t.Vector3,f=new t.Vector3;new t.Vector3,new t.Vector3,new t.Vector3}for(i=0,a=this.faces.length;a>i;i++)o=this.faces[i],u=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],h.subVectors(c,l),f.subVectors(u,l),h.cross(f),s[o.a].add(h),s[o.b].add(h),s[o.c].add(h)}else for(i=0,a=this.faces.length;a>i;i++)o=this.faces[i],s[o.a].add(o.normal),s[o.b].add(o.normal),s[o.c].add(o.normal);for(r=0,n=this.vertices.length;n>r;r++)s[r].normalize();for(i=0,a=this.faces.length;a>i;i++)o=this.faces[i],o.vertexNormals[0]=s[o.a].clone(),o.vertexNormals[1]=s[o.b].clone(),o.vertexNormals[2]=s[o.c].clone()},computeMorphNormals:function(){var e,r,n,i,a;for(n=0,i=this.faces.length;i>n;n++)for(a=this.faces[n],a.__originalFaceNormal?a.__originalFaceNormal.copy(a.normal):a.__originalFaceNormal=a.normal.clone(),a.__originalVertexNormals||(a.__originalVertexNormals=[]),e=0,r=a.vertexNormals.length;r>e;e++)a.__originalVertexNormals[e]?a.__originalVertexNormals[e].copy(a.vertexNormals[e]):a.__originalVertexNormals[e]=a.vertexNormals[e].clone();var o=new t.Geometry;for(o.faces=this.faces,e=0,r=this.morphTargets.length;r>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s,u,l=this.morphNormals[e].faceNormals,c=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;i>n;n++)s=new t.Vector3,u={a:new t.Vector3,b:new t.Vector3,c:new t.Vector3},l.push(s),c.push(u)}var h=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals();var s,u;for(n=0,i=this.faces.length;i>n;n++)a=this.faces[n],s=h.faceNormals[n],u=h.vertexNormals[n],s.copy(a.normal),u.a.copy(a.vertexNormals[0]),u.b.copy(a.vertexNormals[1]),u.c.copy(a.vertexNormals[2])}for(n=0,i=this.faces.length;i>n;n++)a=this.faces[n],a.normal=a.__originalFaceNormal,a.vertexNormals=a.__originalVertexNormals},computeTangents:function(){function e(e,t,r,n,i,a,o){c=e.vertices[t],h=e.vertices[r],f=e.vertices[n],p=l[i],d=l[a],m=l[o],g=h.x-c.x,v=f.x-c.x,y=h.y-c.y,x=f.y-c.y,b=h.z-c.z,w=f.z-c.z,M=d.x-p.x,_=m.x-p.x,T=d.y-p.y,E=m.y-p.y,S=1/(M*E-_*T),D.set((E*g-T*v)*S,(E*y-T*x)*S,(E*b-T*w)*S),P.set((M*v-_*g)*S,(M*x-_*y)*S,(M*w-_*b)*S),R[t].add(D),R[r].add(D),R[n].add(D),L[t].add(P),L[r].add(P),L[n].add(P)}var r,n,i,a,o,s,u,l,c,h,f,p,d,m,g,v,y,x,b,w,M,_,T,E,S,C,A,N,R=[],L=[],D=new t.Vector3,P=new t.Vector3,I=new t.Vector3,F=new t.Vector3,U=new t.Vector3;for(i=0,a=this.vertices.length;a>i;i++)R[i]=new t.Vector3,L[i]=new t.Vector3;for(r=0,n=this.faces.length;n>r;r++)u=this.faces[r],l=this.faceVertexUvs[0][r],e(this,u.a,u.b,u.c,0,1,2);var O=["a","b","c","d"];for(r=0,n=this.faces.length;n>r;r++)for(u=this.faces[r],o=0;o<Math.min(u.vertexNormals.length,3);o++)U.copy(u.vertexNormals[o]),s=u[O[o]],C=R[s],I.copy(C),I.sub(U.multiplyScalar(U.dot(C))).normalize(),F.crossVectors(u.vertexNormals[o],C),A=F.dot(L[s]),N=0>A?-1:1,u.vertexTangents[o]=new t.Vector4(I.x,I.y,I.z,N);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;n>r;r++)r>0&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new t.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new t.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,r,n){if(e instanceof t.Geometry==!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);var i,a=this.vertices.length,o=this.vertices,s=e.vertices,u=this.faces,l=e.faces,c=this.faceVertexUvs[0],h=e.faceVertexUvs[0];void 0===n&&(n=0),void 0!==r&&(i=(new t.Matrix3).getNormalMatrix(r));for(var f=0,p=s.length;p>f;f++){var d=s[f],m=d.clone();void 0!==r&&m.applyMatrix4(r),o.push(m)}for(f=0,p=l.length;p>f;f++){var g,v,y,x=l[f],b=x.vertexNormals,w=x.vertexColors;g=new t.Face3(x.a+a,x.b+a,x.c+a),g.normal.copy(x.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var M=0,_=b.length;_>M;M++)v=b[M].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),g.vertexNormals.push(v);g.color.copy(x.color);for(var M=0,_=w.length;_>M;M++)y=w[M],g.vertexColors.push(y.clone());g.materialIndex=x.materialIndex+n,u.push(g)}for(f=0,p=h.length;p>f;f++){var T=h[f],E=[];if(void 0!==T){for(var M=0,_=T.length;_>M;M++)E.push(new t.Vector2(T[M].x,T[M].y));c.push(E)}}},mergeVertices:function(){var e,t,r,n,i,a,o,s,u={},l=[],c=[],h=4,f=Math.pow(10,h);for(r=0,n=this.vertices.length;n>r;r++)e=this.vertices[r],t=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f),void 0===u[t]?(u[t]=r,l.push(this.vertices[r]),c[r]=l.length-1):c[r]=c[u[t]];var p=[];for(r=0,n=this.faces.length;n>r;r++){i=this.faces[r],i.a=c[i.a],i.b=c[i.b],i.c=c[i.c],a=[i.a,i.b,i.c];for(var d=-1,m=0;3>m;m++)if(a[m]==a[(m+1)%3]){d=m,p.push(r);break}}for(r=p.length-1;r>=0;r--){var g=p[r];for(this.faces.splice(g,1),o=0,s=this.faceVertexUvs.length;s>o;o++)this.faceVertexUvs[o].splice(g,1)}var v=this.vertices.length-l.length;return this.vertices=l,v},toJSON:function(){function e(e,t,r){return r?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==f[t]?f[t]:(f[t]=h.length/3,h.push(e.x,e.y,e.z),f[t])}function r(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==d[t]?d[t]:(d[t]=p.length,p.push(e.getHex()),d[t])}function n(e){var t=e.x.toString()+e.y.toString();return void 0!==g[t]?g[t]:(g[t]=m.length/2,m.push(e.x,e.y),g[t])}var i={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(i.name=this.name),void 0!==this.parameters){var a=this.parameters;for(var o in a)void 0!==a[o]&&(i[o]=a[o]);return i}for(var s=[],u=0;u<this.vertices.length;u++){var l=this.vertices[u];s.push(l.x,l.y,l.z)}for(var c=[],h=[],f={},p=[],d={},m=[],g={},u=0;u<this.faces.length;u++){var v=this.faces[u],y=!1,x=!1,b=void 0!==this.faceVertexUvs[0][u],w=v.normal.length()>0,M=v.vertexNormals.length>0,_=1!==v.color.r||1!==v.color.g||1!==v.color.b,T=v.vertexColors.length>0,E=0;if(E=e(E,0,0),E=e(E,1,y),E=e(E,2,x),E=e(E,3,b),E=e(E,4,w),E=e(E,5,M),E=e(E,6,_),E=e(E,7,T),c.push(E),c.push(v.a,v.b,v.c),b){var S=this.faceVertexUvs[0][u];c.push(n(S[0]),n(S[1]),n(S[2]))}if(w&&c.push(t(v.normal)),M){var C=v.vertexNormals;c.push(t(C[0]),t(C[1]),t(C[2]))}if(_&&c.push(r(v.color)),T){var A=v.vertexColors;c.push(r(A[0]),r(A[1]),r(A[2]))}}return i.data={},i.data.vertices=s,i.data.normals=h,p.length>0&&(i.data.colors=p),m.length>0&&(i.data.uvs=[m]),i.data.faces=c,i},clone:function(){for(var e=new t.Geometry,r=this.vertices,n=0,i=r.length;i>n;n++)e.vertices.push(r[n].clone());for(var a=this.faces,n=0,i=a.length;i>n;n++)e.faces.push(a[n].clone());for(var o=this.faceVertexUvs[0],n=0,i=o.length;i>n;n++){for(var s=o[n],u=[],l=0,c=s.length;c>l;l++)u.push(new t.Vector2(s[l].x,s[l].y));e.faceVertexUvs[0].push(u)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},t.EventDispatcher.prototype.apply(t.Geometry.prototype),t.GeometryIdCount=0,t.Camera=function(){t.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new t.Matrix4,this.projectionMatrix=new t.Matrix4},t.Camera.prototype=Object.create(t.Object3D.prototype),t.Camera.prototype.getWorldDirection=function(){var e=new t.Quaternion;return function(r){var n=r||new t.Vector3;return this.getWorldQuaternion(e),n.set(0,0,-1).applyQuaternion(e)}}(),t.Camera.prototype.lookAt=function(){var e=new t.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),t.Camera.prototype.clone=function(e){return void 0===e&&(e=new t.Camera),t.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},t.CubeCamera=function(e,r,n){t.Object3D.call(this),this.type="CubeCamera";var i=90,a=1,o=new t.PerspectiveCamera(i,a,e,r);o.up.set(0,-1,0),o.lookAt(new t.Vector3(1,0,0)),this.add(o);var s=new t.PerspectiveCamera(i,a,e,r);s.up.set(0,-1,0),s.lookAt(new t.Vector3(-1,0,0)),this.add(s);var u=new t.PerspectiveCamera(i,a,e,r);u.up.set(0,0,1),u.lookAt(new t.Vector3(0,1,0)),this.add(u);var l=new t.PerspectiveCamera(i,a,e,r);l.up.set(0,0,-1),l.lookAt(new t.Vector3(0,-1,0)),this.add(l);var c=new t.PerspectiveCamera(i,a,e,r);c.up.set(0,-1,0),c.lookAt(new t.Vector3(0,0,1)),this.add(c);var h=new t.PerspectiveCamera(i,a,e,r);h.up.set(0,-1,0),h.lookAt(new t.Vector3(0,0,-1)),this.add(h),this.renderTarget=new t.WebGLRenderTargetCube(n,n,{format:t.RGBFormat,magFilter:t.LinearFilter,minFilter:t.LinearFilter}),this.updateCubeMap=function(e,t){var r=this.renderTarget,n=r.generateMipmaps;r.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,o,r),r.activeCubeFace=1,e.render(t,s,r),r.activeCubeFace=2,e.render(t,u,r),r.activeCubeFace=3,e.render(t,l,r),r.activeCubeFace=4,e.render(t,c,r),r.generateMipmaps=n,r.activeCubeFace=5,e.render(t,h,r)}},t.CubeCamera.prototype=Object.create(t.Object3D.prototype),t.OrthographicCamera=function(e,r,n,i,a,o){t.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=r,this.top=n,this.bottom=i,this.near=void 0!==a?a:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},t.OrthographicCamera.prototype=Object.create(t.Camera.prototype),t.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-e,r+e,n+t,n-t,this.near,this.far)},t.OrthographicCamera.prototype.clone=function(){var e=new t.OrthographicCamera;return t.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},t.PerspectiveCamera=function(e,r,n,i){t.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==r?r:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},t.PerspectiveCamera.prototype=Object.create(t.Camera.prototype),t.PerspectiveCamera.prototype.setLens=function(e,r){void 0===r&&(r=24),this.fov=2*t.Math.radToDeg(Math.atan(r/(2*e))),this.updateProjectionMatrix()},t.PerspectiveCamera.prototype.setViewOffset=function(e,t,r,n,i,a){this.fullWidth=e,this.fullHeight=t,this.x=r,this.y=n,this.width=i,this.height=a,this.updateProjectionMatrix()},t.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=t.Math.radToDeg(2*Math.atan(Math.tan(.5*t.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var r=this.fullWidth/this.fullHeight,n=Math.tan(t.Math.degToRad(.5*e))*this.near,i=-n,a=r*i,o=r*n,s=Math.abs(o-a),u=Math.abs(n-i);this.projectionMatrix.makeFrustum(a+this.x*s/this.fullWidth,a+(this.x+this.width)*s/this.fullWidth,n-(this.y+this.height)*u/this.fullHeight,n-this.y*u/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)},t.PerspectiveCamera.prototype.clone=function(){var e=new t.PerspectiveCamera;return t.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},t.Light=function(e){t.Object3D.call(this),this.type="Light",this.color=new t.Color(e)},t.Light.prototype=Object.create(t.Object3D.prototype),t.Light.prototype.clone=function(e){return void 0===e&&(e=new t.Light),t.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},t.AmbientLight=function(e){t.Light.call(this,e),this.type="AmbientLight"},t.AmbientLight.prototype=Object.create(t.Light.prototype),t.AmbientLight.prototype.clone=function(){var e=new t.AmbientLight;return t.Light.prototype.clone.call(this,e),e},t.AreaLight=function(e,r){t.Light.call(this,e),this.type="AreaLight",this.normal=new t.Vector3(0,-1,0),this.right=new t.Vector3(1,0,0),this.intensity=void 0!==r?r:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},t.AreaLight.prototype=Object.create(t.Light.prototype),t.DirectionalLight=function(e,r){t.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new t.Object3D,this.intensity=void 0!==r?r:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new t.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null
},t.DirectionalLight.prototype=Object.create(t.Light.prototype),t.DirectionalLight.prototype.clone=function(){var e=new t.DirectionalLight;return t.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraLeft=this.shadowCameraLeft,e.shadowCameraRight=this.shadowCameraRight,e.shadowCameraTop=this.shadowCameraTop,e.shadowCameraBottom=this.shadowCameraBottom,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e.shadowCascade=this.shadowCascade,e.shadowCascadeOffset.copy(this.shadowCascadeOffset),e.shadowCascadeCount=this.shadowCascadeCount,e.shadowCascadeBias=this.shadowCascadeBias.slice(0),e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),e},t.HemisphereLight=function(e,r,n){t.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new t.Color(r),this.intensity=void 0!==n?n:1},t.HemisphereLight.prototype=Object.create(t.Light.prototype),t.HemisphereLight.prototype.clone=function(){var e=new t.HemisphereLight;return t.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},t.PointLight=function(e,r,n){t.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==r?r:1,this.distance=void 0!==n?n:0},t.PointLight.prototype=Object.create(t.Light.prototype),t.PointLight.prototype.clone=function(){var e=new t.PointLight;return t.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e},t.SpotLight=function(e,r,n,i,a){t.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.target=new t.Object3D,this.intensity=void 0!==r?r:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==a?a:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},t.SpotLight.prototype=Object.create(t.Light.prototype),t.SpotLight.prototype.clone=function(){var e=new t.SpotLight;return t.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraFov=this.shadowCameraFov,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e},t.Cache=function(){this.files={}},t.Cache.prototype={constructor:t.Cache,add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},t.Loader=function(e){this.showStatus=e,this.statusDomElement=e?t.Loader.prototype.addStatusElement():null,this.imageLoader=new t.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},t.Loader.prototype={constructor:t.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";t+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t){for(var r=[],n=0;n<e.length;++n)r[n]=this.createMaterial(e[n],t);return r},needsTangents:function(e){for(var r=0,n=e.length;n>r;r++){var i=e[r];if(i instanceof t.ShaderMaterial)return!0}return!1},createMaterial:function(e,r){function n(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function i(e,i,a,s,u,l,c){var h,f=r+a,p=t.Loader.Handlers.get(f);if(null!==p?h=p.load(f):(h=new t.Texture,p=o.imageLoader,p.crossOrigin=o.crossOrigin,p.load(f,function(e){if(t.Math.isPowerOfTwo(e.width)===!1||t.Math.isPowerOfTwo(e.height)===!1){var r=n(e.width),i=n(e.height),a=document.createElement("canvas");a.width=r,a.height=i;var o=a.getContext("2d");o.drawImage(e,0,0,r,i),h.image=a}else h.image=e;h.needsUpdate=!0})),h.sourceFile=a,s&&(h.repeat.set(s[0],s[1]),1!==s[0]&&(h.wrapS=t.RepeatWrapping),1!==s[1]&&(h.wrapT=t.RepeatWrapping)),u&&h.offset.set(u[0],u[1]),l){var d={repeat:t.RepeatWrapping,mirror:t.MirroredRepeatWrapping};void 0!==d[l[0]]&&(h.wrapS=d[l[0]]),void 0!==d[l[1]]&&(h.wrapT=d[l[1]])}c&&(h.anisotropy=c),e[i]=h}function a(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var o=this,s="MeshLambertMaterial",u={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var l=e.shading.toLowerCase();"phong"===l?s="MeshPhongMaterial":"basic"===l&&(s="MeshBasicMaterial")}if(void 0!==e.blending&&void 0!==t[e.blending]&&(u.blending=t[e.blending]),(void 0!==e.transparent||e.opacity<1)&&(u.transparent=e.transparent),void 0!==e.depthTest&&(u.depthTest=e.depthTest),void 0!==e.depthWrite&&(u.depthWrite=e.depthWrite),void 0!==e.visible&&(u.visible=e.visible),void 0!==e.flipSided&&(u.side=t.BackSide),void 0!==e.doubleSided&&(u.side=t.DoubleSide),void 0!==e.wireframe&&(u.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?u.vertexColors=t.FaceColors:e.vertexColors&&(u.vertexColors=t.VertexColors)),e.colorDiffuse?u.color=a(e.colorDiffuse):e.DbgColor&&(u.color=e.DbgColor),e.colorSpecular&&(u.specular=a(e.colorSpecular)),e.colorAmbient&&(u.ambient=a(e.colorAmbient)),e.colorEmissive&&(u.emissive=a(e.colorEmissive)),e.transparency&&(u.opacity=e.transparency),e.specularCoef&&(u.shininess=e.specularCoef),e.mapDiffuse&&r&&i(u,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&r&&i(u,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&r&&i(u,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&r&&i(u,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&r&&i(u,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapAlpha&&r&&i(u,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy),e.mapBumpScale&&(u.bumpScale=e.mapBumpScale),e.mapNormal){var c=t.ShaderLib.normalmap,h=t.UniformsUtils.clone(c.uniforms);h.tNormal.value=u.normalMap,e.mapNormalFactor&&h.uNormalScale.value.set(e.mapNormalFactor,e.mapNormalFactor),u.map&&(h.tDiffuse.value=u.map,h.enableDiffuse.value=!0),u.specularMap&&(h.tSpecular.value=u.specularMap,h.enableSpecular.value=!0),u.lightMap&&(h.tAO.value=u.lightMap,h.enableAO.value=!0),h.diffuse.value.setHex(u.color),h.specular.value.setHex(u.specular),h.ambient.value.setHex(u.ambient),h.shininess.value=u.shininess,void 0!==u.opacity&&(h.opacity.value=u.opacity);var f={fragmentShader:c.fragmentShader,vertexShader:c.vertexShader,uniforms:h,lights:!0,fog:!0},p=new t.ShaderMaterial(f);u.transparent&&(p.transparent=!0)}else var p=new t[s](u);return void 0!==e.DbgName&&(p.name=e.DbgName),p}},t.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,r=this.handlers.length;r>t;t+=2){var n=this.handlers[t],i=this.handlers[t+1];if(n.test(e))return i}return null}},t.XHRLoader=function(e){this.cache=new t.Cache,this.manager=void 0!==e?e:t.DefaultLoadingManager},t.XHRLoader.prototype={constructor:t.XHRLoader,load:function(e,t,r,n){var i=this,a=i.cache.get(e);if(void 0!==a)return void(t&&t(a));var o=new XMLHttpRequest;o.open("GET",e,!0),o.addEventListener("load",function(){i.cache.add(e,this.response),t&&t(this.response),i.manager.itemEnd(e)},!1),void 0!==r&&o.addEventListener("progress",function(e){r(e)},!1),void 0!==n&&o.addEventListener("error",function(e){n(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(o.responseType=this.responseType),o.send(null),i.manager.itemStart(e)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}},t.ImageLoader=function(e){this.cache=new t.Cache,this.manager=void 0!==e?e:t.DefaultLoadingManager},t.ImageLoader.prototype={constructor:t.ImageLoader,load:function(e,t,r,n){var i=this,a=i.cache.get(e);if(void 0!==a)return void t(a);var o=document.createElement("img");return void 0!==t&&o.addEventListener("load",function(){i.cache.add(e,this),t(this),i.manager.itemEnd(e)},!1),void 0!==r&&o.addEventListener("progress",function(e){r(e)},!1),void 0!==n&&o.addEventListener("error",function(e){n(e)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=e,i.manager.itemStart(e),o},setCrossOrigin:function(e){this.crossOrigin=e}},t.JSONLoader=function(e){t.Loader.call(this,e),this.withCredentials=!1},t.JSONLoader.prototype=Object.create(t.Loader.prototype),t.JSONLoader.prototype.load=function(e,t,r){r=r&&"string"==typeof r?r:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,r)},t.JSONLoader.prototype.loadAjaxJSON=function(e,t,r,n,i){var a=new XMLHttpRequest,o=0;a.onreadystatechange=function(){if(a.readyState===a.DONE)if(200===a.status||0===a.status){if(a.responseText){var s=JSON.parse(a.responseText);if(void 0!==s.metadata&&"scene"===s.metadata.type)return void console.error('THREE.JSONLoader: "'+t+'" seems to be a Scene. Use THREE.SceneLoader instead.');var u=e.parse(s,n);r(u.geometry,u.materials)}else console.error('THREE.JSONLoader: "'+t+'" seems to be unreachable or the file is empty.');e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load \""+t+'" ('+a.status+")");else a.readyState===a.LOADING?i&&(0===o&&(o=a.getResponseHeader("Content-Length")),i({total:o,loaded:a.responseText.length})):a.readyState===a.HEADERS_RECEIVED&&void 0!==i&&(o=a.getResponseHeader("Content-Length"))},a.open("GET",t,!0),a.withCredentials=this.withCredentials,a.send(null)},t.JSONLoader.prototype.parse=function(e,r){function n(r){function n(e,t){return e&1<<t}var i,a,s,u,l,c,h,f,p,d,m,g,v,y,x,b,w,M,_,T,E,S,C,A,N,R,L,D=e.faces,P=e.vertices,I=e.normals,F=e.colors,U=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&U++;for(i=0;U>i;i++)o.faceVertexUvs[i]=[]}for(u=0,l=P.length;l>u;)M=new t.Vector3,M.x=P[u++]*r,M.y=P[u++]*r,M.z=P[u++]*r,o.vertices.push(M);for(u=0,l=D.length;l>u;)if(d=D[u++],m=n(d,0),g=n(d,1),v=n(d,3),y=n(d,4),x=n(d,5),b=n(d,6),w=n(d,7),m){if(T=new t.Face3,T.a=D[u],T.b=D[u+1],T.c=D[u+3],E=new t.Face3,E.a=D[u+1],E.b=D[u+2],E.c=D[u+3],u+=4,g&&(p=D[u++],T.materialIndex=p,E.materialIndex=p),s=o.faces.length,v)for(i=0;U>i;i++)for(A=e.uvs[i],o.faceVertexUvs[i][s]=[],o.faceVertexUvs[i][s+1]=[],a=0;4>a;a++)f=D[u++],R=A[2*f],L=A[2*f+1],N=new t.Vector2(R,L),2!==a&&o.faceVertexUvs[i][s].push(N),0!==a&&o.faceVertexUvs[i][s+1].push(N);if(y&&(h=3*D[u++],T.normal.set(I[h++],I[h++],I[h]),E.normal.copy(T.normal)),x)for(i=0;4>i;i++)h=3*D[u++],C=new t.Vector3(I[h++],I[h++],I[h]),2!==i&&T.vertexNormals.push(C),0!==i&&E.vertexNormals.push(C);if(b&&(c=D[u++],S=F[c],T.color.setHex(S),E.color.setHex(S)),w)for(i=0;4>i;i++)c=D[u++],S=F[c],2!==i&&T.vertexColors.push(new t.Color(S)),0!==i&&E.vertexColors.push(new t.Color(S));o.faces.push(T),o.faces.push(E)}else{if(_=new t.Face3,_.a=D[u++],_.b=D[u++],_.c=D[u++],g&&(p=D[u++],_.materialIndex=p),s=o.faces.length,v)for(i=0;U>i;i++)for(A=e.uvs[i],o.faceVertexUvs[i][s]=[],a=0;3>a;a++)f=D[u++],R=A[2*f],L=A[2*f+1],N=new t.Vector2(R,L),o.faceVertexUvs[i][s].push(N);if(y&&(h=3*D[u++],_.normal.set(I[h++],I[h++],I[h])),x)for(i=0;3>i;i++)h=3*D[u++],C=new t.Vector3(I[h++],I[h++],I[h]),_.vertexNormals.push(C);if(b&&(c=D[u++],_.color.setHex(F[c])),w)for(i=0;3>i;i++)c=D[u++],_.vertexColors.push(new t.Color(F[c]));o.faces.push(_)}}function i(){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;i>n;n+=r){var a=e.skinWeights[n],s=r>1?e.skinWeights[n+1]:0,u=r>2?e.skinWeights[n+2]:0,l=r>3?e.skinWeights[n+3]:0;o.skinWeights.push(new t.Vector4(a,s,u,l))}if(e.skinIndices)for(var n=0,i=e.skinIndices.length;i>n;n+=r){var c=e.skinIndices[n],h=r>1?e.skinIndices[n+1]:0,f=r>2?e.skinIndices[n+2]:0,p=r>3?e.skinIndices[n+3]:0;o.skinIndices.push(new t.Vector4(c,h,f,p))}o.bones=e.bones,o.bones&&o.bones.length>0&&(o.skinWeights.length!==o.skinIndices.length||o.skinIndices.length!==o.vertices.length)&&console.warn("When skinning, number of vertices ("+o.vertices.length+"), skinIndices ("+o.skinIndices.length+"), and skinWeights ("+o.skinWeights.length+") should match."),o.animation=e.animation,o.animations=e.animations}function a(r){if(void 0!==e.morphTargets){var n,i,a,s,u,l;for(n=0,i=e.morphTargets.length;i>n;n++)for(o.morphTargets[n]={},o.morphTargets[n].name=e.morphTargets[n].name,o.morphTargets[n].vertices=[],u=o.morphTargets[n].vertices,l=e.morphTargets[n].vertices,a=0,s=l.length;s>a;a+=3){var c=new t.Vector3;c.x=l[a]*r,c.y=l[a+1]*r,c.z=l[a+2]*r,u.push(c)}}if(void 0!==e.morphColors){var n,i,h,f,p,d,m;for(n=0,i=e.morphColors.length;i>n;n++)for(o.morphColors[n]={},o.morphColors[n].name=e.morphColors[n].name,o.morphColors[n].colors=[],p=o.morphColors[n].colors,d=e.morphColors[n].colors,h=0,f=d.length;f>h;h+=3)m=new t.Color(16755200),m.setRGB(d[h],d[h+1],d[h+2]),p.push(m)}}var o=new t.Geometry,s=void 0!==e.scale?1/e.scale:1;if(n(s),i(),a(s),o.computeFaceNormals(),o.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:o};var u=this.initMaterials(e.materials,r);return this.needsTangents(u)&&o.computeTangents(),{geometry:o,materials:u}},t.LoadingManager=function(e,t,r){var n=this,i=0,a=0;this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(){a++},this.itemEnd=function(e){i++,void 0!==n.onProgress&&n.onProgress(e,i,a),i===a&&void 0!==n.onLoad&&n.onLoad()}},t.DefaultLoadingManager=new t.LoadingManager,t.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:t.DefaultLoadingManager},t.BufferGeometryLoader.prototype={constructor:t.BufferGeometryLoader,load:function(e,r,n,i){var a=this,o=new t.XHRLoader;o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){r(a.parse(JSON.parse(e)))},n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var r=new t.BufferGeometry,n=e.attributes;for(var i in n){var a=n[i],o=new self[a.type](a.array);r.addAttribute(i,new t.BufferAttribute(o,a.itemSize))}var s=e.offsets;void 0!==s&&(r.offsets=JSON.parse(JSON.stringify(s)));var u=e.boundingSphere;if(void 0!==u){var l=new t.Vector3;void 0!==u.center&&l.fromArray(u.center),r.boundingSphere=new t.Sphere(l,u.radius)}return r}},t.MaterialLoader=function(e){this.manager=void 0!==e?e:t.DefaultLoadingManager},t.MaterialLoader.prototype={constructor:t.MaterialLoader,load:function(e,r,n,i){var a=this,o=new t.XHRLoader;o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){r(a.parse(JSON.parse(e)))},n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var r=new t[e.type];if(void 0!==e.color&&r.color.setHex(e.color),void 0!==e.ambient&&r.ambient.setHex(e.ambient),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.uniforms&&(r.uniforms=e.uniforms),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.shading&&(r.shading=e.shading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.materials)for(var n=0,i=e.materials.length;i>n;n++)r.materials.push(this.parse(e.materials[n]));return r}},t.ObjectLoader=function(e){this.manager=void 0!==e?e:t.DefaultLoadingManager},t.ObjectLoader.prototype={constructor:t.ObjectLoader,load:function(e,r,n,i){var a=this,o=new t.XHRLoader(a.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){r(a.parse(JSON.parse(e)))},n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.parseGeometries(e.geometries),r=this.parseMaterials(e.materials),n=this.parseObject(e.object,t,r);return n},parseGeometries:function(e){var r={};if(void 0!==e)for(var n=new t.JSONLoader,i=new t.BufferGeometryLoader,a=0,o=e.length;o>a;a++){var s,u=e[a];switch(u.type){case"PlaneGeometry":s=new t.PlaneGeometry(u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"CubeGeometry":s=new t.BoxGeometry(u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":s=new t.CircleGeometry(u.radius,u.segments);break;case"CylinderGeometry":s=new t.CylinderGeometry(u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded);break;case"SphereGeometry":s=new t.SphereGeometry(u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"IcosahedronGeometry":s=new t.IcosahedronGeometry(u.radius,u.detail);break;case"TorusGeometry":s=new t.TorusGeometry(u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":s=new t.TorusKnotGeometry(u.radius,u.tube,u.radialSegments,u.tubularSegments,u.p,u.q,u.heightScale);break;case"BufferGeometry":s=i.parse(u.data);break;case"Geometry":s=n.parse(u.data).geometry}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),r[u.uuid]=s}return r},parseMaterials:function(e){var r={};if(void 0!==e)for(var n=new t.MaterialLoader,i=0,a=e.length;a>i;i++){var o=e[i],s=n.parse(o);s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),r[o.uuid]=s}return r},parseObject:function(){var e=new t.Matrix4;return function(r,n,i){var a;switch(r.type){case"Scene":a=new t.Scene;break;case"PerspectiveCamera":a=new t.PerspectiveCamera(r.fov,r.aspect,r.near,r.far);break;case"OrthographicCamera":a=new t.OrthographicCamera(r.left,r.right,r.top,r.bottom,r.near,r.far);break;case"AmbientLight":a=new t.AmbientLight(r.color);break;case"DirectionalLight":a=new t.DirectionalLight(r.color,r.intensity);break;case"PointLight":a=new t.PointLight(r.color,r.intensity,r.distance);break;case"SpotLight":a=new t.SpotLight(r.color,r.intensity,r.distance,r.angle,r.exponent);break;case"HemisphereLight":a=new t.HemisphereLight(r.color,r.groundColor,r.intensity);break;case"Mesh":var o=n[r.geometry],s=i[r.material];void 0===o&&console.warn("THREE.ObjectLoader: Undefined geometry",r.geometry),void 0===s&&console.warn("THREE.ObjectLoader: Undefined material",r.material),a=new t.Mesh(o,s);break;case"Line":var o=n[r.geometry],s=i[r.material];void 0===o&&console.warn("THREE.ObjectLoader: Undefined geometry",r.geometry),void 0===s&&console.warn("THREE.ObjectLoader: Undefined material",r.material),a=new t.Line(o,s);break;case"Sprite":var s=i[r.material];void 0===s&&console.warn("THREE.ObjectLoader: Undefined material",r.material),a=new t.Sprite(s);break;case"Group":a=new t.Group;break;default:a=new t.Object3D}if(a.uuid=r.uuid,void 0!==r.name&&(a.name=r.name),void 0!==r.matrix?(e.fromArray(r.matrix),e.decompose(a.position,a.quaternion,a.scale)):(void 0!==r.position&&a.position.fromArray(r.position),void 0!==r.rotation&&a.rotation.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale)),void 0!==r.visible&&(a.visible=r.visible),void 0!==r.userData&&(a.userData=r.userData),void 0!==r.children)for(var u in r.children)a.add(this.parseObject(r.children[u],n,i));return a}}()},t.TextureLoader=function(e){this.manager=void 0!==e?e:t.DefaultLoadingManager},t.TextureLoader.prototype={constructor:t.TextureLoader,load:function(e,r,n,i){var a=this,o=new t.ImageLoader(a.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,function(e){var n=new t.Texture(e);n.needsUpdate=!0,void 0!==r&&r(n)},n,i)},setCrossOrigin:function(e){this.crossOrigin=e}},t.CompressedTextureLoader=function(){this._parser=null},t.CompressedTextureLoader.prototype={constructor:t.CompressedTextureLoader,load:function(e,r){var n=this,i=[],a=new t.CompressedTexture;a.image=i;var o=new t.XHRLoader;if(o.setResponseType("arraybuffer"),e instanceof Array)for(var s=0,u=function(u){o.load(e[u],function(e){var o=n._parser(e,!0);i[u]={width:o.width,height:o.height,format:o.format,mipmaps:o.mipmaps},s+=1,6===s&&(1==o.mipmapCount&&(a.minFilter=t.LinearFilter),a.format=o.format,a.needsUpdate=!0,r&&r(a))})},l=0,c=e.length;c>l;++l)u(l);else o.load(e,function(e){var o=n._parser(e,!0);if(o.isCubemap)for(var s=o.mipmaps.length/o.mipmapCount,u=0;s>u;u++){i[u]={mipmaps:[]};for(var l=0;l<o.mipmapCount;l++)i[u].mipmaps.push(o.mipmaps[u*o.mipmapCount+l]),i[u].format=o.format,i[u].width=o.width,i[u].height=o.height}else a.image.width=o.width,a.image.height=o.height,a.mipmaps=o.mipmaps;1===o.mipmapCount&&(a.minFilter=t.LinearFilter),a.format=o.format,a.needsUpdate=!0,r&&r(a)});return a}},t.Material=function(){Object.defineProperty(this,"id",{value:t.MaterialIdCount++}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Material",this.side=t.FrontSide,this.opacity=1,this.transparent=!1,this.blending=t.NormalBlending,this.blendSrc=t.SrcAlphaFactor,this.blendDst=t.OneMinusSrcAlphaFactor,this.blendEquation=t.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this.needsUpdate=!0},t.Material.prototype={constructor:t.Material,setValues:function(e){if(void 0!==e)for(var r in e){var n=e[r];if(void 0!==n){if(r in this){var i=this[r];i instanceof t.Color?i.set(n):i instanceof t.Vector3&&n instanceof t.Vector3?i.copy(n):this[r]="overdraw"==r?Number(n):n}}else console.warn("THREE.Material: '"+r+"' parameter is undefined.")}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof t.MeshBasicMaterial?(e.color=this.color.getHex(),this.vertexColors!==t.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==t.NormalBlending&&(e.blending=this.blending),this.side!==t.FrontSide&&(e.side=this.side)):this instanceof t.MeshLambertMaterial?(e.color=this.color.getHex(),e.ambient=this.ambient.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==t.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==t.NormalBlending&&(e.blending=this.blending),this.side!==t.FrontSide&&(e.side=this.side)):this instanceof t.MeshPhongMaterial?(e.color=this.color.getHex(),e.ambient=this.ambient.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==t.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==t.NormalBlending&&(e.blending=this.blending),this.side!==t.FrontSide&&(e.side=this.side)):this instanceof t.MeshNormalMaterial?(this.shading!==t.FlatShading&&(e.shading=this.shading),this.blending!==t.NormalBlending&&(e.blending=this.blending),this.side!==t.FrontSide&&(e.side=this.side)):this instanceof t.MeshDepthMaterial?(this.blending!==t.NormalBlending&&(e.blending=this.blending),this.side!==t.FrontSide&&(e.side=this.side)):this instanceof t.ShaderMaterial?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof t.SpriteMaterial&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),this.transparent!==!1&&(e.transparent=this.transparent),this.wireframe!==!1&&(e.wireframe=this.wireframe),e},clone:function(e){return void 0===e&&(e=new t.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},t.EventDispatcher.prototype.apply(t.Material.prototype),t.MaterialIdCount=0,t.LineBasicMaterial=function(e){t.Material.call(this),this.type="LineBasicMaterial",this.color=new t.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=t.NoColors,this.fog=!0,this.setValues(e)},t.LineBasicMaterial.prototype=Object.create(t.Material.prototype),t.LineBasicMaterial.prototype.clone=function(){var e=new t.LineBasicMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},t.LineDashedMaterial=function(e){t.Material.call(this),this.type="LineDashedMaterial",this.color=new t.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},t.LineDashedMaterial.prototype=Object.create(t.Material.prototype),t.LineDashedMaterial.prototype.clone=function(){var e=new t.LineDashedMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},t.MeshBasicMaterial=function(e){t.Material.call(this),this.type="MeshBasicMaterial",this.color=new t.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=t.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=t.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=t.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},t.MeshBasicMaterial.prototype=Object.create(t.Material.prototype),t.MeshBasicMaterial.prototype.clone=function(){var e=new t.MeshBasicMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},t.MeshLambertMaterial=function(e){t.Material.call(this),this.type="MeshLambertMaterial",this.color=new t.Color(16777215),this.ambient=new t.Color(16777215),this.emissive=new t.Color(0),this.wrapAround=!1,this.wrapRGB=new t.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=t.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=t.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=t.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},t.MeshLambertMaterial.prototype=Object.create(t.Material.prototype),t.MeshLambertMaterial.prototype.clone=function(){var e=new t.MeshLambertMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},t.MeshPhongMaterial=function(e){t.Material.call(this),this.type="MeshPhongMaterial",this.color=new t.Color(16777215),this.ambient=new t.Color(16777215),this.emissive=new t.Color(0),this.specular=new t.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new t.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new t.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=t.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=t.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=t.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},t.MeshPhongMaterial.prototype=Object.create(t.Material.prototype),t.MeshPhongMaterial.prototype.clone=function(){var e=new t.MeshPhongMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},t.MeshDepthMaterial=function(e){t.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},t.MeshDepthMaterial.prototype=Object.create(t.Material.prototype),t.MeshDepthMaterial.prototype.clone=function(){var e=new t.MeshDepthMaterial;return t.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},t.MeshNormalMaterial=function(e){t.Material.call(this,e),this.type="MeshNormalMaterial",this.shading=t.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},t.MeshNormalMaterial.prototype=Object.create(t.Material.prototype),t.MeshNormalMaterial.prototype.clone=function(){var e=new t.MeshNormalMaterial;return t.Material.prototype.clone.call(this,e),e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},t.MeshFaceMaterial=function(e){this.uuid=t.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=e instanceof Array?e:[]},t.MeshFaceMaterial.prototype={constructor:t.MeshFaceMaterial,toJSON:function(){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},t=0,r=this.materials.length;r>t;t++)e.materials.push(this.materials[t].toJSON());
return e},clone:function(){for(var e=new t.MeshFaceMaterial,r=0;r<this.materials.length;r++)e.materials.push(this.materials[r].clone());return e}},t.PointCloudMaterial=function(e){t.Material.call(this),this.type="PointCloudMaterial",this.color=new t.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=t.NoColors,this.fog=!0,this.setValues(e)},t.PointCloudMaterial.prototype=Object.create(t.Material.prototype),t.PointCloudMaterial.prototype.clone=function(){var e=new t.PointCloudMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},t.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new t.PointCloudMaterial(e)},t.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new t.PointCloudMaterial(e)},t.ShaderMaterial=function(e){t.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=t.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=t.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(e)},t.ShaderMaterial.prototype=Object.create(t.Material.prototype),t.ShaderMaterial.prototype.clone=function(){var e=new t.ShaderMaterial;return t.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=t.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},t.RawShaderMaterial=function(e){t.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},t.RawShaderMaterial.prototype=Object.create(t.ShaderMaterial.prototype),t.RawShaderMaterial.prototype.clone=function(){var e=new t.RawShaderMaterial;return t.ShaderMaterial.prototype.clone.call(this,e),e},t.SpriteMaterial=function(e){t.Material.call(this),this.type="SpriteMaterial",this.color=new t.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},t.SpriteMaterial.prototype=Object.create(t.Material.prototype),t.SpriteMaterial.prototype.clone=function(){var e=new t.SpriteMaterial;return t.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},t.Texture=function(e,r,n,i,a,o,s,u,l){Object.defineProperty(this,"id",{value:t.TextureIdCount++}),this.uuid=t.Math.generateUUID(),this.name="",this.image=void 0!==e?e:t.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==r?r:t.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:t.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:t.ClampToEdgeWrapping,this.magFilter=void 0!==a?a:t.LinearFilter,this.minFilter=void 0!==o?o:t.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:t.RGBAFormat,this.type=void 0!==u?u:t.UnsignedByteType,this.offset=new t.Vector2(0,0),this.repeat=new t.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},t.Texture.DEFAULT_IMAGE=void 0,t.Texture.DEFAULT_MAPPING=new t.UVMapping,t.Texture.prototype={constructor:t.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){e===!0&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new t.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},t.EventDispatcher.prototype.apply(t.Texture.prototype),t.TextureIdCount=0,t.CubeTexture=function(e,r,n,i,a,o,s,u,l){t.Texture.call(this,e,r,n,i,a,o,s,u,l),this.images=e},t.CubeTexture.prototype=Object.create(t.Texture.prototype),t.CubeTexture.clone=function(e){return void 0===e&&(e=new t.CubeTexture),t.Texture.prototype.clone.call(this,e),e.images=this.images,e},t.CompressedTexture=function(e,r,n,i,a,o,s,u,l,c,h){t.Texture.call(this,null,o,s,u,l,c,i,a,h),this.image={width:r,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},t.CompressedTexture.prototype=Object.create(t.Texture.prototype),t.CompressedTexture.prototype.clone=function(){var e=new t.CompressedTexture;return t.Texture.prototype.clone.call(this,e),e},t.DataTexture=function(e,r,n,i,a,o,s,u,l,c,h){t.Texture.call(this,null,o,s,u,l,c,i,a,h),this.image={data:e,width:r,height:n}},t.DataTexture.prototype=Object.create(t.Texture.prototype),t.DataTexture.prototype.clone=function(){var e=new t.DataTexture;return t.Texture.prototype.clone.call(this,e),e},t.VideoTexture=function(e,r,n,i,a,o,s,u,l){t.Texture.call(this,e,r,n,i,a,o,s,u,l),this.generateMipmaps=!1;var c=this,h=function(){requestAnimationFrame(h),e.readyState===e.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)};h()},t.VideoTexture.prototype=Object.create(t.Texture.prototype),t.Group=function(){t.Object3D.call(this),this.type="Group"},t.Group.prototype=Object.create(t.Object3D.prototype),t.PointCloud=function(e,r){t.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==e?e:new t.Geometry,this.material=void 0!==r?r:new t.PointCloudMaterial({color:16777215*Math.random()}),this.sortParticles=!1},t.PointCloud.prototype=Object.create(t.Object3D.prototype),t.PointCloud.prototype.raycast=function(){var e=new t.Matrix4,r=new t.Ray;return function(n,i){var a=this,o=a.geometry,s=n.params.PointCloud.threshold;if(e.getInverse(this.matrixWorld),r.copy(n.ray).applyMatrix4(e),null===o.boundingBox||r.isIntersectionBox(o.boundingBox)!==!1){var u=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=new t.Vector3,c=function(e,t){var o=r.distanceToPoint(e);if(u>o){var s=r.closestPointToPoint(e);s.applyMatrix4(a.matrixWorld);var l=n.ray.origin.distanceTo(s);i.push({distance:l,distanceToRay:o,point:s.clone(),index:t,face:null,object:a})}};if(o instanceof t.BufferGeometry){var h=o.attributes,f=h.position.array;if(void 0!==h.index){var p=h.index.array,d=o.offsets;if(0===d.length){var m={start:0,count:p.length,index:0};d=[m]}for(var g=0,v=d.length;v>g;++g)for(var y=d[g].start,x=d[g].count,b=d[g].index,w=y,M=y+x;M>w;w++){var _=b+p[w];l.fromArray(f,3*_),c(l,_)}}else for(var T=f.length/3,w=0;T>w;w++)l.set(f[3*w],f[3*w+1],f[3*w+2]),c(l,w)}else for(var E=this.geometry.vertices,w=0;w<E.length;w++)c(E[w],w)}}}(),t.PointCloud.prototype.clone=function(e){return void 0===e&&(e=new t.PointCloud(this.geometry,this.material)),e.sortParticles=this.sortParticles,t.Object3D.prototype.clone.call(this,e),e},t.ParticleSystem=function(e,r){return console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new t.PointCloud(e,r)},t.Line=function(e,r,n){t.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new t.Geometry,this.material=void 0!==r?r:new t.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==n?n:t.LineStrip},t.LineStrip=0,t.LinePieces=1,t.Line.prototype=Object.create(t.Object3D.prototype),t.Line.prototype.raycast=function(){var e=new t.Matrix4,r=new t.Ray,n=new t.Sphere;return function(i,a){var o=i.linePrecision,s=o*o,u=this.geometry;if(null===u.boundingSphere&&u.computeBoundingSphere(),n.copy(u.boundingSphere),n.applyMatrix4(this.matrixWorld),i.ray.isIntersectionSphere(n)!==!1&&(e.getInverse(this.matrixWorld),r.copy(i.ray).applyMatrix4(e),u instanceof t.Geometry))for(var l=u.vertices,c=l.length,h=new t.Vector3,f=new t.Vector3,p=this.mode===t.LineStrip?1:2,d=0;c-1>d;d+=p){var m=r.distanceSqToSegment(l[d],l[d+1],f,h);if(!(m>s)){var g=r.origin.distanceTo(f);g<i.near||g>i.far||a.push({distance:g,point:h.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this})}}}}(),t.Line.prototype.clone=function(e){return void 0===e&&(e=new t.Line(this.geometry,this.material,this.mode)),t.Object3D.prototype.clone.call(this,e),e},t.Mesh=function(e,r){t.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new t.Geometry,this.material=void 0!==r?r:new t.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},t.Mesh.prototype=Object.create(t.Object3D.prototype),t.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},t.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},t.Mesh.prototype.raycast=function(){var e=new t.Matrix4,r=new t.Ray,n=new t.Sphere,i=new t.Vector3,a=new t.Vector3,o=new t.Vector3;return function(s,u){var l=this.geometry;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(this.matrixWorld),s.ray.isIntersectionSphere(n)!==!1&&(e.getInverse(this.matrixWorld),r.copy(s.ray).applyMatrix4(e),null===l.boundingBox||r.isIntersectionBox(l.boundingBox)!==!1))if(l instanceof t.BufferGeometry){var c=this.material;if(void 0===c)return;var h,f,p,d=l.attributes,m=s.precision;if(void 0!==d.index){var g=d.index.array,v=d.position.array,y=l.offsets;0===y.length&&(y=[{start:0,count:g.length,index:0}]);for(var x=0,b=y.length;b>x;++x)for(var w=y[x].start,M=y[x].count,_=y[x].index,T=w,E=w+M;E>T;T+=3){if(h=_+g[T],f=_+g[T+1],p=_+g[T+2],i.fromArray(v,3*h),a.fromArray(v,3*f),o.fromArray(v,3*p),c.side===t.BackSide)var S=r.intersectTriangle(o,a,i,!0);else var S=r.intersectTriangle(i,a,o,c.side!==t.DoubleSide);if(null!==S){S.applyMatrix4(this.matrixWorld);var C=s.ray.origin.distanceTo(S);m>C||C<s.near||C>s.far||u.push({distance:C,point:S,face:new t.Face3(h,f,p,t.Triangle.normal(i,a,o)),faceIndex:null,object:this})}}}else for(var v=d.position.array,T=0,A=0,E=v.length;E>T;T+=3,A+=9){if(h=T,f=T+1,p=T+2,i.fromArray(v,A),a.fromArray(v,A+3),o.fromArray(v,A+6),c.side===t.BackSide)var S=r.intersectTriangle(o,a,i,!0);else var S=r.intersectTriangle(i,a,o,c.side!==t.DoubleSide);if(null!==S){S.applyMatrix4(this.matrixWorld);var C=s.ray.origin.distanceTo(S);m>C||C<s.near||C>s.far||u.push({distance:C,point:S,face:new t.Face3(h,f,p,t.Triangle.normal(i,a,o)),faceIndex:null,object:this})}}}else if(l instanceof t.Geometry)for(var h,f,p,N=this.material instanceof t.MeshFaceMaterial,R=N===!0?this.material.materials:null,m=s.precision,L=l.vertices,D=0,P=l.faces.length;P>D;D++){var I=l.faces[D],c=N===!0?R[I.materialIndex]:this.material;if(void 0!==c){if(h=L[I.a],f=L[I.b],p=L[I.c],c.morphTargets===!0){var F=l.morphTargets,U=this.morphTargetInfluences;i.set(0,0,0),a.set(0,0,0),o.set(0,0,0);for(var O=0,B=F.length;B>O;O++){var V=U[O];if(0!==V){var k=F[O].vertices;i.x+=(k[I.a].x-h.x)*V,i.y+=(k[I.a].y-h.y)*V,i.z+=(k[I.a].z-h.z)*V,a.x+=(k[I.b].x-f.x)*V,a.y+=(k[I.b].y-f.y)*V,a.z+=(k[I.b].z-f.z)*V,o.x+=(k[I.c].x-p.x)*V,o.y+=(k[I.c].y-p.y)*V,o.z+=(k[I.c].z-p.z)*V}}i.add(h),a.add(f),o.add(p),h=i,f=a,p=o}if(c.side===t.BackSide)var S=r.intersectTriangle(p,f,h,!0);else var S=r.intersectTriangle(h,f,p,c.side!==t.DoubleSide);if(null!==S){S.applyMatrix4(this.matrixWorld);var C=s.ray.origin.distanceTo(S);m>C||C<s.near||C>s.far||u.push({distance:C,point:S,face:I,faceIndex:D,object:this})}}}}}(),t.Mesh.prototype.clone=function(e,r){return void 0===e&&(e=new t.Mesh(this.geometry,this.material)),t.Object3D.prototype.clone.call(this,e,r),e},t.Bone=function(e){t.Object3D.call(this),this.skin=e},t.Bone.prototype=Object.create(t.Object3D.prototype),t.Skeleton=function(e,r,n){if(this.useVertexTexture=void 0!==n?n:!0,this.identityMatrix=new t.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var i;i=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new t.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,t.RGBAFormat,t.FloatType),this.boneTexture.minFilter=t.NearestFilter,this.boneTexture.magFilter=t.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===r)this.calculateInverses();else if(this.bones.length===r.length)this.boneInverses=r.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var a=0,o=this.bones.length;o>a;a++)this.boneInverses.push(new t.Matrix4)}},t.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,r=this.bones.length;r>e;e++){var n=new t.Matrix4;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},t.Skeleton.prototype.pose=function(){for(var e,t=0,r=this.bones.length;r>t;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(var t=0,r=this.bones.length;r>t;t++)e=this.bones[t],e&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},t.Skeleton.prototype.update=function(){var e=new t.Matrix4;return function(){for(var t=0,r=this.bones.length;r>t;t++){var n=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;e.multiplyMatrices(n,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),t.SkinnedMesh=function(e,r,n){t.Mesh.call(this,e,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new t.Matrix4,this.bindMatrixInverse=new t.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var a,o,s,u,l,c=0,h=this.geometry.bones.length;h>c;++c)o=this.geometry.bones[c],s=o.pos,u=o.rotq,l=o.scl,a=new t.Bone(this),i.push(a),a.name=o.name,a.position.set(s[0],s[1],s[2]),a.quaternion.set(u[0],u[1],u[2],u[3]),void 0!==l?a.scale.set(l[0],l[1],l[2]):a.scale.set(1,1,1);for(var c=0,h=this.geometry.bones.length;h>c;++c)o=this.geometry.bones[c],-1!==o.parent?i[o.parent].add(i[c]):this.add(i[c])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new t.Skeleton(i,void 0,n))},t.SkinnedMesh.prototype=Object.create(t.Mesh.prototype),t.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},t.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},t.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof t.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var r=this.geometry.skinWeights[e],n=1/r.lengthManhattan();1/0!==n?r.multiplyScalar(n):r.set(1)}},t.SkinnedMesh.prototype.updateMatrixWorld=function(){t.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},t.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new t.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),t.Mesh.prototype.clone.call(this,e),e},t.MorphAnimMesh=function(e,r){t.Mesh.call(this,e,r),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},t.MorphAnimMesh.prototype=Object.create(t.Mesh.prototype),t.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},t.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},t.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},t.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,r=e.animations,n=/([a-z]+)_?(\d+)/,i=0,a=e.morphTargets.length;a>i;i++){var o=e.morphTargets[i],s=o.name.match(n);if(s&&s.length>1){{var u=s[1];s[2]}r[u]||(r[u]={start:1/0,end:-1/0});var l=r[u];i<l.start&&(l.start=i),i>l.end&&(l.end=i),t||(t=u)}}e.firstAnimation=t},t.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,r){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:r}},t.MorphAnimMesh.prototype.playAnimation=function(e,t){var r=this.geometry.animations[e];r?(this.setFrameRange(r.start,r.end),this.duration=1e3*((r.end-r.start)/t),this.time=0):console.warn("animation["+e+"] undefined")},t.MorphAnimMesh.prototype.updateAnimation=function(e){var r=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var n=this.startKeyframe+t.Math.clamp(Math.floor(this.time/r),0,this.length-1);n!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n);var i=this.time%r/r;this.directionBackwards&&(i=1-i),this.morphTargetInfluences[this.currentKeyframe]=i,this.morphTargetInfluences[this.lastKeyframe]=1-i},t.MorphAnimMesh.prototype.interpolateTargets=function(e,t,r){for(var n=this.morphTargetInfluences,i=0,a=n.length;a>i;i++)n[i]=0;e>-1&&(n[e]=1-r),t>-1&&(n[t]=r)},t.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new t.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,t.Mesh.prototype.clone.call(this,e),e},t.LOD=function(){t.Object3D.call(this),this.objects=[]},t.LOD.prototype=Object.create(t.Object3D.prototype),t.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=0;r<this.objects.length&&!(t<this.objects[r].distance);r++);this.objects.splice(r,0,{distance:t,object:e}),this.add(e)},t.LOD.prototype.getObjectForDistance=function(e){for(var t=1,r=this.objects.length;r>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},t.LOD.prototype.raycast=function(){var e=new t.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}(),t.LOD.prototype.update=function(){var e=new t.Vector3,r=new t.Vector3;return function(t){if(this.objects.length>1){e.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(this.matrixWorld);var n=e.distanceTo(r);this.objects[0].object.visible=!0;for(var i=1,a=this.objects.length;a>i&&n>=this.objects[i].distance;i++)this.objects[i-1].object.visible=!1,this.objects[i].object.visible=!0;for(;a>i;i++)this.objects[i].object.visible=!1}}}(),t.LOD.prototype.clone=function(e){void 0===e&&(e=new t.LOD),t.Object3D.prototype.clone.call(this,e);for(var r=0,n=this.objects.length;n>r;r++){var i=this.objects[r].object.clone();i.visible=0===r,e.addLevel(i,this.objects[r].distance)}return e},t.Sprite=function(){var e=new Uint16Array([0,1,2,0,2,3]),r=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),n=new Float32Array([0,0,1,0,1,1,0,1]),i=new t.BufferGeometry;return i.addAttribute("index",new t.BufferAttribute(e,1)),i.addAttribute("position",new t.BufferAttribute(r,3)),i.addAttribute("uv",new t.BufferAttribute(n,2)),function(e){t.Object3D.call(this),this.type="Sprite",this.geometry=i,this.material=void 0!==e?e:new t.SpriteMaterial}}(),t.Sprite.prototype=Object.create(t.Object3D.prototype),t.Sprite.prototype.raycast=function(){var e=new t.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceToPoint(e);n>this.scale.x||r.push({distance:n,point:this.position,face:null,object:this})}}(),t.Sprite.prototype.clone=function(e){return void 0===e&&(e=new t.Sprite(this.material)),t.Object3D.prototype.clone.call(this,e),e},t.Particle=t.Sprite,t.LensFlare=function(e,r,n,i,a){t.Object3D.call(this),this.lensFlares=[],this.positionScreen=new t.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,r,n,i,a)},t.LensFlare.prototype=Object.create(t.Object3D.prototype),t.LensFlare.prototype.add=function(e,r,n,i,a,o){void 0===r&&(r=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===a&&(a=new t.Color(16777215)),void 0===i&&(i=t.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:r,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:a,blending:i})},t.LensFlare.prototype.updateLensFlares=function(){var e,t,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;r>e;e++)t=this.lensFlares[e],t.x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+i*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)},t.Scene=function(){t.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},t.Scene.prototype=Object.create(t.Object3D.prototype),t.Scene.prototype.clone=function(e){return void 0===e&&(e=new t.Scene),t.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},t.Fog=function(e,r,n){this.name="",this.color=new t.Color(e),this.near=void 0!==r?r:1,this.far=void 0!==n?n:1e3},t.Fog.prototype.clone=function(){return new t.Fog(this.color.getHex(),this.near,this.far)},t.FogExp2=function(e,r){this.name="",this.color=new t.Color(e),this.density=void 0!==r?r:25e-5},t.FogExp2.prototype.clone=function(){return new t.FogExp2(this.color.getHex(),this.density)},t.ShaderChunk={},t.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n",t.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n	vec3 dirVector = normalize( lDirection.xyz );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float lDistance = 1.0;\n			if ( spotLightDistance[ i ] > 0.0 )\n				lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif",t.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",t.ShaderChunk.default_vertex="vec4 mvPosition;\n\n#ifdef USE_SKINNING\n\n	mvPosition = modelViewMatrix * skinned;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;",t.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",t.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n",t.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",t.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif",t.ShaderChunk.lights_phong_fragment="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n	normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	vec3 pointDiffuse = vec3( 0.0 );\n	vec3 pointSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n				// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		pointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	vec3 spotDiffuse = vec3( 0.0 );\n	vec3 spotSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( spotLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n					// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n					// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	vec3 dirDiffuse = vec3( 0.0 );\n	vec3 dirSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n		vec3 dirVector = normalize( lDirection.xyz );\n\n				// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		dirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	vec3 hemiDiffuse = vec3( 0.0 );\n	vec3 hemiSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		hemiDiffuse += diffuse * hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n	totalDiffuse += dirDiffuse;\n	totalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	totalDiffuse += hemiDiffuse;\n	totalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	totalDiffuse += pointDiffuse;\n	totalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	totalDiffuse += spotDiffuse;\n	totalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif",t.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",t.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif",t.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	uniform samplerCube envMap;\n	uniform float flipEnvMap;\n	uniform int combine;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform bool useRefract;\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif",t.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",t.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n			// Per-Pixel Tangent Space Normal Mapping\n			// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",t.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",t.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif",t.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",t.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif",t.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	#ifdef GAMMA_INPUT\n\n		texelColor.xyz *= texelColor.xyz;\n\n	#endif\n\n	gl_FragColor = gl_FragColor * texelColor;\n\n#endif",t.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif",t.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif",t.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",t.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	#ifdef GAMMA_INPUT\n\n		vColor = color * color;\n\n	#else\n\n		vColor = color;\n\n	#endif\n\n#endif",t.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",t.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n	uniform bool useRefract;\n\n#endif\n",t.ShaderChunk.linear_to_gamma_fragment="#ifdef GAMMA_OUTPUT\n\n	gl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif",t.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",t.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n",t.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",t.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	vec3 reflectVec;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n		// Transforming Normal Vectors with the Inverse Transformation\n\n		vec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n		if ( useRefract ) {\n\n			reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		} else { \n\n			reflectVec = reflect( cameraToVertex, worldNormal );\n\n		}\n\n	#else\n\n		reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n		vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#else\n\n		vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#endif\n\n	#ifdef GAMMA_INPUT\n\n		cubeColor.xyz *= cubeColor.xyz;\n\n	#endif\n\n	if ( combine == 1 ) {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n\n	} else if ( combine == 2 ) {\n\n		gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n\n	} else {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n\n	}\n\n#endif",t.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",t.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",t.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",t.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",t.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		const float LOG2 = 1.442695;\n		float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n		fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif",t.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n			// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n			//	http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n			// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif",t.ShaderChunk.defaultnormal_vertex="vec3 objectNormal;\n\n#ifdef USE_SKINNING\n\n	objectNormal = skinnedNormal.xyz;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n\n	objectNormal = morphedNormal;\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n\n	objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;",t.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",t.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",t.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",t.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif",t.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",t.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif",t.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif",t.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n	worldNormal = normalize( worldNormal );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	if ( useRefract ) {\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	} else {\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	}\n\n#endif",t.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	#ifdef GAMMA_OUTPUT\n\n		shadowColor *= shadowColor;\n\n	#endif\n\n	gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n",t.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#endif\n\n	#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#endif\n\n	#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif",t.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",t.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",t.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif",t.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	gl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",t.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",t.UniformsUtils={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);
for(var i in n)t[i]=n[i]}return t},clone:function(e){var r={};for(var n in e){r[n]={};for(var i in e[n]){var a=e[n][i];r[n][i]=a instanceof t.Color||a instanceof t.Vector2||a instanceof t.Vector3||a instanceof t.Vector4||a instanceof t.Matrix4||a instanceof t.Texture?a.clone():a instanceof Array?a.slice():a}}return r}},t.UniformsLib={common:{diffuse:{type:"c",value:new t.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new t.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new t.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new t.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new t.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new t.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},t.ShaderLib={basic:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.fog,t.UniformsLib.shadowmap]),vertexShader:[t.ShaderChunk.map_pars_vertex,t.ShaderChunk.lightmap_pars_vertex,t.ShaderChunk.envmap_pars_vertex,t.ShaderChunk.color_pars_vertex,t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.skinning_pars_vertex,t.ShaderChunk.shadowmap_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.map_vertex,t.ShaderChunk.lightmap_vertex,t.ShaderChunk.color_vertex,t.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",t.ShaderChunk.morphnormal_vertex,t.ShaderChunk.skinnormal_vertex,t.ShaderChunk.defaultnormal_vertex,"	#endif",t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.skinning_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,t.ShaderChunk.worldpos_vertex,t.ShaderChunk.envmap_vertex,t.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",t.ShaderChunk.color_pars_fragment,t.ShaderChunk.map_pars_fragment,t.ShaderChunk.alphamap_pars_fragment,t.ShaderChunk.lightmap_pars_fragment,t.ShaderChunk.envmap_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.shadowmap_pars_fragment,t.ShaderChunk.specularmap_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( diffuse, opacity );",t.ShaderChunk.logdepthbuf_fragment,t.ShaderChunk.map_fragment,t.ShaderChunk.alphamap_fragment,t.ShaderChunk.alphatest_fragment,t.ShaderChunk.specularmap_fragment,t.ShaderChunk.lightmap_fragment,t.ShaderChunk.color_fragment,t.ShaderChunk.envmap_fragment,t.ShaderChunk.shadowmap_fragment,t.ShaderChunk.linear_to_gamma_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.fog,t.UniformsLib.lights,t.UniformsLib.shadowmap,{ambient:{type:"c",value:new t.Color(16777215)},emissive:{type:"c",value:new t.Color(0)},wrapRGB:{type:"v3",value:new t.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",t.ShaderChunk.map_pars_vertex,t.ShaderChunk.lightmap_pars_vertex,t.ShaderChunk.envmap_pars_vertex,t.ShaderChunk.lights_lambert_pars_vertex,t.ShaderChunk.color_pars_vertex,t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.skinning_pars_vertex,t.ShaderChunk.shadowmap_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.map_vertex,t.ShaderChunk.lightmap_vertex,t.ShaderChunk.color_vertex,t.ShaderChunk.morphnormal_vertex,t.ShaderChunk.skinbase_vertex,t.ShaderChunk.skinnormal_vertex,t.ShaderChunk.defaultnormal_vertex,t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.skinning_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,t.ShaderChunk.worldpos_vertex,t.ShaderChunk.envmap_vertex,t.ShaderChunk.lights_lambert_vertex,t.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",t.ShaderChunk.color_pars_fragment,t.ShaderChunk.map_pars_fragment,t.ShaderChunk.alphamap_pars_fragment,t.ShaderChunk.lightmap_pars_fragment,t.ShaderChunk.envmap_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.shadowmap_pars_fragment,t.ShaderChunk.specularmap_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",t.ShaderChunk.logdepthbuf_fragment,t.ShaderChunk.map_fragment,t.ShaderChunk.alphamap_fragment,t.ShaderChunk.alphatest_fragment,t.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			gl_FragColor.xyz *= vLightFront;","		else","			gl_FragColor.xyz *= vLightBack;","	#else","		gl_FragColor.xyz *= vLightFront;","	#endif",t.ShaderChunk.lightmap_fragment,t.ShaderChunk.color_fragment,t.ShaderChunk.envmap_fragment,t.ShaderChunk.shadowmap_fragment,t.ShaderChunk.linear_to_gamma_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.bump,t.UniformsLib.normalmap,t.UniformsLib.fog,t.UniformsLib.lights,t.UniformsLib.shadowmap,{ambient:{type:"c",value:new t.Color(16777215)},emissive:{type:"c",value:new t.Color(0)},specular:{type:"c",value:new t.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new t.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",t.ShaderChunk.map_pars_vertex,t.ShaderChunk.lightmap_pars_vertex,t.ShaderChunk.envmap_pars_vertex,t.ShaderChunk.lights_phong_pars_vertex,t.ShaderChunk.color_pars_vertex,t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.skinning_pars_vertex,t.ShaderChunk.shadowmap_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.map_vertex,t.ShaderChunk.lightmap_vertex,t.ShaderChunk.color_vertex,t.ShaderChunk.morphnormal_vertex,t.ShaderChunk.skinbase_vertex,t.ShaderChunk.skinnormal_vertex,t.ShaderChunk.defaultnormal_vertex,"	vNormal = normalize( transformedNormal );",t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.skinning_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = -mvPosition.xyz;",t.ShaderChunk.worldpos_vertex,t.ShaderChunk.envmap_vertex,t.ShaderChunk.lights_phong_vertex,t.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",t.ShaderChunk.color_pars_fragment,t.ShaderChunk.map_pars_fragment,t.ShaderChunk.alphamap_pars_fragment,t.ShaderChunk.lightmap_pars_fragment,t.ShaderChunk.envmap_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.lights_phong_pars_fragment,t.ShaderChunk.shadowmap_pars_fragment,t.ShaderChunk.bumpmap_pars_fragment,t.ShaderChunk.normalmap_pars_fragment,t.ShaderChunk.specularmap_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",t.ShaderChunk.logdepthbuf_fragment,t.ShaderChunk.map_fragment,t.ShaderChunk.alphamap_fragment,t.ShaderChunk.alphatest_fragment,t.ShaderChunk.specularmap_fragment,t.ShaderChunk.lights_phong_fragment,t.ShaderChunk.lightmap_fragment,t.ShaderChunk.color_fragment,t.ShaderChunk.envmap_fragment,t.ShaderChunk.shadowmap_fragment,t.ShaderChunk.linear_to_gamma_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:t.UniformsUtils.merge([t.UniformsLib.particle,t.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",t.ShaderChunk.color_pars_vertex,t.ShaderChunk.shadowmap_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",t.ShaderChunk.logdepthbuf_vertex,t.ShaderChunk.worldpos_vertex,t.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",t.ShaderChunk.color_pars_fragment,t.ShaderChunk.map_particle_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.shadowmap_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( psColor, opacity );",t.ShaderChunk.logdepthbuf_fragment,t.ShaderChunk.map_particle_fragment,t.ShaderChunk.alphatest_fragment,t.ShaderChunk.color_fragment,t.ShaderChunk.shadowmap_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:t.UniformsUtils.merge([t.UniformsLib.common,t.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",t.ShaderChunk.color_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",t.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",t.ShaderChunk.color_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	gl_FragColor = vec4( diffuse, opacity );",t.ShaderChunk.logdepthbuf_fragment,t.ShaderChunk.color_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",t.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",t.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},normalmap:{uniforms:t.UniformsUtils.merge([t.UniformsLib.fog,t.UniformsLib.lights,t.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new t.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new t.Color(16777215)},specular:{type:"c",value:new t.Color(1118481)},ambient:{type:"c",value:new t.Color(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:.98},reflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new t.Vector2(0,0)},uRepeat:{type:"v2",value:new t.Vector2(1,1)},wrapRGB:{type:"v3",value:new t.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float refractionRatio;","uniform float reflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","	uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",t.ShaderChunk.shadowmap_pars_fragment,t.ShaderChunk.fog_pars_fragment,t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",t.ShaderChunk.logdepthbuf_fragment,"	gl_FragColor = vec4( vec3( 1.0 ), opacity );","	vec3 specularTex = vec3( 1.0 );","	vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","	normalTex.xy *= uNormalScale;","	normalTex = normalize( normalTex );","	if( enableDiffuse ) {","		#ifdef GAMMA_INPUT","			vec4 texelColor = texture2D( tDiffuse, vUv );","			texelColor.xyz *= texelColor.xyz;","			gl_FragColor = gl_FragColor * texelColor;","		#else","			gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","		#endif","	}","	if( enableAO ) {","		#ifdef GAMMA_INPUT","			vec4 aoColor = texture2D( tAO, vUv );","			aoColor.xyz *= aoColor.xyz;","			gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","		#else","			gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","		#endif","	}",t.ShaderChunk.alphatest_fragment,"	if( enableSpecular )","		specularTex = texture2D( tSpecular, vUv ).xyz;","	mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","	vec3 finalNormal = tsb * normalTex;","	#ifdef FLIP_SIDED","		finalNormal = -finalNormal;","	#endif","	vec3 normal = normalize( finalNormal );","	vec3 viewPosition = normalize( vViewPosition );","	#if MAX_POINT_LIGHTS > 0","		vec3 pointDiffuse = vec3( 0.0 );","		vec3 pointSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","			vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","			float pointDistance = 1.0;","			if ( pointLightDistance[ i ] > 0.0 )","				pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","			pointVector = normalize( pointVector );","			#ifdef WRAP_AROUND","				float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","				float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","				vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","			#else","				float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","			#endif","			pointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;","			vec3 pointHalfVector = normalize( pointVector + viewPosition );","			float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","			float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( pointVector, pointHalfVector ), 0.0 ), 5.0 );","			pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","		}","	#endif","	#if MAX_SPOT_LIGHTS > 0","		vec3 spotDiffuse = vec3( 0.0 );","		vec3 spotSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","			vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","			float spotDistance = 1.0;","			if ( spotLightDistance[ i ] > 0.0 )","				spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","			spotVector = normalize( spotVector );","			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","			if ( spotEffect > spotLightAngleCos[ i ] ) {","				spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );","				#ifdef WRAP_AROUND","					float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","					float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","					vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","				#else","					float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","				#endif","				spotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;","				vec3 spotHalfVector = normalize( spotVector + viewPosition );","				float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","				float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );","				float specularNormalization = ( shininess + 2.0 ) / 8.0;","				vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( spotVector, spotHalfVector ), 0.0 ), 5.0 );","				spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","			}","		}","	#endif","	#if MAX_DIR_LIGHTS > 0","		vec3 dirDiffuse = vec3( 0.0 );","		vec3 dirSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","			vec3 dirVector = normalize( lDirection.xyz );","			#ifdef WRAP_AROUND","				float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","				float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","				vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","			#else","				float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","			#endif","			dirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;","			vec3 dirHalfVector = normalize( dirVector + viewPosition );","			float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","			float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );","			dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","		}","	#endif","	#if MAX_HEMI_LIGHTS > 0","		vec3 hemiDiffuse = vec3( 0.0 );","		vec3 hemiSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","			vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","			vec3 lVector = normalize( lDirection.xyz );","			float dotProduct = dot( normal, lVector );","			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","			vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","			hemiDiffuse += diffuse * hemiColor;","			vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","			float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","			float hemiSpecularWeightSky = specularTex.r * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );","			vec3 lVectorGround = -lVector;","			vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","			float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","			float hemiSpecularWeightGround = specularTex.r * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );","			float dotProductGround = dot( normal, lVectorGround );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );","			vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );","			hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","		}","	#endif","	vec3 totalDiffuse = vec3( 0.0 );","	vec3 totalSpecular = vec3( 0.0 );","	#if MAX_DIR_LIGHTS > 0","		totalDiffuse += dirDiffuse;","		totalSpecular += dirSpecular;","	#endif","	#if MAX_HEMI_LIGHTS > 0","		totalDiffuse += hemiDiffuse;","		totalSpecular += hemiSpecular;","	#endif","	#if MAX_POINT_LIGHTS > 0","		totalDiffuse += pointDiffuse;","		totalSpecular += pointSpecular;","	#endif","	#if MAX_SPOT_LIGHTS > 0","		totalDiffuse += spotDiffuse;","		totalSpecular += spotSpecular;","	#endif","	#ifdef METAL","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );","	#else","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","	#endif","	if ( enableReflection ) {","		vec3 vReflect;","		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","		if ( useRefract ) {","			vReflect = refract( cameraToVertex, normal, refractionRatio );","		} else {","			vReflect = reflect( cameraToVertex, normal );","		}","		vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","		#ifdef GAMMA_INPUT","			cubeColor.xyz *= cubeColor.xyz;","		#endif","		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );","	}",t.ShaderChunk.shadowmap_fragment,t.ShaderChunk.linear_to_gamma_fragment,t.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","	uniform sampler2D tDisplacement;","	uniform float uDisplacementScale;","	uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",t.ShaderChunk.skinning_pars_vertex,t.ShaderChunk.shadowmap_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.skinbase_vertex,t.ShaderChunk.skinnormal_vertex,"	#ifdef USE_SKINNING","		vNormal = normalize( normalMatrix * skinnedNormal.xyz );","		vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","		vTangent = normalize( normalMatrix * skinnedTangent.xyz );","	#else","		vNormal = normalize( normalMatrix * normal );","		vTangent = normalize( normalMatrix * tangent.xyz );","	#endif","	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","	vUv = uv * uRepeat + uOffset;","	vec3 displacedPosition;","	#ifdef VERTEX_TEXTURES","		if ( enableDisplacement ) {","			vec3 dv = texture2D( tDisplacement, uv ).xyz;","			float df = uDisplacementScale * dv.x + uDisplacementBias;","			displacedPosition = position + normalize( normal ) * df;","		} else {","			#ifdef USE_SKINNING","				vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","				vec4 skinned = vec4( 0.0 );","				skinned += boneMatX * skinVertex * skinWeight.x;","				skinned += boneMatY * skinVertex * skinWeight.y;","				skinned += boneMatZ * skinVertex * skinWeight.z;","				skinned += boneMatW * skinVertex * skinWeight.w;","				skinned  = bindMatrixInverse * skinned;","				displacedPosition = skinned.xyz;","			#else","				displacedPosition = position;","			#endif","		}","	#else","		#ifdef USE_SKINNING","			vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","			vec4 skinned = vec4( 0.0 );","			skinned += boneMatX * skinVertex * skinWeight.x;","			skinned += boneMatY * skinVertex * skinWeight.y;","			skinned += boneMatZ * skinVertex * skinWeight.z;","			skinned += boneMatW * skinVertex * skinWeight.w;","			skinned  = bindMatrixInverse * skinned;","			displacedPosition = skinned.xyz;","		#else","			displacedPosition = position;","		#endif","	#endif","	vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","	vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",t.ShaderChunk.logdepthbuf_vertex,"	vWorldPosition = worldPosition.xyz;","	vViewPosition = -mvPosition.xyz;","	#ifdef USE_SHADOWMAP","		for( int i = 0; i < MAX_SHADOWS; i ++ ) {","			vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","		}","	#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","	vWorldPosition = worldPosition.xyz;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",t.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",t.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",t.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[t.ShaderChunk.morphtarget_pars_vertex,t.ShaderChunk.skinning_pars_vertex,t.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",t.ShaderChunk.skinbase_vertex,t.ShaderChunk.morphtarget_vertex,t.ShaderChunk.skinning_vertex,t.ShaderChunk.default_vertex,t.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[t.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",t.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}},t.WebGLRenderer=function(e){function r(){Ot.clearColor(0,0,0,1),Ot.clearDepth(1),Ot.clearStencil(0),Ot.enable(Ot.DEPTH_TEST),Ot.depthFunc(Ot.LEQUAL),Ot.frontFace(Ot.CCW),Ot.cullFace(Ot.BACK),Ot.enable(Ot.CULL_FACE),Ot.enable(Ot.BLEND),Ot.blendEquation(Ot.FUNC_ADD),Ot.blendFunc(Ot.SRC_ALPHA,Ot.ONE_MINUS_SRC_ALPHA),Ot.viewport(ir,ar,or,sr),Ot.clearColor(At.r,At.g,At.b,Nt)}function n(e){e.__webglVertexBuffer=Ot.createBuffer(),e.__webglColorBuffer=Ot.createBuffer(),Bt.info.memory.geometries++}function i(e){e.__webglVertexBuffer=Ot.createBuffer(),e.__webglColorBuffer=Ot.createBuffer(),e.__webglLineDistanceBuffer=Ot.createBuffer(),Bt.info.memory.geometries++}function a(e){e.__webglVertexBuffer=Ot.createBuffer(),e.__webglNormalBuffer=Ot.createBuffer(),e.__webglTangentBuffer=Ot.createBuffer(),e.__webglColorBuffer=Ot.createBuffer(),e.__webglUVBuffer=Ot.createBuffer(),e.__webglUV2Buffer=Ot.createBuffer(),e.__webglSkinIndicesBuffer=Ot.createBuffer(),e.__webglSkinWeightsBuffer=Ot.createBuffer(),e.__webglFaceBuffer=Ot.createBuffer(),e.__webglLineBuffer=Ot.createBuffer();var t,r;if(e.numMorphTargets)for(e.__webglMorphTargetsBuffers=[],t=0,r=e.numMorphTargets;r>t;t++)e.__webglMorphTargetsBuffers.push(Ot.createBuffer());if(e.numMorphNormals)for(e.__webglMorphNormalsBuffers=[],t=0,r=e.numMorphNormals;r>t;t++)e.__webglMorphNormalsBuffers.push(Ot.createBuffer());Bt.info.memory.geometries++}function o(e){var t=e.geometry,r=e.material,n=t.vertices.length;if(r.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var i in r.attributes){var a=r.attributes[i];if(!a.__webglInitialized||a.createUniqueBuffers){a.__webglInitialized=!0;var o=1;"v2"===a.type?o=2:"v3"===a.type?o=3:"v4"===a.type?o=4:"c"===a.type&&(o=3),a.size=o,a.array=new Float32Array(n*o),a.buffer=Ot.createBuffer(),a.buffer.belongsToAttribute=i,a.needsUpdate=!0}t.__webglCustomAttributesList.push(a)}}}function s(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__sortArray=[],e.__webglParticleCount=r,o(t)}function u(e,t){var r=e.vertices.length;e.__vertexArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__lineDistanceArray=new Float32Array(1*r),e.__webglLineCount=r,o(t)}function l(e,t){var r=t.geometry,n=e.faces3,i=3*n.length,a=1*n.length,o=3*n.length,s=c(t,e);e.__vertexArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__uvArray=new Float32Array(2*i),r.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*i)),r.hasTangents&&(e.__tangentArray=new Float32Array(4*i)),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*i),e.__skinWeightArray=new Float32Array(4*i));var u=null!==wr.get("OES_element_index_uint")&&a>21845?Uint32Array:Uint16Array;e.__typeArray=u,e.__faceArray=new u(3*a),e.__lineArray=new u(2*o);var l,h;if(e.numMorphTargets)for(e.__morphTargetsArrays=[],l=0,h=e.numMorphTargets;h>l;l++)e.__morphTargetsArrays.push(new Float32Array(3*i));if(e.numMorphNormals)for(e.__morphNormalsArrays=[],l=0,h=e.numMorphNormals;h>l;l++)e.__morphNormalsArrays.push(new Float32Array(3*i));if(e.__webglFaceCount=3*a,e.__webglLineCount=2*o,s.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var f in s.attributes){var p=s.attributes[f],d={};for(var m in p)d[m]=p[m];if(!d.__webglInitialized||d.createUniqueBuffers){d.__webglInitialized=!0;var g=1;"v2"===d.type?g=2:"v3"===d.type?g=3:"v4"===d.type?g=4:"c"===d.type&&(g=3),d.size=g,d.array=new Float32Array(i*g),d.buffer=Ot.createBuffer(),d.buffer.belongsToAttribute=f,p.needsUpdate=!0,d.__original=p
}e.__webglCustomAttributesList.push(d)}}e.__inittedArrays=!0}function c(e,r){return e.material instanceof t.MeshFaceMaterial?e.material.materials[r.materialIndex]:e.material}function h(e){return e&&void 0!==e.shading&&e.shading===t.SmoothShading}function f(e,t,r){var n,i,a,o,s,u,l,c,h,f,p,d,m=e.vertices,g=m.length,v=e.colors,y=v.length,x=e.__vertexArray,b=e.__colorArray,w=e.__sortArray,M=e.verticesNeedUpdate,T=(e.elementsNeedUpdate,e.colorsNeedUpdate),E=e.__webglCustomAttributesList;if(r.sortParticles){for(dr.copy(pr),dr.multiply(r.matrixWorld),n=0;g>n;n++)a=m[n],mr.copy(a),mr.applyProjection(dr),w[n]=[mr.z,n];for(w.sort(_),n=0;g>n;n++)a=m[w[n][1]],o=3*n,x[o]=a.x,x[o+1]=a.y,x[o+2]=a.z;for(i=0;y>i;i++)o=3*i,u=v[w[i][1]],b[o]=u.r,b[o+1]=u.g,b[o+2]=u.b;if(E)for(l=0,c=E.length;c>l;l++)if(d=E[l],void 0===d.boundTo||"vertices"===d.boundTo)if(o=0,f=d.value.length,1===d.size)for(h=0;f>h;h++)s=w[h][1],d.array[h]=d.value[s];else if(2===d.size)for(h=0;f>h;h++)s=w[h][1],p=d.value[s],d.array[o]=p.x,d.array[o+1]=p.y,o+=2;else if(3===d.size)if("c"===d.type)for(h=0;f>h;h++)s=w[h][1],p=d.value[s],d.array[o]=p.r,d.array[o+1]=p.g,d.array[o+2]=p.b,o+=3;else for(h=0;f>h;h++)s=w[h][1],p=d.value[s],d.array[o]=p.x,d.array[o+1]=p.y,d.array[o+2]=p.z,o+=3;else if(4===d.size)for(h=0;f>h;h++)s=w[h][1],p=d.value[s],d.array[o]=p.x,d.array[o+1]=p.y,d.array[o+2]=p.z,d.array[o+3]=p.w,o+=4}else{if(M)for(n=0;g>n;n++)a=m[n],o=3*n,x[o]=a.x,x[o+1]=a.y,x[o+2]=a.z;if(T)for(i=0;y>i;i++)u=v[i],o=3*i,b[o]=u.r,b[o+1]=u.g,b[o+2]=u.b;if(E)for(l=0,c=E.length;c>l;l++)if(d=E[l],d.needsUpdate&&(void 0===d.boundTo||"vertices"===d.boundTo))if(f=d.value.length,o=0,1===d.size)for(h=0;f>h;h++)d.array[h]=d.value[h];else if(2===d.size)for(h=0;f>h;h++)p=d.value[h],d.array[o]=p.x,d.array[o+1]=p.y,o+=2;else if(3===d.size)if("c"===d.type)for(h=0;f>h;h++)p=d.value[h],d.array[o]=p.r,d.array[o+1]=p.g,d.array[o+2]=p.b,o+=3;else for(h=0;f>h;h++)p=d.value[h],d.array[o]=p.x,d.array[o+1]=p.y,d.array[o+2]=p.z,o+=3;else if(4===d.size)for(h=0;f>h;h++)p=d.value[h],d.array[o]=p.x,d.array[o+1]=p.y,d.array[o+2]=p.z,d.array[o+3]=p.w,o+=4}if((M||r.sortParticles)&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglVertexBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,x,t)),(T||r.sortParticles)&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglColorBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,b,t)),E)for(l=0,c=E.length;c>l;l++)d=E[l],(d.needsUpdate||r.sortParticles)&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,d.buffer),Ot.bufferData(Ot.ARRAY_BUFFER,d.array,t))}function p(e,t){var r,n,i,a,o,s,u,l,c,h,f,p,d=e.vertices,m=e.colors,g=e.lineDistances,v=d.length,y=m.length,x=g.length,b=e.__vertexArray,w=e.__colorArray,M=e.__lineDistanceArray,_=e.verticesNeedUpdate,T=e.colorsNeedUpdate,E=e.lineDistancesNeedUpdate,S=e.__webglCustomAttributesList;if(_){for(r=0;v>r;r++)a=d[r],o=3*r,b[o]=a.x,b[o+1]=a.y,b[o+2]=a.z;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglVertexBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,b,t)}if(T){for(n=0;y>n;n++)s=m[n],o=3*n,w[o]=s.r,w[o+1]=s.g,w[o+2]=s.b;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglColorBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,w,t)}if(E){for(i=0;x>i;i++)M[i]=g[i];Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglLineDistanceBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,M,t)}if(S)for(u=0,l=S.length;l>u;u++)if(p=S[u],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(o=0,h=p.value.length,1===p.size)for(c=0;h>c;c++)p.array[c]=p.value[c];else if(2===p.size)for(c=0;h>c;c++)f=p.value[c],p.array[o]=f.x,p.array[o+1]=f.y,o+=2;else if(3===p.size)if("c"===p.type)for(c=0;h>c;c++)f=p.value[c],p.array[o]=f.r,p.array[o+1]=f.g,p.array[o+2]=f.b,o+=3;else for(c=0;h>c;c++)f=p.value[c],p.array[o]=f.x,p.array[o+1]=f.y,p.array[o+2]=f.z,o+=3;else if(4===p.size)for(c=0;h>c;c++)f=p.value[c],p.array[o]=f.x,p.array[o+1]=f.y,p.array[o+2]=f.z,p.array[o+3]=f.w,o+=4;Ot.bindBuffer(Ot.ARRAY_BUFFER,p.buffer),Ot.bufferData(Ot.ARRAY_BUFFER,p.array,t)}}function d(e,r,n,i,a){if(e.__inittedArrays){var o,s,u,l,c,f,p,d,m,g,v,y,x,b,w,M,_,T,E,S,C,A,N,R,L,D,P,I,F,U,O,B,V,k,z,q,G,H,j,W,X,Y,K=h(a),Z=0,Q=0,$=0,J=0,et=0,tt=0,rt=0,nt=0,it=0,at=0,ot=0,st=0,ut=0,lt=e.__vertexArray,ct=e.__uvArray,ht=e.__uv2Array,ft=e.__normalArray,pt=e.__tangentArray,dt=e.__colorArray,mt=e.__skinIndexArray,gt=e.__skinWeightArray,vt=e.__morphTargetsArrays,yt=e.__morphNormalsArrays,xt=e.__webglCustomAttributesList,bt=e.__faceArray,wt=e.__lineArray,Mt=r.geometry,_t=Mt.verticesNeedUpdate,Tt=Mt.elementsNeedUpdate,Et=Mt.uvsNeedUpdate,St=Mt.normalsNeedUpdate,Ct=Mt.tangentsNeedUpdate,At=Mt.colorsNeedUpdate,Nt=Mt.morphTargetsNeedUpdate,Rt=Mt.vertices,Lt=e.faces3,Dt=Mt.faces,Pt=Mt.faceVertexUvs[0],It=Mt.faceVertexUvs[1],Ft=(Mt.colors,Mt.skinIndices),Ut=Mt.skinWeights,Bt=Mt.morphTargets,Vt=Mt.morphNormals;if(_t){for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],y=Rt[l.a],x=Rt[l.b],b=Rt[l.c],lt[Q]=y.x,lt[Q+1]=y.y,lt[Q+2]=y.z,lt[Q+3]=x.x,lt[Q+4]=x.y,lt[Q+5]=x.z,lt[Q+6]=b.x,lt[Q+7]=b.y,lt[Q+8]=b.z,Q+=9;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglVertexBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,lt,n)}if(Nt)for(z=0,q=Bt.length;q>z;z++){for(ot=0,o=0,s=Lt.length;s>o;o++)j=Lt[o],l=Dt[j],y=Bt[z].vertices[l.a],x=Bt[z].vertices[l.b],b=Bt[z].vertices[l.c],void 0===b&&console.log("undefined"),G=vt[z],G[ot]=y.x,G[ot+1]=y.y,G[ot+2]=y.z,G[ot+3]=x.x,G[ot+4]=x.y,G[ot+5]=x.z,G[ot+6]=b.x,G[ot+7]=b.y,G[ot+8]=b.z,a.morphNormals&&(K?(W=Vt[z].vertexNormals[j],T=W.a,E=W.b,S=W.c):(T=Vt[z].faceNormals[j],E=T,S=T),H=yt[z],H[ot]=T.x,H[ot+1]=T.y,H[ot+2]=T.z,H[ot+3]=E.x,H[ot+4]=E.y,H[ot+5]=E.z,H[ot+6]=S.x,H[ot+7]=S.y,H[ot+8]=S.z),ot+=9;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[z]),Ot.bufferData(Ot.ARRAY_BUFFER,vt[z],n),a.morphNormals&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[z]),Ot.bufferData(Ot.ARRAY_BUFFER,yt[z],n))}if(Ut.length){for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],R=Ut[l.a],L=Ut[l.b],D=Ut[l.c],gt[at]=R.x,gt[at+1]=R.y,gt[at+2]=R.z,gt[at+3]=R.w,gt[at+4]=L.x,gt[at+5]=L.y,gt[at+6]=L.z,gt[at+7]=L.w,gt[at+8]=D.x,gt[at+9]=D.y,gt[at+10]=D.z,gt[at+11]=D.w,P=Ft[l.a],I=Ft[l.b],F=Ft[l.c],mt[at]=P.x,mt[at+1]=P.y,mt[at+2]=P.z,mt[at+3]=P.w,mt[at+4]=I.x,mt[at+5]=I.y,mt[at+6]=I.z,mt[at+7]=I.w,mt[at+8]=F.x,mt[at+9]=F.y,mt[at+10]=F.z,mt[at+11]=F.w,at+=12;at>0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,mt,n),Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,gt,n))}if(At){for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],p=l.vertexColors,d=l.color,3===p.length&&a.vertexColors===t.VertexColors?(C=p[0],A=p[1],N=p[2]):(C=d,A=d,N=d),dt[it]=C.r,dt[it+1]=C.g,dt[it+2]=C.b,dt[it+3]=A.r,dt[it+4]=A.g,dt[it+5]=A.b,dt[it+6]=N.r,dt[it+7]=N.g,dt[it+8]=N.b,it+=9;it>0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglColorBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,dt,n))}if(Ct&&Mt.hasTangents){for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],m=l.vertexTangents,w=m[0],M=m[1],_=m[2],pt[rt]=w.x,pt[rt+1]=w.y,pt[rt+2]=w.z,pt[rt+3]=w.w,pt[rt+4]=M.x,pt[rt+5]=M.y,pt[rt+6]=M.z,pt[rt+7]=M.w,pt[rt+8]=_.x,pt[rt+9]=_.y,pt[rt+10]=_.z,pt[rt+11]=_.w,rt+=12;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglTangentBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,pt,n)}if(St){for(o=0,s=Lt.length;s>o;o++)if(l=Dt[Lt[o]],c=l.vertexNormals,f=l.normal,3===c.length&&K)for(U=0;3>U;U++)B=c[U],ft[tt]=B.x,ft[tt+1]=B.y,ft[tt+2]=B.z,tt+=3;else for(U=0;3>U;U++)ft[tt]=f.x,ft[tt+1]=f.y,ft[tt+2]=f.z,tt+=3;Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglNormalBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,ft,n)}if(Et&&Pt){for(o=0,s=Lt.length;s>o;o++)if(u=Lt[o],g=Pt[u],void 0!==g)for(U=0;3>U;U++)V=g[U],ct[$]=V.x,ct[$+1]=V.y,$+=2;$>0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglUVBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,ct,n))}if(Et&&It){for(o=0,s=Lt.length;s>o;o++)if(u=Lt[o],v=It[u],void 0!==v)for(U=0;3>U;U++)k=v[U],ht[J]=k.x,ht[J+1]=k.y,J+=2;J>0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglUV2Buffer),Ot.bufferData(Ot.ARRAY_BUFFER,ht,n))}if(Tt){for(o=0,s=Lt.length;s>o;o++)bt[et]=Z,bt[et+1]=Z+1,bt[et+2]=Z+2,et+=3,wt[nt]=Z,wt[nt+1]=Z+1,wt[nt+2]=Z,wt[nt+3]=Z+2,wt[nt+4]=Z+1,wt[nt+5]=Z+2,nt+=6,Z+=3;Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),Ot.bufferData(Ot.ELEMENT_ARRAY_BUFFER,bt,n),Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),Ot.bufferData(Ot.ELEMENT_ARRAY_BUFFER,wt,n)}if(xt)for(U=0,O=xt.length;O>U;U++)if(Y=xt[U],Y.__original.needsUpdate){if(st=0,ut=0,1===Y.size){if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],Y.array[st]=Y.value[l.a],Y.array[st+1]=Y.value[l.b],Y.array[st+2]=Y.value[l.c],st+=3;else if("faces"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],Y.array[st]=X,Y.array[st+1]=X,Y.array[st+2]=X,st+=3}else if(2===Y.size){if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],y=Y.value[l.a],x=Y.value[l.b],b=Y.value[l.c],Y.array[st]=y.x,Y.array[st+1]=y.y,Y.array[st+2]=x.x,Y.array[st+3]=x.y,Y.array[st+4]=b.x,Y.array[st+5]=b.y,st+=6;else if("faces"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],y=X,x=X,b=X,Y.array[st]=y.x,Y.array[st+1]=y.y,Y.array[st+2]=x.x,Y.array[st+3]=x.y,Y.array[st+4]=b.x,Y.array[st+5]=b.y,st+=6}else if(3===Y.size){var kt;if(kt="c"===Y.type?["r","g","b"]:["x","y","z"],void 0===Y.boundTo||"vertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],y=Y.value[l.a],x=Y.value[l.b],b=Y.value[l.c],Y.array[st]=y[kt[0]],Y.array[st+1]=y[kt[1]],Y.array[st+2]=y[kt[2]],Y.array[st+3]=x[kt[0]],Y.array[st+4]=x[kt[1]],Y.array[st+5]=x[kt[2]],Y.array[st+6]=b[kt[0]],Y.array[st+7]=b[kt[1]],Y.array[st+8]=b[kt[2]],st+=9;else if("faces"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],y=X,x=X,b=X,Y.array[st]=y[kt[0]],Y.array[st+1]=y[kt[1]],Y.array[st+2]=y[kt[2]],Y.array[st+3]=x[kt[0]],Y.array[st+4]=x[kt[1]],Y.array[st+5]=x[kt[2]],Y.array[st+6]=b[kt[0]],Y.array[st+7]=b[kt[1]],Y.array[st+8]=b[kt[2]],st+=9;else if("faceVertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],y=X[0],x=X[1],b=X[2],Y.array[st]=y[kt[0]],Y.array[st+1]=y[kt[1]],Y.array[st+2]=y[kt[2]],Y.array[st+3]=x[kt[0]],Y.array[st+4]=x[kt[1]],Y.array[st+5]=x[kt[2]],Y.array[st+6]=b[kt[0]],Y.array[st+7]=b[kt[1]],Y.array[st+8]=b[kt[2]],st+=9}else if(4===Y.size)if(void 0===Y.boundTo||"vertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)l=Dt[Lt[o]],y=Y.value[l.a],x=Y.value[l.b],b=Y.value[l.c],Y.array[st]=y.x,Y.array[st+1]=y.y,Y.array[st+2]=y.z,Y.array[st+3]=y.w,Y.array[st+4]=x.x,Y.array[st+5]=x.y,Y.array[st+6]=x.z,Y.array[st+7]=x.w,Y.array[st+8]=b.x,Y.array[st+9]=b.y,Y.array[st+10]=b.z,Y.array[st+11]=b.w,st+=12;else if("faces"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],y=X,x=X,b=X,Y.array[st]=y.x,Y.array[st+1]=y.y,Y.array[st+2]=y.z,Y.array[st+3]=y.w,Y.array[st+4]=x.x,Y.array[st+5]=x.y,Y.array[st+6]=x.z,Y.array[st+7]=x.w,Y.array[st+8]=b.x,Y.array[st+9]=b.y,Y.array[st+10]=b.z,Y.array[st+11]=b.w,st+=12;else if("faceVertices"===Y.boundTo)for(o=0,s=Lt.length;s>o;o++)X=Y.value[Lt[o]],y=X[0],x=X[1],b=X[2],Y.array[st]=y.x,Y.array[st+1]=y.y,Y.array[st+2]=y.z,Y.array[st+3]=y.w,Y.array[st+4]=x.x,Y.array[st+5]=x.y,Y.array[st+6]=x.z,Y.array[st+7]=x.w,Y.array[st+8]=b.x,Y.array[st+9]=b.y,Y.array[st+10]=b.z,Y.array[st+11]=b.w,st+=12;Ot.bindBuffer(Ot.ARRAY_BUFFER,Y.buffer),Ot.bufferData(Ot.ARRAY_BUFFER,Y.array,n)}i&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function m(e){for(var t=e.attributes,r=e.attributesKeys,n=0,i=r.length;i>n;n++){var a=r[n],o=t[a];if(void 0===o.buffer&&(o.buffer=Ot.createBuffer(),o.needsUpdate=!0),o.needsUpdate===!0){var s="index"===a?Ot.ELEMENT_ARRAY_BUFFER:Ot.ARRAY_BUFFER;Ot.bindBuffer(s,o.buffer),Ot.bufferData(s,o.array,Ot.STATIC_DRAW),o.needsUpdate=!1}}}function g(e,t,r,n){for(var i=r.attributes,a=t.attributes,o=t.attributesKeys,s=0,u=o.length;u>s;s++){var l=o[s],c=a[l];if(c>=0){var h=i[l];if(void 0!==h){var f=h.itemSize;Ot.bindBuffer(Ot.ARRAY_BUFFER,h.buffer),y(c),Ot.vertexAttribPointer(c,f,Ot.FLOAT,!1,0,n*f*4)}else void 0!==e.defaultAttributeValues&&(2===e.defaultAttributeValues[l].length?Ot.vertexAttrib2fv(c,e.defaultAttributeValues[l]):3===e.defaultAttributeValues[l].length&&Ot.vertexAttrib3fv(c,e.defaultAttributeValues[l]))}}x()}function v(){for(var e=0,t=cr.length;t>e;e++)cr[e]=0}function y(e){cr[e]=1,0===hr[e]&&(Ot.enableVertexAttribArray(e),hr[e]=1)}function x(){for(var e=0,t=hr.length;t>e;e++)hr[e]!==cr[e]&&(Ot.disableVertexAttribArray(e),hr[e]=0)}function b(e,t,r){var n=e.program.attributes;if(-1!==r.morphTargetBase&&n.position>=0?(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[r.morphTargetBase]),y(n.position),Ot.vertexAttribPointer(n.position,3,Ot.FLOAT,!1,0,0)):n.position>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglVertexBuffer),y(n.position),Ot.vertexAttribPointer(n.position,3,Ot.FLOAT,!1,0,0)),r.morphTargetForcedOrder.length)for(var i=0,a=r.morphTargetForcedOrder,o=r.morphTargetInfluences;i<e.numSupportedMorphTargets&&i<a.length;)n["morphTarget"+i]>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[a[i]]),y(n["morphTarget"+i]),Ot.vertexAttribPointer(n["morphTarget"+i],3,Ot.FLOAT,!1,0,0)),n["morphNormal"+i]>=0&&e.morphNormals&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[a[i]]),y(n["morphNormal"+i]),Ot.vertexAttribPointer(n["morphNormal"+i],3,Ot.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[i]=o[a[i]],i++;else{var s,u,l=[],o=r.morphTargetInfluences,c=o.length;for(u=0;c>u;u++)s=o[u],s>0&&l.push([s,u]);l.length>e.numSupportedMorphTargets?(l.sort(_),l.length=e.numSupportedMorphTargets):l.length>e.numSupportedMorphNormals?l.sort(_):0===l.length&&l.push([0,0]);for(var h,i=0;i<e.numSupportedMorphTargets;)l[i]?(h=l[i][1],n["morphTarget"+i]>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[h]),y(n["morphTarget"+i]),Ot.vertexAttribPointer(n["morphTarget"+i],3,Ot.FLOAT,!1,0,0)),n["morphNormal"+i]>=0&&e.morphNormals&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[h]),y(n["morphNormal"+i]),Ot.vertexAttribPointer(n["morphNormal"+i],3,Ot.FLOAT,!1,0,0)),r.__webglMorphTargetInfluences[i]=o[h]):r.__webglMorphTargetInfluences[i]=0,i++}null!==e.program.uniforms.morphTargetInfluences&&Ot.uniform1fv(e.program.uniforms.morphTargetInfluences,r.__webglMorphTargetInfluences)}function w(e,t){return e.material.id!==t.material.id?t.material.id-e.material.id:e.z!==t.z?t.z-e.z:e.id-t.id}function M(e,t){return e.z!==t.z?e.z-t.z:e.id-t.id}function _(e,t){return t[0]-e[0]}function T(e,r){if(r.visible!==!1){if(r instanceof t.Scene||r instanceof t.Group);else if(N(r,e),r instanceof t.Light)Rt.push(r);else if(r instanceof t.Sprite)Ft.push(r);else if(r instanceof t.LensFlare)Ut.push(r);else{var n=Lt[r.id];if(n&&(r.frustumCulled===!1||fr.intersectsObject(r)===!0)){I(r,e);for(var i=0,a=n.length;a>i;i++){var o=n[i];A(o),o.render=!0,Bt.sortObjects===!0&&(null!==r.renderDepth?o.z=r.renderDepth:(mr.setFromMatrixPosition(r.matrixWorld),mr.applyProjection(pr),o.z=mr.z))}}}for(var i=0,a=r.children.length;a>i;i++)T(e,r.children[i])}}function E(e,r,n,i,a,o){for(var s,u=e.length-1;-1!==u;u--){var l=e[u],c=l.object,h=l.buffer;if(et(c,r),o)s=o;else{if(s=l.material,!s)continue;a&&Bt.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst),Bt.setDepthTest(s.depthTest),Bt.setDepthWrite(s.depthWrite),at(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}Bt.setMaterialFaces(s),h instanceof t.BufferGeometry?Bt.renderBufferDirect(r,n,i,s,h,c):Bt.renderBuffer(r,n,i,s,h,c)}}function S(e,t,r,n,i,a,o){for(var s,u=0,l=e.length;l>u;u++){var c=e[u],h=c.object;if(h.visible){if(o)s=o;else{if(s=c[t],!s)continue;a&&Bt.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst),Bt.setDepthTest(s.depthTest),Bt.setDepthWrite(s.depthWrite),at(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}Bt.renderImmediateObject(r,n,i,s,h)}}}function C(e){var t=e.object,r=t.material;r.transparent?(e.transparent=r,e.opaque=null):(e.opaque=r,e.transparent=null)}function A(e){var r=e.object,n=e.buffer,i=r.geometry,a=r.material;if(a instanceof t.MeshFaceMaterial){var o=i instanceof t.BufferGeometry?0:n.materialIndex;a=a.materials[o],e.material=a,a.transparent?It.push(e):Pt.push(e)}else a&&(e.material=a,a.transparent?It.push(e):Pt.push(e))}function N(e,r){void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new t.Matrix4,e._normalMatrix=new t.Matrix3,e.addEventListener("removed",Br));var a=e.geometry;if(void 0===a||void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("dispose",Vr),a instanceof t.BufferGeometry||(e instanceof t.Mesh?L(r,e,a):e instanceof t.Line?void 0===a.__webglVertexBuffer&&(i(a),u(a,e),a.verticesNeedUpdate=!0,a.colorsNeedUpdate=!0,a.lineDistancesNeedUpdate=!0):e instanceof t.PointCloud&&void 0===a.__webglVertexBuffer&&(n(a),s(a,e),a.verticesNeedUpdate=!0,a.colorsNeedUpdate=!0))),void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof t.Mesh){if(a instanceof t.BufferGeometry)D(Lt,a,e);else if(a instanceof t.Geometry)for(var o=Yr[a.id],l=0,c=o.length;c>l;l++)D(Lt,o[l],e)}else e instanceof t.Line||e instanceof t.PointCloud?D(Lt,a,e):(e instanceof t.ImmediateRenderObject||e.immediateRenderCallback)&&P(Dt,e)}function R(e,t){for(var r,n,i=wr.get("OES_element_index_uint")?4294967296:65535,a={},o=e.morphTargets.length,s=e.morphNormals.length,u={},l=[],c=0,h=e.faces.length;h>c;c++){var f=e.faces[c],p=t?f.materialIndex:0;p in a||(a[p]={hash:p,counter:0}),r=a[p].hash+"_"+a[p].counter,r in u||(n={id:Kr++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:o,numMorphNormals:s},u[r]=n,l.push(n)),u[r].vertices+3>i&&(a[p].counter+=1,r=a[p].hash+"_"+a[p].counter,r in u||(n={id:Kr++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:o,numMorphNormals:s},u[r]=n,l.push(n))),u[r].faces3.push(c),u[r].vertices+=3}return l}function L(e,r,n){var i=r.material,o=!1;(void 0===Yr[n.id]||n.groupsNeedUpdate===!0)&&(delete Lt[r.id],Yr[n.id]=R(n,i instanceof t.MeshFaceMaterial),n.groupsNeedUpdate=!1);for(var s=Yr[n.id],u=0,c=s.length;c>u;u++){var h=s[u];void 0===h.__webglVertexBuffer?(a(h),l(h,r),n.verticesNeedUpdate=!0,n.morphTargetsNeedUpdate=!0,n.elementsNeedUpdate=!0,n.uvsNeedUpdate=!0,n.normalsNeedUpdate=!0,n.tangentsNeedUpdate=!0,n.colorsNeedUpdate=!0,o=!0):o=!1,(o||void 0===r.__webglActive)&&D(Lt,h,r)}r.__webglActive=!0}function D(e,t,r){var n=r.id;e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:r,material:null,z:0})}function P(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function I(e,r){var n,i,a=e.geometry;if(a instanceof t.BufferGeometry)m(a);else if(e instanceof t.Mesh){a.groupsNeedUpdate===!0&&L(r,e,a);for(var o=Yr[a.id],s=0,u=o.length;u>s;s++){var h=o[s];i=c(e,h),a.groupsNeedUpdate===!0&&l(h,e),n=i.attributes&&F(i),(a.verticesNeedUpdate||a.morphTargetsNeedUpdate||a.elementsNeedUpdate||a.uvsNeedUpdate||a.normalsNeedUpdate||a.colorsNeedUpdate||a.tangentsNeedUpdate||n)&&d(h,e,Ot.DYNAMIC_DRAW,!a.dynamic,i)}a.verticesNeedUpdate=!1,a.morphTargetsNeedUpdate=!1,a.elementsNeedUpdate=!1,a.uvsNeedUpdate=!1,a.normalsNeedUpdate=!1,a.colorsNeedUpdate=!1,a.tangentsNeedUpdate=!1,i.attributes&&U(i)}else e instanceof t.Line?(i=c(e,a),n=i.attributes&&F(i),(a.verticesNeedUpdate||a.colorsNeedUpdate||a.lineDistancesNeedUpdate||n)&&p(a,Ot.DYNAMIC_DRAW),a.verticesNeedUpdate=!1,a.colorsNeedUpdate=!1,a.lineDistancesNeedUpdate=!1,i.attributes&&U(i)):e instanceof t.PointCloud&&(i=c(e,a),n=i.attributes&&F(i),(a.verticesNeedUpdate||a.colorsNeedUpdate||e.sortParticles||n)&&f(a,Ot.DYNAMIC_DRAW,e),a.verticesNeedUpdate=!1,a.colorsNeedUpdate=!1,i.attributes&&U(i))}function F(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function U(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function O(e){e instanceof t.Mesh||e instanceof t.PointCloud||e instanceof t.Line?delete Lt[e.id]:(e instanceof t.ImmediateRenderObject||e.immediateRenderCallback)&&B(Dt,e),delete e.__webglInit,delete e._modelViewMatrix,delete e._normalMatrix,delete e.__webglActive}function B(e,t){for(var r=e.length-1;r>=0;r--)e[r].object===t&&e.splice(r,1)}function V(e,r,n,i){e.addEventListener("dispose",qr);var a;if(e instanceof t.MeshDepthMaterial?a="depth":e instanceof t.MeshNormalMaterial?a="normal":e instanceof t.MeshBasicMaterial?a="basic":e instanceof t.MeshLambertMaterial?a="lambert":e instanceof t.MeshPhongMaterial?a="phong":e instanceof t.LineBasicMaterial?a="basic":e instanceof t.LineDashedMaterial?a="dashed":e instanceof t.PointCloudMaterial&&(a="particle_basic"),a){var o=t.ShaderLib[a];e.__webglShader={uniforms:t.UniformsUtils.clone(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var s=gt(r),u=vt(r),l=mt(i),c={precision:bt,supportsVertexTextures:Sr,map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,fog:n,useFog:e.fog,fogExp:n instanceof t.FogExp2,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:Ct,skinning:e.skinning,maxBones:l,useVertexTexture:Cr&&i&&i.skeleton&&i.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:Bt.maxMorphTargets,maxMorphNormals:Bt.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:u,shadowMapEnabled:Bt.shadowMapEnabled&&i.receiveShadow&&u>0,shadowMapType:Bt.shadowMapType,shadowMapDebug:Bt.shadowMapDebug,shadowMapCascade:Bt.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===t.DoubleSide,flipSided:e.side===t.BackSide},h=[];if(a?h.push(a):(h.push(e.fragmentShader),h.push(e.vertexShader)),void 0!==e.defines)for(var f in e.defines)h.push(f),h.push(e.defines[f]);for(var f in c)h.push(f),h.push(c[f]);for(var p,d=h.join(),m=0,g=Vt.length;g>m;m++){var v=Vt[m];if(v.code===d){p=v,p.usedTimes++;break}}void 0===p&&(p=new t.WebGLProgram(Bt,d,e,c),Vt.push(p),Bt.info.memory.programs=Vt.length),e.program=p;var y=p.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;for(var x,b="morphTarget",w=0;w<Bt.maxMorphTargets;w++)x=b+w,y[x]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;var x,b="morphNormal";for(w=0;w<Bt.maxMorphNormals;w++)x=b+w,y[x]>=0&&e.numSupportedMorphNormals++}e.uniformsList=[];for(var M in e.__webglShader.uniforms){var _=e.program.uniforms[M];_&&e.uniformsList.push([e.__webglShader.uniforms[M],_])}}function k(e,r,n,i,a){jt=0,i.needsUpdate&&(i.program&&Xr(i),V(i,r,n,a),i.needsUpdate=!1),i.morphTargets&&(a.__webglMorphTargetInfluences||(a.__webglMorphTargetInfluences=new Float32Array(Bt.maxMorphTargets)));var o=!1,s=!1,u=!1,l=i.program,c=l.uniforms,h=i.__webglShader.uniforms;if(l.id!==kt&&(Ot.useProgram(l.program),kt=l.id,o=!0,s=!0,u=!0),i.id!==qt&&(-1===qt&&(u=!0),qt=i.id,s=!0),(o||e!==Ht)&&(Ot.uniformMatrix4fv(c.projectionMatrix,!1,e.projectionMatrix.elements),Ct&&Ot.uniform1f(c.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==Ht&&(Ht=e),(i instanceof t.ShaderMaterial||i instanceof t.MeshPhongMaterial||i.envMap)&&null!==c.cameraPosition&&(mr.setFromMatrixPosition(e.matrixWorld),Ot.uniform3f(c.cameraPosition,mr.x,mr.y,mr.z)),(i instanceof t.MeshPhongMaterial||i instanceof t.MeshLambertMaterial||i instanceof t.ShaderMaterial||i.skinning)&&null!==c.viewMatrix&&Ot.uniformMatrix4fv(c.viewMatrix,!1,e.matrixWorldInverse.elements)),i.skinning)if(a.bindMatrix&&null!==c.bindMatrix&&Ot.uniformMatrix4fv(c.bindMatrix,!1,a.bindMatrix.elements),a.bindMatrixInverse&&null!==c.bindMatrixInverse&&Ot.uniformMatrix4fv(c.bindMatrixInverse,!1,a.bindMatrixInverse.elements),Cr&&a.skeleton&&a.skeleton.useVertexTexture){if(null!==c.boneTexture){var f=$();Ot.uniform1i(c.boneTexture,f),Bt.setTexture(a.skeleton.boneTexture,f)}null!==c.boneTextureWidth&&Ot.uniform1i(c.boneTextureWidth,a.skeleton.boneTextureWidth),null!==c.boneTextureHeight&&Ot.uniform1i(c.boneTextureHeight,a.skeleton.boneTextureHeight)}else a.skeleton&&a.skeleton.boneMatrices&&null!==c.boneGlobalMatrices&&Ot.uniformMatrix4fv(c.boneGlobalMatrices,!1,a.skeleton.boneMatrices);return s&&(n&&i.fog&&j(h,n),(i instanceof t.MeshPhongMaterial||i instanceof t.MeshLambertMaterial||i.lights)&&(vr&&(u=!0,nt(r),vr=!1),u?(Y(h,yr),K(h,!0)):K(h,!1)),(i instanceof t.MeshBasicMaterial||i instanceof t.MeshLambertMaterial||i instanceof t.MeshPhongMaterial)&&z(h,i),i instanceof t.LineBasicMaterial?q(h,i):i instanceof t.LineDashedMaterial?(q(h,i),G(h,i)):i instanceof t.PointCloudMaterial?H(h,i):i instanceof t.MeshPhongMaterial?W(h,i):i instanceof t.MeshLambertMaterial?X(h,i):i instanceof t.MeshDepthMaterial?(h.mNear.value=e.near,h.mFar.value=e.far,h.opacity.value=i.opacity):i instanceof t.MeshNormalMaterial&&(h.opacity.value=i.opacity),a.receiveShadow&&!i._shadowPass&&Z(h,r),J(i.uniformsList)),Q(c,a),null!==c.modelMatrix&&Ot.uniformMatrix4fv(c.modelMatrix,!1,a.matrixWorld.elements),l}function z(e,r){e.opacity.value=r.opacity,Bt.gammaInput?e.diffuse.value.copyGammaToLinear(r.color):e.diffuse.value=r.color,e.map.value=r.map,e.lightMap.value=r.lightMap,e.specularMap.value=r.specularMap,e.alphaMap.value=r.alphaMap,r.bumpMap&&(e.bumpMap.value=r.bumpMap,e.bumpScale.value=r.bumpScale),r.normalMap&&(e.normalMap.value=r.normalMap,e.normalScale.value.copy(r.normalScale));var n;if(r.map?n=r.map:r.specularMap?n=r.specularMap:r.normalMap?n=r.normalMap:r.bumpMap?n=r.bumpMap:r.alphaMap&&(n=r.alphaMap),void 0!==n){var i=n.offset,a=n.repeat;e.offsetRepeat.value.set(i.x,i.y,a.x,a.y)}e.envMap.value=r.envMap,e.flipEnvMap.value=r.envMap instanceof t.WebGLRenderTargetCube?1:-1,e.reflectivity.value=Bt.gammaInput?r.reflectivity:r.reflectivity,e.refractionRatio.value=r.refractionRatio,e.combine.value=r.combine,e.useRefract.value=r.envMap&&r.envMap.mapping instanceof t.CubeRefractionMapping}function q(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function G(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function H(e,t){e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=yt.height/2,e.map.value=t.map}function j(e,r){e.fogColor.value=r.color,r instanceof t.Fog?(e.fogNear.value=r.near,e.fogFar.value=r.far):r instanceof t.FogExp2&&(e.fogDensity.value=r.density)}function W(e,t){e.shininess.value=t.shininess,Bt.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive),e.specular.value.copyGammaToLinear(t.specular)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive,e.specular.value=t.specular),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function X(e,t){Bt.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function Y(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function K(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function Z(e,r){if(e.shadowMatrix)for(var n=0,i=0,a=r.length;a>i;i++){var o=r[i];o.castShadow&&(o instanceof t.SpotLight||o instanceof t.DirectionalLight&&!o.shadowCascade)&&(e.shadowMap.value[n]=o.shadowMap,e.shadowMapSize.value[n]=o.shadowMapSize,e.shadowMatrix.value[n]=o.shadowMatrix,e.shadowDarkness.value[n]=o.shadowDarkness,e.shadowBias.value[n]=o.shadowBias,n++)}}function Q(e,t){Ot.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&Ot.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}function $(){var e=jt;return e>=Mr&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Mr),jt+=1,e}function J(e){for(var r,n,i,a=0,o=e.length;o>a;a++){var s=e[a][0];if(s.needsUpdate!==!1){var u=s.type,l=s.value,c=e[a][1];switch(u){case"1i":Ot.uniform1i(c,l);break;case"1f":Ot.uniform1f(c,l);break;case"2f":Ot.uniform2f(c,l[0],l[1]);break;case"3f":Ot.uniform3f(c,l[0],l[1],l[2]);break;case"4f":Ot.uniform4f(c,l[0],l[1],l[2],l[3]);break;case"1iv":Ot.uniform1iv(c,l);break;case"3iv":Ot.uniform3iv(c,l);break;case"1fv":Ot.uniform1fv(c,l);break;case"2fv":Ot.uniform2fv(c,l);break;case"3fv":Ot.uniform3fv(c,l);break;case"4fv":Ot.uniform4fv(c,l);break;case"Matrix3fv":Ot.uniformMatrix3fv(c,!1,l);break;case"Matrix4fv":Ot.uniformMatrix4fv(c,!1,l);break;case"i":Ot.uniform1i(c,l);break;case"f":Ot.uniform1f(c,l);break;case"v2":Ot.uniform2f(c,l.x,l.y);break;case"v3":Ot.uniform3f(c,l.x,l.y,l.z);break;case"v4":Ot.uniform4f(c,l.x,l.y,l.z,l.w);break;case"c":Ot.uniform3f(c,l.r,l.g,l.b);break;case"iv1":Ot.uniform1iv(c,l);break;case"iv":Ot.uniform3iv(c,l);break;case"fv1":Ot.uniform1fv(c,l);break;case"fv":Ot.uniform3fv(c,l);break;case"v2v":void 0===s._array&&(s._array=new Float32Array(2*l.length));for(var h=0,f=l.length;f>h;h++)i=2*h,s._array[i]=l[h].x,s._array[i+1]=l[h].y;Ot.uniform2fv(c,s._array);break;case"v3v":void 0===s._array&&(s._array=new Float32Array(3*l.length));for(var h=0,f=l.length;f>h;h++)i=3*h,s._array[i]=l[h].x,s._array[i+1]=l[h].y,s._array[i+2]=l[h].z;Ot.uniform3fv(c,s._array);break;case"v4v":void 0===s._array&&(s._array=new Float32Array(4*l.length));for(var h=0,f=l.length;f>h;h++)i=4*h,s._array[i]=l[h].x,s._array[i+1]=l[h].y,s._array[i+2]=l[h].z,s._array[i+3]=l[h].w;Ot.uniform4fv(c,s._array);break;case"m3":Ot.uniformMatrix3fv(c,!1,l.elements);break;case"m3v":void 0===s._array&&(s._array=new Float32Array(9*l.length));for(var h=0,f=l.length;f>h;h++)l[h].flattenToArrayOffset(s._array,9*h);Ot.uniformMatrix3fv(c,!1,s._array);break;case"m4":Ot.uniformMatrix4fv(c,!1,l.elements);break;case"m4v":void 0===s._array&&(s._array=new Float32Array(16*l.length));for(var h=0,f=l.length;f>h;h++)l[h].flattenToArrayOffset(s._array,16*h);Ot.uniformMatrix4fv(c,!1,s._array);break;case"t":if(r=l,n=$(),Ot.uniform1i(c,n),!r)continue;r instanceof t.CubeTexture||r.image instanceof Array&&6===r.image.length?ut(r,n):r instanceof t.WebGLRenderTargetCube?lt(r,n):Bt.setTexture(r,n);break;case"tv":void 0===s._array&&(s._array=[]);for(var h=0,f=s.value.length;f>h;h++)s._array[h]=$();Ot.uniform1iv(c,s._array);for(var h=0,f=s.value.length;f>h;h++)r=s.value[h],n=s._array[h],r&&Bt.setTexture(r,n);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+u)}}}}function et(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function tt(e,t,r,n){e[t]=r.r*r.r*n,e[t+1]=r.g*r.g*n,e[t+2]=r.b*r.b*n}function rt(e,t,r,n){e[t]=r.r*n,e[t+1]=r.g*n,e[t+2]=r.b*n}function nt(e){var r,n,i,a,o,s,u,l,c,h=0,f=0,p=0,d=yr,m=d.directional.colors,g=d.directional.positions,v=d.point.colors,y=d.point.positions,x=d.point.distances,b=d.spot.colors,w=d.spot.positions,M=d.spot.distances,_=d.spot.directions,T=d.spot.anglesCos,E=d.spot.exponents,S=d.hemi.skyColors,C=d.hemi.groundColors,A=d.hemi.positions,N=0,R=0,L=0,D=0,P=0,I=0,F=0,U=0,O=0,B=0,V=0,k=0;for(r=0,n=e.length;n>r;r++)if(i=e[r],!i.onlyShadow)if(a=i.color,u=i.intensity,c=i.distance,i instanceof t.AmbientLight){if(!i.visible)continue;
Bt.gammaInput?(h+=a.r*a.r,f+=a.g*a.g,p+=a.b*a.b):(h+=a.r,f+=a.g,p+=a.b)}else if(i instanceof t.DirectionalLight){if(P+=1,!i.visible)continue;gr.setFromMatrixPosition(i.matrixWorld),mr.setFromMatrixPosition(i.target.matrixWorld),gr.sub(mr),gr.normalize(),O=3*N,g[O]=gr.x,g[O+1]=gr.y,g[O+2]=gr.z,Bt.gammaInput?tt(m,O,a,u*u):rt(m,O,a,u),N+=1}else if(i instanceof t.PointLight){if(I+=1,!i.visible)continue;B=3*R,Bt.gammaInput?tt(v,B,a,u*u):rt(v,B,a,u),mr.setFromMatrixPosition(i.matrixWorld),y[B]=mr.x,y[B+1]=mr.y,y[B+2]=mr.z,x[R]=c,R+=1}else if(i instanceof t.SpotLight){if(F+=1,!i.visible)continue;V=3*L,Bt.gammaInput?tt(b,V,a,u*u):rt(b,V,a,u),gr.setFromMatrixPosition(i.matrixWorld),w[V]=gr.x,w[V+1]=gr.y,w[V+2]=gr.z,M[L]=c,mr.setFromMatrixPosition(i.target.matrixWorld),gr.sub(mr),gr.normalize(),_[V]=gr.x,_[V+1]=gr.y,_[V+2]=gr.z,T[L]=Math.cos(i.angle),E[L]=i.exponent,L+=1}else if(i instanceof t.HemisphereLight){if(U+=1,!i.visible)continue;gr.setFromMatrixPosition(i.matrixWorld),gr.normalize(),k=3*D,A[k]=gr.x,A[k+1]=gr.y,A[k+2]=gr.z,o=i.color,s=i.groundColor,Bt.gammaInput?(l=u*u,tt(S,k,o,l),tt(C,k,s,l)):(rt(S,k,o,u),rt(C,k,s,u)),D+=1}for(r=3*N,n=Math.max(m.length,3*P);n>r;r++)m[r]=0;for(r=3*R,n=Math.max(v.length,3*I);n>r;r++)v[r]=0;for(r=3*L,n=Math.max(b.length,3*F);n>r;r++)b[r]=0;for(r=3*D,n=Math.max(S.length,3*U);n>r;r++)S[r]=0;for(r=3*D,n=Math.max(C.length,3*U);n>r;r++)C[r]=0;d.directional.length=N,d.point.length=R,d.spot.length=L,d.hemi.length=D,d.ambient[0]=h,d.ambient[1]=f,d.ambient[2]=p}function it(e){e!==nr&&(Ot.lineWidth(e),nr=e)}function at(e,t,r){er!==e&&(e?Ot.enable(Ot.POLYGON_OFFSET_FILL):Ot.disable(Ot.POLYGON_OFFSET_FILL),er=e),!e||tr===t&&rr===r||(Ot.polygonOffset(t,r),tr=t,rr=r)}function ot(e,r,n){var i;n?(Ot.texParameteri(e,Ot.TEXTURE_WRAP_S,dt(r.wrapS)),Ot.texParameteri(e,Ot.TEXTURE_WRAP_T,dt(r.wrapT)),Ot.texParameteri(e,Ot.TEXTURE_MAG_FILTER,dt(r.magFilter)),Ot.texParameteri(e,Ot.TEXTURE_MIN_FILTER,dt(r.minFilter))):(Ot.texParameteri(e,Ot.TEXTURE_WRAP_S,Ot.CLAMP_TO_EDGE),Ot.texParameteri(e,Ot.TEXTURE_WRAP_T,Ot.CLAMP_TO_EDGE),Ot.texParameteri(e,Ot.TEXTURE_MAG_FILTER,pt(r.magFilter)),Ot.texParameteri(e,Ot.TEXTURE_MIN_FILTER,pt(r.minFilter))),i=wr.get("EXT_texture_filter_anisotropic"),i&&r.type!==t.FloatType&&(r.anisotropy>1||r.__oldAnisotropy)&&(Ot.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,Bt.getMaxAnisotropy())),r.__oldAnisotropy=r.anisotropy)}function st(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height),n=document.createElement("canvas");n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r);var i=n.getContext("2d");return i.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.log("THREE.WebGLRenderer:",e,"is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height+"."),n}return e}function ut(e,r){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",kr),e.image.__webglTextureCube=Ot.createTexture(),Bt.info.memory.textures++),Ot.activeTexture(Ot.TEXTURE0+r),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),Ot.pixelStorei(Ot.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e instanceof t.CompressedTexture,i=e.image[0]instanceof t.DataTexture,a=[],o=0;6>o;o++)a[o]=!Bt.autoScaleCubemaps||n||i?i?e.image[o].image:e.image[o]:st(e.image[o],Er);var s=a[0],u=t.Math.isPowerOfTwo(s.width)&&t.Math.isPowerOfTwo(s.height),l=dt(e.format),c=dt(e.type);ot(Ot.TEXTURE_CUBE_MAP,e,u);for(var o=0;6>o;o++)if(n)for(var h,f=a[o].mipmaps,p=0,d=f.length;d>p;p++)h=f[p],e.format!==t.RGBAFormat&&e.format!==t.RGBFormat?Dr().indexOf(l)>-1?Ot.compressedTexImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o,p,l,h.width,h.height,0,h.data):console.warn("Attempt to load unsupported compressed texture format"):Ot.texImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o,p,l,h.width,h.height,0,l,c,h.data);else i?Ot.texImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,a[o].width,a[o].height,0,l,c,a[o].data):Ot.texImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,l,c,a[o]);e.generateMipmaps&&u&&Ot.generateMipmap(Ot.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else Ot.activeTexture(Ot.TEXTURE0+r),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function lt(e,t){Ot.activeTexture(Ot.TEXTURE0+t),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,e.__webglTexture)}function ct(e,t,r){Ot.bindFramebuffer(Ot.FRAMEBUFFER,e),Ot.framebufferTexture2D(Ot.FRAMEBUFFER,Ot.COLOR_ATTACHMENT0,r,t.__webglTexture,0)}function ht(e,t){Ot.bindRenderbuffer(Ot.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(Ot.renderbufferStorage(Ot.RENDERBUFFER,Ot.DEPTH_COMPONENT16,t.width,t.height),Ot.framebufferRenderbuffer(Ot.FRAMEBUFFER,Ot.DEPTH_ATTACHMENT,Ot.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(Ot.renderbufferStorage(Ot.RENDERBUFFER,Ot.DEPTH_STENCIL,t.width,t.height),Ot.framebufferRenderbuffer(Ot.FRAMEBUFFER,Ot.DEPTH_STENCIL_ATTACHMENT,Ot.RENDERBUFFER,e)):Ot.renderbufferStorage(Ot.RENDERBUFFER,Ot.RGBA4,t.width,t.height)}function ft(e){e instanceof t.WebGLRenderTargetCube?(Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,e.__webglTexture),Ot.generateMipmap(Ot.TEXTURE_CUBE_MAP),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,null)):(Ot.bindTexture(Ot.TEXTURE_2D,e.__webglTexture),Ot.generateMipmap(Ot.TEXTURE_2D),Ot.bindTexture(Ot.TEXTURE_2D,null))}function pt(e){return e===t.NearestFilter||e===t.NearestMipMapNearestFilter||e===t.NearestMipMapLinearFilter?Ot.NEAREST:Ot.LINEAR}function dt(e){var r;if(e===t.RepeatWrapping)return Ot.REPEAT;if(e===t.ClampToEdgeWrapping)return Ot.CLAMP_TO_EDGE;if(e===t.MirroredRepeatWrapping)return Ot.MIRRORED_REPEAT;if(e===t.NearestFilter)return Ot.NEAREST;if(e===t.NearestMipMapNearestFilter)return Ot.NEAREST_MIPMAP_NEAREST;if(e===t.NearestMipMapLinearFilter)return Ot.NEAREST_MIPMAP_LINEAR;if(e===t.LinearFilter)return Ot.LINEAR;if(e===t.LinearMipMapNearestFilter)return Ot.LINEAR_MIPMAP_NEAREST;if(e===t.LinearMipMapLinearFilter)return Ot.LINEAR_MIPMAP_LINEAR;if(e===t.UnsignedByteType)return Ot.UNSIGNED_BYTE;if(e===t.UnsignedShort4444Type)return Ot.UNSIGNED_SHORT_4_4_4_4;if(e===t.UnsignedShort5551Type)return Ot.UNSIGNED_SHORT_5_5_5_1;if(e===t.UnsignedShort565Type)return Ot.UNSIGNED_SHORT_5_6_5;if(e===t.ByteType)return Ot.BYTE;if(e===t.ShortType)return Ot.SHORT;if(e===t.UnsignedShortType)return Ot.UNSIGNED_SHORT;if(e===t.IntType)return Ot.INT;if(e===t.UnsignedIntType)return Ot.UNSIGNED_INT;if(e===t.FloatType)return Ot.FLOAT;if(e===t.AlphaFormat)return Ot.ALPHA;if(e===t.RGBFormat)return Ot.RGB;if(e===t.RGBAFormat)return Ot.RGBA;if(e===t.LuminanceFormat)return Ot.LUMINANCE;if(e===t.LuminanceAlphaFormat)return Ot.LUMINANCE_ALPHA;if(e===t.AddEquation)return Ot.FUNC_ADD;if(e===t.SubtractEquation)return Ot.FUNC_SUBTRACT;if(e===t.ReverseSubtractEquation)return Ot.FUNC_REVERSE_SUBTRACT;if(e===t.ZeroFactor)return Ot.ZERO;if(e===t.OneFactor)return Ot.ONE;if(e===t.SrcColorFactor)return Ot.SRC_COLOR;if(e===t.OneMinusSrcColorFactor)return Ot.ONE_MINUS_SRC_COLOR;if(e===t.SrcAlphaFactor)return Ot.SRC_ALPHA;if(e===t.OneMinusSrcAlphaFactor)return Ot.ONE_MINUS_SRC_ALPHA;if(e===t.DstAlphaFactor)return Ot.DST_ALPHA;if(e===t.OneMinusDstAlphaFactor)return Ot.ONE_MINUS_DST_ALPHA;if(e===t.DstColorFactor)return Ot.DST_COLOR;if(e===t.OneMinusDstColorFactor)return Ot.ONE_MINUS_DST_COLOR;if(e===t.SrcAlphaSaturateFactor)return Ot.SRC_ALPHA_SATURATE;if(r=wr.get("WEBGL_compressed_texture_s3tc"),null!==r){if(e===t.RGB_S3TC_DXT1_Format)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===t.RGBA_S3TC_DXT1_Format)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===t.RGBA_S3TC_DXT3_Format)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===t.RGBA_S3TC_DXT5_Format)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r=wr.get("WEBGL_compressed_texture_pvrtc"),null!==r){if(e===t.RGB_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===t.RGB_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===t.RGBA_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===t.RGBA_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r=wr.get("EXT_blend_minmax"),null!==r){if(e===t.MinEquation)return r.MIN_EXT;if(e===t.MaxEquation)return r.MAX_EXT}return 0}function mt(e){if(Cr&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var r=Ot.getParameter(Ot.MAX_VERTEX_UNIFORM_VECTORS),n=Math.floor((r-20)/4),i=n;return void 0!==e&&e instanceof t.SkinnedMesh&&(i=Math.min(e.skeleton.bones.length,i),i<e.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)")),i}function gt(e){for(var r=0,n=0,i=0,a=0,o=0,s=e.length;s>o;o++){var u=e[o];u.onlyShadow||u.visible===!1||(u instanceof t.DirectionalLight&&r++,u instanceof t.PointLight&&n++,u instanceof t.SpotLight&&i++,u instanceof t.HemisphereLight&&a++)}return{directional:r,point:n,spot:i,hemi:a}}function vt(e){for(var r=0,n=0,i=e.length;i>n;n++){var a=e[n];a.castShadow&&(a instanceof t.SpotLight&&r++,a instanceof t.DirectionalLight&&!a.shadowCascade&&r++)}return r}console.log("THREE.WebGLRenderer",t.REVISION),e=e||{};var yt=void 0!==e.canvas?e.canvas:document.createElement("canvas"),xt=void 0!==e.context?e.context:null,bt=void 0!==e.precision?e.precision:"highp",wt=void 0!==e.alpha?e.alpha:!1,Mt=void 0!==e.depth?e.depth:!0,_t=void 0!==e.stencil?e.stencil:!0,Tt=void 0!==e.antialias?e.antialias:!1,Et=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,St=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,Ct=void 0!==e.logarithmicDepthBuffer?e.logarithmicDepthBuffer:!1,At=new t.Color(0),Nt=0,Rt=[],Lt={},Dt=[],Pt=[],It=[],Ft=[],Ut=[];this.domElement=yt,this.context=null,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=t.PCFShadowMap,this.shadowMapCullFace=t.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Ot,Bt=this,Vt=[],kt=null,zt=null,qt=-1,Gt=-1,Ht=null,jt=0,Wt=-1,Xt=-1,Yt=-1,Kt=-1,Zt=-1,Qt=-1,$t=-1,Jt=-1,er=null,tr=null,rr=null,nr=null,ir=0,ar=0,or=yt.width,sr=yt.height,ur=0,lr=0,cr=new Uint8Array(16),hr=new Uint8Array(16),fr=new t.Frustum,pr=new t.Matrix4,dr=new t.Matrix4,mr=new t.Vector3,gr=new t.Vector3,vr=!0,yr={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var xr={alpha:wt,depth:Mt,stencil:_t,antialias:Tt,premultipliedAlpha:Et,preserveDrawingBuffer:St};if(Ot=xt||yt.getContext("webgl",xr)||yt.getContext("experimental-webgl",xr),null===Ot)throw null!==yt.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context."}catch(br){console.error(br)}void 0===Ot.getShaderPrecisionFormat&&(Ot.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var wr=new t.WebGLExtensions(Ot);wr.get("OES_texture_float"),wr.get("OES_texture_float_linear"),wr.get("OES_standard_derivatives"),Ct&&wr.get("EXT_frag_depth"),r(),this.context=Ot;var Mr=Ot.getParameter(Ot.MAX_TEXTURE_IMAGE_UNITS),_r=Ot.getParameter(Ot.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Tr=Ot.getParameter(Ot.MAX_TEXTURE_SIZE),Er=Ot.getParameter(Ot.MAX_CUBE_MAP_TEXTURE_SIZE),Sr=_r>0,Cr=Sr&&wr.get("OES_texture_float"),Ar=Ot.getShaderPrecisionFormat(Ot.VERTEX_SHADER,Ot.HIGH_FLOAT),Nr=Ot.getShaderPrecisionFormat(Ot.VERTEX_SHADER,Ot.MEDIUM_FLOAT),Rr=(Ot.getShaderPrecisionFormat(Ot.VERTEX_SHADER,Ot.LOW_FLOAT),Ot.getShaderPrecisionFormat(Ot.FRAGMENT_SHADER,Ot.HIGH_FLOAT)),Lr=Ot.getShaderPrecisionFormat(Ot.FRAGMENT_SHADER,Ot.MEDIUM_FLOAT),Dr=(Ot.getShaderPrecisionFormat(Ot.FRAGMENT_SHADER,Ot.LOW_FLOAT),function(){var e;return function(){if(void 0!==e)return e;if(e=[],wr.get("WEBGL_compressed_texture_pvrtc")||wr.get("WEBGL_compressed_texture_s3tc"))for(var t=Ot.getParameter(Ot.COMPRESSED_TEXTURE_FORMATS),r=0;r<t.length;r++)e.push(t[r]);return e}}()),Pr=Ar.precision>0&&Rr.precision>0,Ir=Nr.precision>0&&Lr.precision>0;"highp"!==bt||Pr||(Ir?(bt="mediump",console.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(bt="lowp",console.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==bt||Ir||(bt="lowp",console.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var Fr=new t.ShadowMapPlugin(this,Rt,Lt,Dt),Ur=new t.SpritePlugin(this,Ft),Or=new t.LensFlarePlugin(this,Ut);this.getContext=function(){return Ot},this.supportsVertexTextures=function(){return Sr},this.supportsFloatTextures=function(){return wr.get("OES_texture_float")},this.supportsStandardDerivatives=function(){return wr.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return wr.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return wr.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return wr.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var t=wr.get("EXT_texture_filter_anisotropic");return e=null!==t?Ot.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return bt},this.setSize=function(e,t,r){yt.width=e*this.devicePixelRatio,yt.height=t*this.devicePixelRatio,r!==!1&&(yt.style.width=e+"px",yt.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,n){ir=e*this.devicePixelRatio,ar=t*this.devicePixelRatio,or=r*this.devicePixelRatio,sr=n*this.devicePixelRatio,Ot.viewport(ir,ar,or,sr)},this.setScissor=function(e,t,r,n){Ot.scissor(e*this.devicePixelRatio,t*this.devicePixelRatio,r*this.devicePixelRatio,n*this.devicePixelRatio)},this.enableScissorTest=function(e){e?Ot.enable(Ot.SCISSOR_TEST):Ot.disable(Ot.SCISSOR_TEST)},this.setClearColor=function(e,t){At.set(e),Nt=void 0!==t?t:1,Ot.clearColor(At.r,At.g,At.b,Nt)},this.setClearColorHex=function(e,t){console.warn("THREE.WebGLRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return At},this.getClearAlpha=function(){return Nt},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=Ot.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Ot.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=Ot.STENCIL_BUFFER_BIT),Ot.clear(n)},this.clearColor=function(){Ot.clear(Ot.COLOR_BUFFER_BIT)},this.clearDepth=function(){Ot.clear(Ot.DEPTH_BUFFER_BIT)},this.clearStencil=function(){Ot.clear(Ot.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.resetGLState=function(){kt=null,Ht=null,Yt=-1,$t=-1,Jt=-1,Wt=-1,Xt=-1,Gt=-1,qt=-1,vr=!0};var Br=function(e){var t=e.target;t.traverse(function(e){e.removeEventListener("remove",Br),O(e)})},Vr=function(e){var t=e.target;t.removeEventListener("dispose",Vr),Hr(t)},kr=function(e){var t=e.target;t.removeEventListener("dispose",kr),jr(t),Bt.info.memory.textures--},zr=function(e){var t=e.target;t.removeEventListener("dispose",zr),Wr(t),Bt.info.memory.textures--},qr=function(e){var t=e.target;t.removeEventListener("dispose",qr),Xr(t)},Gr=function(e){for(var t=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],r=0,n=t.length;n>r;r++){var i=t[r];void 0!==e[i]&&(Ot.deleteBuffer(e[i]),delete e[i])}if(void 0!==e.__webglCustomAttributesList){for(var i in e.__webglCustomAttributesList)Ot.deleteBuffer(e.__webglCustomAttributesList[i].buffer);delete e.__webglCustomAttributesList}Bt.info.memory.geometries--},Hr=function(e){if(delete e.__webglInit,e instanceof t.BufferGeometry){for(var r in e.attributes){var n=e.attributes[r];void 0!==n.buffer&&(Ot.deleteBuffer(n.buffer),delete n.buffer)}Bt.info.memory.geometries--}else{var i=Yr[e.id];if(void 0!==i){for(var a=0,o=i.length;o>a;a++){var s=i[a];if(void 0!==s.numMorphTargets){for(var u=0,l=s.numMorphTargets;l>u;u++)Ot.deleteBuffer(s.__webglMorphTargetsBuffers[u]);delete s.__webglMorphTargetsBuffers}if(void 0!==s.numMorphNormals){for(var u=0,l=s.numMorphNormals;l>u;u++)Ot.deleteBuffer(s.__webglMorphNormalsBuffers[u]);delete s.__webglMorphNormalsBuffers}Gr(s)}delete Yr[e.id]}else Gr(e)}Gt=-1},jr=function(e){if(e.image&&e.image.__webglTextureCube)Ot.deleteTexture(e.image.__webglTextureCube),delete e.image.__webglTextureCube;else{if(void 0===e.__webglInit)return;Ot.deleteTexture(e.__webglTexture),delete e.__webglTexture,delete e.__webglInit}},Wr=function(e){if(e&&void 0!==e.__webglTexture){if(Ot.deleteTexture(e.__webglTexture),delete e.__webglTexture,e instanceof t.WebGLRenderTargetCube)for(var r=0;6>r;r++)Ot.deleteFramebuffer(e.__webglFramebuffer[r]),Ot.deleteRenderbuffer(e.__webglRenderbuffer[r]);else Ot.deleteFramebuffer(e.__webglFramebuffer),Ot.deleteRenderbuffer(e.__webglRenderbuffer);delete e.__webglFramebuffer,delete e.__webglRenderbuffer}},Xr=function(e){var t=e.program.program;if(void 0!==t){e.program=void 0;var r,n,i,a=!1;for(r=0,n=Vt.length;n>r;r++)if(i=Vt[r],i.program===t){i.usedTimes--,0===i.usedTimes&&(a=!0);break}if(a===!0){var o=[];for(r=0,n=Vt.length;n>r;r++)i=Vt[r],i.program!==t&&o.push(i);Vt=o,Ot.deleteProgram(t),Bt.info.memory.programs--}}};this.renderBufferImmediate=function(e,r,n){if(v(),e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=Ot.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=Ot.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=Ot.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=Ot.createBuffer()),e.hasPositions&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglVertexBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,e.positionArray,Ot.DYNAMIC_DRAW),y(r.attributes.position),Ot.vertexAttribPointer(r.attributes.position,3,Ot.FLOAT,!1,0,0)),e.hasNormals){if(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglNormalBuffer),n.shading===t.FlatShading){var i,a,o,s,u,l,c,h,f,p,d,m,g,b,w=3*e.count;for(b=0;w>b;b+=9)g=e.normalArray,s=g[b],c=g[b+1],p=g[b+2],u=g[b+3],h=g[b+4],d=g[b+5],l=g[b+6],f=g[b+7],m=g[b+8],i=(s+u+l)/3,a=(c+h+f)/3,o=(p+d+m)/3,g[b]=i,g[b+1]=a,g[b+2]=o,g[b+3]=i,g[b+4]=a,g[b+5]=o,g[b+6]=i,g[b+7]=a,g[b+8]=o}Ot.bufferData(Ot.ARRAY_BUFFER,e.normalArray,Ot.DYNAMIC_DRAW),y(r.attributes.normal),Ot.vertexAttribPointer(r.attributes.normal,3,Ot.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglUvBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,e.uvArray,Ot.DYNAMIC_DRAW),y(r.attributes.uv),Ot.vertexAttribPointer(r.attributes.uv,2,Ot.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==t.NoColors&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,e.__webglColorBuffer),Ot.bufferData(Ot.ARRAY_BUFFER,e.colorArray,Ot.DYNAMIC_DRAW),y(r.attributes.color),Ot.vertexAttribPointer(r.attributes.color,3,Ot.FLOAT,!1,0,0)),x(),Ot.drawArrays(Ot.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,r,n,i,a,o){if(i.visible!==!1){var s=k(e,r,n,i,o),u=!1,l=i.wireframe?1:0,c=16777215*a.id+2*s.id+l;if(c!==Gt&&(Gt=c,u=!0),u&&v(),o instanceof t.Mesh){var h=i.wireframe===!0?Ot.LINES:Ot.TRIANGLES,f=a.attributes.index;if(f){var p,d;f.array instanceof Uint32Array&&wr.get("OES_element_index_uint")?(p=Ot.UNSIGNED_INT,d=4):(p=Ot.UNSIGNED_SHORT,d=2);var m=a.offsets;if(0===m.length)u&&(g(i,s,a,0),Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,f.buffer)),Ot.drawElements(h,f.array.length,p,0),Bt.info.render.calls++,Bt.info.render.vertices+=f.array.length,Bt.info.render.faces+=f.array.length/3;else{u=!0;for(var y=0,x=m.length;x>y;y++){var b=m[y].index;u&&(g(i,s,a,b),Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,f.buffer)),Ot.drawElements(h,m[y].count,p,m[y].start*d),Bt.info.render.calls++,Bt.info.render.vertices+=m[y].count,Bt.info.render.faces+=m[y].count/3}}}else{u&&g(i,s,a,0);var w=a.attributes.position;Ot.drawArrays(h,0,w.array.length/3),Bt.info.render.calls++,Bt.info.render.vertices+=w.array.length/3,Bt.info.render.faces+=w.array.length/9}}else if(o instanceof t.PointCloud){u&&g(i,s,a,0);var w=a.attributes.position;Ot.drawArrays(Ot.POINTS,0,w.array.length/3),Bt.info.render.calls++,Bt.info.render.points+=w.array.length/3}else if(o instanceof t.Line){var h=o.mode===t.LineStrip?Ot.LINE_STRIP:Ot.LINES;it(i.linewidth);var f=a.attributes.index;if(f){var p,d;f.array instanceof Uint32Array?(p=Ot.UNSIGNED_INT,d=4):(p=Ot.UNSIGNED_SHORT,d=2);var m=a.offsets;if(0===m.length)u&&(g(i,s,a,0),Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,f.buffer)),Ot.drawElements(h,f.array.length,p,0),Bt.info.render.calls++,Bt.info.render.vertices+=f.array.length;else{m.length>1&&(u=!0);for(var y=0,x=m.length;x>y;y++){var b=m[y].index;u&&(g(i,s,a,b),Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,f.buffer)),Ot.drawElements(h,m[y].count,p,m[y].start*d),Bt.info.render.calls++,Bt.info.render.vertices+=m[y].count}}}else{u&&g(i,s,a,0);var w=a.attributes.position;Ot.drawArrays(h,0,w.array.length/3),Bt.info.render.calls++,Bt.info.render.points+=w.array.length/3}}}},this.renderBuffer=function(e,r,n,i,a,o){if(i.visible!==!1){var s=k(e,r,n,i,o),u=s.attributes,l=!1,c=i.wireframe?1:0,h=16777215*a.id+2*s.id+c;if(h!==Gt&&(Gt=h,l=!0),l&&v(),!i.morphTargets&&u.position>=0?l&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglVertexBuffer),y(u.position),Ot.vertexAttribPointer(u.position,3,Ot.FLOAT,!1,0,0)):o.morphTargetBase&&b(i,a,o),l){if(a.__webglCustomAttributesList)for(var f=0,p=a.__webglCustomAttributesList.length;p>f;f++){var d=a.__webglCustomAttributesList[f];u[d.buffer.belongsToAttribute]>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,d.buffer),y(u[d.buffer.belongsToAttribute]),Ot.vertexAttribPointer(u[d.buffer.belongsToAttribute],d.size,Ot.FLOAT,!1,0,0))}u.color>=0&&(o.geometry.colors.length>0||o.geometry.faces.length>0?(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglColorBuffer),y(u.color),Ot.vertexAttribPointer(u.color,3,Ot.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Ot.vertexAttrib3fv(u.color,i.defaultAttributeValues.color)),u.normal>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglNormalBuffer),y(u.normal),Ot.vertexAttribPointer(u.normal,3,Ot.FLOAT,!1,0,0)),u.tangent>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglTangentBuffer),y(u.tangent),Ot.vertexAttribPointer(u.tangent,4,Ot.FLOAT,!1,0,0)),u.uv>=0&&(o.geometry.faceVertexUvs[0]?(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglUVBuffer),y(u.uv),Ot.vertexAttribPointer(u.uv,2,Ot.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Ot.vertexAttrib2fv(u.uv,i.defaultAttributeValues.uv)),u.uv2>=0&&(o.geometry.faceVertexUvs[1]?(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglUV2Buffer),y(u.uv2),Ot.vertexAttribPointer(u.uv2,2,Ot.FLOAT,!1,0,0)):void 0!==i.defaultAttributeValues&&Ot.vertexAttrib2fv(u.uv2,i.defaultAttributeValues.uv2)),i.skinning&&u.skinIndex>=0&&u.skinWeight>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglSkinIndicesBuffer),y(u.skinIndex),Ot.vertexAttribPointer(u.skinIndex,4,Ot.FLOAT,!1,0,0),Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglSkinWeightsBuffer),y(u.skinWeight),Ot.vertexAttribPointer(u.skinWeight,4,Ot.FLOAT,!1,0,0)),u.lineDistance>=0&&(Ot.bindBuffer(Ot.ARRAY_BUFFER,a.__webglLineDistanceBuffer),y(u.lineDistance),Ot.vertexAttribPointer(u.lineDistance,1,Ot.FLOAT,!1,0,0))}if(x(),o instanceof t.Mesh){var m=a.__typeArray===Uint32Array?Ot.UNSIGNED_INT:Ot.UNSIGNED_SHORT;i.wireframe?(it(i.wireframeLinewidth),l&&Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,a.__webglLineBuffer),Ot.drawElements(Ot.LINES,a.__webglLineCount,m,0)):(l&&Ot.bindBuffer(Ot.ELEMENT_ARRAY_BUFFER,a.__webglFaceBuffer),Ot.drawElements(Ot.TRIANGLES,a.__webglFaceCount,m,0)),Bt.info.render.calls++,Bt.info.render.vertices+=a.__webglFaceCount,Bt.info.render.faces+=a.__webglFaceCount/3}else if(o instanceof t.Line){var g=o.mode===t.LineStrip?Ot.LINE_STRIP:Ot.LINES;it(i.linewidth),Ot.drawArrays(g,0,a.__webglLineCount),Bt.info.render.calls++}else o instanceof t.PointCloud&&(Ot.drawArrays(Ot.POINTS,0,a.__webglParticleCount),Bt.info.render.calls++,Bt.info.render.points+=a.__webglParticleCount)}},this.render=function(e,r,n,i){if(r instanceof t.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var a=e.fog;Gt=-1,qt=-1,Ht=null,vr=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===r.parent&&r.updateMatrixWorld(),e.traverse(function(e){e instanceof t.SkinnedMesh&&e.skeleton.update()}),r.matrixWorldInverse.getInverse(r.matrixWorld),pr.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),fr.setFromMatrix(pr),Rt.length=0,Pt.length=0,It.length=0,Ft.length=0,Ut.length=0,T(e,e),Bt.sortObjects===!0&&(Pt.sort(w),It.sort(M)),Fr.render(e,r),Bt.info.render.calls=0,Bt.info.render.vertices=0,Bt.info.render.faces=0,Bt.info.render.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var o=0,s=Dt.length;s>o;o++){var u=Dt[o],l=u.object;l.visible&&(et(l,r),C(u))}if(e.overrideMaterial){var c=e.overrideMaterial;this.setBlending(c.blending,c.blendEquation,c.blendSrc,c.blendDst),this.setDepthTest(c.depthTest),this.setDepthWrite(c.depthWrite),at(c.polygonOffset,c.polygonOffsetFactor,c.polygonOffsetUnits),E(Pt,r,Rt,a,!0,c),E(It,r,Rt,a,!0,c),S(Dt,"",r,Rt,a,!1,c)}else{var c=null;this.setBlending(t.NoBlending),E(Pt,r,Rt,a,!1,c),S(Dt,"opaque",r,Rt,a,!1,c),E(It,r,Rt,a,!0,c),S(Dt,"transparent",r,Rt,a,!0,c)}Ur.render(e,r),Or.render(e,r,ur,lr),n&&n.generateMipmaps&&n.minFilter!==t.NearestFilter&&n.minFilter!==t.LinearFilter&&ft(n),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(e,t,r,n,i){var a=k(e,t,r,n,i);Gt=-1,Bt.setMaterialFaces(n),i.immediateRenderCallback?i.immediateRenderCallback(a,Ot,fr):i.render(function(e){Bt.renderBufferImmediate(e,a,n)})};var Yr={},Kr=0;this.setFaceCulling=function(e,r){e===t.CullFaceNone?Ot.disable(Ot.CULL_FACE):(Ot.frontFace(r===t.FrontFaceDirectionCW?Ot.CW:Ot.CCW),Ot.cullFace(e===t.CullFaceBack?Ot.BACK:e===t.CullFaceFront?Ot.FRONT:Ot.FRONT_AND_BACK),Ot.enable(Ot.CULL_FACE))},this.setMaterialFaces=function(e){var r=e.side===t.DoubleSide,n=e.side===t.BackSide;Wt!==r&&(r?Ot.disable(Ot.CULL_FACE):Ot.enable(Ot.CULL_FACE),Wt=r),Xt!==n&&(Ot.frontFace(n?Ot.CW:Ot.CCW),Xt=n)},this.setDepthTest=function(e){$t!==e&&(e?Ot.enable(Ot.DEPTH_TEST):Ot.disable(Ot.DEPTH_TEST),$t=e)},this.setDepthWrite=function(e){Jt!==e&&(Ot.depthMask(e),Jt=e)},this.setBlending=function(e,r,n,i){e!==Yt&&(e===t.NoBlending?Ot.disable(Ot.BLEND):e===t.AdditiveBlending?(Ot.enable(Ot.BLEND),Ot.blendEquation(Ot.FUNC_ADD),Ot.blendFunc(Ot.SRC_ALPHA,Ot.ONE)):e===t.SubtractiveBlending?(Ot.enable(Ot.BLEND),Ot.blendEquation(Ot.FUNC_ADD),Ot.blendFunc(Ot.ZERO,Ot.ONE_MINUS_SRC_COLOR)):e===t.MultiplyBlending?(Ot.enable(Ot.BLEND),Ot.blendEquation(Ot.FUNC_ADD),Ot.blendFunc(Ot.ZERO,Ot.SRC_COLOR)):e===t.CustomBlending?Ot.enable(Ot.BLEND):(Ot.enable(Ot.BLEND),Ot.blendEquationSeparate(Ot.FUNC_ADD,Ot.FUNC_ADD),Ot.blendFuncSeparate(Ot.SRC_ALPHA,Ot.ONE_MINUS_SRC_ALPHA,Ot.ONE,Ot.ONE_MINUS_SRC_ALPHA)),Yt=e),e===t.CustomBlending?(r!==Kt&&(Ot.blendEquation(dt(r)),Kt=r),(n!==Zt||i!==Qt)&&(Ot.blendFunc(dt(n),dt(i)),Zt=n,Qt=i)):(Kt=null,Zt=null,Qt=null)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",kr),e.__webglTexture=Ot.createTexture(),Bt.info.memory.textures++),Ot.bindTexture(Ot.TEXTURE_2D,e.__webglTexture),Ot.pixelStorei(Ot.UNPACK_FLIP_Y_WEBGL,e.flipY),Ot.pixelStorei(Ot.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Ot.pixelStorei(Ot.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=st(e.image,Tr);var r=e.image,n=t.Math.isPowerOfTwo(r.width)&&t.Math.isPowerOfTwo(r.height),i=dt(e.format),a=dt(e.type);ot(Ot.TEXTURE_2D,e,n);var o,s=e.mipmaps;if(e instanceof t.DataTexture)if(s.length>0&&n){for(var u=0,l=s.length;l>u;u++)o=s[u],Ot.texImage2D(Ot.TEXTURE_2D,u,i,o.width,o.height,0,i,a,o.data);e.generateMipmaps=!1}else Ot.texImage2D(Ot.TEXTURE_2D,0,i,r.width,r.height,0,i,a,r.data);else if(e instanceof t.CompressedTexture)for(var u=0,l=s.length;l>u;u++)o=s[u],e.format!==t.RGBAFormat&&e.format!==t.RGBFormat?Dr().indexOf(i)>-1?Ot.compressedTexImage2D(Ot.TEXTURE_2D,u,i,o.width,o.height,0,o.data):console.warn("Attempt to load unsupported compressed texture format"):Ot.texImage2D(Ot.TEXTURE_2D,u,i,o.width,o.height,0,i,a,o.data);else if(s.length>0&&n){for(var u=0,l=s.length;l>u;u++)o=s[u],Ot.texImage2D(Ot.TEXTURE_2D,u,i,i,a,o);e.generateMipmaps=!1}else Ot.texImage2D(Ot.TEXTURE_2D,0,i,i,a,e.image);e.generateMipmaps&&n&&Ot.generateMipmap(Ot.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){Ot.activeTexture(Ot.TEXTURE0+t),e.needsUpdate?Bt.uploadTexture(e):Ot.bindTexture(Ot.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var r=e instanceof t.WebGLRenderTargetCube;if(e&&void 0===e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",zr),e.__webglTexture=Ot.createTexture(),Bt.info.memory.textures++;var n=t.Math.isPowerOfTwo(e.width)&&t.Math.isPowerOfTwo(e.height),i=dt(e.format),a=dt(e.type);if(r){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,e.__webglTexture),ot(Ot.TEXTURE_CUBE_MAP,e,n);for(var o=0;6>o;o++)e.__webglFramebuffer[o]=Ot.createFramebuffer(),e.__webglRenderbuffer[o]=Ot.createRenderbuffer(),Ot.texImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,i,e.width,e.height,0,i,a,null),ct(e.__webglFramebuffer[o],e,Ot.TEXTURE_CUBE_MAP_POSITIVE_X+o),ht(e.__webglRenderbuffer[o],e);n&&Ot.generateMipmap(Ot.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=Ot.createFramebuffer(),e.__webglRenderbuffer=e.shareDepthFrom?e.shareDepthFrom.__webglRenderbuffer:Ot.createRenderbuffer(),Ot.bindTexture(Ot.TEXTURE_2D,e.__webglTexture),ot(Ot.TEXTURE_2D,e,n),Ot.texImage2D(Ot.TEXTURE_2D,0,i,e.width,e.height,0,i,a,null),ct(e.__webglFramebuffer,e,Ot.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?Ot.framebufferRenderbuffer(Ot.FRAMEBUFFER,Ot.DEPTH_ATTACHMENT,Ot.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&Ot.framebufferRenderbuffer(Ot.FRAMEBUFFER,Ot.DEPTH_STENCIL_ATTACHMENT,Ot.RENDERBUFFER,e.__webglRenderbuffer):ht(e.__webglRenderbuffer,e),n&&Ot.generateMipmap(Ot.TEXTURE_2D);r?Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,null):Ot.bindTexture(Ot.TEXTURE_2D,null),Ot.bindRenderbuffer(Ot.RENDERBUFFER,null),Ot.bindFramebuffer(Ot.FRAMEBUFFER,null)}var s,u,l,c,h;e?(s=r?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,u=e.width,l=e.height,c=0,h=0):(s=null,u=or,l=sr,c=ir,h=ar),s!==zt&&(Ot.bindFramebuffer(Ot.FRAMEBUFFER,s),Ot.viewport(c,h,u,l),zt=s),ur=u,lr=l},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},t.WebGLRenderTarget=function(e,r,n){this.width=e,this.height=r,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:t.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:t.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:t.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:t.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new t.Vector2(0,0),this.repeat=new t.Vector2(1,1),this.format=void 0!==n.format?n.format:t.RGBAFormat,this.type=void 0!==n.type?n.type:t.UnsignedByteType,this.depthBuffer=void 0!==n.depthBuffer?n.depthBuffer:!0,this.stencilBuffer=void 0!==n.stencilBuffer?n.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},t.WebGLRenderTarget.prototype={constructor:t.WebGLRenderTarget,setSize:function(e,t){this.width=e,this.height=t
},clone:function(){var e=new t.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},t.EventDispatcher.prototype.apply(t.WebGLRenderTarget.prototype),t.WebGLRenderTargetCube=function(e,r,n){t.WebGLRenderTarget.call(this,e,r,n),this.activeCubeFace=0},t.WebGLRenderTargetCube.prototype=Object.create(t.WebGLRenderTarget.prototype),t.WebGLExtensions=function(e){var t={};this.get=function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"OES_texture_float":n=e.getExtension("OES_texture_float");break;case"OES_texture_float_linear":n=e.getExtension("OES_texture_float_linear");break;case"OES_standard_derivatives":n=e.getExtension("OES_standard_derivatives");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"OES_element_index_uint":n=e.getExtension("OES_element_index_uint");break;case"EXT_blend_minmax":n=e.getExtension("EXT_blend_minmax");break;case"EXT_frag_depth":n=e.getExtension("EXT_frag_depth")}return null===n&&console.log("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}},t.WebGLProgram=function(){var e=0,r=function(e){var t,r,n=[];for(var i in e)t=e[i],t!==!1&&(r="#define "+i+" "+t,n.push(r));return n.join("\n")},n=function(e,t,r){for(var n={},i=0,a=r.length;a>i;i++){var o=r[i];n[o]=e.getUniformLocation(t,o)}return n},i=function(e,t,r){for(var n={},i=0,a=r.length;a>i;i++){var o=r[i];n[o]=e.getAttribLocation(t,o)}return n};return function(a,o,s,u){var l=a,c=l.context,h=s.defines,f=s.__webglShader.uniforms,p=s.attributes,d=s.__webglShader.vertexShader,m=s.__webglShader.fragmentShader,g=s.index0AttributeName;void 0===g&&u.morphTargets===!0&&(g="position");var v="SHADOWMAP_TYPE_BASIC";u.shadowMapType===t.PCFShadowMap?v="SHADOWMAP_TYPE_PCF":u.shadowMapType===t.PCFSoftShadowMap&&(v="SHADOWMAP_TYPE_PCF_SOFT");var y,x,b=r(h),w=c.createProgram();s instanceof t.RawShaderMaterial?(y="",x=""):(y=["precision "+u.precision+" float;","precision "+u.precision+" int;",b,u.supportsVertexTextures?"#define VERTEX_TEXTURES":"",l.gammaInput?"#define GAMMA_INPUT":"",l.gammaOutput?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+u.maxDirLights,"#define MAX_POINT_LIGHTS "+u.maxPointLights,"#define MAX_SPOT_LIGHTS "+u.maxSpotLights,"#define MAX_HEMI_LIGHTS "+u.maxHemiLights,"#define MAX_SHADOWS "+u.maxShadows,"#define MAX_BONES "+u.maxBones,u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.lightMap?"#define USE_LIGHTMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.skinning?"#define USE_SKINNING":"",u.useVertexTexture?"#define BONE_TEXTURE":"",u.morphTargets?"#define USE_MORPHTARGETS":"",u.morphNormals?"#define USE_MORPHNORMALS":"",u.wrapAround?"#define WRAP_AROUND":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+v:"",u.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",u.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",u.sizeAttenuation?"#define USE_SIZEATTENUATION":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",""].join("\n"),x=["precision "+u.precision+" float;","precision "+u.precision+" int;",u.bumpMap||u.normalMap?"#extension GL_OES_standard_derivatives : enable":"",b,"#define MAX_DIR_LIGHTS "+u.maxDirLights,"#define MAX_POINT_LIGHTS "+u.maxPointLights,"#define MAX_SPOT_LIGHTS "+u.maxSpotLights,"#define MAX_HEMI_LIGHTS "+u.maxHemiLights,"#define MAX_SHADOWS "+u.maxShadows,u.alphaTest?"#define ALPHATEST "+u.alphaTest:"",l.gammaInput?"#define GAMMA_INPUT":"",l.gammaOutput?"#define GAMMA_OUTPUT":"",u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.lightMap?"#define USE_LIGHTMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexColors?"#define USE_COLOR":"",u.metal?"#define METAL":"",u.wrapAround?"#define WRAP_AROUND":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+v:"",u.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",u.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var M=new t.WebGLShader(c,c.VERTEX_SHADER,y+d),_=new t.WebGLShader(c,c.FRAGMENT_SHADER,x+m);c.attachShader(w,M),c.attachShader(w,_),void 0!==g&&c.bindAttribLocation(w,0,g),c.linkProgram(w),c.getProgramParameter(w,c.LINK_STATUS)===!1&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",c.getProgramParameter(w,c.VALIDATE_STATUS)),console.error("gl.getError()",c.getError())),""!==c.getProgramInfoLog(w)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",c.getProgramInfoLog(w)),c.deleteShader(M),c.deleteShader(_);var T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];u.useVertexTexture?(T.push("boneTexture"),T.push("boneTextureWidth"),T.push("boneTextureHeight")):T.push("boneGlobalMatrices"),u.logarithmicDepthBuffer&&T.push("logDepthBufFC");for(var E in f)T.push(E);this.uniforms=n(c,w,T),T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var S=0;S<u.maxMorphTargets;S++)T.push("morphTarget"+S);for(var S=0;S<u.maxMorphNormals;S++)T.push("morphNormal"+S);for(var C in p)T.push(C);return this.attributes=i(c,w,T),this.attributesKeys=Object.keys(this.attributes),this.id=e++,this.code=o,this.usedTimes=1,this.program=w,this.vertexShader=M,this.fragmentShader=_,this}}(),t.WebGLShader=function(){var e=function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")};return function(t,r,n){var i=t.createShader(r);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&(console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t.getShaderInfoLog(i)),console.warn(e(n))),i}}(),t.LensFlarePlugin=function(e,r){function n(t){var r=f.createProgram(),n=f.createShader(f.FRAGMENT_SHADER),i=f.createShader(f.VERTEX_SHADER),a="precision "+e.getPrecision()+" float;\n";return f.shaderSource(n,a+t.fragmentShader),f.shaderSource(i,a+t.vertexShader),f.compileShader(n),f.compileShader(i),f.attachShader(r,n),f.attachShader(r,i),f.linkProgram(r),r}var i,a,o,s,u,l,c,h,f=e.context,p=function(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),t=new Uint16Array([0,1,2,0,2,3]);i=f.createBuffer(),a=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,i),f.bufferData(f.ARRAY_BUFFER,e,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),f.bufferData(f.ELEMENT_ARRAY_BUFFER,t,f.STATIC_DRAW),c=f.createTexture(),h=f.createTexture(),f.bindTexture(f.TEXTURE_2D,c),f.texImage2D(f.TEXTURE_2D,0,f.RGB,16,16,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.bindTexture(f.TEXTURE_2D,h),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,16,16,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),l=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;var r;r=l?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},o=n(r),s={vertex:f.getAttribLocation(o,"position"),uv:f.getAttribLocation(o,"uv")},u={renderType:f.getUniformLocation(o,"renderType"),map:f.getUniformLocation(o,"map"),occlusionMap:f.getUniformLocation(o,"occlusionMap"),opacity:f.getUniformLocation(o,"opacity"),color:f.getUniformLocation(o,"color"),scale:f.getUniformLocation(o,"scale"),rotation:f.getUniformLocation(o,"rotation"),screenPosition:f.getUniformLocation(o,"screenPosition")}};this.render=function(n,d,m,g){if(0!==r.length){var v=new t.Vector3,y=g/m,x=.5*m,b=.5*g,w=16/g,M=new t.Vector2(w*y,w),_=new t.Vector3(1,1,0),T=new t.Vector2(1,1);void 0===o&&p(),f.useProgram(o),f.enableVertexAttribArray(s.vertex),f.enableVertexAttribArray(s.uv),f.uniform1i(u.occlusionMap,0),f.uniform1i(u.map,1),f.bindBuffer(f.ARRAY_BUFFER,i),f.vertexAttribPointer(s.vertex,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(s.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a),f.disable(f.CULL_FACE),f.depthMask(!1);for(var E=0,S=r.length;S>E;E++){w=16/g,M.set(w*y,w);var C=r[E];if(v.set(C.matrixWorld.elements[12],C.matrixWorld.elements[13],C.matrixWorld.elements[14]),v.applyMatrix4(d.matrixWorldInverse),v.applyProjection(d.projectionMatrix),_.copy(v),T.x=_.x*x+x,T.y=_.y*b+b,l||T.x>0&&T.x<m&&T.y>0&&T.y<g){f.activeTexture(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,c),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGB,T.x-8,T.y-8,16,16,0),f.uniform1i(u.renderType,0),f.uniform2f(u.scale,M.x,M.y),f.uniform3f(u.screenPosition,_.x,_.y,_.z),f.disable(f.BLEND),f.enable(f.DEPTH_TEST),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,h),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,T.x-8,T.y-8,16,16,0),f.uniform1i(u.renderType,1),f.disable(f.DEPTH_TEST),f.activeTexture(f.TEXTURE1),f.bindTexture(f.TEXTURE_2D,c),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),C.positionScreen.copy(_),C.customUpdateCallback?C.customUpdateCallback(C):C.updateLensFlares(),f.uniform1i(u.renderType,2),f.enable(f.BLEND);for(var A=0,N=C.lensFlares.length;N>A;A++){var R=C.lensFlares[A];R.opacity>.001&&R.scale>.001&&(_.x=R.x,_.y=R.y,_.z=R.z,w=R.size*R.scale/g,M.x=w*y,M.y=w,f.uniform3f(u.screenPosition,_.x,_.y,_.z),f.uniform2f(u.scale,M.x,M.y),f.uniform1f(u.rotation,R.rotation),f.uniform1f(u.opacity,R.opacity),f.uniform3f(u.color,R.color.r,R.color.g,R.color.b),e.setBlending(R.blending,R.blendEquation,R.blendSrc,R.blendDst),e.setTexture(R.texture,1),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0))}}}f.enable(f.CULL_FACE),f.enable(f.DEPTH_TEST),f.depthMask(!0),e.resetGLState()}}},t.ShadowMapPlugin=function(e,r,n,i){function a(e,t,r){if(t.visible){var i=n[t.id];if(i&&t.castShadow&&(t.frustumCulled===!1||m.intersectsObject(t)===!0))for(var o=0,s=i.length;s>o;o++){var u=i[o];t._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),b.push(u)}for(var o=0,s=t.children.length;s>o;o++)a(e,t.children[o],r)}}function o(e,r){var n=new t.DirectionalLight;n.isVirtual=!0,n.onlyShadow=!0,n.castShadow=!0,n.shadowCameraNear=e.shadowCameraNear,n.shadowCameraFar=e.shadowCameraFar,n.shadowCameraLeft=e.shadowCameraLeft,n.shadowCameraRight=e.shadowCameraRight,n.shadowCameraBottom=e.shadowCameraBottom,n.shadowCameraTop=e.shadowCameraTop,n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[r],n.shadowMapWidth=e.shadowCascadeWidth[r],n.shadowMapHeight=e.shadowCascadeHeight[r],n.pointsWorld=[],n.pointsFrustum=[];for(var i=n.pointsWorld,a=n.pointsFrustum,o=0;8>o;o++)i[o]=new t.Vector3,a[o]=new t.Vector3;var s=e.shadowCascadeNearZ[r],u=e.shadowCascadeFarZ[r];return a[0].set(-1,-1,s),a[1].set(1,-1,s),a[2].set(-1,1,s),a[3].set(1,1,s),a[4].set(-1,-1,u),a[5].set(1,-1,u),a[6].set(-1,1,u),a[7].set(1,1,u),n}function s(e,t){var r=e.shadowCascadeArray[t];r.position.copy(e.position),r.target.position.copy(e.target.position),r.lookAt(r.target),r.shadowCameraVisible=e.shadowCameraVisible,r.shadowDarkness=e.shadowDarkness,r.shadowBias=e.shadowCascadeBias[t];var n=e.shadowCascadeNearZ[t],i=e.shadowCascadeFarZ[t],a=r.pointsFrustum;a[0].z=n,a[1].z=n,a[2].z=n,a[3].z=n,a[4].z=i,a[5].z=i,a[6].z=i,a[7].z=i}function u(e,t){var r=t.shadowCamera,n=t.pointsFrustum,i=t.pointsWorld;v.set(1/0,1/0,1/0),y.set(-1/0,-1/0,-1/0);for(var a=0;8>a;a++){var o=i[a];o.copy(n[a]),o.unproject(e),o.applyMatrix4(r.matrixWorldInverse),o.x<v.x&&(v.x=o.x),o.x>y.x&&(y.x=o.x),o.y<v.y&&(v.y=o.y),o.y>y.y&&(y.y=o.y),o.z<v.z&&(v.z=o.z),o.z>y.z&&(y.z=o.z)}r.left=v.x,r.right=y.x,r.top=y.y,r.bottom=v.y,r.updateProjectionMatrix()}function l(e){return e.material instanceof t.MeshFaceMaterial?e.material.materials[0]:e.material}var c,h,f,p,d=e.context,m=new t.Frustum,g=new t.Matrix4,v=new t.Vector3,y=new t.Vector3,x=new t.Vector3,b=[],w=t.ShaderLib.depthRGBA,M=t.UniformsUtils.clone(w.uniforms);c=new t.ShaderMaterial({uniforms:M,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader}),h=new t.ShaderMaterial({uniforms:M,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0}),f=new t.ShaderMaterial({uniforms:M,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,skinning:!0}),p=new t.ShaderMaterial({uniforms:M,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:!0,skinning:!0}),c._shadowPass=!0,h._shadowPass=!0,f._shadowPass=!0,p._shadowPass=!0,this.render=function(n,v){if(e.shadowMapEnabled!==!1){var y,w,M,_,T,E,S,C,A,N,R,L,D,P=[],I=0,F=null;for(d.clearColor(1,1,1,1),d.disable(d.BLEND),d.enable(d.CULL_FACE),d.frontFace(d.CCW),d.cullFace(e.shadowMapCullFace===t.CullFaceFront?d.FRONT:d.BACK),e.setDepthTest(!0),y=0,w=r.length;w>y;y++)if(D=r[y],D.castShadow)if(D instanceof t.DirectionalLight&&D.shadowCascade)for(T=0;T<D.shadowCascadeCount;T++){var U;if(D.shadowCascadeArray[T])U=D.shadowCascadeArray[T];else{U=o(D,T),U.originalCamera=v;var O=new t.Gyroscope;O.position.copy(D.shadowCascadeOffset),O.add(U),O.add(U.target),v.add(O),D.shadowCascadeArray[T]=U,console.log("Created virtualLight",U)}s(D,T),P[I]=U,I++}else P[I]=D,I++;for(y=0,w=P.length;w>y;y++){if(D=P[y],!D.shadowMap){var B=t.LinearFilter;e.shadowMapType===t.PCFSoftShadowMap&&(B=t.NearestFilter);var V={minFilter:B,magFilter:B,format:t.RGBAFormat};D.shadowMap=new t.WebGLRenderTarget(D.shadowMapWidth,D.shadowMapHeight,V),D.shadowMapSize=new t.Vector2(D.shadowMapWidth,D.shadowMapHeight),D.shadowMatrix=new t.Matrix4}if(!D.shadowCamera){if(D instanceof t.SpotLight)D.shadowCamera=new t.PerspectiveCamera(D.shadowCameraFov,D.shadowMapWidth/D.shadowMapHeight,D.shadowCameraNear,D.shadowCameraFar);else{if(!(D instanceof t.DirectionalLight)){console.error("Unsupported light type for shadow");continue}D.shadowCamera=new t.OrthographicCamera(D.shadowCameraLeft,D.shadowCameraRight,D.shadowCameraTop,D.shadowCameraBottom,D.shadowCameraNear,D.shadowCameraFar)}n.add(D.shadowCamera),n.autoUpdate===!0&&n.updateMatrixWorld()}D.shadowCameraVisible&&!D.cameraHelper&&(D.cameraHelper=new t.CameraHelper(D.shadowCamera),n.add(D.cameraHelper)),D.isVirtual&&U.originalCamera==v&&u(v,D),E=D.shadowMap,S=D.shadowMatrix,C=D.shadowCamera,C.position.setFromMatrixPosition(D.matrixWorld),x.setFromMatrixPosition(D.target.matrixWorld),C.lookAt(x),C.updateMatrixWorld(),C.matrixWorldInverse.getInverse(C.matrixWorld),D.cameraHelper&&(D.cameraHelper.visible=D.shadowCameraVisible),D.shadowCameraVisible&&D.cameraHelper.update(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(C.projectionMatrix),S.multiply(C.matrixWorldInverse),g.multiplyMatrices(C.projectionMatrix,C.matrixWorldInverse),m.setFromMatrix(g),e.setRenderTarget(E),e.clear(),b.length=0,a(n,n,C);var k,z,q;for(M=0,_=b.length;_>M;M++)R=b[M],L=R.object,A=R.buffer,k=l(L),z=void 0!==L.geometry.morphTargets&&L.geometry.morphTargets.length>0&&k.morphTargets,q=L instanceof t.SkinnedMesh&&k.skinning,N=L.customDepthMaterial?L.customDepthMaterial:q?z?p:f:z?h:c,e.setMaterialFaces(k),A instanceof t.BufferGeometry?e.renderBufferDirect(C,r,F,N,A,L):e.renderBuffer(C,r,F,N,A,L);for(M=0,_=i.length;_>M;M++)R=i[M],L=R.object,L.visible&&L.castShadow&&(L._modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,L.matrixWorld),e.renderImmediateObject(C,r,F,c,L))}var G=e.getClearColor(),H=e.getClearAlpha();d.clearColor(G.r,G.g,G.b,H),d.enable(d.BLEND),e.shadowMapCullFace===t.CullFaceFront&&d.cullFace(d.BACK),e.resetGLState()}}},t.SpritePlugin=function(e,r){function n(){var t=h.createProgram(),r=h.createShader(h.VERTEX_SHADER),n=h.createShader(h.FRAGMENT_SHADER);return h.shaderSource(r,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),h.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),h.compileShader(r),h.compileShader(n),h.attachShader(t,r),h.attachShader(t,n),h.linkProgram(t),t}function i(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var a,o,s,u,l,c,h=e.context,f=function(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);a=h.createBuffer(),o=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,a),h.bufferData(h.ARRAY_BUFFER,e,h.STATIC_DRAW),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r,h.STATIC_DRAW),s=n(),u={position:h.getAttribLocation(s,"position"),uv:h.getAttribLocation(s,"uv")},l={uvOffset:h.getUniformLocation(s,"uvOffset"),uvScale:h.getUniformLocation(s,"uvScale"),rotation:h.getUniformLocation(s,"rotation"),scale:h.getUniformLocation(s,"scale"),color:h.getUniformLocation(s,"color"),map:h.getUniformLocation(s,"map"),opacity:h.getUniformLocation(s,"opacity"),modelViewMatrix:h.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:h.getUniformLocation(s,"projectionMatrix"),fogType:h.getUniformLocation(s,"fogType"),fogDensity:h.getUniformLocation(s,"fogDensity"),fogNear:h.getUniformLocation(s,"fogNear"),fogFar:h.getUniformLocation(s,"fogFar"),fogColor:h.getUniformLocation(s,"fogColor"),alphaTest:h.getUniformLocation(s,"alphaTest")};var i=document.createElement("canvas");i.width=8,i.height=8;var f=i.getContext("2d");f.fillStyle="white",f.fillRect(0,0,8,8),c=new t.Texture(i),c.needsUpdate=!0};this.render=function(n,p){if(0!==r.length){void 0===s&&f(),h.useProgram(s),h.enableVertexAttribArray(u.position),h.enableVertexAttribArray(u.uv),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.bindBuffer(h.ARRAY_BUFFER,a),h.vertexAttribPointer(u.position,2,h.FLOAT,!1,16,0),h.vertexAttribPointer(u.uv,2,h.FLOAT,!1,16,8),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),h.uniformMatrix4fv(l.projectionMatrix,!1,p.projectionMatrix.elements),h.activeTexture(h.TEXTURE0),h.uniform1i(l.map,0);var d=0,m=0,g=n.fog;g?(h.uniform3f(l.fogColor,g.color.r,g.color.g,g.color.b),g instanceof t.Fog?(h.uniform1f(l.fogNear,g.near),h.uniform1f(l.fogFar,g.far),h.uniform1i(l.fogType,1),d=1,m=1):g instanceof t.FogExp2&&(h.uniform1f(l.fogDensity,g.density),h.uniform1i(l.fogType,2),d=2,m=2)):(h.uniform1i(l.fogType,0),d=0,m=0);for(var v=0,y=r.length;y>v;v++){var x=r[v];x._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,x.matrixWorld),x.z=null===x.renderDepth?-x._modelViewMatrix.elements[14]:x.renderDepth}r.sort(i);for(var b=[],v=0,y=r.length;y>v;v++){var x=r[v],w=x.material;h.uniform1f(l.alphaTest,w.alphaTest),h.uniformMatrix4fv(l.modelViewMatrix,!1,x._modelViewMatrix.elements),b[0]=x.scale.x,b[1]=x.scale.y;var M=0;n.fog&&w.fog&&(M=m),d!==M&&(h.uniform1i(l.fogType,M),d=M),null!==w.map?(h.uniform2f(l.uvOffset,w.map.offset.x,w.map.offset.y),h.uniform2f(l.uvScale,w.map.repeat.x,w.map.repeat.y)):(h.uniform2f(l.uvOffset,0,0),h.uniform2f(l.uvScale,1,1)),h.uniform1f(l.opacity,w.opacity),h.uniform3f(l.color,w.color.r,w.color.g,w.color.b),h.uniform1f(l.rotation,w.rotation),h.uniform2fv(l.scale,b),e.setBlending(w.blending,w.blendEquation,w.blendSrc,w.blendDst),e.setDepthTest(w.depthTest),e.setDepthWrite(w.depthWrite),w.map&&w.map.image&&w.map.image.width?e.setTexture(w.map,0):e.setTexture(c,0),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0)}h.enable(h.CULL_FACE),e.resetGLState()}}},t.GeometryUtils={merge:function(e,r,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;r instanceof t.Mesh&&(r.matrixAutoUpdate&&r.updateMatrix(),i=r.matrix,r=r.geometry),e.merge(r,i,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(e,r,n,i){var a=new t.ImageLoader;a.crossOrigin=this.crossOrigin;var o=new t.Texture(void 0,r);return a.load(e,function(e){o.image=e,o.needsUpdate=!0,n&&n(o)},void 0,function(e){i&&i(e)}),o.sourceFile=e,o},loadTextureCube:function(e,r,n){var i=[],a=new t.ImageLoader;a.crossOrigin=this.crossOrigin;var o=new t.CubeTexture(i,r);o.flipY=!1;for(var s=0,u=function(t){a.load(e[t],function(e){o.images[t]=e,s+=1,6===s&&(o.needsUpdate=!0,n&&n(o))})},l=0,c=e.length;c>l;++l)u(l);return o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var r=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},n=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},i=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var a=e.width,o=e.height,s=document.createElement("canvas");s.width=a,s.height=o;var u=s.getContext("2d");u.drawImage(e,0,0);for(var l=u.getImageData(0,0,a,o).data,c=u.createImageData(a,o),h=c.data,f=0;a>f;f++)for(var p=0;o>p;p++){var d=0>p-1?0:p-1,m=p+1>o-1?o-1:p+1,g=0>f-1?0:f-1,v=f+1>a-1?a-1:f+1,y=[],x=[0,0,l[4*(p*a+f)]/255*t];y.push([-1,0,l[4*(p*a+g)]/255*t]),y.push([-1,-1,l[4*(d*a+g)]/255*t]),y.push([0,-1,l[4*(d*a+f)]/255*t]),y.push([1,-1,l[4*(d*a+v)]/255*t]),y.push([1,0,l[4*(p*a+v)]/255*t]),y.push([1,1,l[4*(m*a+v)]/255*t]),y.push([0,1,l[4*(m*a+f)]/255*t]),y.push([-1,1,l[4*(m*a+g)]/255*t]);for(var b=[],w=y.length,M=0;w>M;M++){var _=y[M],T=y[(M+1)%w];_=n(_,x),T=n(T,x),b.push(i(r(_,T)))}for(var E=[0,0,0],M=0;M<b.length;M++)E[0]+=b[M][0],E[1]+=b[M][1],E[2]+=b[M][2];E[0]/=b.length,E[1]/=b.length,E[2]/=b.length;var S=4*(p*a+f);h[S]=(E[0]+1)/2*255|0,h[S+1]=(E[1]+1)/2*255|0,h[S+2]=255*E[2]|0,h[S+3]=255}return u.putImageData(c,0,0),s},generateDataTexture:function(e,r,n){for(var i=e*r,a=new Uint8Array(3*i),o=Math.floor(255*n.r),s=Math.floor(255*n.g),u=Math.floor(255*n.b),l=0;i>l;l++)a[3*l]=o,a[3*l+1]=s,a[3*l+2]=u;var c=new t.DataTexture(a,e,r,t.RGBFormat);return c.needsUpdate=!0,c}},t.SceneUtils={createMultiMaterialObject:function(e,r){for(var n=new t.Object3D,i=0,a=r.length;a>i;i++)n.add(new t.Mesh(e,r[i]));return n},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,r,n){var i=new t.Matrix4;i.getInverse(n.matrixWorld),e.applyMatrix(i),r.remove(e),n.add(e)}},t.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase(),r=this;r.faces[t]=r.faces[t]||{},r.faces[t][e.cssFontWeight]=r.faces[t][e.cssFontWeight]||{},r.faces[t][e.cssFontWeight][e.cssFontStyle]=e;r.faces[t][e.cssFontWeight][e.cssFontStyle]=e;return e},drawText:function(e){var r,n=this.getFace(),i=this.size/n.resolution,a=0,o=String(e).split(""),s=o.length,u=[];for(r=0;s>r;r++){var l=new t.Path,c=this.extractGlyphPoints(o[r],n,i,a,l);a+=c.offset,u.push(c.path)}var h=a/2;return{paths:u,offset:h}},extractGlyphPoints:function(e,r,n,i,a){var o,s,u,l,c,h,f,p,d,m,g,v,y,x,b,w,M,_,T,E=[],S=r.glyphs[e]||r.glyphs["?"];if(S){if(S.o)for(l=S._cachedOutline||(S._cachedOutline=S.o.split(" ")),h=l.length,f=n,p=n,o=0;h>o;)switch(c=l[o++]){case"m":d=l[o++]*f+i,m=l[o++]*p,a.moveTo(d,m);break;case"l":d=l[o++]*f+i,m=l[o++]*p,a.lineTo(d,m);break;case"q":if(g=l[o++]*f+i,v=l[o++]*p,b=l[o++]*f+i,w=l[o++]*p,a.quadraticCurveTo(b,w,g,v),T=E[E.length-1])for(y=T.x,x=T.y,s=1,u=this.divisions;u>=s;s++){var C=s/u;t.Shape.Utils.b2(C,y,b,g),t.Shape.Utils.b2(C,x,w,v)}break;case"b":if(g=l[o++]*f+i,v=l[o++]*p,b=l[o++]*f+i,w=l[o++]*p,M=l[o++]*f+i,_=l[o++]*p,a.bezierCurveTo(b,w,M,_,g,v),T=E[E.length-1])for(y=T.x,x=T.y,s=1,u=this.divisions;u>=s;s++){var C=s/u;t.Shape.Utils.b3(C,y,b,M,g),t.Shape.Utils.b3(C,x,w,_,v)}}return{offset:S.ha*n,path:a}}}},t.FontUtils.generateShapes=function(e,r){r=r||{};var n=void 0!==r.size?r.size:100,i=void 0!==r.curveSegments?r.curveSegments:4,a=void 0!==r.font?r.font:"helvetiker",o=void 0!==r.weight?r.weight:"normal",s=void 0!==r.style?r.style:"normal";t.FontUtils.size=n,t.FontUtils.divisions=i,t.FontUtils.face=a,t.FontUtils.weight=o,t.FontUtils.style=s;for(var u=t.FontUtils.drawText(e),l=u.paths,c=[],h=0,f=l.length;f>h;h++)Array.prototype.push.apply(c,l[h].toShapes());return c},function(e){var t=1e-10,r=function(e,t){var r=e.length;if(3>r)return null;var a,o,s,u=[],l=[],c=[];if(n(e)>0)for(o=0;r>o;o++)l[o]=o;else for(o=0;r>o;o++)l[o]=r-1-o;var h=r,f=2*h;for(o=h-1;h>2;){if(f--<=0)return console.log("Warning, unable to triangulate polygon!"),t?c:u;if(a=o,a>=h&&(a=0),o=a+1,o>=h&&(o=0),s=o+1,s>=h&&(s=0),i(e,a,o,s,h,l)){var p,d,m,g,v;for(p=l[a],d=l[o],m=l[s],u.push([e[p],e[d],e[m]]),c.push([l[a],l[o],l[s]]),g=o,v=o+1;h>v;g++,v++)l[g]=l[v];h--,f=2*h}}return t?c:u},n=function(e){for(var t=e.length,r=0,n=t-1,i=0;t>i;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},i=function(e,r,n,i,a,o){var s,u,l,c,h,f,p,d,m;if(u=e[o[r]].x,l=e[o[r]].y,c=e[o[n]].x,h=e[o[n]].y,f=e[o[i]].x,p=e[o[i]].y,t>(c-u)*(p-l)-(h-l)*(f-u))return!1;
var g,v,y,x,b,w,M,_,T,E,S,C,A,N,R;for(g=f-c,v=p-h,y=u-f,x=l-p,b=c-u,w=h-l,s=0;a>s;s++)if(d=e[o[s]].x,m=e[o[s]].y,!(d===u&&m===l||d===c&&m===h||d===f&&m===p)&&(M=d-u,_=m-l,T=d-c,E=m-h,S=d-f,C=m-p,R=g*E-v*T,A=b*_-w*M,N=y*C-x*S,R>=-t&&N>=-t&&A>=-t))return!1;return!0};return e.Triangulate=r,e.Triangulate.area=n,e}(t.FontUtils),self._typeface_js={faces:t.FontUtils.faces,loadFace:t.FontUtils.loadFace},t.typeface_js=self._typeface_js,t.Audio=function(e){t.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},t.Audio.prototype=Object.create(t.Object3D.prototype),t.Audio.prototype.load=function(e){var t=this,r=new XMLHttpRequest;return r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){t.context.decodeAudioData(this.response,function(e){t.source.buffer=e,t.source.connect(t.panner),t.source.start(0)})},r.send(),this},t.Audio.prototype.setLoop=function(e){this.source.loop=e},t.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},t.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},t.Audio.prototype.updateMatrixWorld=function(){var e=new t.Vector3;return function(r){t.Object3D.prototype.updateMatrixWorld.call(this,r),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),t.AudioListener=function(){t.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},t.AudioListener.prototype=Object.create(t.Object3D.prototype),t.AudioListener.prototype.updateMatrixWorld=function(){var e=new t.Vector3,r=new t.Quaternion,n=new t.Vector3,i=new t.Vector3,a=new t.Vector3,o=new t.Vector3;return function(s){t.Object3D.prototype.updateMatrixWorld.call(this,s);var u=this.context.listener;this.matrixWorld.decompose(e,r,n),i.set(0,0,-1).applyQuaternion(r),a.subVectors(e,o),u.setPosition(e.x,e.y,e.z),u.setOrientation(i.x,i.y,i.z,this.up.x,this.up.y,this.up.z),u.setVelocity(a.x,a.y,a.z),o.copy(e)}}(),t.Curve=function(){},t.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},t.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},t.Curve.prototype.getPoints=function(e){e||(e=5);var t,r=[];for(t=0;e>=t;t++)r.push(this.getPoint(t/e));return r},t.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,r=[];for(t=0;e>=t;t++)r.push(this.getPointAt(t/e));return r},t.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},t.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),a=0;for(n.push(0),r=1;e>=r;r++)t=this.getPoint(r/e),a+=t.distanceTo(i),n.push(a),i=t;return this.cacheArcLengths=n,n},t.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},t.Curve.prototype.getUtoTmapping=function(e,t){var r,n=this.getLengths(),i=0,a=n.length;r=t?t:e*n[a-1];for(var o,s=0,u=a-1;u>=s;)if(i=Math.floor(s+(u-s)/2),o=n[i]-r,0>o)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(i=u,n[i]==r){var l=i/(a-1);return l}var c=n[i],h=n[i+1],f=h-c,p=(r-c)/f,l=(i+p)/(a-1);return l},t.Curve.prototype.getTangent=function(e){var t=1e-4,r=e-t,n=e+t;0>r&&(r=0),n>1&&(n=1);var i=this.getPoint(r),a=this.getPoint(n),o=a.clone().sub(i);return o.normalize()},t.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},t.Curve.Utils={tangentQuadraticBezier:function(e,t,r,n){return 2*(1-e)*(r-t)+2*e*(n-r)},tangentCubicBezier:function(e,t,r,n,i){return-3*t*(1-e)*(1-e)+3*r*(1-e)*(1-e)-6*e*r*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*i},tangentSpline:function(e){var t=6*e*e-6*e,r=3*e*e-4*e+1,n=-6*e*e+6*e,i=3*e*e-2*e;return t+r+n+i},interpolate:function(e,t,r,n,i){var a=.5*(r-e),o=.5*(n-t),s=i*i,u=i*s;return(2*t-2*r+a+o)*u+(-3*t+3*r-2*a-o)*s+a*i+t}},t.Curve.create=function(e,r){return e.prototype=Object.create(t.Curve.prototype),e.prototype.getPoint=r,e},t.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},t.CurvePath.prototype=Object.create(t.Curve.prototype),t.CurvePath.prototype.add=function(e){this.curves.push(e)},t.CurvePath.prototype.checkConnection=function(){},t.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);e.equals(r)||this.curves.push(new t.LineCurve(r,e))},t.CurvePath.prototype.getPoint=function(e){for(var t,r,n=e*this.getLength(),i=this.getCurveLengths(),a=0;a<i.length;){if(i[a]>=n){t=i[a]-n,r=this.curves[a];var o=1-t/r.getLength();return r.getPointAt(o)}a++}return null},t.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},t.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],r=0,n=this.curves.length;for(e=0;n>e;e++)r+=this.curves[e].getLength(),t.push(r);return this.cacheLengths=t,t},t.CurvePath.prototype.getBoundingBox=function(){var e,r,n,i,a,o,s=this.getPoints();e=r=Number.NEGATIVE_INFINITY,i=a=Number.POSITIVE_INFINITY;var u,l,c,h,f=s[0]instanceof t.Vector3;for(h=f?new t.Vector3:new t.Vector2,l=0,c=s.length;c>l;l++)u=s[l],u.x>e?e=u.x:u.x<i&&(i=u.x),u.y>r?r=u.y:u.y<a&&(a=u.y),f&&(u.z>n?n=u.z:u.z<o&&(o=u.z)),h.add(u);var p={minX:i,minY:a,maxX:e,maxY:r};return f&&(p.maxZ=n,p.minZ=o),p},t.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},t.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},t.CurvePath.prototype.createGeometry=function(e){for(var r=new t.Geometry,n=0;n<e.length;n++)r.vertices.push(new t.Vector3(e[n].x,e[n].y,e[n].z||0));return r},t.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},t.CurvePath.prototype.getTransformedPoints=function(e,t){var r,n,i=this.getPoints(e);for(t||(t=this.bends),r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i},t.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var r,n,i=this.getSpacedPoints(e);for(t||(t=this.bends),r=0,n=t.length;n>r;r++)i=this.getWrapPoints(i,t[r]);return i},t.CurvePath.prototype.getWrapPoints=function(e,t){var r,n,i,a,o,s,u=this.getBoundingBox();for(r=0,n=e.length;n>r;r++){i=e[r],a=i.x,o=i.y,s=a/u.maxX,s=t.getUtoTmapping(s,a);var l=t.getPoint(s),c=t.getTangent(s);c.set(-c.y,c.x).multiplyScalar(o),i.x=l.x+c.x,i.y=l.y+c.y}return e},t.Gyroscope=function(){t.Object3D.call(this)},t.Gyroscope.prototype=Object.create(t.Object3D.prototype),t.Gyroscope.prototype.updateMatrixWorld=function(){var e=new t.Vector3,r=new t.Quaternion,n=new t.Vector3,i=new t.Vector3,a=new t.Quaternion,o=new t.Vector3;return function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(i,a,o),this.matrix.decompose(e,r,n),this.matrixWorld.compose(i,r,o)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var s=0,u=this.children.length;u>s;s++)this.children[s].updateMatrixWorld(t)}}(),t.Path=function(e){t.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},t.Path.prototype=Object.create(t.CurvePath.prototype),t.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},t.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;r>t;t++)this.lineTo(e[t].x,e[t].y)},t.Path.prototype.moveTo=function(){var e=Array.prototype.slice.call(arguments);this.actions.push({action:t.PathActions.MOVE_TO,args:e})},t.Path.prototype.lineTo=function(e,r){var n=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,a=i[i.length-2],o=i[i.length-1],s=new t.LineCurve(new t.Vector2(a,o),new t.Vector2(e,r));this.curves.push(s),this.actions.push({action:t.PathActions.LINE_TO,args:n})},t.Path.prototype.quadraticCurveTo=function(e,r,n,i){var a=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,s=o[o.length-2],u=o[o.length-1],l=new t.QuadraticBezierCurve(new t.Vector2(s,u),new t.Vector2(e,r),new t.Vector2(n,i));this.curves.push(l),this.actions.push({action:t.PathActions.QUADRATIC_CURVE_TO,args:a})},t.Path.prototype.bezierCurveTo=function(e,r,n,i,a,o){var s=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,l=u[u.length-2],c=u[u.length-1],h=new t.CubicBezierCurve(new t.Vector2(l,c),new t.Vector2(e,r),new t.Vector2(n,i),new t.Vector2(a,o));this.curves.push(h),this.actions.push({action:t.PathActions.BEZIER_CURVE_TO,args:s})},t.Path.prototype.splineThru=function(e){var r=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],a=n[n.length-1],o=[new t.Vector2(i,a)];Array.prototype.push.apply(o,e);var s=new t.SplineCurve(o);this.curves.push(s),this.actions.push({action:t.PathActions.CSPLINE_THRU,args:r})},t.Path.prototype.arc=function(e,t,r,n,i,a){var o=this.actions[this.actions.length-1].args,s=o[o.length-2],u=o[o.length-1];this.absarc(e+s,t+u,r,n,i,a)},t.Path.prototype.absarc=function(e,t,r,n,i,a){this.absellipse(e,t,r,r,n,i,a)},t.Path.prototype.ellipse=function(e,t,r,n,i,a,o){var s=this.actions[this.actions.length-1].args,u=s[s.length-2],l=s[s.length-1];this.absellipse(e+u,t+l,r,n,i,a,o)},t.Path.prototype.absellipse=function(e,r,n,i,a,o,s){var u=Array.prototype.slice.call(arguments),l=new t.EllipseCurve(e,r,n,i,a,o,s);this.curves.push(l);var c=l.getPoint(1);u.push(c.x),u.push(c.y),this.actions.push({action:t.PathActions.ELLIPSE,args:u})},t.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var t=[],r=0;e>r;r++)t.push(this.getPoint(r/e));return t},t.Path.prototype.getPoints=function(e,r){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,r);e=e||12;var n,i,a,o,s,u,l,c,h,f,p,d,m,g,v,y,x,b,w=[];for(n=0,i=this.actions.length;i>n;n++)switch(a=this.actions[n],o=a.action,s=a.args,o){case t.PathActions.MOVE_TO:w.push(new t.Vector2(s[0],s[1]));break;case t.PathActions.LINE_TO:w.push(new t.Vector2(s[0],s[1]));break;case t.PathActions.QUADRATIC_CURVE_TO:for(u=s[2],l=s[3],f=s[0],p=s[1],w.length>0?(g=w[w.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)y=v/e,x=t.Shape.Utils.b2(y,d,f,u),b=t.Shape.Utils.b2(y,m,p,l),w.push(new t.Vector2(x,b));break;case t.PathActions.BEZIER_CURVE_TO:for(u=s[4],l=s[5],f=s[0],p=s[1],c=s[2],h=s[3],w.length>0?(g=w[w.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)y=v/e,x=t.Shape.Utils.b3(y,d,f,c,u),b=t.Shape.Utils.b3(y,m,p,h,l),w.push(new t.Vector2(x,b));break;case t.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var M=new t.Vector2(g[g.length-2],g[g.length-1]),_=[M],T=e*s[0].length;_=_.concat(s[0]);var E=new t.SplineCurve(_);for(v=1;T>=v;v++)w.push(E.getPointAt(v/T));break;case t.PathActions.ARC:var S,C=s[0],A=s[1],N=s[2],R=s[3],L=s[4],D=!!s[5],P=L-R,I=2*e;for(v=1;I>=v;v++)y=v/I,D||(y=1-y),S=R+y*P,x=C+N*Math.cos(S),b=A+N*Math.sin(S),w.push(new t.Vector2(x,b));break;case t.PathActions.ELLIPSE:var S,C=s[0],A=s[1],F=s[2],U=s[3],R=s[4],L=s[5],D=!!s[6],P=L-R,I=2*e;for(v=1;I>=v;v++)y=v/I,D||(y=1-y),S=R+y*P,x=C+F*Math.cos(S),b=A+U*Math.sin(S),w.push(new t.Vector2(x,b))}var O=w[w.length-1],B=1e-10;return Math.abs(O.x-w[0].x)<B&&Math.abs(O.y-w[0].y)<B&&w.splice(w.length-1,1),r&&w.push(w[0]),w},t.Path.prototype.toShapes=function(e,r){function n(e){var r,n,i,a,o,s=[],u=new t.Path;for(r=0,n=e.length;n>r;r++)i=e[r],o=i.args,a=i.action,a==t.PathActions.MOVE_TO&&0!=u.actions.length&&(s.push(u),u=new t.Path),u[a].apply(u,o);return 0!=u.actions.length&&s.push(u),s}function i(e){for(var r=[],n=0,i=e.length;i>n;n++){var a=e[n],o=new t.Shape;o.actions=a.actions,o.curves=a.curves,r.push(o)}return r}function a(e,t){for(var r=1e-10,n=t.length,i=!1,a=n-1,o=0;n>o;a=o++){var s=t[a],u=t[o],l=u.x-s.x,c=u.y-s.y;if(Math.abs(c)>r){if(0>c&&(s=t[o],l=-l,u=t[a],c=-c),e.y<s.y||e.y>u.y)continue;if(e.y==s.y){if(e.x==s.x)return!0}else{var h=c*(e.x-s.x)-l*(e.y-s.y);if(0==h)return!0;if(0>h)continue;i=!i}}else{if(e.y!=s.y)continue;if(u.x<=e.x&&e.x<=s.x||s.x<=e.x&&e.x<=u.x)return!0}}return i}var o=n(this.actions);if(0==o.length)return[];if(r===!0)return i(o);var s,u,l,c=[];if(1==o.length)return u=o[0],l=new t.Shape,l.actions=u.actions,l.curves=u.curves,c.push(l),c;var h=!t.Shape.Utils.isClockWise(o[0].getPoints());h=e?!h:h;var f,p=[],d=[],m=[],g=0;d[g]=void 0,m[g]=[];var v,y;for(v=0,y=o.length;y>v;v++)u=o[v],f=u.getPoints(),s=t.Shape.Utils.isClockWise(f),s=e?!s:s,s?(!h&&d[g]&&g++,d[g]={s:new t.Shape,p:f},d[g].s.actions=u.actions,d[g].s.curves=u.curves,h&&g++,m[g]=[]):m[g].push({h:u,p:f[0]});if(!d[0])return i(o);if(d.length>1){for(var x=!1,b=[],w=0,M=d.length;M>w;w++)p[w]=[];for(var w=0,M=d.length;M>w;w++)for(var _=(d[w],m[w]),T=0;T<_.length;T++){for(var E=_[T],S=!0,C=0;C<d.length;C++)a(E.p,d[C].p)&&(w!=C&&b.push({froms:w,tos:C,hole:T}),S?(S=!1,p[C].push(E)):x=!0);S&&p[w].push(E)}b.length>0&&(x||(m=p))}var A,N,R;for(v=0,y=d.length;y>v;v++)for(l=d[v].s,c.push(l),A=m[v],N=0,R=A.length;R>N;N++)l.holes.push(A[N].h);return c},t.Shape=function(){t.Path.apply(this,arguments),this.holes=[]},t.Shape.prototype=Object.create(t.Path.prototype),t.Shape.prototype.extrude=function(e){var r=new t.ExtrudeGeometry(this,e);return r},t.Shape.prototype.makeGeometry=function(e){var r=new t.ShapeGeometry(this,e);return r},t.Shape.prototype.getPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;r>t;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},t.Shape.prototype.getSpacedPointsHoles=function(e){var t,r=this.holes.length,n=[];for(t=0;r>t;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},t.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},t.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},t.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},t.Shape.Utils={triangulateShape:function(e,r){function n(e,t,r){return e.x!=t.x?e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x:e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y}function i(e,t,r,i,a){var o=1e-10,s=t.x-e.x,u=t.y-e.y,l=i.x-r.x,c=i.y-r.y,h=e.x-r.x,f=e.y-r.y,p=u*l-s*c,d=u*h-s*f;if(Math.abs(p)>o){var m;if(p>0){if(0>d||d>p)return[];if(m=c*h-l*f,0>m||m>p)return[]}else{if(d>0||p>d)return[];if(m=c*h-l*f,m>0||p>m)return[]}if(0==m)return!a||0!=d&&d!=p?[e]:[];if(m==p)return!a||0!=d&&d!=p?[t]:[];if(0==d)return[r];if(d==p)return[i];var g=m/p;return[{x:e.x+g*s,y:e.y+g*u}]}if(0!=d||c*h!=l*f)return[];var v=0==s&&0==u,y=0==l&&0==c;if(v&&y)return e.x!=r.x||e.y!=r.y?[]:[e];if(v)return n(r,i,e)?[e]:[];if(y)return n(e,t,r)?[r]:[];var x,b,w,M,_,T,E,S;return 0!=s?(e.x<t.x?(x=e,w=e.x,b=t,M=t.x):(x=t,w=t.x,b=e,M=e.x),r.x<i.x?(_=r,E=r.x,T=i,S=i.x):(_=i,E=i.x,T=r,S=r.x)):(e.y<t.y?(x=e,w=e.y,b=t,M=t.y):(x=t,w=t.y,b=e,M=e.y),r.y<i.y?(_=r,E=r.y,T=i,S=i.y):(_=i,E=i.y,T=r,S=r.y)),E>=w?E>M?[]:M==E?a?[]:[_]:S>=M?[_,b]:[_,T]:w>S?[]:w==S?a?[]:[x]:S>=M?[x,b]:[x,T]}function a(e,t,r,n){var i=1e-10,a=t.x-e.x,o=t.y-e.y,s=r.x-e.x,u=r.y-e.y,l=n.x-e.x,c=n.y-e.y,h=a*u-o*s,f=a*c-o*l;if(Math.abs(h)>i){var p=l*u-c*s;return h>0?f>=0&&p>=0:f>=0||p>=0}return f>0}function o(e,t){function r(e,t){var r=y.length-1,n=e-1;0>n&&(n=r);var i=e+1;i>r&&(i=0);var o=a(y[e],y[n],y[i],s[t]);if(!o)return!1;var u=s.length-1,l=t-1;0>l&&(l=u);var c=t+1;return c>u&&(c=0),o=a(s[t],s[l],s[c],y[e]),o?!0:!1}function n(e,t){var r,n,a;for(r=0;r<y.length;r++)if(n=r+1,n%=y.length,a=i(e,t,y[r],y[n],!0),a.length>0)return!0;return!1}function o(e,r){var n,a,o,s,u;for(n=0;n<x.length;n++)for(a=t[x[n]],o=0;o<a.length;o++)if(s=o+1,s%=a.length,u=i(e,r,a[o],a[s],!0),u.length>0)return!0;return!1}for(var s,u,l,c,h,f,p,d,m,g,v,y=e.concat(),x=[],b=[],w=0,M=t.length;M>w;w++)x.push(w);for(var _=0,T=2*x.length;x.length>0;){if(T--,0>T){console.log("Infinite Loop! Holes left:"+x.length+", Probably Hole outside Shape!");break}for(l=_;l<y.length;l++){c=y[l],u=-1;for(var w=0;w<x.length;w++)if(f=x[w],p=c.x+":"+c.y+":"+f,void 0===b[p]){s=t[f];for(var E=0;E<s.length;E++)if(h=s[E],r(l,E)&&!n(c,h)&&!o(c,h)){u=E,x.splice(w,1),d=y.slice(0,l+1),m=y.slice(l),g=s.slice(u),v=s.slice(0,u+1),y=d.concat(g).concat(v).concat(m),_=l;break}if(u>=0)break;b[p]=!0}if(u>=0)break}}return y}for(var s,u,l,c,h,f,p={},d=e.concat(),m=0,g=r.length;g>m;m++)Array.prototype.push.apply(d,r[m]);for(s=0,u=d.length;u>s;s++)h=d[s].x+":"+d[s].y,void 0!==p[h]&&console.log("Duplicate point",h),p[h]=s;var v=o(e,r),y=t.FontUtils.Triangulate(v,!1);for(s=0,u=y.length;u>s;s++)for(c=y[s],l=0;3>l;l++)h=c[l].x+":"+c[l].y,f=p[h],void 0!==f&&(c[l]=f);return y.concat()},isClockWise:function(e){return t.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var r=1-e;return r*r*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,r,n){return this.b2p0(e,t)+this.b2p1(e,r)+this.b2p2(e,n)},b3p0:function(e,t){var r=1-e;return r*r*r*t},b3p1:function(e,t){var r=1-e;return 3*r*r*e*t},b3p2:function(e,t){var r=1-e;return 3*r*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,r,n,i){return this.b3p0(e,t)+this.b3p1(e,r)+this.b3p2(e,n)+this.b3p3(e,i)}},t.LineCurve=function(e,t){this.v1=e,this.v2=t},t.LineCurve.prototype=Object.create(t.Curve.prototype),t.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},t.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},t.LineCurve.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()},t.QuadraticBezierCurve=function(e,t,r){this.v0=e,this.v1=t,this.v2=r},t.QuadraticBezierCurve.prototype=Object.create(t.Curve.prototype),t.QuadraticBezierCurve.prototype.getPoint=function(e){var r=new t.Vector2;return r.x=t.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),r.y=t.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),r},t.QuadraticBezierCurve.prototype.getTangent=function(e){var r=new t.Vector2;return r.x=t.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),r.y=t.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),r.normalize()},t.CubicBezierCurve=function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n},t.CubicBezierCurve.prototype=Object.create(t.Curve.prototype),t.CubicBezierCurve.prototype.getPoint=function(e){var r,n;return r=t.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=t.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new t.Vector2(r,n)},t.CubicBezierCurve.prototype.getTangent=function(e){var r,n;r=t.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=t.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var i=new t.Vector2(r,n);return i.normalize(),i},t.SplineCurve=function(e){this.points=void 0==e?[]:e},t.SplineCurve.prototype=Object.create(t.Curve.prototype),t.SplineCurve.prototype.getPoint=function(e){var r=this.points,n=(r.length-1)*e,i=Math.floor(n),a=n-i,o=r[0==i?i:i-1],s=r[i],u=r[i>r.length-2?r.length-1:i+1],l=r[i>r.length-3?r.length-1:i+2],c=new t.Vector2;return c.x=t.Curve.Utils.interpolate(o.x,s.x,u.x,l.x,a),c.y=t.Curve.Utils.interpolate(o.y,s.y,u.y,l.y,a),c},t.EllipseCurve=function(e,t,r,n,i,a,o){this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o},t.EllipseCurve.prototype=Object.create(t.Curve.prototype),t.EllipseCurve.prototype.getPoint=function(e){var r=this.aEndAngle-this.aStartAngle;0>r&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI);var n;n=this.aClockwise===!0?this.aEndAngle+(1-e)*(2*Math.PI-r):this.aStartAngle+e*r;var i=new t.Vector2;return i.x=this.aX+this.xRadius*Math.cos(n),i.y=this.aY+this.yRadius*Math.sin(n),i},t.ArcCurve=function(e,r,n,i,a,o){t.EllipseCurve.call(this,e,r,n,n,i,a,o)},t.ArcCurve.prototype=Object.create(t.EllipseCurve.prototype),t.LineCurve3=t.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var r=new t.Vector3;return r.subVectors(this.v2,this.v1),r.multiplyScalar(e),r.add(this.v1),r}),t.QuadraticBezierCurve3=t.Curve.create(function(e,t,r){this.v0=e,this.v1=t,this.v2=r},function(e){var r=new t.Vector3;return r.x=t.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),r.y=t.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),r.z=t.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),r}),t.CubicBezierCurve3=t.Curve.create(function(e,t,r,n){this.v0=e,this.v1=t,this.v2=r,this.v3=n},function(e){var r=new t.Vector3;return r.x=t.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r.y=t.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),r.z=t.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),r}),t.SplineCurve3=t.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var r=this.points,n=(r.length-1)*e,i=Math.floor(n),a=n-i,o=r[0==i?i:i-1],s=r[i],u=r[i>r.length-2?r.length-1:i+1],l=r[i>r.length-3?r.length-1:i+2],c=new t.Vector3;return c.x=t.Curve.Utils.interpolate(o.x,s.x,u.x,l.x,a),c.y=t.Curve.Utils.interpolate(o.y,s.y,u.y,l.y,a),c.z=t.Curve.Utils.interpolate(o.z,s.z,u.z,l.z,a),c}),t.ClosedSplineCurve3=t.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var r=this.points,n=(r.length-0)*e,i=Math.floor(n),a=n-i;i+=i>0?0:(Math.floor(Math.abs(i)/r.length)+1)*r.length;var o=r[(i-1)%r.length],s=r[i%r.length],u=r[(i+1)%r.length],l=r[(i+2)%r.length],c=new t.Vector3;return c.x=t.Curve.Utils.interpolate(o.x,s.x,u.x,l.x,a),c.y=t.Curve.Utils.interpolate(o.y,s.y,u.y,l.y,a),c.z=t.Curve.Utils.interpolate(o.z,s.z,u.z,l.z,a),c}),t.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(console.log("here"),e.initialized!==!0){for(var r=0;r<e.hierarchy.length;r++){for(var n=0;n<e.hierarchy[r].keys.length;n++)if(e.hierarchy[r].keys[n].time<0&&(e.hierarchy[r].keys[n].time=0),void 0!==e.hierarchy[r].keys[n].rot&&!(e.hierarchy[r].keys[n].rot instanceof t.Quaternion)){var i=e.hierarchy[r].keys[n].rot;e.hierarchy[r].keys[n].rot=(new t.Quaternion).fromArray(i)}if(e.hierarchy[r].keys.length&&void 0!==e.hierarchy[r].keys[0].morphTargets){for(var a={},n=0;n<e.hierarchy[r].keys.length;n++)for(var o=0;o<e.hierarchy[r].keys[n].morphTargets.length;o++){var s=e.hierarchy[r].keys[n].morphTargets[o];a[s]=-1}e.hierarchy[r].usedMorphTargets=a;for(var n=0;n<e.hierarchy[r].keys.length;n++){var u={};for(var s in a){for(var o=0;o<e.hierarchy[r].keys[n].morphTargets.length;o++)if(e.hierarchy[r].keys[n].morphTargets[o]===s){u[s]=e.hierarchy[r].keys[n].morphTargetsInfluences[o];break}o===e.hierarchy[r].keys[n].morphTargets.length&&(u[s]=0)}e.hierarchy[r].keys[n].morphTargetsInfluences=u}}for(var n=1;n<e.hierarchy[r].keys.length;n++)e.hierarchy[r].keys[n].time===e.hierarchy[r].keys[n-1].time&&(e.hierarchy[r].keys.splice(n,1),n--);for(var n=0;n<e.hierarchy[r].keys.length;n++)e.hierarchy[r].keys[n].index=n}return e.initialized=!0,e}},parse:function(e){var r=function(e,t){t.push(e);for(var n=0;n<e.children.length;n++)r(e.children[n],t)},n=[];if(e instanceof t.SkinnedMesh)for(var i=0;i<e.skeleton.bones.length;i++)n.push(e.skeleton.bones[i]);else r(e,n);return n},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)}},t.Animation=function(e,r){this.root=e,this.data=t.AnimationHandler.init(r),this.hierarchy=t.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=t.AnimationHandler.LINEAR},t.Animation.prototype.keyTypes=["pos","rot","scl"],t.Animation.prototype.play=function(e,r){this.currentTime=void 0!==e?e:0,this.weight=void 0!==r?r:1,this.isPlaying=!0,this.reset(),t.AnimationHandler.play(this)},t.Animation.prototype.stop=function(){this.isPlaying=!1,t.AnimationHandler.stop(this)},t.Animation.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var r=this.hierarchy[e];r.matrixAutoUpdate=!0,void 0===r.animationCache&&(r.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}}),void 0===r.animationCache.animations[this.data.name]&&(r.animationCache.animations[this.data.name]={},r.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0},r.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0},r.animationCache.animations[this.data.name].originalMatrix=r.matrix);for(var n=r.animationCache.animations[this.data.name],i=0;3>i;i++){for(var a=this.keyTypes[i],o=this.data.hierarchy[e].keys[0],s=this.getNextKeyWith(a,e,1);s.time<this.currentTime&&s.index>o.index;)o=s,s=this.getNextKeyWith(a,e,s.index+1);n.prevKey[a]=o,n.nextKey[a]=s}}},t.Animation.prototype.resetBlendWeights=function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var r=this.hierarchy[e];void 0!==r.animationCache&&(r.animationCache.blending.positionWeight=0,r.animationCache.blending.quaternionWeight=0,r.animationCache.blending.scaleWeight=0)}},t.Animation.prototype.update=function(){var e=[],r=new t.Vector3,n=new t.Vector3,i=new t.Quaternion,a=function(e,t){var r,n,i,a,s,u,l,c,h,f=[],p=[];return r=(e.length-1)*t,n=Math.floor(r),i=r-n,f[0]=0===n?n:n-1,f[1]=n,f[2]=n>e.length-2?n:n+1,f[3]=n>e.length-3?n:n+2,u=e[f[0]],l=e[f[1]],c=e[f[2]],h=e[f[3]],a=i*i,s=i*a,p[0]=o(u[0],l[0],c[0],h[0],i,a,s),p[1]=o(u[1],l[1],c[1],h[1],i,a,s),p[2]=o(u[2],l[2],c[2],h[2],i,a,s),p},o=function(e,t,r,n,i,a,o){var s=.5*(r-e),u=.5*(n-t);return(2*(t-r)+s+u)*o+(-3*(t-r)-2*s-u)*a+s*i+t};return function(o){if(this.isPlaying!==!1&&(this.currentTime+=o*this.timeScale,0!==this.weight)){var s=this.data.length;if(this.currentTime>s||this.currentTime<0){if(!this.loop)return void this.stop();this.currentTime%=s,this.currentTime<0&&(this.currentTime+=s),this.reset()}for(var u=0,l=this.hierarchy.length;l>u;u++)for(var c=this.hierarchy[u],h=c.animationCache.animations[this.data.name],f=c.animationCache.blending,p=0;3>p;p++){var d=this.keyTypes[p],m=h.prevKey[d],g=h.nextKey[d];if(this.timeScale>0&&g.time<=this.currentTime||this.timeScale<0&&m.time>=this.currentTime){for(m=this.data.hierarchy[u].keys[0],g=this.getNextKeyWith(d,u,1);g.time<this.currentTime&&g.index>m.index;)m=g,g=this.getNextKeyWith(d,u,g.index+1);h.prevKey[d]=m,h.nextKey[d]=g}c.matrixAutoUpdate=!0,c.matrixWorldNeedsUpdate=!0;var v=(this.currentTime-m.time)/(g.time-m.time),y=m[d],x=g[d];if(0>v&&(v=0),v>1&&(v=1),"pos"===d){if(this.interpolationType===t.AnimationHandler.LINEAR){n.x=y[0]+(x[0]-y[0])*v,n.y=y[1]+(x[1]-y[1])*v,n.z=y[2]+(x[2]-y[2])*v;var b=this.weight/(this.weight+f.positionWeight);c.position.lerp(n,b),f.positionWeight+=this.weight}else if(this.interpolationType===t.AnimationHandler.CATMULLROM||this.interpolationType===t.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",u,m.index-1).pos,e[1]=y,e[2]=x,e[3]=this.getNextKeyWith("pos",u,g.index+1).pos,v=.33*v+.33;var w=a(e,v),b=this.weight/(this.weight+f.positionWeight);f.positionWeight+=this.weight;var M=c.position;if(M.x=M.x+(w[0]-M.x)*b,M.y=M.y+(w[1]-M.y)*b,M.z=M.z+(w[2]-M.z)*b,this.interpolationType===t.AnimationHandler.CATMULLROM_FORWARD){var _=a(e,1.01*v);r.set(_[0],_[1],_[2]),r.sub(M),r.y=0,r.normalize();var T=Math.atan2(r.x,r.z);c.rotation.set(0,T,0)}}}else if("rot"===d)if(t.Quaternion.slerp(y,x,i,v),0===f.quaternionWeight)c.quaternion.copy(i),f.quaternionWeight=this.weight;else{var b=this.weight/(this.weight+f.quaternionWeight);t.Quaternion.slerp(c.quaternion,i,c.quaternion,b),f.quaternionWeight+=this.weight}else if("scl"===d){n.x=y[0]+(x[0]-y[0])*v,n.y=y[1]+(x[1]-y[1])*v,n.z=y[2]+(x[2]-y[2])*v;var b=this.weight/(this.weight+f.scaleWeight);c.scale.lerp(n,b),f.scaleWeight+=this.weight}}return!0}}}(),t.Animation.prototype.getNextKeyWith=function(e,r,n){var i=this.data.hierarchy[r].keys;for(this.interpolationType===t.AnimationHandler.CATMULLROM||this.interpolationType===t.AnimationHandler.CATMULLROM_FORWARD?n=n<i.length-1?n:i.length-1:n%=i.length;n<i.length;n++)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[r].keys[0]},t.Animation.prototype.getPrevKeyWith=function(e,r,n){var i=this.data.hierarchy[r].keys;for(n=this.interpolationType===t.AnimationHandler.CATMULLROM||this.interpolationType===t.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+i.length;n>=0;n--)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[r].keys[i.length-1]},t.KeyFrameAnimation=function(e){this.root=e.node,this.data=t.AnimationHandler.init(e),this.hierarchy=t.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var r=0,n=this.hierarchy.length;n>r;r++){var i=this.data.hierarchy[r].keys,a=this.data.hierarchy[r].sids,o=this.hierarchy[r];if(i.length&&a){for(var s=0;s<a.length;s++){var u=a[s],l=this.getNextKeyWith(u,r,0);l&&l.apply(u)}o.matrixAutoUpdate=!1,this.data.hierarchy[r].node.updateMatrix(),o.matrixWorldNeedsUpdate=!0}}},t.KeyFrameAnimation.prototype.play=function(e){if(this.currentTime=void 0!==e?e:0,this.isPlaying===!1){this.isPlaying=!0;var r,n,i,a=this.hierarchy.length;for(r=0;a>r;r++){n=this.hierarchy[r],i=this.data.hierarchy[r],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=n.matrix);var o=this.data.hierarchy[r].keys;o.length&&(i.animationCache.prevKey=o[0],i.animationCache.nextKey=o[1],this.startTime=Math.min(o[0].time,this.startTime),this.endTime=Math.max(o[o.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,t.AnimationHandler.play(this)},t.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,t.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var r=this.hierarchy[e],n=this.data.hierarchy[e];if(void 0!==n.animationCache){var i=n.animationCache.originalMatrix;i.copy(r.matrix),r.matrix=i,delete n.animationCache}}},t.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying!==!1){this.currentTime+=e*this.timeScale;var t=this.data.length;this.loop===!0&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t);for(var r=0,n=this.hierarchy.length;n>r;r++){var i=this.hierarchy[r],a=this.data.hierarchy[r],o=a.keys,s=a.animationCache;if(o.length){var u=s.prevKey,l=s.nextKey;if(l.time<=this.currentTime){for(;l.time<this.currentTime&&l.index>u.index;)u=l,l=o[u.index+1];s.prevKey=u,s.nextKey=l}l.time>=this.currentTime?u.interpolate(l,this.currentTime):u.interpolate(l,l.time),this.data.hierarchy[r].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}}},t.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;for(r%=n.length;r<n.length;r++)if(n[r].hasTarget(e))return n[r];return n[0]},t.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,r){var n=this.data.hierarchy[t].keys;for(r=r>=0?r:r+n.length;r>=0;r--)if(n[r].hasTarget(e))return n[r];return n[n.length-1]},t.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.isPlaying=!1},t.MorphAnimation.prototype={play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1
},update:function(){var e=0,t=0;return function(r){if(this.isPlaying!==!1){this.currentTime+=r,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var n=this.duration/this.frames,i=Math.floor(this.currentTime/n);i!=t&&(this.mesh.morphTargetInfluences[e]=0,this.mesh.morphTargetInfluences[t]=1,this.mesh.morphTargetInfluences[i]=0,e=t,t=i),this.mesh.morphTargetInfluences[i]=this.currentTime%n/n,this.mesh.morphTargetInfluences[e]=1-this.mesh.morphTargetInfluences[i]}}}()},t.BoxGeometry=function(e,r,n,i,a,o){function s(e,r,n,i,a,o,s,l){var c,h,f,p=u.widthSegments,d=u.heightSegments,m=a/2,g=o/2,v=u.vertices.length;"x"===e&&"y"===r||"y"===e&&"x"===r?c="z":"x"===e&&"z"===r||"z"===e&&"x"===r?(c="y",d=u.depthSegments):("z"===e&&"y"===r||"y"===e&&"z"===r)&&(c="x",p=u.depthSegments);var y=p+1,x=d+1,b=a/p,w=o/d,M=new t.Vector3;for(M[c]=s>0?1:-1,f=0;x>f;f++)for(h=0;y>h;h++){var _=new t.Vector3;_[e]=(h*b-m)*n,_[r]=(f*w-g)*i,_[c]=s,u.vertices.push(_)}for(f=0;d>f;f++)for(h=0;p>h;h++){var T=h+y*f,E=h+y*(f+1),S=h+1+y*(f+1),C=h+1+y*f,A=new t.Vector2(h/p,1-f/d),N=new t.Vector2(h/p,1-(f+1)/d),R=new t.Vector2((h+1)/p,1-(f+1)/d),L=new t.Vector2((h+1)/p,1-f/d),D=new t.Face3(T+v,E+v,C+v);D.normal.copy(M),D.vertexNormals.push(M.clone(),M.clone(),M.clone()),D.materialIndex=l,u.faces.push(D),u.faceVertexUvs[0].push([A,N,L]),D=new t.Face3(E+v,S+v,C+v),D.normal.copy(M),D.vertexNormals.push(M.clone(),M.clone(),M.clone()),D.materialIndex=l,u.faces.push(D),u.faceVertexUvs[0].push([N.clone(),R,L.clone()])}}t.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:r,depth:n,widthSegments:i,heightSegments:a,depthSegments:o},this.widthSegments=i||1,this.heightSegments=a||1,this.depthSegments=o||1;var u=this,l=e/2,c=r/2,h=n/2;s("z","y",-1,-1,n,r,l,0),s("z","y",1,-1,n,r,-l,1),s("x","z",1,1,e,n,c,2),s("x","z",1,-1,e,n,-c,3),s("x","y",1,-1,e,r,h,4),s("x","y",-1,-1,e,r,-h,5),this.mergeVertices()},t.BoxGeometry.prototype=Object.create(t.Geometry.prototype),t.CircleGeometry=function(e,r,n,i){t.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:r,thetaStart:n,thetaLength:i},e=e||50,r=void 0!==r?Math.max(3,r):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var a,o=[],s=new t.Vector3,u=new t.Vector2(.5,.5);for(this.vertices.push(s),o.push(u),a=0;r>=a;a++){var l=new t.Vector3,c=n+a/r*i;l.x=e*Math.cos(c),l.y=e*Math.sin(c),this.vertices.push(l),o.push(new t.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var h=new t.Vector3(0,0,1);for(a=1;r>=a;a++)this.faces.push(new t.Face3(a,a+1,0,[h.clone(),h.clone(),h.clone()])),this.faceVertexUvs[0].push([o[a].clone(),o[a+1].clone(),u.clone()]);this.computeFaceNormals(),this.boundingSphere=new t.Sphere(new t.Vector3,e)},t.CircleGeometry.prototype=Object.create(t.Geometry.prototype),t.CubeGeometry=function(e,r,n,i,a,o){return console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new t.BoxGeometry(e,r,n,i,a,o)},t.CylinderGeometry=function(e,r,n,i,a,o){t.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:r,height:n,radialSegments:i,heightSegments:a,openEnded:o},e=void 0!==e?e:20,r=void 0!==r?r:20,n=void 0!==n?n:100,i=i||8,a=a||1,o=void 0!==o?o:!1;var s,u,l=n/2,c=[],h=[];for(u=0;a>=u;u++){var f=[],p=[],d=u/a,m=d*(r-e)+e;for(s=0;i>=s;s++){var g=s/i,v=new t.Vector3;v.x=m*Math.sin(g*Math.PI*2),v.y=-d*n+l,v.z=m*Math.cos(g*Math.PI*2),this.vertices.push(v),f.push(this.vertices.length-1),p.push(new t.Vector2(g,1-d))}c.push(f),h.push(p)}var y,x,b=(r-e)/n;for(s=0;i>s;s++)for(0!==e?(y=this.vertices[c[0][s]].clone(),x=this.vertices[c[0][s+1]].clone()):(y=this.vertices[c[1][s]].clone(),x=this.vertices[c[1][s+1]].clone()),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*b).normalize(),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*b).normalize(),u=0;a>u;u++){var w=c[u][s],M=c[u+1][s],_=c[u+1][s+1],T=c[u][s+1],E=y.clone(),S=y.clone(),C=x.clone(),A=x.clone(),N=h[u][s].clone(),R=h[u+1][s].clone(),L=h[u+1][s+1].clone(),D=h[u][s+1].clone();this.faces.push(new t.Face3(w,M,T,[E,S,A])),this.faceVertexUvs[0].push([N,R,D]),this.faces.push(new t.Face3(M,_,T,[S.clone(),C,A.clone()])),this.faceVertexUvs[0].push([R.clone(),L,D.clone()])}if(o===!1&&e>0)for(this.vertices.push(new t.Vector3(0,l,0)),s=0;i>s;s++){var w=c[0][s],M=c[0][s+1],_=this.vertices.length-1,E=new t.Vector3(0,1,0),S=new t.Vector3(0,1,0),C=new t.Vector3(0,1,0),N=h[0][s].clone(),R=h[0][s+1].clone(),L=new t.Vector2(R.x,0);this.faces.push(new t.Face3(w,M,_,[E,S,C])),this.faceVertexUvs[0].push([N,R,L])}if(o===!1&&r>0)for(this.vertices.push(new t.Vector3(0,-l,0)),s=0;i>s;s++){var w=c[u][s+1],M=c[u][s],_=this.vertices.length-1,E=new t.Vector3(0,-1,0),S=new t.Vector3(0,-1,0),C=new t.Vector3(0,-1,0),N=h[u][s+1].clone(),R=h[u][s].clone(),L=new t.Vector2(R.x,1);this.faces.push(new t.Face3(w,M,_,[E,S,C])),this.faceVertexUvs[0].push([N,R,L])}this.computeFaceNormals()},t.CylinderGeometry.prototype=Object.create(t.Geometry.prototype),t.ExtrudeGeometry=function(e,r){return"undefined"==typeof e?void(e=[]):(t.Geometry.call(this),this.type="ExtrudeGeometry",e=e instanceof Array?e:[e],this.addShapeList(e,r),void this.computeFaceNormals())},t.ExtrudeGeometry.prototype=Object.create(t.Geometry.prototype),t.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var r=e.length,n=0;r>n;n++){var i=e[n];this.addShape(i,t)}},t.ExtrudeGeometry.prototype.addShape=function(e,r){function n(e,t,r){return t||console.log("die"),t.clone().multiplyScalar(r).add(e)}function i(e,r,n){var i,a,o=1e-10,s=1,u=e.x-r.x,l=e.y-r.y,c=n.x-e.x,h=n.y-e.y,f=u*u+l*l,p=u*h-l*c;if(Math.abs(p)>o){var d=Math.sqrt(f),m=Math.sqrt(c*c+h*h),g=r.x-l/d,v=r.y+u/d,y=n.x-h/m,x=n.y+c/m,b=((y-g)*h-(x-v)*c)/(u*h-l*c);i=g+u*b-e.x,a=v+l*b-e.y;var w=i*i+a*a;if(2>=w)return new t.Vector2(i,a);s=Math.sqrt(w/2)}else{var M=!1;u>o?c>o&&(M=!0):-o>u?-o>c&&(M=!0):Math.sign(l)==Math.sign(h)&&(M=!0),M?(i=-l,a=u,s=Math.sqrt(f)):(i=u,a=l,s=Math.sqrt(f/2))}return new t.Vector2(i/s,a/s)}function a(){if(b){var e=0,t=j*e;for(Y=0;W>Y;Y++)H=O[Y],l(H[2]+t,H[1]+t,H[0]+t);for(e=M+2*x,t=j*e,Y=0;W>Y;Y++)H=O[Y],l(H[0]+t,H[1]+t,H[2]+t)}else{for(Y=0;W>Y;Y++)H=O[Y],l(H[2],H[1],H[0]);for(Y=0;W>Y;Y++)H=O[Y],l(H[0]+j*M,H[1]+j*M,H[2]+j*M)}}function o(){var e=0;for(s(B,e),e+=B.length,N=0,R=F.length;R>N;N++)A=F[N],s(A,e),e+=A.length}function s(e,t){var r,n;for(Y=e.length;--Y>=0;){r=Y,n=Y-1,0>n&&(n=e.length-1);var i=0,a=M+2*x;for(i=0;a>i;i++){var o=j*i,s=j*(i+1),u=t+r+o,l=t+n+o,h=t+n+s,f=t+r+s;c(u,l,h,f,e,i,a,r,n)}}}function u(e,r,n){L.vertices.push(new t.Vector3(e,r,n))}function l(e,r,n){e+=D,r+=D,n+=D,L.faces.push(new t.Face3(e,r,n,null,null,E));var i=C.generateTopUV(L,e,r,n);L.faceVertexUvs[0].push(i)}function c(e,r,n,i){e+=D,r+=D,n+=D,i+=D,L.faces.push(new t.Face3(e,r,i,null,null,S)),L.faces.push(new t.Face3(r,n,i,null,null,S));var a=C.generateSideWallUV(L,e,r,n,i);L.faceVertexUvs[0].push([a[0],a[1],a[3]]),L.faceVertexUvs[0].push([a[1],a[2],a[3]])}var h,f,p,d,m,g=void 0!==r.amount?r.amount:100,v=void 0!==r.bevelThickness?r.bevelThickness:6,y=void 0!==r.bevelSize?r.bevelSize:v-2,x=void 0!==r.bevelSegments?r.bevelSegments:3,b=void 0!==r.bevelEnabled?r.bevelEnabled:!0,w=void 0!==r.curveSegments?r.curveSegments:12,M=void 0!==r.steps?r.steps:1,_=r.extrudePath,T=!1,E=r.material,S=r.extrudeMaterial,C=void 0!==r.UVGenerator?r.UVGenerator:t.ExtrudeGeometry.WorldUVGenerator;_&&(h=_.getSpacedPoints(M),T=!0,b=!1,f=void 0!==r.frames?r.frames:new t.TubeGeometry.FrenetFrames(_,M,!1),p=new t.Vector3,d=new t.Vector3,m=new t.Vector3),b||(x=0,v=0,y=0);var A,N,R,L=this,D=this.vertices.length,P=e.extractPoints(w),I=P.shape,F=P.holes,U=!t.Shape.Utils.isClockWise(I);if(U){for(I=I.reverse(),N=0,R=F.length;R>N;N++)A=F[N],t.Shape.Utils.isClockWise(A)&&(F[N]=A.reverse());U=!1}var O=t.Shape.Utils.triangulateShape(I,F),B=I;for(N=0,R=F.length;R>N;N++)A=F[N],I=I.concat(A);for(var V,k,z,q,G,H,j=I.length,W=O.length,X=(B.length,180/Math.PI,[]),Y=0,K=B.length,Z=K-1,Q=Y+1;K>Y;Y++,Z++,Q++){Z===K&&(Z=0),Q===K&&(Q=0);{B[Y],B[Z],B[Q]}X[Y]=i(B[Y],B[Z],B[Q])}var $,J=[],et=X.concat();for(N=0,R=F.length;R>N;N++){for(A=F[N],$=[],Y=0,K=A.length,Z=K-1,Q=Y+1;K>Y;Y++,Z++,Q++)Z===K&&(Z=0),Q===K&&(Q=0),$[Y]=i(A[Y],A[Z],A[Q]);J.push($),et=et.concat($)}for(V=0;x>V;V++){for(z=V/x,q=v*(1-z),k=y*Math.sin(z*Math.PI/2),Y=0,K=B.length;K>Y;Y++)G=n(B[Y],X[Y],k),u(G.x,G.y,-q);for(N=0,R=F.length;R>N;N++)for(A=F[N],$=J[N],Y=0,K=A.length;K>Y;Y++)G=n(A[Y],$[Y],k),u(G.x,G.y,-q)}for(k=y,Y=0;j>Y;Y++)G=b?n(I[Y],et[Y],k):I[Y],T?(d.copy(f.normals[0]).multiplyScalar(G.x),p.copy(f.binormals[0]).multiplyScalar(G.y),m.copy(h[0]).add(d).add(p),u(m.x,m.y,m.z)):u(G.x,G.y,0);var tt;for(tt=1;M>=tt;tt++)for(Y=0;j>Y;Y++)G=b?n(I[Y],et[Y],k):I[Y],T?(d.copy(f.normals[tt]).multiplyScalar(G.x),p.copy(f.binormals[tt]).multiplyScalar(G.y),m.copy(h[tt]).add(d).add(p),u(m.x,m.y,m.z)):u(G.x,G.y,g/M*tt);for(V=x-1;V>=0;V--){for(z=V/x,q=v*(1-z),k=y*Math.sin(z*Math.PI/2),Y=0,K=B.length;K>Y;Y++)G=n(B[Y],X[Y],k),u(G.x,G.y,g+q);for(N=0,R=F.length;R>N;N++)for(A=F[N],$=J[N],Y=0,K=A.length;K>Y;Y++)G=n(A[Y],$[Y],k),T?u(G.x,G.y+h[M-1].y,h[M-1].x+q):u(G.x,G.y,g+q)}a(),o()},t.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,r,n,i){var a=e.vertices,o=a[r],s=a[n],u=a[i];return[new t.Vector2(o.x,o.y),new t.Vector2(s.x,s.y),new t.Vector2(u.x,u.y)]},generateSideWallUV:function(e,r,n,i,a){var o=e.vertices,s=o[r],u=o[n],l=o[i],c=o[a];return Math.abs(s.y-u.y)<.01?[new t.Vector2(s.x,1-s.z),new t.Vector2(u.x,1-u.z),new t.Vector2(l.x,1-l.z),new t.Vector2(c.x,1-c.z)]:[new t.Vector2(s.y,1-s.z),new t.Vector2(u.y,1-u.z),new t.Vector2(l.y,1-l.z),new t.Vector2(c.y,1-c.z)]}},t.ShapeGeometry=function(e,r){t.Geometry.call(this),this.type="ShapeGeometry",e instanceof Array==!1&&(e=[e]),this.addShapeList(e,r),this.computeFaceNormals()},t.ShapeGeometry.prototype=Object.create(t.Geometry.prototype),t.ShapeGeometry.prototype.addShapeList=function(e,t){for(var r=0,n=e.length;n>r;r++)this.addShape(e[r],t);return this},t.ShapeGeometry.prototype.addShape=function(e,r){void 0===r&&(r={});var n,i,a,o=void 0!==r.curveSegments?r.curveSegments:12,s=r.material,u=void 0===r.UVGenerator?t.ExtrudeGeometry.WorldUVGenerator:r.UVGenerator,l=this.vertices.length,c=e.extractPoints(o),h=c.shape,f=c.holes,p=!t.Shape.Utils.isClockWise(h);if(p){for(h=h.reverse(),n=0,i=f.length;i>n;n++)a=f[n],t.Shape.Utils.isClockWise(a)&&(f[n]=a.reverse());p=!1}var d=t.Shape.Utils.triangulateShape(h,f),m=h;for(n=0,i=f.length;i>n;n++)a=f[n],h=h.concat(a);{var g,v,y=h.length,x=d.length;m.length}for(n=0;y>n;n++)g=h[n],this.vertices.push(new t.Vector3(g.x,g.y,0));for(n=0;x>n;n++){v=d[n];var b=v[0]+l,w=v[1]+l,M=v[2]+l;this.faces.push(new t.Face3(b,w,M,null,null,s)),this.faceVertexUvs[0].push(u.generateTopUV(this,b,w,M))}},t.LatheGeometry=function(e,r,n,i){t.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:r,phiStart:n,phiLength:i},r=r||12,n=n||0,i=i||2*Math.PI;for(var a=1/(e.length-1),o=1/r,s=0,u=r;u>=s;s++)for(var l=n+s*o*i,c=Math.cos(l),h=Math.sin(l),f=0,p=e.length;p>f;f++){var d=e[f],m=new t.Vector3;m.x=c*d.x-h*d.y,m.y=h*d.x+c*d.y,m.z=d.z,this.vertices.push(m)}for(var g=e.length,s=0,u=r;u>s;s++)for(var f=0,p=e.length-1;p>f;f++){var v=f+g*s,y=v,x=v+g,c=v+1+g,b=v+1,w=s*o,M=f*a,_=w+o,T=M+a;this.faces.push(new t.Face3(y,x,b)),this.faceVertexUvs[0].push([new t.Vector2(w,M),new t.Vector2(_,M),new t.Vector2(w,T)]),this.faces.push(new t.Face3(x,c,b)),this.faceVertexUvs[0].push([new t.Vector2(_,M),new t.Vector2(_,T),new t.Vector2(w,T)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},t.LatheGeometry.prototype=Object.create(t.Geometry.prototype),t.PlaneGeometry=function(e,r,n,i){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),t.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:r,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new t.PlaneBufferGeometry(e,r,n,i))},t.PlaneGeometry.prototype=Object.create(t.Geometry.prototype),t.PlaneBufferGeometry=function(e,r,n,i){t.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:r,widthSegments:n,heightSegments:i};for(var a=e/2,o=r/2,s=n||1,u=i||1,l=s+1,c=u+1,h=e/s,f=r/u,p=new Float32Array(l*c*3),d=new Float32Array(l*c*3),m=new Float32Array(l*c*2),g=0,v=0,y=0;c>y;y++)for(var x=y*f-o,b=0;l>b;b++){var w=b*h-a;p[g]=w,p[g+1]=-x,d[g+2]=1,m[v]=b/s,m[v+1]=1-y/u,g+=3,v+=2}g=0;for(var M=new(p.length/3>65535?Uint32Array:Uint16Array)(s*u*6),y=0;u>y;y++)for(var b=0;s>b;b++){var _=b+l*y,T=b+l*(y+1),E=b+1+l*(y+1),S=b+1+l*y;M[g]=_,M[g+1]=T,M[g+2]=S,M[g+3]=T,M[g+4]=E,M[g+5]=S,g+=6}this.addAttribute("index",new t.BufferAttribute(M,1)),this.addAttribute("position",new t.BufferAttribute(p,3)),this.addAttribute("normal",new t.BufferAttribute(d,3)),this.addAttribute("uv",new t.BufferAttribute(m,2))},t.PlaneBufferGeometry.prototype=Object.create(t.BufferGeometry.prototype),t.RingGeometry=function(e,r,n,i,a,o){t.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:r,thetaSegments:n,phiSegments:i,thetaStart:a,thetaLength:o},e=e||0,r=r||50,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,i=void 0!==i?Math.max(1,i):8;var s,u,l=[],c=e,h=(r-e)/i;for(s=0;i+1>s;s++){for(u=0;n+1>u;u++){var f=new t.Vector3,p=a+u/n*o;f.x=c*Math.cos(p),f.y=c*Math.sin(p),this.vertices.push(f),l.push(new t.Vector2((f.x/r+1)/2,(f.y/r+1)/2))}c+=h}var d=new t.Vector3(0,0,1);for(s=0;i>s;s++){var m=s*(n+1);for(u=0;n>u;u++){var p=u+m,g=p,v=p+n+1,y=p+n+2;this.faces.push(new t.Face3(g,v,y,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([l[g].clone(),l[v].clone(),l[y].clone()]),g=p,v=p+n+2,y=p+1,this.faces.push(new t.Face3(g,v,y,[d.clone(),d.clone(),d.clone()])),this.faceVertexUvs[0].push([l[g].clone(),l[v].clone(),l[y].clone()])}}this.computeFaceNormals(),this.boundingSphere=new t.Sphere(new t.Vector3,c)},t.RingGeometry.prototype=Object.create(t.Geometry.prototype),t.SphereGeometry=function(e,r,n,i,a,o,s){t.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:r,heightSegments:n,phiStart:i,phiLength:a,thetaStart:o,thetaLength:s},e=e||50,r=Math.max(3,Math.floor(r)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,o=void 0!==o?o:0,s=void 0!==s?s:Math.PI;var u,l,c=[],h=[];for(l=0;n>=l;l++){var f=[],p=[];for(u=0;r>=u;u++){var d=u/r,m=l/n,g=new t.Vector3;g.x=-e*Math.cos(i+d*a)*Math.sin(o+m*s),g.y=e*Math.cos(o+m*s),g.z=e*Math.sin(i+d*a)*Math.sin(o+m*s),this.vertices.push(g),f.push(this.vertices.length-1),p.push(new t.Vector2(d,1-m))}c.push(f),h.push(p)}for(l=0;n>l;l++)for(u=0;r>u;u++){var v=c[l][u+1],y=c[l][u],x=c[l+1][u],b=c[l+1][u+1],w=this.vertices[v].clone().normalize(),M=this.vertices[y].clone().normalize(),_=this.vertices[x].clone().normalize(),T=this.vertices[b].clone().normalize(),E=h[l][u+1].clone(),S=h[l][u].clone(),C=h[l+1][u].clone(),A=h[l+1][u+1].clone();Math.abs(this.vertices[v].y)===e?(E.x=(E.x+S.x)/2,this.faces.push(new t.Face3(v,x,b,[w,_,T])),this.faceVertexUvs[0].push([E,C,A])):Math.abs(this.vertices[x].y)===e?(C.x=(C.x+A.x)/2,this.faces.push(new t.Face3(v,y,x,[w,M,_])),this.faceVertexUvs[0].push([E,S,C])):(this.faces.push(new t.Face3(v,y,b,[w,M,T])),this.faceVertexUvs[0].push([E,S,A]),this.faces.push(new t.Face3(y,x,b,[M.clone(),_,T.clone()])),this.faceVertexUvs[0].push([S.clone(),C,A.clone()]))}this.computeFaceNormals(),this.boundingSphere=new t.Sphere(new t.Vector3,e)},t.SphereGeometry.prototype=Object.create(t.Geometry.prototype),t.TextGeometry=function(e,r){r=r||{};var n=t.FontUtils.generateShapes(e,r);r.amount=void 0!==r.height?r.height:50,void 0===r.bevelThickness&&(r.bevelThickness=10),void 0===r.bevelSize&&(r.bevelSize=8),void 0===r.bevelEnabled&&(r.bevelEnabled=!1),t.ExtrudeGeometry.call(this,n,r),this.type="TextGeometry"},t.TextGeometry.prototype=Object.create(t.ExtrudeGeometry.prototype),t.TorusGeometry=function(e,r,n,i,a){t.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:r,radialSegments:n,tubularSegments:i,arc:a},e=e||100,r=r||40,n=n||8,i=i||6,a=a||2*Math.PI;for(var o=new t.Vector3,s=[],u=[],l=0;n>=l;l++)for(var c=0;i>=c;c++){var h=c/i*a,f=l/n*Math.PI*2;o.x=e*Math.cos(h),o.y=e*Math.sin(h);var p=new t.Vector3;p.x=(e+r*Math.cos(f))*Math.cos(h),p.y=(e+r*Math.cos(f))*Math.sin(h),p.z=r*Math.sin(f),this.vertices.push(p),s.push(new t.Vector2(c/i,l/n)),u.push(p.clone().sub(o).normalize())}for(var l=1;n>=l;l++)for(var c=1;i>=c;c++){var d=(i+1)*l+c-1,m=(i+1)*(l-1)+c-1,g=(i+1)*(l-1)+c,v=(i+1)*l+c,y=new t.Face3(d,m,v,[u[d].clone(),u[m].clone(),u[v].clone()]);this.faces.push(y),this.faceVertexUvs[0].push([s[d].clone(),s[m].clone(),s[v].clone()]),y=new t.Face3(m,g,v,[u[m].clone(),u[g].clone(),u[v].clone()]),this.faces.push(y),this.faceVertexUvs[0].push([s[m].clone(),s[g].clone(),s[v].clone()])}this.computeFaceNormals()},t.TorusGeometry.prototype=Object.create(t.Geometry.prototype),t.TorusKnotGeometry=function(e,r,n,i,a,o,s){function u(e,r,n,i,a){var o=Math.cos(e),s=Math.sin(e),u=r/n*e,l=Math.cos(u),c=i*(2+l)*.5*o,h=i*(2+l)*s*.5,f=a*i*Math.sin(u)*.5;return new t.Vector3(c,h,f)}t.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:r,radialSegments:n,tubularSegments:i,p:a,q:o,heightScale:s},e=e||100,r=r||40,n=n||64,i=i||8,a=a||2,o=o||3,s=s||1;for(var l=new Array(n),c=new t.Vector3,h=new t.Vector3,f=new t.Vector3,p=0;n>p;++p){l[p]=new Array(i);var d=p/n*2*a*Math.PI,m=u(d,o,a,e,s),g=u(d+.01,o,a,e,s);c.subVectors(g,m),h.addVectors(g,m),f.crossVectors(c,h),h.crossVectors(f,c),f.normalize(),h.normalize();for(var v=0;i>v;++v){var y=v/i*2*Math.PI,x=-r*Math.cos(y),b=r*Math.sin(y),w=new t.Vector3;w.x=m.x+x*h.x+b*f.x,w.y=m.y+x*h.y+b*f.y,w.z=m.z+x*h.z+b*f.z,l[p][v]=this.vertices.push(w)-1}}for(var p=0;n>p;++p)for(var v=0;i>v;++v){var M=(p+1)%n,_=(v+1)%i,T=l[p][v],E=l[M][v],S=l[M][_],C=l[p][_],A=new t.Vector2(p/n,v/i),N=new t.Vector2((p+1)/n,v/i),R=new t.Vector2((p+1)/n,(v+1)/i),L=new t.Vector2(p/n,(v+1)/i);this.faces.push(new t.Face3(T,E,C)),this.faceVertexUvs[0].push([A,N,L]),this.faces.push(new t.Face3(E,S,C)),this.faceVertexUvs[0].push([N.clone(),R,L.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},t.TorusKnotGeometry.prototype=Object.create(t.Geometry.prototype),t.TubeGeometry=function(e,r,n,i,a){function o(e,r,n){return A.vertices.push(new t.Vector3(e,r,n))-1}t.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:r,radius:n,radialSegments:i,closed:a},r=r||64,n=n||1,i=i||8,a=a||!1;var s,u,l,c,h,f,p,d,m,g,v,y,x,b,w,M,_,T,E,S,C=[],A=this,N=r+1,R=new t.Vector3,L=new t.TubeGeometry.FrenetFrames(e,r,a),D=L.tangents,P=L.normals,I=L.binormals;for(this.tangents=D,this.normals=P,this.binormals=I,m=0;N>m;m++)for(C[m]=[],c=m/(N-1),d=e.getPointAt(c),s=D[m],u=P[m],l=I[m],g=0;i>g;g++)h=g/i*2*Math.PI,f=-n*Math.cos(h),p=n*Math.sin(h),R.copy(d),R.x+=f*u.x+p*l.x,R.y+=f*u.y+p*l.y,R.z+=f*u.z+p*l.z,C[m][g]=o(R.x,R.y,R.z);for(m=0;r>m;m++)for(g=0;i>g;g++)v=a?(m+1)%r:m+1,y=(g+1)%i,x=C[m][g],b=C[v][g],w=C[v][y],M=C[m][y],_=new t.Vector2(m/r,g/i),T=new t.Vector2((m+1)/r,g/i),E=new t.Vector2((m+1)/r,(g+1)/i),S=new t.Vector2(m/r,(g+1)/i),this.faces.push(new t.Face3(x,b,M)),this.faceVertexUvs[0].push([_,T,S]),this.faces.push(new t.Face3(b,w,M)),this.faceVertexUvs[0].push([T.clone(),E,S.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},t.TubeGeometry.prototype=Object.create(t.Geometry.prototype),t.TubeGeometry.FrenetFrames=function(e,r,n){function i(){d[0]=new t.Vector3,m[0]=new t.Vector3,o=Number.MAX_VALUE,s=Math.abs(p[0].x),u=Math.abs(p[0].y),l=Math.abs(p[0].z),o>=s&&(o=s,f.set(1,0,0)),o>=u&&(o=u,f.set(0,1,0)),o>=l&&f.set(0,0,1),g.crossVectors(p[0],f).normalize(),d[0].crossVectors(p[0],g),m[0].crossVectors(p[0],d[0])}var a,o,s,u,l,c,h,f=(new t.Vector3,new t.Vector3),p=(new t.Vector3,[]),d=[],m=[],g=new t.Vector3,v=new t.Matrix4,y=r+1,x=1e-4;for(this.tangents=p,this.normals=d,this.binormals=m,c=0;y>c;c++)h=c/(y-1),p[c]=e.getTangentAt(h),p[c].normalize();for(i(),c=1;y>c;c++)d[c]=d[c-1].clone(),m[c]=m[c-1].clone(),g.crossVectors(p[c-1],p[c]),g.length()>x&&(g.normalize(),a=Math.acos(t.Math.clamp(p[c-1].dot(p[c]),-1,1)),d[c].applyMatrix4(v.makeRotationAxis(g,a))),m[c].crossVectors(p[c],d[c]);if(n)for(a=Math.acos(t.Math.clamp(d[0].dot(d[y-1]),-1,1)),a/=y-1,p[0].dot(g.crossVectors(d[0],d[y-1]))>0&&(a=-a),c=1;y>c;c++)d[c].applyMatrix4(v.makeRotationAxis(p[c],a*c)),m[c].crossVectors(p[c],d[c])},t.PolyhedronGeometry=function(e,r,n,i){function a(e){var r=e.normalize().clone();r.index=h.vertices.push(r)-1;var n=u(e)/2/Math.PI+.5,i=l(e)/Math.PI+.5;return r.uv=new t.Vector2(n,1-i),r}function o(e,r,n){var i=new t.Face3(e.index,r.index,n.index,[e.clone(),r.clone(),n.clone()]);h.faces.push(i),b.copy(e).add(r).add(n).divideScalar(3);var a=u(b);h.faceVertexUvs[0].push([c(e.uv,e,a),c(r.uv,r,a),c(n.uv,n,a)])}function s(e,t){for(var r=Math.pow(2,t),n=(Math.pow(4,t),a(h.vertices[e.a])),i=a(h.vertices[e.b]),s=a(h.vertices[e.c]),u=[],l=0;r>=l;l++){u[l]=[];for(var c=a(n.clone().lerp(s,l/r)),f=a(i.clone().lerp(s,l/r)),p=r-l,d=0;p>=d;d++)u[l][d]=0==d&&l==r?c:a(c.clone().lerp(f,d/p))}for(var l=0;r>l;l++)for(var d=0;2*(r-l)-1>d;d++){var m=Math.floor(d/2);d%2==0?o(u[l][m+1],u[l+1][m],u[l][m]):o(u[l][m+1],u[l+1][m+1],u[l+1][m])}}function u(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function c(e,r,n){return 0>n&&1===e.x&&(e=new t.Vector2(e.x-1,e.y)),0===r.x&&0===r.z&&(e=new t.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}t.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:r,radius:n,detail:i},n=n||1,i=i||0;for(var h=this,f=0,p=e.length;p>f;f+=3)a(new t.Vector3(e[f],e[f+1],e[f+2]));for(var d=this.vertices,m=[],f=0,g=0,p=r.length;p>f;f+=3,g++){var v=d[r[f]],y=d[r[f+1]],x=d[r[f+2]];m[g]=new t.Face3(v.index,y.index,x.index,[v.clone(),y.clone(),x.clone()])}for(var b=new t.Vector3,f=0,p=m.length;p>f;f++)s(m[f],i);for(var f=0,p=this.faceVertexUvs[0].length;p>f;f++){var w=this.faceVertexUvs[0][f],M=w[0].x,_=w[1].x,T=w[2].x,E=Math.max(M,Math.max(_,T)),S=Math.min(M,Math.min(_,T));E>.9&&.1>S&&(.2>M&&(w[0].x+=1),.2>_&&(w[1].x+=1),.2>T&&(w[2].x+=1))}for(var f=0,p=this.vertices.length;p>f;f++)this.vertices[f].multiplyScalar(n);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new t.Sphere(new t.Vector3,n)},t.PolyhedronGeometry.prototype=Object.create(t.Geometry.prototype),t.DodecahedronGeometry=function(e,r){this.parameters={radius:e,detail:r};var n=(1+Math.sqrt(5))/2,i=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];t.PolyhedronGeometry.call(this,a,o,e,r)},t.DodecahedronGeometry.prototype=Object.create(t.Geometry.prototype),t.IcosahedronGeometry=function(e,r){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];t.PolyhedronGeometry.call(this,i,a,e,r),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:r}},t.IcosahedronGeometry.prototype=Object.create(t.Geometry.prototype),t.OctahedronGeometry=function(e,r){this.parameters={radius:e,detail:r};var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];t.PolyhedronGeometry.call(this,n,i,e,r),this.type="OctahedronGeometry",this.parameters={radius:e,detail:r}},t.OctahedronGeometry.prototype=Object.create(t.Geometry.prototype),t.TetrahedronGeometry=function(e,r){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];t.PolyhedronGeometry.call(this,n,i,e,r),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:r}},t.TetrahedronGeometry.prototype=Object.create(t.Geometry.prototype),t.ParametricGeometry=function(e,r,n){t.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:r,stacks:n};var i,a,o,s,u,l=this.vertices,c=this.faces,h=this.faceVertexUvs[0],f=r+1;for(i=0;n>=i;i++)for(u=i/n,a=0;r>=a;a++)s=a/r,o=e(s,u),l.push(o);var p,d,m,g,v,y,x,b;for(i=0;n>i;i++)for(a=0;r>a;a++)p=i*f+a,d=i*f+a+1,m=(i+1)*f+a+1,g=(i+1)*f+a,v=new t.Vector2(a/r,i/n),y=new t.Vector2((a+1)/r,i/n),x=new t.Vector2((a+1)/r,(i+1)/n),b=new t.Vector2(a/r,(i+1)/n),c.push(new t.Face3(p,d,g)),h.push([v,y,b]),c.push(new t.Face3(d,m,g)),h.push([y.clone(),x,b.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},t.ParametricGeometry.prototype=Object.create(t.Geometry.prototype),t.AxisHelper=function(e){e=e||1;var r=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new t.BufferGeometry;i.addAttribute("position",new t.BufferAttribute(r,3)),i.addAttribute("color",new t.BufferAttribute(n,3));var a=new t.LineBasicMaterial({vertexColors:t.VertexColors});t.Line.call(this,i,a,t.LinePieces)},t.AxisHelper.prototype=Object.create(t.Line.prototype),t.ArrowHelper=function(){var e=new t.Geometry;e.vertices.push(new t.Vector3(0,0,0),new t.Vector3(0,1,0));var r=new t.CylinderGeometry(0,.5,1,5,1);return r.applyMatrix((new t.Matrix4).makeTranslation(0,-.5,0)),function(n,i,a,o,s,u){t.Object3D.call(this),void 0===o&&(o=16776960),void 0===a&&(a=1),void 0===s&&(s=.2*a),void 0===u&&(u=.2*s),this.position.copy(i),this.line=new t.Line(e,new t.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new t.Mesh(r,new t.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(a,s,u)}}(),t.ArrowHelper.prototype=Object.create(t.Object3D.prototype),t.ArrowHelper.prototype.setDirection=function(){var e,r=new t.Vector3;return function(t){t.y>.99999?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(r.set(t.z,0,-t.x).normalize(),e=Math.acos(t.y),this.quaternion.setFromAxisAngle(r,e))}}(),t.ArrowHelper.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,e,1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},t.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},t.BoxHelper=function(e){var r=new t.BufferGeometry;r.addAttribute("position",new t.BufferAttribute(new Float32Array(72),3)),t.Line.call(this,r,new t.LineBasicMaterial({color:16776960}),t.LinePieces),void 0!==e&&this.update(e)},t.BoxHelper.prototype=Object.create(t.Line.prototype),t.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var r=t.boundingBox.min,n=t.boundingBox.max,i=this.geometry.attributes.position.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=r.x,i[4]=n.y,i[5]=n.z,i[6]=r.x,i[7]=n.y,i[8]=n.z,i[9]=r.x,i[10]=r.y,i[11]=n.z,i[12]=r.x,i[13]=r.y,i[14]=n.z,i[15]=n.x,i[16]=r.y,i[17]=n.z,i[18]=n.x,i[19]=r.y,i[20]=n.z,i[21]=n.x,i[22]=n.y,i[23]=n.z,i[24]=n.x,i[25]=n.y,i[26]=r.z,i[27]=r.x,i[28]=n.y,i[29]=r.z,i[30]=r.x,i[31]=n.y,i[32]=r.z,i[33]=r.x,i[34]=r.y,i[35]=r.z,i[36]=r.x,i[37]=r.y,i[38]=r.z,i[39]=n.x,i[40]=r.y,i[41]=r.z,i[42]=n.x,i[43]=r.y,i[44]=r.z,i[45]=n.x,i[46]=n.y,i[47]=r.z,i[48]=n.x,i[49]=n.y,i[50]=n.z,i[51]=n.x,i[52]=n.y,i[53]=r.z,i[54]=r.x,i[55]=n.y,i[56]=n.z,i[57]=r.x,i[58]=n.y,i[59]=r.z,i[60]=r.x,i[61]=r.y,i[62]=n.z,i[63]=r.x,i[64]=r.y,i[65]=r.z,i[66]=n.x,i[67]=r.y,i[68]=n.z,i[69]=n.x,i[70]=r.y,i[71]=r.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},t.BoundingBoxHelper=function(e,r){var n=void 0!==r?r:8947848;this.object=e,this.box=new t.Box3,t.Mesh.call(this,new t.BoxGeometry(1,1,1),new t.MeshBasicMaterial({color:n,wireframe:!0}))},t.BoundingBoxHelper.prototype=Object.create(t.Mesh.prototype),t.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},t.CameraHelper=function(e){function r(e,t,r){n(e,r),n(t,r)}function n(e,r){i.vertices.push(new t.Vector3),i.colors.push(new t.Color(r)),void 0===o[e]&&(o[e]=[]),o[e].push(i.vertices.length-1)}var i=new t.Geometry,a=new t.LineBasicMaterial({color:16777215,vertexColors:t.FaceColors}),o={},s=16755200,u=16711680,l=43775,c=16777215,h=3355443;r("n1","n2",s),r("n2","n4",s),r("n4","n3",s),r("n3","n1",s),r("f1","f2",s),r("f2","f4",s),r("f4","f3",s),r("f3","f1",s),r("n1","f1",s),r("n2","f2",s),r("n3","f3",s),r("n4","f4",s),r("p","n1",u),r("p","n2",u),r("p","n3",u),r("p","n4",u),r("u1","u2",l),r("u2","u3",l),r("u3","u1",l),r("c","t",c),r("p","c",h),r("cn1","cn2",h),r("cn3","cn4",h),r("cf1","cf2",h),r("cf3","cf4",h),t.Line.call(this,i,a,t.LinePieces),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},t.CameraHelper.prototype=Object.create(t.Line.prototype),t.CameraHelper.prototype.update=function(){var e,r,n=new t.Vector3,i=new t.Camera,a=function(t,a,o,s){n.set(a,o,s).unproject(i);var u=r[t];if(void 0!==u)for(var l=0,c=u.length;c>l;l++)e.vertices[u[l]].copy(n)};return function(){e=this.geometry,r=this.pointMap;var t=1,n=1;i.projectionMatrix.copy(this.camera.projectionMatrix),a("c",0,0,-1),a("t",0,0,1),a("n1",-t,-n,-1),a("n2",t,-n,-1),a("n3",-t,n,-1),a("n4",t,n,-1),a("f1",-t,-n,1),a("f2",t,-n,1),a("f3",-t,n,1),a("f4",t,n,1),a("u1",.7*t,1.1*n,-1),a("u2",.7*-t,1.1*n,-1),a("u3",0,2*n,-1),a("cf1",-t,0,1),a("cf2",t,0,1),a("cf3",0,-n,1),a("cf4",0,n,1),a("cn1",-t,0,-1),a("cn2",t,0,-1),a("cn3",0,-n,-1),a("cn4",0,n,-1),e.verticesNeedUpdate=!0}}(),t.DirectionalLightHelper=function(e,r){t.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,r=r||1;var n=new t.Geometry;n.vertices.push(new t.Vector3(-r,r,0),new t.Vector3(r,r,0),new t.Vector3(r,-r,0),new t.Vector3(-r,-r,0),new t.Vector3(-r,r,0));var i=new t.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new t.Line(n,i),this.add(this.lightPlane),n=new t.Geometry,n.vertices.push(new t.Vector3,new t.Vector3),i=new t.LineBasicMaterial({fog:!1}),i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new t.Line(n,i),this.add(this.targetLine),this.update()},t.DirectionalLightHelper.prototype=Object.create(t.Object3D.prototype),t.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},t.DirectionalLightHelper.prototype.update=function(){var e=new t.Vector3,r=new t.Vector3,n=new t.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),r.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(r,e),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),t.EdgesHelper=function(e,r){var n=void 0!==r?r:16777215,i=[0,0],a={},o=function(e,t){return e-t},s=["a","b","c"],u=new t.BufferGeometry,l=e.geometry.clone();l.mergeVertices(),l.computeFaceNormals();for(var c=l.vertices,h=l.faces,f=0,p=0,d=h.length;d>p;p++)for(var m=h[p],g=0;3>g;g++){i[0]=m[s[g]],i[1]=m[s[(g+1)%3]],i.sort(o);var v=i.toString();void 0===a[v]?(a[v]={vert1:i[0],vert2:i[1],face1:p,face2:void 0},f++):a[v].face2=p}var y=new Float32Array(2*f*3),x=0;for(var v in a){var b=a[v];if(void 0===b.face2||h[b.face1].normal.dot(h[b.face2].normal)<.9999){var w=c[b.vert1];y[x++]=w.x,y[x++]=w.y,y[x++]=w.z,w=c[b.vert2],y[x++]=w.x,y[x++]=w.y,y[x++]=w.z
}}u.addAttribute("position",new t.BufferAttribute(y,3)),t.Line.call(this,u,new t.LineBasicMaterial({color:n}),t.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},t.EdgesHelper.prototype=Object.create(t.Line.prototype),t.FaceNormalsHelper=function(e,r,n,i){this.object=e,this.size=void 0!==r?r:1;for(var a=void 0!==n?n:16776960,o=void 0!==i?i:1,s=new t.Geometry,u=this.object.geometry.faces,l=0,c=u.length;c>l;l++)s.vertices.push(new t.Vector3,new t.Vector3);t.Line.call(this,s,new t.LineBasicMaterial({color:a,linewidth:o}),t.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new t.Matrix3,this.update()},t.FaceNormalsHelper.prototype=Object.create(t.Line.prototype),t.FaceNormalsHelper.prototype.update=function(){var e=this.geometry.vertices,t=this.object,r=t.geometry.vertices,n=t.geometry.faces,i=t.matrixWorld;t.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(i);for(var a=0,o=0,s=n.length;s>a;a++,o+=2){var u=n[a];e[o].copy(r[u.a]).add(r[u.b]).add(r[u.c]).divideScalar(3).applyMatrix4(i),e[o+1].copy(u.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[o])}return this.geometry.verticesNeedUpdate=!0,this},t.GridHelper=function(e,r){var n=new t.Geometry,i=new t.LineBasicMaterial({vertexColors:t.VertexColors});this.color1=new t.Color(4473924),this.color2=new t.Color(8947848);for(var a=-e;e>=a;a+=r){n.vertices.push(new t.Vector3(-e,0,a),new t.Vector3(e,0,a),new t.Vector3(a,0,-e),new t.Vector3(a,0,e));var o=0===a?this.color1:this.color2;n.colors.push(o,o,o,o)}t.Line.call(this,n,i,t.LinePieces)},t.GridHelper.prototype=Object.create(t.Line.prototype),t.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},t.HemisphereLightHelper=function(e,r){t.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new t.Color,new t.Color];var n=new t.SphereGeometry(r,4,2);n.applyMatrix((new t.Matrix4).makeRotationX(-Math.PI/2));for(var i=0,a=8;a>i;i++)n.faces[i].color=this.colors[4>i?0:1];var o=new t.MeshBasicMaterial({vertexColors:t.FaceColors,wireframe:!0});this.lightSphere=new t.Mesh(n,o),this.add(this.lightSphere),this.update()},t.HemisphereLightHelper.prototype=Object.create(t.Object3D.prototype),t.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},t.HemisphereLightHelper.prototype.update=function(){var e=new t.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),t.PointLightHelper=function(e,r){this.light=e,this.light.updateMatrixWorld();var n=new t.SphereGeometry(r,4,2),i=new t.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),t.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},t.PointLightHelper.prototype=Object.create(t.Mesh.prototype),t.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},t.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},t.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var r=new t.Geometry,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent instanceof t.Bone&&(r.vertices.push(new t.Vector3),r.vertices.push(new t.Vector3),r.colors.push(new t.Color(0,0,1)),r.colors.push(new t.Color(0,1,0)))}var a=new t.LineBasicMaterial({vertexColors:t.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});t.Line.call(this,r,a,t.LinePieces),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},t.SkeletonHelper.prototype=Object.create(t.Line.prototype),t.SkeletonHelper.prototype.getBoneList=function(e){var r=[];e instanceof t.Bone&&r.push(e);for(var n=0;n<e.children.length;n++)r.push.apply(r,this.getBoneList(e.children[n]));return r},t.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,r=(new t.Matrix4).getInverse(this.root.matrixWorld),n=new t.Matrix4,i=0,a=0;a<this.bones.length;a++){var o=this.bones[a];o.parent instanceof t.Bone&&(n.multiplyMatrices(r,o.matrixWorld),e.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(r,o.parent.matrixWorld),e.vertices[i+1].setFromMatrixPosition(n),i+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},t.SpotLightHelper=function(e){t.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var r=new t.CylinderGeometry(0,1,1,8,1,!0);r.applyMatrix((new t.Matrix4).makeTranslation(0,-.5,0)),r.applyMatrix((new t.Matrix4).makeRotationX(-Math.PI/2));var n=new t.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new t.Mesh(r,n),this.add(this.cone),this.update()},t.SpotLightHelper.prototype=Object.create(t.Object3D.prototype),t.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},t.SpotLightHelper.prototype.update=function(){var e=new t.Vector3,r=new t.Vector3;return function(){var t=this.light.distance?this.light.distance:1e4,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.light.matrixWorld),r.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(r.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),t.VertexNormalsHelper=function(e,r,n,i){this.object=e,this.size=void 0!==r?r:1;for(var a=void 0!==n?n:16711680,o=void 0!==i?i:1,s=new t.Geometry,u=(e.geometry.vertices,e.geometry.faces),l=0,c=u.length;c>l;l++)for(var h=u[l],f=0,p=h.vertexNormals.length;p>f;f++)s.vertices.push(new t.Vector3,new t.Vector3);t.Line.call(this,s,new t.LineBasicMaterial({color:a,linewidth:o}),t.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new t.Matrix3,this.update()},t.VertexNormalsHelper.prototype=Object.create(t.Line.prototype),t.VertexNormalsHelper.prototype.update=function(){var e=new t.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var r=this.geometry.vertices,n=this.object.geometry.vertices,i=this.object.geometry.faces,a=this.object.matrixWorld,o=0,s=0,u=i.length;u>s;s++)for(var l=i[s],c=0,h=l.vertexNormals.length;h>c;c++){var f=l[t[c]],p=n[f],d=l.vertexNormals[c];r[o].copy(p).applyMatrix4(a),e.copy(d).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),e.add(r[o]),o+=1,r[o].copy(e),o+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),t.VertexTangentsHelper=function(e,r,n,i){this.object=e,this.size=void 0!==r?r:1;for(var a=void 0!==n?n:255,o=void 0!==i?i:1,s=new t.Geometry,u=(e.geometry.vertices,e.geometry.faces),l=0,c=u.length;c>l;l++)for(var h=u[l],f=0,p=h.vertexTangents.length;p>f;f++)s.vertices.push(new t.Vector3),s.vertices.push(new t.Vector3);t.Line.call(this,s,new t.LineBasicMaterial({color:a,linewidth:o}),t.LinePieces),this.matrixAutoUpdate=!1,this.update()},t.VertexTangentsHelper.prototype=Object.create(t.Line.prototype),t.VertexTangentsHelper.prototype.update=function(){var e=new t.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var r=this.geometry.vertices,n=this.object.geometry.vertices,i=this.object.geometry.faces,a=this.object.matrixWorld,o=0,s=0,u=i.length;u>s;s++)for(var l=i[s],c=0,h=l.vertexTangents.length;h>c;c++){var f=l[t[c]],p=n[f],d=l.vertexTangents[c];r[o].copy(p).applyMatrix4(a),e.copy(d).transformDirection(a).multiplyScalar(this.size),e.add(r[o]),o+=1,r[o].copy(e),o+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),t.WireframeHelper=function(e,r){var n=void 0!==r?r:16777215,i=[0,0],a={},o=function(e,t){return e-t},s=["a","b","c"],u=new t.BufferGeometry;if(e.geometry instanceof t.Geometry){for(var l=e.geometry.vertices,c=e.geometry.faces,h=0,f=new Uint32Array(6*c.length),p=0,d=c.length;d>p;p++)for(var m=c[p],g=0;3>g;g++){i[0]=m[s[g]],i[1]=m[s[(g+1)%3]],i.sort(o);var v=i.toString();void 0===a[v]&&(f[2*h]=i[0],f[2*h+1]=i[1],a[v]=!0,h++)}for(var y=new Float32Array(2*h*3),p=0,d=h;d>p;p++)for(var g=0;2>g;g++){var x=l[f[2*p+g]],b=6*p+3*g;y[b+0]=x.x,y[b+1]=x.y,y[b+2]=x.z}u.addAttribute("position",new t.BufferAttribute(y,3))}else if(e.geometry instanceof t.BufferGeometry)if(void 0!==e.geometry.attributes.index){var l=e.geometry.attributes.position.array,w=e.geometry.attributes.index.array,M=e.geometry.drawcalls,h=0;0===M.length&&(M=[{count:w.length,index:0,start:0}]);for(var f=new Uint32Array(2*w.length),_=0,T=M.length;T>_;++_)for(var E=M[_].start,S=M[_].count,b=M[_].index,p=E,C=E+S;C>p;p+=3)for(var g=0;3>g;g++){i[0]=b+w[p+g],i[1]=b+w[p+(g+1)%3],i.sort(o);var v=i.toString();void 0===a[v]&&(f[2*h]=i[0],f[2*h+1]=i[1],a[v]=!0,h++)}for(var y=new Float32Array(2*h*3),p=0,d=h;d>p;p++)for(var g=0;2>g;g++){var b=6*p+3*g,A=3*f[2*p+g];y[b+0]=l[A],y[b+1]=l[A+1],y[b+2]=l[A+2]}u.addAttribute("position",new t.BufferAttribute(y,3))}else{for(var l=e.geometry.attributes.position.array,h=l.length/3,N=h/3,y=new Float32Array(2*h*3),p=0,d=N;d>p;p++)for(var g=0;3>g;g++){var b=18*p+6*g,R=9*p+3*g;y[b+0]=l[R],y[b+1]=l[R+1],y[b+2]=l[R+2];var A=9*p+3*((g+1)%3);y[b+3]=l[A],y[b+4]=l[A+1],y[b+5]=l[A+2]}u.addAttribute("position",new t.BufferAttribute(y,3))}t.Line.call(this,u,new t.LineBasicMaterial({color:n}),t.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},t.WireframeHelper.prototype=Object.create(t.Line.prototype),t.ImmediateRenderObject=function(){t.Object3D.call(this),this.render=function(){}},t.ImmediateRenderObject.prototype=Object.create(t.Object3D.prototype),t.MorphBlendMesh=function(e,r){t.Mesh.call(this,e,r),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i="__default",a=0,o=n-1,s=n/1;this.createAnimation(i,a,o,s),this.setAnimationWeight(i,1)},t.MorphBlendMesh.prototype=Object.create(t.Mesh.prototype),t.MorphBlendMesh.prototype.createAnimation=function(e,t,r,n){var i={startFrame:t,endFrame:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=i,this.animationsList.push(i)},t.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,r=/([a-z]+)_?(\d+)/,n={},i=this.geometry,a=0,o=i.morphTargets.length;o>a;a++){var s=i.morphTargets[a],u=s.name.match(r);if(u&&u.length>1){{var l=u[1];u[2]}n[l]||(n[l]={start:1/0,end:-1/0});var c=n[l];a<c.start&&(c.start=a),a>c.end&&(c.end=a),t||(t=l)}}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},t.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},t.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},t.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)},t.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)},t.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)},t.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)},t.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,r=this.animationsMap[e];return r&&(t=r.time),t},t.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,r=this.animationsMap[e];return r&&(t=r.duration),t},t.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("animation["+e+"] undefined")},t.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},t.MorphBlendMesh.prototype.update=function(e){for(var r=0,n=this.animationsList.length;n>r;r++){var i=this.animationsList[r];if(i.active){var a=i.duration/i.length;i.time+=i.direction*e,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var o=i.startFrame+t.Math.clamp(Math.floor(i.time/a),0,i.length-1),s=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*s,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o);var u=i.time%a/a;i.directionBackwards&&(u=1-u),this.morphTargetInfluences[i.currentFrame]=u*s,this.morphTargetInfluences[i.lastFrame]=(1-u)*s}}},e["default"]=t}),define("frontend/libraries/mathAnimationLibrary/dist/vendor/trackballControls",["exports","./three"],function(e,t){"use strict";t["default"].TrackballControls=function(e,r){function n(e){f.enabled!==!1&&(window.removeEventListener("keydown",n),v=g,g===p.NONE&&(e.keyCode!==f.keys[p.ROTATE]||f.noRotate?e.keyCode!==f.keys[p.ZOOM]||f.noZoom?e.keyCode!==f.keys[p.PAN]||f.noPan||(g=p.PAN):g=p.ZOOM:g=p.ROTATE))}function i(){f.enabled!==!1&&(g=v,window.addEventListener("keydown",n,!1))}function a(e){f.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g===p.NONE&&(g=e.button),g!==p.ROTATE||f.noRotate?g!==p.ZOOM||f.noZoom?g!==p.PAN||f.noPan||(E.copy(R(e.pageX,e.pageY)),S.copy(E)):(w.copy(R(e.pageX,e.pageY)),M.copy(w)):(x.copy(L(e.pageX,e.pageY)),b.copy(x)),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",s,!1),f.dispatchEvent(A))}function o(e){f.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g!==p.ROTATE||f.noRotate?g!==p.ZOOM||f.noZoom?g!==p.PAN||f.noPan||S.copy(R(e.pageX,e.pageY)):M.copy(R(e.pageX,e.pageY)):b.copy(L(e.pageX,e.pageY)))}function s(e){f.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),g=p.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s),f.dispatchEvent(N))}function u(e){if(f.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),w.y+=.01*t,f.dispatchEvent(A),f.dispatchEvent(N)}}function l(e){if(f.enabled!==!1){switch(e.touches.length){case 1:g=p.TOUCH_ROTATE,x.copy(L(e.touches[0].pageX,e.touches[0].pageY)),b.copy(x);break;case 2:g=p.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;T=_=Math.sqrt(t*t+r*r);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;E.copy(R(n,i)),S.copy(E);break;default:g=p.NONE}f.dispatchEvent(A)}}function c(e){if(f.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:b.copy(L(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;T=Math.sqrt(t*t+r*r);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;S.copy(R(n,i));break;default:g=p.NONE}}function h(e){if(f.enabled!==!1){switch(e.touches.length){case 1:b.copy(L(e.touches[0].pageX,e.touches[0].pageY)),x.copy(b);break;case 2:_=T=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,r=(e.touches[0].pageY+e.touches[1].pageY)/2;S.copy(R(t,r)),E.copy(S)}g=p.NONE,f.dispatchEvent(N)}}var f=this,p={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==r?r:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new t["default"].Vector3;var d=1e-6,m=new t["default"].Vector3,g=p.NONE,v=p.NONE,y=new t["default"].Vector3,x=new t["default"].Vector3,b=new t["default"].Vector3,w=new t["default"].Vector2,M=new t["default"].Vector2,_=0,T=0,E=new t["default"].Vector2,S=new t["default"].Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var C={type:"change"},A={type:"start"},N={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var R=function(){var e=new t["default"].Vector2;return function(t,r){return e.set((t-f.screen.left)/f.screen.width,(r-f.screen.top)/f.screen.height),e}}(),L=function(){var e=new t["default"].Vector3,r=new t["default"].Vector3,n=new t["default"].Vector3;return function(t,i){n.set((t-.5*f.screen.width-f.screen.left)/(.5*f.screen.width),(.5*f.screen.height+f.screen.top-i)/(.5*f.screen.height),0);var a=n.length();return f.noRoll?n.z=a<Math.SQRT1_2?Math.sqrt(1-a*a):.5/a:a>1?n.normalize():n.z=Math.sqrt(1-a*a),y.copy(f.object.position).sub(f.target),e.copy(f.object.up).setLength(n.y),e.add(r.copy(f.object.up).cross(y).setLength(n.x)),e.add(y.setLength(n.z)),e}}();this.rotateCamera=function(){var e=new t["default"].Vector3,r=new t["default"].Quaternion;return function(){var t=Math.acos(x.dot(b)/x.length()/b.length());t&&(e.crossVectors(x,b).normalize(),t*=f.rotateSpeed,r.setFromAxisAngle(e,-t),y.applyQuaternion(r),f.object.up.applyQuaternion(r),b.applyQuaternion(r),f.staticMoving?x.copy(b):(r.setFromAxisAngle(e,t*(f.dynamicDampingFactor-1)),x.applyQuaternion(r)))}}(),this.zoomCamera=function(){if(g===p.TOUCH_ZOOM_PAN){var e=_/T;_=T,y.multiplyScalar(e)}else{var e=1+(M.y-w.y)*f.zoomSpeed;1!==e&&e>0&&(y.multiplyScalar(e),f.staticMoving?w.copy(M):w.y+=(M.y-w.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var e=new t["default"].Vector2,r=new t["default"].Vector3,n=new t["default"].Vector3;return function(){e.copy(S).sub(E),e.lengthSq()&&(e.multiplyScalar(y.length()*f.panSpeed),n.copy(y).cross(f.object.up).setLength(e.x),n.add(r.copy(f.object.up).setLength(e.y)),f.object.position.add(n),f.target.add(n),f.staticMoving?E.copy(S):E.add(e.subVectors(S,E).multiplyScalar(f.dynamicDampingFactor)))}}(),this.checkDistances=function(){f.noZoom&&f.noPan||(y.lengthSq()>f.maxDistance*f.maxDistance&&f.object.position.addVectors(f.target,y.setLength(f.maxDistance)),y.lengthSq()<f.minDistance*f.minDistance&&f.object.position.addVectors(f.target,y.setLength(f.minDistance)))},this.update=function(){y.subVectors(f.object.position,f.target),f.noRotate||f.rotateCamera(),f.noZoom||f.zoomCamera(),f.noPan||f.panCamera(),f.object.position.addVectors(f.target,y),f.checkDistances(),f.object.lookAt(f.target),m.distanceToSquared(f.object.position)>d&&(f.dispatchEvent(C),m.copy(f.object.position))},this.reset=function(){g=p.NONE,v=p.NONE,f.target.copy(f.target0),f.object.position.copy(f.position0),f.object.up.copy(f.up0),y.subVectors(f.object.position,f.target),f.object.lookAt(f.target),f.dispatchEvent(C),m.copy(f.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",u,!1),this.domElement.addEventListener("DOMMouseScroll",u,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",h,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",i,!1),this.handleResize(),this.update()},t["default"].TrackballControls.prototype=Object.create(t["default"].EventDispatcher.prototype),e["default"]=t["default"].TrackballControls}),define("frontend/mixins/animation",["exports","ember"],function(e,t){"use strict";var r=t["default"].Mixin.create({axisIsX:!0,discrete:!1,actions:{setXaxis:function(){this.set("axisIsX",!0),this.trigger("setAxis","x")},setYaxis:function(){this.set("axisIsX",!1),this.trigger("setAxis","y")},makeDiscrete:function(){this.set("discrete",!0),this.trigger("chooseDiscrete",!0)},makeNotDiscrete:function(){this.set("discrete",!1),this.trigger("chooseDiscrete",!1)},setNumDiscrete:function(e){this.trigger("setNumDiscrete",e)},showFunction:function(){var e=this.get("functionInput");this.trigger("showFunction",e),this.get("discrete")?this.slideDownDiscrete():this.slideDownRange()},dualBoundRestrict:function(e,t){this.trigger("dualBoundRestrict",e,t)},showAxis:function(e){this.trigger("showAxis",e)},dualBoundIntegrate:function(e,t){this.trigger("dualBoundIntegrate",e,t)},showDerivative:function(e){this.trigger("showDerivative",e)},showDerivativeFunction:function(){var e=this.get("functionInput");this.trigger("showFunction",e),this.slideDownLocation()},startAnimation:function(){this.slideUpAxis(),this.trigger("startAnimation")},playAnimation:function(){this.trigger("playAnimation")},pauseAnimation:function(){this.trigger("pauseAnimation")},slowAnimation:function(){this.trigger("slowAnimation")},speedAnimation:function(){this.trigger("speedAnimation")},resetDisplay:function(){this.trigger("resetDisplay"),this.trigger("resetSliders"),this.set("functionInput","")},toggleDiscrete:function(){this.trigger("toggleSubContainer",".discrete-wrapper")},toggleRange:function(){this.trigger("toggleSubContainer",".range-wrapper")},toggleLocation:function(){this.trigger("toggleSubContainer",".location-wrapper")},toggleAxis:function(){this.trigger("toggleSubContainer",".axis-wrapper")},discreteFinished:function(){this.slideUpDiscrete(),this.slideDownRange()},rangeFinished:function(){this.slideUpRange(),this.slideDownAxis()},axisFinished:function(){this.slideUpAxis()}},slideUpDiscrete:function(){this.trigger("slideUpSubContainer",".discrete-wrapper")},slideUpRange:function(){this.trigger("slideUpSubContainer",".range-wrapper")},slideUpAxis:function(){this.trigger("slideUpSubContainer",".axis-wrapper")},slideDownDiscrete:function(){this.trigger("slideDownSubContainer",".discrete-wrapper")},slideDownRange:function(){this.trigger("slideDownSubContainer",".range-wrapper")},slideDownAxis:function(){this.trigger("slideDownSubContainer",".axis-wrapper")},slideDownLocation:function(){this.trigger("slideDownSubContainer",".location-wrapper")},testIt:function(){console.log("Controller")}});e["default"]=r}),define("frontend/models/animation-params",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({keys:t["default"].hasManyFragments(),values:t["default"].hasManyFragments()});e["default"]=r}),define("frontend/models/animation",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({params:t["default"].hasOneFragment("animationParams"),specialParams:t["default"].hasOneFragment("specialAnimationParams")});e["default"]=r}),define("frontend/models/choice",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({choiceId:t["default"].attr("number"),content:t["default"].attr("string"),correctAnswer:t["default"].attr("boolean"),answerResponse:t["default"].attr("string")});e["default"]=r}),define("frontend/models/equation-part",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({content:t["default"].attr("string"),explanation:t["default"].attr("string")});e["default"]=r}),define("frontend/models/equation",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({title:t["default"].attr("string"),parts:t["default"].hasManyFragments("equationPart")});e["default"]=r}),define("frontend/models/explanation",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({instructions:t["default"].hasManyFragments("instruction")});e["default"]=r}),define("frontend/models/instruction",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({orderNumber:t["default"].attr("number"),content:t["default"].attr("string")});e["default"]=r}),define("frontend/models/lesson-step-type",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({typeNumber:t["default"].attr("number"),animationType:t["default"].attr("number")});e["default"]=r}),define("frontend/models/lesson-step",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({orderNumber:t["default"].attr("number"),lesson:t["default"].belongsTo("lesson"),lessonStepType:t["default"].hasOneFragment("lessonStepType"),multipleChoice:t["default"].hasOneFragment("multipleChoice"),animation:t["default"].hasOneFragment("animation"),explanation:t["default"].hasOneFragment("explanation"),stepUrl:function(){var e=this.get("lessonStepType").get("typeNumber"),t=this.get("lessonStepType").get("animationType");if(1===e)return"/images/multipleChoice.png";if(2===e){if(1===t)return"/images/derivativesStep.png";if(2===t)return"/images/integralsStep.png";if(3===t)return"/images/revolutionsStep.png"}else if(3===e)return"/images/equationStep.png"}.property("lessonStepType")});e["default"]=r}),define("frontend/models/lesson",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({title:t["default"].attr("string"),author:t["default"].belongsTo("user",{async:!0}),updatedAt:t["default"].attr("date"),lessonSteps:t["default"].hasMany("lessonStep")});e["default"]=r}),define("frontend/models/multiple-choice",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({question:t["default"].attr("string"),choices:t["default"].hasManyFragments("choice")});e["default"]=r}),define("frontend/models/section",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({title:t["default"].attr("string"),subject:t["default"].belongsTo("subject")});e["default"]=r}),define("frontend/models/special-animation-params",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].ModelFragment.extend({keys:t["default"].hasManyFragments(),values:t["default"].hasManyFragments()});e["default"]=r}),define("frontend/models/subject",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({title:t["default"].attr("string"),sections:t["default"].hasMany("section")});e["default"]=r}),define("frontend/models/user",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].Model.extend({firstName:t["default"].attr("string"),lastName:t["default"].attr("string"),email:t["default"].attr("string"),lessons:t["default"].hasMany("lesson",{async:!0})});e["default"]=r}),define("frontend/objects/flash-controller",["exports","ember","./flash"],function(e,t,r){"use strict";var n=t["default"].Object.create({content:null,clearContent:function(e,t){return t.hide(function(){return r["default"].removeObject(e)})}});n.addObserver("content",function(){return this.get("content")?this.get("view")?(this.get("view").show(this.get("content")),setTimeout(this.clearContent,4e3,this.get("content"),this.get("view"))):void 0:r["default"].contentChanged()}),e["default"]=n}),define("frontend/objects/flash",["exports","ember","./flash-controller"],function(e,t,r){"use strict";var n=t["default"].Object.extend({type:"notice",message:null,isNotice:function(){return"notice"===this.get("type")}.property("type").cacheable(),isWarning:function(){return"warning"===this.get("type")}.property("type").cacheable(),isError:function(){return"error"===this.get("type")}.property("type").cacheable()}),i=t["default"].ArrayProxy.create({content:[],contentChanged:function(){var e;return e=r["default"].get("content"),e!==this.objectAt(0)?r["default"].set("content",this.objectAt(0)):void 0},pushFlash:function(e,t){return this.pushObject(n.create({message:t,type:e}))}});i.addObserver("length",function(){return this.contentChanged()}),e["default"]=i}),define("frontend/objects/session",["exports","ember","../app","./flash"],function(e,t,r,n){"use strict";var i=t["default"].Object.extend({loggedIn:!1,userId:"",onAppLoad:function(e){var r=t["default"].$.cookie("rememberToken"),n=t["default"].$.cookie("encryptedId");r&&n?this.checkRememberToken(r,n,e):e()},isLoggedIn:function(){return this.get("loggedIn")},currentUser:function(){var e=this.get("store"),t=this.get("userId");return this.get("loggedIn")?e.getById("user",t):null},login:function(e,r,n){var i=this;this.loadUser(e,function(){var a=i.createRandom();r?t["default"].$.cookie("rememberToken",a,{expires:7,path:"/"}):t["default"].$.cookie("rememberToken",a,{path:"/"}),i.sendRememberToken(a,r,e),n()})},loadUser:function(e,t){var r=this.get("store");console.log(e),r.push("user",{id:e._id,firstName:e.firstName,lastName:e.lastName,email:e.email,lessons:e.lessons}),this.set("userId",e._id),this.set("loggedIn",!0),t()},logout:function(e){this.set("userId",""),this.set("loggedIn",!1),$.removeCookie("rememberToken"),$.removeCookie("encryptedId"),n["default"].pushFlash("notice","Successfully logged out"),e()},createRandom:function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",r=0;20>r;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},sendRememberToken:function(e,r,n){console.log(n),t["default"].$.ajax("/session/save",{type:"POST",dataType:"JSON",data:{rememberToken:e,user:n},success:function(e){r?t["default"].$.cookie("encryptedId",e.encryptedId,{expires:7,path:"/"}):t["default"].$.cookie("encryptedId",e.encryptedId,{path:"/"})},error:function(e){window.console.log(e)}})},checkRememberToken:function(e,r,n){var i=this;t["default"].$.ajax("/session/check",{type:"POST",dataType:"JSON",data:{rememberToken:e,encryptedId:r},success:function(e){e.user&&i.loadUser(e.user,n)},error:function(e){window.console.log(e)}})}});e["default"]=i}),define("frontend/router",["exports","ember","./config/environment"],function(e,t,r){"use strict";var n=t["default"].Router.extend({location:r["default"].locationType});n.map(function(){this.route("login"),this.route("logout"),this.route("signup"),this.resource("demos",function(){this.route("revolutions"),this.route("integrals"),this.route("derivatives")}),this.resource("lessons",function(){this.resource("lessons.new",{path:"/new"},function(){this.route("step",{path:"/:step_id"}),this.route("createStep")}),this.resource("lessons.show",{path:"/:lesson_id"},function(){this.route("step",{path:"/:step_id"})})}),this.resource("subjects",function(){this.route("show",{path:"/:subject_id"})})}),e["default"]=n}),define("frontend/routes/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({});e["default"]=r}),define("frontend/routes/lessons/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(){var e=this.store.find("lesson");return e}});e["default"]=r}),define("frontend/routes/lessons/new",["exports","ember","../../objects/session"],function(e,t,r){"use strict";var n=t["default"].Route.extend({model:function(){var e=r["default"].currentUser(),t=this.store.createRecord("lesson",{title:"Untitled",author:e});return t}});e["default"]=n}),define("frontend/routes/lessons/new/create-step",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({});e["default"]=r}),define("frontend/routes/lessons/new/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({});e["default"]=r}),define("frontend/routes/lessons/new/step",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(e){var t=this.store.find("lessonStep",e.step_id);return t}});e["default"]=r}),define("frontend/routes/lessons/show",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(e){var t=this.store.find("lesson",e.lesson_id);
return t}});e["default"]=r}),define("frontend/routes/lessons/show/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({setupController:function(e){e.send("setCurrentStep")}});e["default"]=r}),define("frontend/routes/lessons/show/step",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(e){var t=this.store.find("lessonStep",e.step_id);return t}});e["default"]=r}),define("frontend/routes/logout",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({beforeModel:function(){var e=this;this.get("session").logout(function(){e.transitionTo("index")})}});e["default"]=r}),define("frontend/routes/subjects/index",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(){var e=this.store.find("subject");return e}});e["default"]=r}),define("frontend/routes/subjects/show",["exports","ember"],function(e,t){"use strict";var r=t["default"].Route.extend({model:function(e){var t=this.store.find("subject",e.subject_id);return t}});e["default"]=r}),define("frontend/serializers/application",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].RESTSerializer.extend({primaryKey:"_id",keyForRelationship:function(e){return e}});e["default"]=r}),define("frontend/serializers/lesson",["exports","ember-data"],function(e,t){"use strict";var r=t["default"].RESTSerializer.extend(t["default"].EmbeddedRecordsMixin,{attrs:{lessonSteps:{embedded:"always"}},normalize:function(e,t,r){return t.id=t._id,delete t._id,this._super(e,t,r)}});e["default"]=r}),define("frontend/serializers/subject",["ember-data"],function(e){"use strict";e["default"].RESTSerializer.extend(e["default"].EmbeddedRecordsMixin,{attrs:{sections:{embedded:"always"}},normalize:function(e,t,r){return t.id=t._id,delete t._id,this._super(e,t,r)}})}),define("frontend/templates/about",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push('<div class="about-container">\n	<div class="opacity-shield">\n		<div class="container">\n			<div class="about-info">\n				<h3 class="center-align">We\'re on a mission</h3>\n				<p>HigherEd was formed with the idea that a student will learn more if they can engage with the materials. Textbooks aren\'t cutting it, and we want to make a new platform for teaching. One that brings curiosity to the students and relevance to the material.</p>\n			</div>\n		</div>	\n	</div>\n</div>\n<div class="team-banner"><h3 class="team-header">Meet our incredible team</h3></div>\n<div class="team-content">\n	<p>We\'re passionate educators, innovators, and students. We think that education needs a shakeup, and we\'re ready to do it. From snowboarding to rock climbing, teachers to programmers, we\'re a diverse group brought together by a passion for teaching and learning.</p>\n</div>\n<div class="row">\n	<div class="col s6 m4 offset-s3 offset-m4">\n		<div class="circle-div image-container profile-headshot">\n			<img src="../images/jakedluhy-headshot.jpg">\n		</div>\n	</div>\n</div>\n'),n.buffer.push(a((t.partial||e&&e.partial||i).call(e,"partials/footer",{name:"partial",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),o},useData:!0})}),define("frontend/templates/application",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push("HigherEd")},3:function(e,t,r,n){n.buffer.push("Home")},5:function(e,t,r,n){n.buffer.push("Demos")},7:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("              <li>"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"logout",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(8,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</li>\n"),o},8:function(e,t,r,n){n.buffer.push("Logout")},10:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("              <li>"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"login",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(11,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</li>\n"),o},11:function(e,t,r,n){n.buffer.push("Login")},13:function(e,t,r,n){var i,a="";return n.buffer.push('    <div id="message">\n      '),i=t._triageMustache.call(e,"view.content.message",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    </div>\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('<section id="main-container">\n  <div class="navbar-fixed green darken-2">\n    <nav class="green darken-2">\n      <div class="nav-wrapper">\n        <div class="col s12">\n          '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"application",{name:"link-to",hash:{"class":"brand-logo"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n          <ul class="right side-nav">\n            <li>'),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"index",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(3,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</li>\n            <li>"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"demos.index",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(5,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</li>\n"),i=t["if"].call(e,"loggedIn",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(7,n),inverse:this.program(10,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("          </ul>\n        </div>\n      </div>\n    </nav>\n  </div>\n  \n"),i=t.view.call(e,"flash",{name:"view",hash:{id:"flash-view"},hashTypes:{id:"STRING"},hashContexts:{id:e},fn:this.program(13,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n  <div id="main-wrapper">\n    '),i=t._triageMustache.call(e,"outlet",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n  </div>\n\n</section>"),o},useData:!0})}),define("frontend/templates/backend",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('  <div class="creating-container">\n    '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"cooking.new",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(2,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    "),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"programming.new",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    "),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"life.new",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(6,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n  </div>\n"),o},2:function(e,t,r,n){n.buffer.push("Cooking")},4:function(e,t,r,n){n.buffer.push("Programming")},6:function(e,t,r,n){n.buffer.push("Life")},8:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('  <div class="auth-container">\n    '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"signup",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(9,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    "),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"login",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(11,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n  </div>\n"),o},9:function(e,t,r,n){n.buffer.push("Sign up")},11:function(e,t,r,n){n.buffer.push("Login")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div id="backend-container">\n'),i=t["if"].call(e,"isAdmin",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(8,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>"),a},useData:!0})}),define("frontend/templates/components/base-focusable",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},useData:!0})}),define("frontend/templates/components/dual-slider",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("						"),n.buffer.push(a((t["slider-label-input"]||e&&e["slider-label-input"]||i).call(e,{name:"slider-label-input",hash:{"insert-newline":"confirmValueFirst","focus-out":"confirmValueFirst",value:"first"},hashTypes:{"insert-newline":"STRING","focus-out":"STRING",value:"ID"},hashContexts:{"insert-newline":e,"focus-out":e,value:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},3:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("						<div "),n.buffer.push(a(t.action.call(e,"inputValueFirst",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n							<strong>Value:</strong>\n							<span>"),i=t._triageMustache.call(e,"first",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</span>\n						</div>\n"),o},5:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("					"),n.buffer.push(a((t["slider-label-input"]||e&&e["slider-label-input"]||i).call(e,{name:"slider-label-input",hash:{"insert-newline":"confirmValueSecond","focus-out":"confirmValueSecond",value:"second"},hashTypes:{"insert-newline":"STRING","focus-out":"STRING",value:"ID"},hashContexts:{"insert-newline":e,"focus-out":e,value:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},7:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("					<div "),n.buffer.push(a(t.action.call(e,"inputValueSecond",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n						<strong>Value:</strong>\n						<span>"),i=t._triageMustache.call(e,"second",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</span>\n					</div>\n"),o},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push('<div class="slider-background">\n	<div class="slider-base">\n		<div class="slider-connector" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{style:"firstPercentage"},hashTypes:{style:"ID"},hashContexts:{style:e},types:[],contexts:[],data:n}))),n.buffer.push('>\n			<div class="handle-container handle-container-lower">\n				<div class="handle" '),n.buffer.push(a(t.action.call(e,"moveFirstHandle",{name:"action",hash:{on:"mouseDown"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>\n\n				</div>\n				<div class="handle-label">\n'),i=t["if"].call(e,"inputtingFirst",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('				</div>\n			</div>\n		</div>\n		<div class="slider-second-part" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{style:"secondPercentage"},hashTypes:{style:"ID"},hashContexts:{style:e},types:[],contexts:[],data:n}))),n.buffer.push('>\n			<div class="handle-container handle-container-upper">\n				<div class="handle" '),n.buffer.push(a(t.action.call(e,"moveSecondHandle",{name:"action",hash:{on:"mouseDown"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>\n\n				</div>\n				<div class="handle-label">\n'),i=t["if"].call(e,"inputtingSecond",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(5,n),inverse:this.program(7,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("				</div>\n			</div>\n		</div>\n	</div>\n</div>"),o},useData:!0})}),define("frontend/templates/components/materialize-button",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("  <i "),n.buffer.push(i(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":"icon iconPosition"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push("></i>\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return i=t["if"].call(e,"icon",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),i=t._triageMustache.call(e,"text",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},useData:!0})}),define("frontend/templates/components/materialize-navbar",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i;i=t._triageMustache.call(e,"name",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),n.buffer.push(null!=i?i:"")},3:function(e,t,r,n){n.buffer.push("<i class='mdi-navigation-menu'></i>")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("<div class='nav-wrapper'>\n  <div class='container'>\n    "),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"index",{name:"link-to",hash:{"class":"brand-logo"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    <ul id='nav-mobile' class='right side-nav'>\n      "),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n    </ul>\n  </div>\n  "),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"index",{name:"link-to",hash:{"data-activates":"nav-mobile","class":"button-collapse"},hashTypes:{"data-activates":"STRING","class":"STRING"},hashContexts:{"data-activates":e,"class":e},fn:this.program(3,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n</div>\n"),o},useData:!0})}),define("frontend/templates/components/paper-button",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("<span "),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{disabled:"disabled",type:"type"},hashTypes:{disabled:"ID",type:"ID"},hashContexts:{disabled:e,type:e},types:[],contexts:[],data:n}))),n.buffer.push(">\n  "),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n</span>\n"),o},useData:!0})}),define("frontend/templates/components/paper-checkbox",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push('  <div class="md-label">\n    '),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n  </div>\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="md-container">\n  <div class="md-icon"></div>\n</div>\n'),i=t["if"].call(e,"template",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),a},useData:!0})}),define("frontend/templates/components/paper-content",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},useData:!0})}),define("frontend/templates/components/paper-drawer",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},useData:!0})}),define("frontend/templates/components/paper-radio",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push('  <div class="md-label">\n    '),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n  </div>\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="md-container">\n  <div class="md-off"></div>\n  <div class="md-on"></div>\n</div>\n'),i=t["if"].call(e,"template",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),a},useData:!0})}),define("frontend/templates/components/paper-sidenav",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push('<div class="icon ic-menu nav-button" '),n.buffer.push(a(t.action.call(e,"toggleDrawer",{name:"action",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),n.buffer.push("></div>\n"),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n<div "),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":animatable drawerOpen:visible :sidenav-modal-bg"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"closeDrawer",{name:"action",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),n.buffer.push("></div>"),o},useData:!0})}),define("frontend/templates/components/paper-text",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o=t.helperMissing,s="";return n.buffer.push("<label "),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"for":"inputElementId"},hashTypes:{"for":"ID"},hashContexts:{"for":e},types:[],contexts:[],data:n}))),n.buffer.push(">"),i=t._triageMustache.call(e,"label",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</label>\n"),n.buffer.push(a((t.input||e&&e.input||o).call(e,{name:"input",hash:{disabled:"disabled","focus-out":"focusOut","focus-in":"focusIn",value:"value",type:"type",id:"inputElementId"},hashTypes:{disabled:"ID","focus-out":"STRING","focus-in":"STRING",value:"ID",type:"ID",id:"ID"},hashContexts:{disabled:e,"focus-out":e,"focus-in":e,value:e,type:e,id:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),s},useData:!0})}),define("frontend/templates/components/paper-toggle",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push("  "),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('<div class="md-switch-bar"></div>\n'),i=(t["paper-radio"]||e&&e["paper-radio"]||a).call(e,{name:"paper-radio",hash:{noink:"noink",disabled:"disabled",checked:"value",classNames:"md-switch-thumb"},hashTypes:{noink:"ID",disabled:"ID",checked:"ID",classNames:"STRING"},hashContexts:{noink:e,disabled:e,checked:e,classNames:e},fn:this.program(1,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),o},useData:!0})}),define("frontend/templates/components/scroll-arrow",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("<div "),n.buffer.push(i(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":scroll-arrow-background direction"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(i(t.action.call(e,"showIt",{name:"action",hash:{on:"mouseEnter"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n<div "),n.buffer.push(i(t.action.call(e,"hideIt",{name:"action",hash:{on:"mouseLeave"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n	<div "),n.buffer.push(i(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":scroll-arrow visible:visible"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(i(t.action.call(e,"scrollIt",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n\n	</div>\n</div>\n</div>"),a},useData:!0})}),define("frontend/templates/components/single-slider",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("						"),n.buffer.push(a((t["slider-label-input"]||e&&e["slider-label-input"]||i).call(e,{name:"slider-label-input",hash:{"insert-newline":"confirmValue","focus-out":"confirmValue",value:"pos"},hashTypes:{"insert-newline":"STRING","focus-out":"STRING",value:"ID"},hashContexts:{"insert-newline":e,"focus-out":e,value:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},3:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("						<div "),n.buffer.push(a(t.action.call(e,"inputValue",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n							<strong>Value:</strong>\n							<span>"),i=t._triageMustache.call(e,"pos",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</span>\n						</div>\n"),o},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push('<div class="slider-background">\n	<div class="slider-base">\n		<div class="slider-second-part" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{style:"percentage"},hashTypes:{style:"ID"},hashContexts:{style:e},types:[],contexts:[],data:n}))),n.buffer.push('>\n			<div class="handle-container handle-container-upper">\n				<div class="handle" '),n.buffer.push(a(t.action.call(e,"moveHandle",{name:"action",hash:{on:"mouseDown"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>\n\n				</div>\n				<div class="handle-label">\n'),i=t["if"].call(e,"inputting",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("				</div>\n			</div>\n		</div>\n	</div>\n</div>"),o},useData:!0})}),define("frontend/templates/components/square-div",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("<div "),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":square-div addedClass"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push('>\n	<div class="content">'),i=t._triageMustache.call(e,"yield",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n</div>"),o},useData:!0})}),define("frontend/templates/demos/derivatives",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push('<div class="options-container">\n  <div class="content-header"><h5>Options</h5></div>\n  <div class="content-wrapper options">\n      <div class=\'options content-container\'>\n        <div class="function-container">\n            <div class="function-label">f(x) = </div>\n            '),n.buffer.push(a((t.input||e&&e.input||i).call(e,{name:"input",hash:{"focus-out":"showDerivativeFunction",value:"functionInput",placeholder:"Enter a function","class":"function-input"},hashTypes:{"focus-out":"STRING",value:"ID",placeholder:"STRING","class":"STRING"},hashContexts:{"focus-out":e,value:e,placeholder:e,"class":e},types:[],contexts:[],data:n}))),n.buffer.push('\n        </div> \n        <div class="location-container">\n          <div class="sub-header" '),n.buffer.push(a(t.action.call(e,"toggleLocation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Derivative Location</div>\n          <div class="location-wrapper option-wrapper">\n            '),n.buffer.push(a((t["single-slider"]||e&&e["single-slider"]||i).call(e,{name:"single-slider",hash:{action:"showDerivative",orientation:"horizontal"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push('\n          </div>\n        </div>  \n      </div>\n  </div>\n  <div class="content-header"><h5>Controls</h5></div>\n  <div class="content-wrapper controls">\n    <div class=\'controls content-container\'>\n      <a href="#" class="button reset" '),n.buffer.push(a(t.action.call(e,"resetDisplay",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">Reset</a>\n    </div>\n  </div>\n</div>\n<div class='primary-container'></div>"),o},useData:!0})}),define("frontend/templates/demos/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(){return""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('<div id="demos-index-main">\n  <div class="center">\n    <div class="revolutions">\n      '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"demos.revolutions",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n    </div>\n    <div class="integrals">\n      '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"demos.integrals",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n    </div>\n    <div class="derivatives">\n      '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"demos.derivatives",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n    </div>\n  </div>\n  <div class="container">\n    <div class="row">\n      <div class="col s6 m4">\n        <div class="card">\n          <div class="card-image">\n            <img src="../images/revolutionsDemo.png">\n            <span class="card-title">Card Title</span>\n          </div>\n          <div class="card-content">\n            <p>Revolutions of solids about an axis.</p>\n          </div>\n        </div>\n      </div>\n      <div class="col s6 m4">\n        <div class="card">\n          <div class="card-image">\n            <img src="../images/integralsDemo.png">\n            <span class="card-title">Card Title</span>\n          </div>\n          <div class="card-content">\n            <p>Integration of functions, including a demonstration of Riemann Sums.</p>\n          </div>\n        </div>\n      </div>\n      <div class="col s6 m4">\n        <div class="card">\n          <div class="card-image">\n            <img src="../images/derivativesDemo.png">\n            <span class="card-title">Card Title</span>\n          </div>\n          <div class="card-content">\n            <p>Derivatives of functions, showing slopes of lines.</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'),o},useData:!0})}),define("frontend/templates/demos/integrals",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push('            <div class="function-label">f(x) = </div>\n')},3:function(e,t,r,n){n.buffer.push('            <div class="function-label">f(y) = </div>\n')},5:function(e,t,r,n){var i=this.escapeExpression,a=t.helperMissing,o="";return n.buffer.push('          <div class="discrete-container">\n            <div class="sub-header" '),n.buffer.push(i(t.action.call(e,"toggleDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Discrete Steps</div>\n            <div class="discrete-wrapper option-wrapper" '),n.buffer.push(i(t.action.call(e,"discreteFinished",{name:"action",hash:{on:"mouseLeave"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n              "),n.buffer.push(i((t["single-slider"]||e&&e["single-slider"]||a).call(e,{name:"single-slider",hash:{pos:10,rangeEnd:20,rangeStart:1,action:"setNumDiscrete",orientation:"horizontal"},hashTypes:{pos:"NUMBER",rangeEnd:"NUMBER",rangeStart:"NUMBER",action:"STRING",orientation:"STRING"},hashContexts:{pos:e,rangeEnd:e,rangeStart:e,action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n            </div>\n          </div>\n"),o},7:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("              "),n.buffer.push(a((t["dual-slider"]||e&&e["dual-slider"]||i).call(e,{name:"dual-slider",hash:{action:"dualBoundIntegrate",orientation:"horizontal"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},9:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("              "),n.buffer.push(a((t["dual-slider"]||e&&e["dual-slider"]||i).call(e,{name:"dual-slider",hash:{action:"dualBoundIntegrate",orientation:"vertical"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o
},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o=t.helperMissing,s="";return n.buffer.push('<div class="options-container">\n  <div class="content-header"><h5>Options</h5></div>\n  <div class="content-wrapper options">\n      <div class=\'options content-container\'>\n        <div class="axis-selection">\n          <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :xaxis axisIsX:selected:deselected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"setXaxis",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>X-Axis</a>\n          <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :yaxis axisIsX:deselected:selected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"setYaxis",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Y-Axis</a>\n        </div>\n        <div class="axis-selection">\n          <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :continuous discrete:deselected:selected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"makeNotDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Continuous</a>\n          <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :discrete discrete:selected:deselected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"makeDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Discrete</a>\n        </div>\n        <div class="function-container">\n'),i=t["if"].call(e,"axisIsX",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("          "),n.buffer.push(a((t.input||e&&e.input||o).call(e,{name:"input",hash:{"focus-out":"showFunction",value:"functionInput",placeholder:"Enter a function","class":"function-input"},hashTypes:{"focus-out":"STRING",value:"ID",placeholder:"STRING","class":"STRING"},hashContexts:{"focus-out":e,value:e,placeholder:e,"class":e},types:[],contexts:[],data:n}))),n.buffer.push("\n        </div>\n"),i=t["if"].call(e,"discrete",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(5,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('        <div class="range-container">\n          <div class="sub-header" '),n.buffer.push(a(t.action.call(e,"toggleRange",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Restrict The Integral</div>\n          <div class="range-wrapper option-wrapper" '),n.buffer.push(a(t.action.call(e,"rangeFinished",{name:"action",hash:{on:"mouseLeave"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n"),i=t["if"].call(e,"axisIsX",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(7,n),inverse:this.program(9,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('          </div>\n        </div>\n      </div>\n  </div>\n  <div class="content-header"><h5>Controls</h5></div>\n  <div class="content-wrapper controls">\n    <div class=\'controls content-container\'>\n      <a href="#" class="button reset" '),n.buffer.push(a(t.action.call(e,"resetDisplay",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">Reset</a>\n    </div>\n  </div>\n</div>\n<div class='primary-container'></div>"),s},useData:!0})}),define("frontend/templates/demos/revolutions",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push('          <div class="function-label">f(x) = </div>\n')},3:function(e,t,r,n){n.buffer.push('          <div class="function-label">f(y) = </div>\n')},5:function(e,t,r,n){var i=this.escapeExpression,a=t.helperMissing,o="";return n.buffer.push('        <div class="discrete-container">\n          <div class="sub-header" '),n.buffer.push(i(t.action.call(e,"toggleDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Discrete Steps</div>\n          <div class="discrete-wrapper option-wrapper" '),n.buffer.push(i(t.action.call(e,"discreteFinished",{name:"action",hash:{on:"mouseLeave"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n            "),n.buffer.push(i((t["single-slider"]||e&&e["single-slider"]||a).call(e,{name:"single-slider",hash:{pos:10,rangeEnd:20,rangeStart:1,action:"setNumDiscrete",orientation:"horizontal"},hashTypes:{pos:"NUMBER",rangeEnd:"NUMBER",rangeStart:"NUMBER",action:"STRING",orientation:"STRING"},hashContexts:{pos:e,rangeEnd:e,rangeStart:e,action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n          </div>\n        </div>\n"),o},7:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("            "),n.buffer.push(a((t["dual-slider"]||e&&e["dual-slider"]||i).call(e,{name:"dual-slider",hash:{action:"dualBoundRestrict",orientation:"horizontal"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},9:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("            "),n.buffer.push(a((t["dual-slider"]||e&&e["dual-slider"]||i).call(e,{name:"dual-slider",hash:{action:"dualBoundRestrict",orientation:"vertical"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},11:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("            "),n.buffer.push(a((t["single-slider"]||e&&e["single-slider"]||i).call(e,{name:"single-slider",hash:{action:"showAxis",orientation:"vertical"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},13:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("            "),n.buffer.push(a((t["single-slider"]||e&&e["single-slider"]||i).call(e,{name:"single-slider",hash:{action:"showAxis",orientation:"horizontal"},hashTypes:{action:"STRING",orientation:"STRING"},hashContexts:{action:e,orientation:e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o=t.helperMissing,s="";return n.buffer.push('<div class="options-container">\n  <div class="content-header"><h5>Options</h5></div>\n  <div class="content-wrapper options">\n    <div class=\'options content-container\'>\n      <div class="axis-selection">\n        <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :xaxis axisIsX:selected:deselected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"setXaxis",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>X-Axis</a>\n        <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :yaxis axisIsX:deselected:selected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"setYaxis",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Y-Axis</a>\n      </div>\n      <div class="axis-selection">\n        <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :continuous discrete:deselected:selected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"makeNotDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Continuous</a>\n        <a href="#" '),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":button :discrete discrete:selected:deselected"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push(" "),n.buffer.push(a(t.action.call(e,"makeDiscrete",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Discrete</a>\n      </div>\n      <div class="function-container">\n'),i=t["if"].call(e,"axisIsX",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("        "),n.buffer.push(a((t.input||e&&e.input||o).call(e,{name:"input",hash:{"focus-out":"showFunction",value:"functionInput",placeholder:"Enter a function","class":"function-input"},hashTypes:{"focus-out":"STRING",value:"ID",placeholder:"STRING","class":"STRING"},hashContexts:{"focus-out":e,value:e,placeholder:e,"class":e},types:[],contexts:[],data:n}))),n.buffer.push("\n      </div>\n"),i=t["if"].call(e,"discrete",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(5,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('      <div class="range-container">\n        <div class="sub-header" '),n.buffer.push(a(t.action.call(e,"toggleRange",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Restrict The Function</div>\n        <div class="range-wrapper option-wrapper" '),n.buffer.push(a(t.action.call(e,"rangeFinished",{name:"action",hash:{on:"mouseLeave"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">\n"),i=t["if"].call(e,"axisIsX",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(7,n),inverse:this.program(9,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('        </div>\n      </div>\n      <div class="axis-container">\n        <div class="sub-header" '),n.buffer.push(a(t.action.call(e,"toggleAxis",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Rotation Axis</div>\n        <div class="axis-wrapper option-wrapper">\n'),i=t["if"].call(e,"axisIsX",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(11,n),inverse:this.program(13,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('        </div>\n      </div>\n      <a href="#" class="button start-animation" '),n.buffer.push(a(t.action.call(e,"startAnimation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('>Start the animation</a>\n    </div>\n  </div>\n  <div class="content-header"><h5>Controls</h5></div>\n  <div class="content-wrapper controls  display-none">\n      <div class=\'controls content-container\'>\n        <div class="row">\n            <div class="small-4 columns"><div class="ani-controls slow" '),n.buffer.push(a(t.action.call(e,"slowAnimation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('><i class="fa fa-backward"></i></div></div>\n            <div class="small-4 columns">\n                <div class="ani-controls play" '),n.buffer.push(a(t.action.call(e,"playAnimation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('><i class="fa fa-play"></i></div>\n                <div class="ani-controls pause" '),n.buffer.push(a(t.action.call(e,"pauseAnimation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('><i class="fa fa-pause"></i></div>\n            </div>\n            <div class="small-4 columns"><div class="ani-controls speed" '),n.buffer.push(a(t.action.call(e,"speedAnimation",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('><i class="fa fa-forward"></i></div></div>\n        </div>\n        <a href="#" class="button reset" '),n.buffer.push(a(t.action.call(e,"resetDisplay",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">Reset</a>\n        <p>Use the scroll wheel to zoom,<br> left click + mouse move for rotation,<br> right click + mouse move for panning</p>\n      </div>\n  </div>\n</div>\n<div class='primary-container'></div>"),s},useData:!0})}),define("frontend/templates/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("				"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"demos",{name:"link-to",hash:{"class":"btn"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},fn:this.program(2,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),o},2:function(e,t,r,n){n.buffer.push("Play around!")},4:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("				"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"signup",{name:"link-to",hash:{"class":"btn"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},fn:this.program(5,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),o},5:function(e,t,r,n){n.buffer.push("Come explore with us!")},7:function(e,t,r,n){n.buffer.push("Confirm")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o=this.escapeExpression,s="";return n.buffer.push('<div class="welcome-banner index-div">\n	<div class="opacity-shield">\n		<div class="welcome-container">\n			<h2>Welcome to HigherEd!</h2>\n			<h4>The next generation of better Education starts here.</h4>\n'),i=t["if"].call(e,"loggedIn",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(4,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('		</div>\n	</div>\n</div>\n\n<div id="about" class="about index-div">\n	<div class="container">\n		<div class="row">\n			<div class="col s12 m10">\n				<div class="card white">\n					<div class="card-content grey-text text-darken-4">\n						<div class="row">\n							<div class="col s8">\n								<div class="valign-wrapper">\n									<p class="valign">The idea behind HigherEd is that students will learn faster and better the more they interact with the material.</p>\n								</div>\n							</div>\n							<div class="col s4">\n								<div class="circle-div image-container right">\n									<img src="../images/frontpageAbout1.png">\n								</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</div>\n			<div class="col s12 m10 offset-m2">\n				<div class="card white">\n					<div class="card-content white grey-text text-darken-4">\n						<div class="row">\n							<div class="col s4">\n								<div class="circle-div image-container left">\n									<img src="../images/frontpageAbout2.png">\n								</div>\n							</div>\n							<div class="col s8">\n								<div class="valign-wrapper">\n									<p class="valign">We provide the animations and interactive graphs. Teachers, TA\'s, and students provide the content.</p>\n								</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</div>\n			<div class="col s12 m10">\n				<div class="card white">\n					<div class="card-content white grey-text text-darken-4">\n						<div class="row">\n							<div class="col s8">\n								<div class="valign-wrapper">\n									<p>With our intuitive lesson creating tool, making content for your students is a snap.</p>\n								</div>\n							</div>\n							<div class="col s4">\n								<div class="circle-div image-container right">\n									<img src="../images/frontpageAbout3.png">\n								</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n<div class="signup index-div">\n	<div class="signup-container">\n		<h3 class="center-align">Signup for our Newsletter</h3>\n		'),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"email",label:"Email",type:"email"},hashTypes:{value:"ID",label:"STRING",type:"STRING"},hashContexts:{value:e,label:e,type:e},types:[],contexts:[],data:n}))),n.buffer.push("\n		"),i=(t["paper-button"]||e&&e["paper-button"]||a).call(e,{name:"paper-button",hash:{action:"submitSignup",classNames:"email-submit",raised:!0},hashTypes:{action:"STRING",classNames:"STRING",raised:"BOOLEAN"},hashContexts:{action:e,classNames:e,raised:e},fn:this.program(7,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('\n	</div>\n</div>\n<div class="press index-div">\n	<div class="container">\n		<div class="press-container">\n			<h3 class="center-align press-header">As seen in</h3>\n			<div class="row">\n				<div class="col s4 offset-s4">\n					<div class="image-container">\n						<a href="http://aerospace.illinois.edu/news/seeing-equals-learning-student%E2%80%99s-startup-features-visual-mathematics" target="_blank"><img src="../images/illinoisPress.png"></a>\n					</div>\n				</div>\n			</div>\n			<div class="row">\n				<div class="col s4 offset-s4">\n					<div class="image-container rackspace-logo">\n						<img src="../images/rackspaceLogo.png">\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n'),n.buffer.push(o((t.partial||e&&e.partial||a).call(e,"partials/footer",{name:"partial",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),s},useData:!0})}),define("frontend/templates/lessons/equationViewer",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){n.buffer.push("Hello World")},useData:!0})}),define("frontend/templates/lessons/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("  <li>"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"lessons.show","lesson",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(2,n),inverse:this.noop,types:["STRING","ID"],contexts:[e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</li>\n"),o},2:function(e,t,r,n){var i;i=t._triageMustache.call(e,"lesson.title",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),n.buffer.push(null!=i?i:"")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div>Lesson Library</div>\n<ul id="lesson-list">\n'),i=t.each.call(e,"lesson","in","model",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</ul>"),a},useData:!0})}),define("frontend/templates/lessons/multipleChoice",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("		<div "),n.buffer.push(a(t["bind-attr"].call(e,{name:"bind-attr",hash:{"class":":answer-container answer.choiceId"},hashTypes:{"class":"STRING"},hashContexts:{"class":e},types:[],contexts:[],data:n}))),n.buffer.push('>\n			<div class="answer">'),i=t._triageMustache.call(e,"answer.content",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n		</div>\n"),o},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="question-container">\n	<p>'),i=t._triageMustache.call(e,"multipleChoiceQuestion",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</p>\n</div>\n<div class="answers-container">\n'),i=t.each.call(e,"answer","in","multipleChoiceAnswers",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>"),a},useData:!0})}),define("frontend/templates/lessons/new",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push('			<div class="title-preview">\n				<h2>Title Page</h2>\n			</div>\n')},3:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("			"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"lessons.show.step","step",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["STRING","ID"],contexts:[e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),o},4:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("<img "),n.buffer.push(i(t["bind-attr"].call(e,{name:"bind-attr",hash:{src:"step.stepUrl"},hashTypes:{src:"ID"},hashContexts:{src:e},types:[],contexts:[],data:n}))),n.buffer.push(">"),a},6:function(e,t,r,n){n.buffer.push('			<div class="create-step">\n				<h2>Create Step</h2>\n			</div>\n')},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push('<div class="lesson-nav-bar">\n	<div class="step-preview">\n'),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"lessons.new.index",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),i=t.each.call(e,"step","in","steps",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(3,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"lessons.new.createStep",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(6,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('	</div>\n</div>\n\n<div class="lesson-main-container">\n'),i=t._triageMustache.call(e,"outlet",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n</div>"),o},useData:!0})}),define("frontend/templates/lessons/new/createStep",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push('	<div class="select-box">\n'),i=t.each.call(e,"choice","in","choices",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(2,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("	</div>\n"),a},2:function(e,t,r,n){var i,a="";return n.buffer.push('		<div class="choice-label">\n			'),i=t._triageMustache.call(e,"choice.label",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n		</div>\n"),i=t["if"].call(e,"choice.animationTypes",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(3,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),a},3:function(e,t,r,n){var i,a="";return i=t.each.call(e,"animation","in","choice.animationTypes",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),a},4:function(e,t,r,n){var i,a="";return n.buffer.push('				<div class="animation-type">\n					'),i=t._triageMustache.call(e,"animation.type",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n				</div>\n"),a},6:function(e,t,r,n){n.buffer.push("\n")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i;i=t["if"].call(e,"selectType",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(6,n),types:["ID"],contexts:[e],data:n}),n.buffer.push(null!=i?i:"")},useData:!0})}),define("frontend/templates/lessons/new/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i=t.helperMissing,a=this.escapeExpression,o="";return n.buffer.push("		"),n.buffer.push(a((t["focus-input"]||e&&e["focus-input"]||i).call(e,{name:"focus-input",hash:{"focus-out":"stopEdit",value:"title","class":"title-input"},hashTypes:{"focus-out":"STRING",value:"ID","class":"STRING"},hashContexts:{"focus-out":e,value:e,"class":e},types:[],contexts:[],data:n}))),n.buffer.push("\n"),o},3:function(e,t,r,n){var i,a=this.escapeExpression,o="";return n.buffer.push("		<h2 "),n.buffer.push(a(t.action.call(e,"editTitle",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push(">"),i=t._triageMustache.call(e,"title",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</h2>\n"),o},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="title-page-wrapper">\n	<div class="title">\n'),i=t["if"].call(e,"editTitle",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('	</div>\n	<div class="name">\n		<span>By</span><br>\n		<h4>'),i=t._triageMustache.call(e,"fullName",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</h4>\n	</div>\n</div>"),a},useData:!0})}),define("frontend/templates/lessons/new/step",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return""},useData:!0})}),define("frontend/templates/lessons/show",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push('			<div class="title-preview">\n				<h2>'),i=t._triageMustache.call(e,"title",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</h2>\n				<p>By</p>\n				<h4>"),i=t._triageMustache.call(e,"fullName",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</h4>\n			</div>\n"),a},3:function(e,t,r,n){var i,a=t.helperMissing,o="";return n.buffer.push("			"),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"lessons.show.step","step",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["STRING","ID"],contexts:[e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),o},4:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("<img "),n.buffer.push(i(t["bind-attr"].call(e,{name:"bind-attr",hash:{src:"step.stepUrl"},hashTypes:{src:"ID"},hashContexts:{src:e},types:[],contexts:[],data:n}))),n.buffer.push(">"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a=this.escapeExpression,o=t.helperMissing,s="";return n.buffer.push('<div class="lesson-nav-bar">\n	<div class="step-direction step-back">\n		<i class="fa fa-chevron-left" '),n.buffer.push(a(t.action.call(e,"previousStep",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('></i>\n	</div>\n	<div class="step-preview">\n'),i=(t["link-to"]||e&&e["link-to"]||o).call(e,"lessons.show.index",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),i=t.each.call(e,"step","in","steps",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(3,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('	</div>\n	<div class="step-direction step-forward">\n		<i class="fa fa-chevron-right" '),n.buffer.push(a(t.action.call(e,"nextStep",{name:"action",hash:{on:"click"},hashTypes:{on:"STRING"},hashContexts:{on:e},types:["STRING"],contexts:[e],data:n}))),n.buffer.push('></i>\n	</div>\n</div>\n\n<div class="lesson-main-container">\n'),i=t._triageMustache.call(e,"outlet",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n</div>"),s},useData:!0})}),define("frontend/templates/lessons/show/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="title-page-wrapper">\n	<div class="title">\n		<h2>'),i=t._triageMustache.call(e,"title",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</h2>\n	</div>\n	<div class="name">\n		<span>By</span><br>\n		<h4>'),i=t._triageMustache.call(e,"fullName",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</h4>\n	</div>\n</div>"),a},useData:!0})}),define("frontend/templates/lessons/show/step",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("		"),n.buffer.push(i(t.view.call(e,"lessons.multipleChoice",{name:"view",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),n.buffer.push("\n"),a},3:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("		"),n.buffer.push(i(t.view.call(e,"animationType",{name:"view",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}))),n.buffer.push("\n"),a},5:function(e,t,r,n){var i=this.escapeExpression,a="";return n.buffer.push("		"),n.buffer.push(i(t.view.call(e,"lessons.equationViewer",{name:"view",hash:{},hashTypes:{},hashContexts:{},types:["STRING"],contexts:[e],data:n}))),n.buffer.push("\n"),a},7:function(e,t,r,n){var i,a=t.helperMissing,o="";return i=(t["square-div"]||e&&e["square-div"]||a).call(e,{name:"square-div",hash:{centerVertically:!0,addedClass:"instruction-node"},hashTypes:{centerVertically:"BOOLEAN",addedClass:"STRING"},hashContexts:{centerVertically:e,addedClass:e},fn:this.program(8,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),o},8:function(e,t,r,n){var i,a="";return n.buffer.push("			"),i=t._triageMustache.call(e,"instruction.orderNumber",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="step-viewing-area">\n'),i=t["if"].call(e,"multipleChoice",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),i=t["if"].call(e,"animation",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(3,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),i=t["if"].call(e,"equation",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(5,n),inverse:this.noop,types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</div>\n<div class="lesson-explanation-bar">\n'),i=t.each.call(e,"instruction","in","instructions",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(7,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>"),a
},useData:!0})}),define("frontend/templates/login",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push("		Logged in\n")},3:function(e,t,r,n){var i,a=t.helperMissing,o=this.escapeExpression,s="";return n.buffer.push('		<span class="login-header">Login</span>\n		<span class="signup-change">Not a member? '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"signup",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</span>\n		<form class="login-form" action="/login" method="POST">\n			'),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"email",type:"email",label:"Email"},hashTypes:{value:"ID",type:"STRING",label:"STRING"},hashContexts:{value:e,type:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push("\n			"),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"password",type:"password",label:"Password"},hashTypes:{value:"ID",type:"STRING",label:"STRING"},hashContexts:{value:e,type:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push('\n			<div class="row">\n				<div class="col s12 m6">'),i=(t["paper-checkbox"]||e&&e["paper-checkbox"]||a).call(e,{name:"paper-checkbox",hash:{checked:"rememberMe"},hashTypes:{checked:"ID"},hashContexts:{checked:e},fn:this.program(6,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</div>\n				<div class="col s12 m6">'),i=(t["paper-button"]||e&&e["paper-button"]||a).call(e,{name:"paper-button",hash:{action:"submitForm",raised:!0},hashTypes:{action:"STRING",raised:"BOOLEAN"},hashContexts:{action:e,raised:e},fn:this.program(8,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n			</div>\n		</form>\n"),s},4:function(e,t,r,n){n.buffer.push("Signup")},6:function(e,t,r,n){n.buffer.push("Remember Me!")},8:function(e,t,r,n){n.buffer.push("Sign in")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="login-container auth-container">\n'),i=t["if"].call(e,"loggedIn",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n"),a},useData:!0})}),define("frontend/templates/partials/footer",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i="";return n.buffer.push('<footer class="page-footer grey darken-2">\n	<div class="container grey darken-2">\n    <div class="row">\n      <div class="col l6 s12">\n        <h3 class="white-text">HigherEd</h3>\n        <p class="grey-text text-lighten-4">Bringing new and exciting technology into the world of education.</p>\n      </div>\n    </div>\n  </div>\n	<div class="footer-copyright grey darken-3">\n    <div class="container">\n    Copyright &#169 HigherEd, 2015\n    </div>\n  </div>\n</footer>'),i},useData:!0})}),define("frontend/templates/signup",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){n.buffer.push("		Logged In\n")},3:function(e,t,r,n){var i,a=t.helperMissing,o=this.escapeExpression,s="";return n.buffer.push('		<span class="login-header">Join HigherEd!</span>\n		<span class="signup-change">Already a member? '),i=(t["link-to"]||e&&e["link-to"]||a).call(e,"login",{name:"link-to",hash:{},hashTypes:{},hashContexts:{},fn:this.program(4,n),inverse:this.noop,types:["STRING"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push('</span>\n		<form class="signup-form">\n			'),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"firstName",label:"First Name"},hashTypes:{value:"ID",label:"STRING"},hashContexts:{value:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push("\n			"),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"lastName",label:"Last Name"},hashTypes:{value:"ID",label:"STRING"},hashContexts:{value:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push("\n			"),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"email",type:"email",label:"Email"},hashTypes:{value:"ID",type:"STRING",label:"STRING"},hashContexts:{value:e,type:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push("\n			"),n.buffer.push(o((t["paper-text"]||e&&e["paper-text"]||a).call(e,{name:"paper-text",hash:{value:"password",type:"password",label:"Password"},hashTypes:{value:"ID",type:"STRING",label:"STRING"},hashContexts:{value:e,type:e,label:e},types:[],contexts:[],data:n}))),n.buffer.push('\n			<div class="row">\n				<div class="col s12 m6 offset-m6">'),i=(t["paper-button"]||e&&e["paper-button"]||a).call(e,{name:"paper-button",hash:{action:"submitForm",raised:!0},hashTypes:{action:"STRING",raised:"BOOLEAN"},hashContexts:{action:e,raised:e},fn:this.program(6,n),inverse:this.noop,types:[],contexts:[],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n			</div>\n		</form>\n"),s},4:function(e,t,r,n){n.buffer.push("Login")},6:function(e,t,r,n){n.buffer.push("Sign in")},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push('<div class="signup-container auth-container">\n'),i=t["if"].call(e,"loggedIn",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.program(3,n),types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("</div>\n"),a},useData:!0})}),define("frontend/templates/subjects/index",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({1:function(e,t,r,n){var i,a="";return n.buffer.push("	"),i=t._triageMustache.call(e,"subject.title",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),null!=i&&n.buffer.push(i),n.buffer.push("\n"),a},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i,a="";return n.buffer.push("Hello world\n"),i=t.each.call(e,"subject","in","model",{name:"each",hash:{},hashTypes:{},hashContexts:{},fn:this.program(1,n),inverse:this.noop,types:["ID","ID","ID"],contexts:[e,e,e],data:n}),null!=i&&n.buffer.push(i),a},useData:!0})}),define("frontend/templates/subjects/show",["exports"],function(e){"use strict";e["default"]=Ember.Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,r,n){var i;i=t._triageMustache.call(e,"demo",{name:"_triageMustache",hash:{},hashTypes:{},hashContexts:{},types:["ID"],contexts:[e],data:n}),n.buffer.push(null!=i?i:"")},useData:!0})}),define("frontend/views/demos/derivatives",["exports","ember","../../libraries/mathAnimationLibrary/dist/display-library"],function(e,t,r){"use strict";var n=t["default"].View.extend({classNames:["full-height-view"],templateName:"demos/derivatives",didInsertElement:function(){this.get("controller").on("showFunction",this,this.showFunction),this.get("controller").on("showDerivative",this,this.showDerivative),this.get("controller").on("resetDisplay",this,this.resetDisplay),this.get("controller").on("toggleSubContainer",this,this.toggleSubContainer),this.get("controller").on("slideUpSubContainer",this,this.slideUpSubContainer),this.get("controller").on("slideDownSubContainer",this,this.slideDownSubContainer),this.params={functionInput:0,start:-10,end:10},this.derivativeParams={functionInput:0,location:0};var e=this;t["default"].run.next(function(){var t=$(".primary-container"),n=t[0],i=new r["default"](t,n,!0,!1,!1);e.display=i})},showFunction:function(e){this.params.functionInput=e,this.derivativeParams.functionInput=e,this.display.create2DFunction(this.params),this.showDerivative(this.derivativeParams)},showDerivative:function(e){this.derivativeParams.location=e,this.display.showDerivative(this.derivativeParams)},resetDisplay:function(){this.display.clearDisplay()},toggleContainers:function(){var e=$(".content-wrapper");e.animate({height:"toggle"},1e3)},toggleSubContainer:function(e){var t=$(e);t.slideToggle()},slideUpSubContainer:function(e){var t=$(e);t.slideUp()},slideDownSubContainer:function(e){var t=$(e);console.log(t),t.slideDown()}});e["default"]=n}),define("frontend/views/demos/integrals",["exports","ember","../../libraries/mathAnimationLibrary/dist/display-library"],function(e,t,r){"use strict";var n=t["default"].View.extend({classNames:["full-height-view"],templateName:"demos/integrals",didInsertElement:function(){this.get("controller").on("setAxis",this,this.setAxis),this.get("controller").on("chooseDiscrete",this,this.chooseDiscrete),this.get("controller").on("setNumDiscrete",this,this.setNumDiscrete),this.get("controller").on("showFunction",this,this.showFunction),this.get("controller").on("lowerBoundIntegrate",this,this.lowerBoundIntegrate),this.get("controller").on("upperBoundIntegrate",this,this.upperBoundIntegrate),this.get("controller").on("dualBoundIntegrate",this,this.dualBoundIntegrate),this.get("controller").on("resetDisplay",this,this.resetDisplay),this.get("controller").on("toggleSubContainer",this,this.toggleSubContainer),this.get("controller").on("slideUpSubContainer",this,this.slideUpSubContainer),this.get("controller").on("slideDownSubContainer",this,this.slideDownSubContainer),this.params={functionInput:0,axis:"x",start:-10,end:10},this.integralParams={functionInput:0,axis:"x",start:-10,end:10};var e=this;t["default"].run.next(function(){var t=$(".primary-container"),n=t[0],i=new r["default"](t,n,!0,!1,!1);e.display=i})},setAxis:function(e){this.params.axis=e,this.integralParams.axis=e},chooseDiscrete:function(){this.integralParams.discrete=!0,this.integralParams.numDiscrete=10,this.showFunction(this.params.functionInput)},setNumDiscrete:function(e){this.integralParams.numDiscrete=e},showFunction:function(e){this.params.functionInput=e,this.integralParams.functionInput=e,this.display.create2DFunction(this.params),this.display.createIntegralDisplay(this.integralParams)},lowerBoundIntegrate:function(e){this.integralParams.start=e,this.display.createIntegralDisplay(this.integralParams)},upperBoundIntegrate:function(e){this.integralParams.end=e,this.display.createIntegralDisplay(this.integralParams)},dualBoundIntegrate:function(e,t){this.integralParams.start=e,this.integralParams.end=t,this.display.createIntegralDisplay(this.integralParams)},resetDisplay:function(){this.display.clearDisplay(),this.params={functionInput:0,axis:"x",start:-10,end:10},this.integralParams={functionInput:0,axis:"x",start:-10,end:10}},toggleContainers:function(){var e=$(".content-wrapper");e.animate({height:"toggle"},1e3)},toggleSubContainer:function(e){var t=$(e);t.slideToggle()},slideUpSubContainer:function(e){var t=$(e);t.slideUp()},slideDownSubContainer:function(e){var t=$(e);t.slideDown()}});e["default"]=n}),define("frontend/views/demos/revolutions",["exports","ember","../../libraries/mathAnimationLibrary/dist/display-library"],function(e,t,r){"use strict";var n=t["default"].View.extend({classNames:["full-height-view"],templateName:"demos/revolutions",didInsertElement:function(){this.get("controller").on("setAxis",this,this.setAxis),this.get("controller").on("chooseDiscrete",this,this.chooseDiscrete),this.get("controller").on("setNumDiscrete",this,this.setNumDiscrete),this.get("controller").on("showFunction",this,this.showFunction),this.get("controller").on("lowerBoundRestrict",this,this.lowerBoundRestrict),this.get("controller").on("upperBoundRestrict",this,this.upperBoundRestrict),this.get("controller").on("dualBoundRestrict",this,this.dualBoundRestrict),this.get("controller").on("showAxis",this,this.showAxis),this.get("controller").on("startAnimation",this,this.startAnimation),this.get("controller").on("playAnimation",this,this.playAnimation),this.get("controller").on("pauseAnimation",this,this.pauseAnimation),this.get("controller").on("slowAnimation",this,this.slowAnimation),this.get("controller").on("speedAnimation",this,this.speedAnimation),this.get("controller").on("resetDisplay",this,this.resetDisplay),this.get("controller").on("toggleSubContainer",this,this.toggleSubContainer),this.get("controller").on("slideUpSubContainer",this,this.slideUpSubContainer),this.get("controller").on("slideDownSubContainer",this,this.slideDownSubContainer),this.params={functionInput:0,axis:"x",axisValue:0,start:-10,end:10};var e=this;t["default"].run.next(function(){var t=$(".primary-container"),n=t[0],i=new r["default"](t,n,!0,!1,!1);e.display=i})},setAxis:function(e){this.params.axis=e},chooseDiscrete:function(e){this.params.discrete=e,this.params.numDiscrete=10},setNumDiscrete:function(e){console.log(e),this.params.numDiscrete=e,console.log(this.params)},showFunction:function(e){this.params.functionInput=e,this.display.create2DFunction(this.params)},lowerBoundRestrict:function(e){this.params.start=e,this.display.create2DFunction(this.params)},upperBoundRestrict:function(e){this.params.end=e,this.display.create2DFunction(this.params)},dualBoundRestrict:function(e,t){this.params.start=e,this.params.end=t,this.display.create2DFunction(this.params)},showAxis:function(e){this.params.axisValue=e,this.display.createAxis(this.params)},startAnimation:function(){this.display.createRotationFunction(this.params),console.log(this.params),this.toggleContainers()},playAnimation:function(){this.display.playAnimation()},pauseAnimation:function(){this.display.pauseAnimation()},slowAnimation:function(){this.display.animationSpeed*=.5},speedAnimation:function(){this.display.animationSpeed*=2},resetDisplay:function(){this.display.clearDisplay(),this.params={functionInput:0,axis:"x",axisValue:0,start:-10,end:10},this.toggleContainers()},toggleContainers:function(){var e=$(".content-wrapper");e.slideToggle(1e3)},toggleSubContainer:function(e){var t=$(e);t.slideToggle()},slideUpSubContainer:function(e){var t=$(e);t.slideUp()},slideDownSubContainer:function(e){var t=$(e);t.slideDown()}});e["default"]=n}),define("frontend/views/flash",["exports","ember","../objects/flash-controller"],function(e,t,r){"use strict";var n=t["default"].View.extend({classNameBindings:["isNotice","isWarning","isError"],isNoticeBinding:"content.isNotice",isWarningBinding:"content.isWarning",isErrorBinding:"content.isError",didInsertElement:function(){return this.$("#message").hide(),r["default"].set("view",this)},show:function(e,t){return this.set("content",e),this.$("#message").css({top:"-40px"}).animate({top:"+=100",opacity:"toggle"},500,t)},hide:function(e){return this.$("#message").css({top:"0px"}).animate({top:"-39px",opacity:"toggle"},500,e)}});e["default"]=n}),define("frontend/views/lessons/equationViewer",["exports","ember"],function(e,t){"use strict";var r=t["default"].View.extend({templateName:"lessons/equationViewer"});e["default"]=r}),define("frontend/views/lessons/multipleChoice",["exports","ember"],function(e,t){"use strict";var r=t["default"].View.extend({templateName:"lessons/multipleChoice",didInsertElement:function(){this.setHeight(),this.verticallyCenter(),$(window).bind("resize",this.setHeight)},willDestroy:function(){$(window).unbind("resize",this.setHeight)},setHeight:function(){var e=$(".lesson-main-container").height(),t=$(".question-container").height(),r=e-t,n=$(".answer-container");n.css("height",r/2)},verticallyCenter:function(){var e=$(".answer-container");e.each(function(e,t){var r=$(t).height(),n=$(t).find(".answer"),i=n.height(),a=(r-i)/2;n.css("margin-top",a)})}});e["default"]=r}),define("frontend/config/environment",["ember"],function(e){var t="frontend";try{var r=t+"/config/environment",n=e["default"].$('meta[name="'+r+'"]').attr("content"),i=JSON.parse(unescape(n));return{"default":i}}catch(a){throw new Error('Could not read config from meta tag with name "'+r+'".')}}),runningTests?require("frontend/tests/test-helper"):require("frontend/app")["default"].create({name:"frontend",version:"0.0.0.7d5dfe0d"});